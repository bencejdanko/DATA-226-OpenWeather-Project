[0m23:16:53.064798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030a8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049d3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049d3d90>]}


============================== 23:16:53.067911 | d5af214c-91f6-430e-b5bc-961c3c148280 ==============================
[0m23:16:53.067911 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:16:53.068258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:16:53.291029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5af214c-91f6-430e-b5bc-961c3c148280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10562a520>]}
[0m23:16:53.314448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5af214c-91f6-430e-b5bc-961c3c148280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105524050>]}
[0m23:16:53.315030 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:16:53.382870 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:16:53.383366 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:16:53.383531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd5af214c-91f6-430e-b5bc-961c3c148280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054a4a50>]}
[0m23:16:53.798060 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.weather_dbt.openweather_join' (models/openweather_join.sql) depends on a node named 'WEATHER_FACT_TABLE' which was not found
[0m23:16:53.799931 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.77425057, "process_in_blocks": "0", "process_kernel_time": 0.209961, "process_mem_max_rss": "125304832", "process_out_blocks": "0", "process_user_time": 1.165652}
[0m23:16:53.800239 [debug] [MainThread]: Command `dbt run` failed at 23:16:53.800186 after 0.77 seconds
[0m23:16:53.800414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10582d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10582d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049dbe70>]}
[0m23:16:53.800576 [debug] [MainThread]: Flushing usage events
[0m23:18:18.035059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110098d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113adbb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113adbd90>]}


============================== 23:18:18.038131 | 7c0f7e30-9223-4124-a035-c0c934c74b67 ==============================
[0m23:18:18.038131 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:18:18.038451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:18:18.259083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c0f7e30-9223-4124-a035-c0c934c74b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114916520>]}
[0m23:18:18.282769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c0f7e30-9223-4124-a035-c0c934c74b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147f4050>]}
[0m23:18:18.283383 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:18:18.356710 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:18:18.357205 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:18:18.357373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7c0f7e30-9223-4124-a035-c0c934c74b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11476ca50>]}
[0m23:18:18.828867 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.weather_dbt.openweather_join' (models/input/openweather_join.sql) depends on a node named 'WEATHER_FACT_TABLE' which was not found
[0m23:18:18.832303 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8348069, "process_in_blocks": "0", "process_kernel_time": 0.209025, "process_mem_max_rss": "127107072", "process_out_blocks": "0", "process_user_time": 1.206207}
[0m23:18:18.832585 [debug] [MainThread]: Command `dbt run` failed at 23:18:18.832536 after 0.84 seconds
[0m23:18:18.832759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c1b200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c1bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ae3e70>]}
[0m23:18:18.832905 [debug] [MainThread]: Flushing usage events
[0m23:18:56.613307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ea8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d3d90>]}


============================== 23:18:56.615729 | 9f95813e-ed13-4b22-8194-10b43c7786d8 ==============================
[0m23:18:56.615729 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:18:56.616035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:18:56.792912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f95813e-ed13-4b22-8194-10b43c7786d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10542a520>]}
[0m23:18:56.816570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f95813e-ed13-4b22-8194-10b43c7786d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105324050>]}
[0m23:18:56.817126 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:18:56.876904 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:18:56.877410 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:18:56.877579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9f95813e-ed13-4b22-8194-10b43c7786d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052a0a50>]}
[0m23:18:57.370383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f95813e-ed13-4b22-8194-10b43c7786d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105276a80>]}
[0m23:18:57.413635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f95813e-ed13-4b22-8194-10b43c7786d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10563ab30>]}
[0m23:18:57.413917 [info ] [MainThread]: Found 1 model, 2 sources, 459 macros
[0m23:18:57.414071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f95813e-ed13-4b22-8194-10b43c7786d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105624870>]}
[0m23:18:57.415155 [info ] [MainThread]: 
[0m23:18:57.415418 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:18:57.415823 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:18:57.421863 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:18:57.422010 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:18:57.422133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:58.518554 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.096 seconds
[0m23:18:58.522394 [debug] [ThreadPool]: On list_openweather: Close
[0m23:18:58.709413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:18:58.720358 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:18:58.720710 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:18:58.720983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:18:59.192967 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.472 seconds
[0m23:18:59.196700 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:18:59.325372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f95813e-ed13-4b22-8194-10b43c7786d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059eb110>]}
[0m23:18:59.326299 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:18:59.326651 [info ] [MainThread]: 
[0m23:18:59.331303 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:18:59.331905 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:18:59.332358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.openweather_join)
[0m23:18:59.332703 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:18:59.340858 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:18:59.342089 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:18:59.363449 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:18:59.364564 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:18:59.364819 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    

SELECT
    w.CITY_ID,
    c.Name AS CITY_NAME,
    w.DATE_TIME,
    w.TEMP,
    w.FEELS_LIKE,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM 
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN 
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON 
    w.CITY_ID = c.CITY_ID
  );
[0m23:18:59.365027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:59.879417 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a36-0004-3867-0002-59430003563e
[0m23:18:59.880146 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 4
invalid identifier 'C.NAME'
[0m23:18:59.880720 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:19:00.023588 [debug] [Thread-1 (]: Database Error in model openweather_join (models/input/openweather_join.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'C.NAME'
  compiled code at target/run/weather_dbt/models/input/openweather_join.sql
[0m23:19:00.024921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f95813e-ed13-4b22-8194-10b43c7786d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b59860>]}
[0m23:19:00.025420 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics.openweather_join ................ [[31mERROR[0m in 0.69s]
[0m23:19:00.025880 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:19:00.027200 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:19:00.027441 [debug] [MainThread]: Connection 'model.weather_dbt.openweather_join' was properly closed.
[0m23:19:00.027666 [info ] [MainThread]: 
[0m23:19:00.027884 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.61 seconds (2.61s).
[0m23:19:00.028354 [debug] [MainThread]: Command end result
[0m23:19:00.047433 [info ] [MainThread]: 
[0m23:19:00.047703 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:19:00.047876 [info ] [MainThread]: 
[0m23:19:00.048096 [error] [MainThread]:   Database Error in model openweather_join (models/input/openweather_join.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'C.NAME'
  compiled code at target/run/weather_dbt/models/input/openweather_join.sql
[0m23:19:00.048261 [info ] [MainThread]: 
[0m23:19:00.048427 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:19:00.050194 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.4708219, "process_in_blocks": "0", "process_kernel_time": 0.261096, "process_mem_max_rss": "142065664", "process_out_blocks": "0", "process_user_time": 1.614037}
[0m23:19:00.050535 [debug] [MainThread]: Command `dbt run` failed at 23:19:00.050476 after 3.47 seconds
[0m23:19:00.050744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b831b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bc3ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105931a50>]}
[0m23:19:00.050938 [debug] [MainThread]: Flushing usage events
[0m23:19:31.320294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd3d90>]}


============================== 23:19:31.322809 | 91a441e8-0a26-42a7-a741-b4d8d953748d ==============================
[0m23:19:31.322809 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:19:31.323143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:19:31.498736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91a441e8-0a26-42a7-a741-b4d8d953748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10792a520>]}
[0m23:19:31.523326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91a441e8-0a26-42a7-a741-b4d8d953748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782c050>]}
[0m23:19:31.523818 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:19:31.580224 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:19:31.634984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:19:31.635346 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/input/openweather_join.sql
[0m23:19:31.736140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91a441e8-0a26-42a7-a741-b4d8d953748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a3250>]}
[0m23:19:31.776284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91a441e8-0a26-42a7-a741-b4d8d953748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb8140>]}
[0m23:19:31.776601 [info ] [MainThread]: Found 1 model, 2 sources, 459 macros
[0m23:19:31.776775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91a441e8-0a26-42a7-a741-b4d8d953748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce0590>]}
[0m23:19:31.777667 [info ] [MainThread]: 
[0m23:19:31.777983 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:19:31.778433 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:19:31.784874 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:19:31.785077 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:19:31.785207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:32.437911 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.653 seconds
[0m23:19:32.439586 [debug] [ThreadPool]: On list_openweather: Close
[0m23:19:32.560851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:19:32.571795 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:19:32.572154 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:19:32.572410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:19:33.106466 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.534 seconds
[0m23:19:33.109223 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:19:33.260783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91a441e8-0a26-42a7-a741-b4d8d953748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c88c80>]}
[0m23:19:33.261448 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:19:33.261725 [info ] [MainThread]: 
[0m23:19:33.264080 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:19:33.264683 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:19:33.265117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.openweather_join)
[0m23:19:33.265392 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:19:33.272779 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:19:33.273606 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:19:33.296718 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:19:33.297774 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:19:33.298079 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c.Name AS CITY_NAME,
    w.DATE_TIME,
    w.TEMP,
    w.FEELS_LIKE,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM 
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN 
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON 
    w.CITY_ID = c.CITY_ID
  );
[0m23:19:33.298328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:19:33.826582 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a37-0004-386b-0002-59430003b61e
[0m23:19:33.827406 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 4
invalid identifier 'C.NAME'
[0m23:19:33.828054 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:19:33.966364 [debug] [Thread-1 (]: Database Error in model openweather_join (models/input/openweather_join.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'C.NAME'
  compiled code at target/run/weather_dbt/models/input/openweather_join.sql
[0m23:19:33.968320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91a441e8-0a26-42a7-a741-b4d8d953748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb8d10>]}
[0m23:19:33.969101 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics.openweather_join ................ [[31mERROR[0m in 0.70s]
[0m23:19:33.969712 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:19:33.971923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:19:33.972263 [debug] [MainThread]: Connection 'model.weather_dbt.openweather_join' was properly closed.
[0m23:19:33.972529 [info ] [MainThread]: 
[0m23:19:33.972780 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m23:19:33.973346 [debug] [MainThread]: Command end result
[0m23:19:33.993930 [info ] [MainThread]: 
[0m23:19:33.994272 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:19:33.994494 [info ] [MainThread]: 
[0m23:19:33.994759 [error] [MainThread]:   Database Error in model openweather_join (models/input/openweather_join.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'C.NAME'
  compiled code at target/run/weather_dbt/models/input/openweather_join.sql
[0m23:19:33.994965 [info ] [MainThread]: 
[0m23:19:33.995201 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:19:33.996410 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.7121155, "process_in_blocks": "0", "process_kernel_time": 0.207388, "process_mem_max_rss": "141279232", "process_out_blocks": "0", "process_user_time": 1.228307}
[0m23:19:33.996728 [debug] [MainThread]: Command `dbt run` failed at 23:19:33.996672 after 2.71 seconds
[0m23:19:33.996933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe8680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f9f7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f9ff70>]}
[0m23:19:33.997120 [debug] [MainThread]: Flushing usage events
[0m23:20:25.303495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024c4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103defb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103defd90>]}


============================== 23:20:25.305935 | 2a79df66-1299-488b-a501-de3a0373d652 ==============================
[0m23:20:25.305935 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:20:25.306239 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:20:25.484752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a79df66-1299-488b-a501-de3a0373d652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c82520>]}
[0m23:20:25.509968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a79df66-1299-488b-a501-de3a0373d652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf0050>]}
[0m23:20:25.510568 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:20:25.568444 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:20:25.621285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:20:25.621625 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/input/openweather_join.sql
[0m23:20:25.726141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a79df66-1299-488b-a501-de3a0373d652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b6f250>]}
[0m23:20:25.772960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a79df66-1299-488b-a501-de3a0373d652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b43c50>]}
[0m23:20:25.773263 [info ] [MainThread]: Found 1 model, 2 sources, 459 macros
[0m23:20:25.773433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a79df66-1299-488b-a501-de3a0373d652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10503c2f0>]}
[0m23:20:25.774641 [info ] [MainThread]: 
[0m23:20:25.775068 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:20:25.775717 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:20:25.782725 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:20:25.782947 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:20:25.783083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:20:26.387975 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.604 seconds
[0m23:20:26.391289 [debug] [ThreadPool]: On list_openweather: Close
[0m23:20:26.506673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:20:26.515384 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:20:26.515644 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:20:26.515830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:20:27.033357 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.517 seconds
[0m23:20:27.036331 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:20:27.158867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a79df66-1299-488b-a501-de3a0373d652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe4c80>]}
[0m23:20:27.159730 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:20:27.160151 [info ] [MainThread]: 
[0m23:20:27.164616 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:20:27.165221 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:20:27.165676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.openweather_join)
[0m23:20:27.166056 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:20:27.174339 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:20:27.175211 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:20:27.197826 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:20:27.198766 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:20:27.199029 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,  -- Use quotes for case-sensitive column names
    w.DATE_TIME,
    w.TEMP,
    w.FEELS_LIKE,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM 
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN 
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON 
    w.CITY_ID = c.CITY_ID
  );
[0m23:20:27.199270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:27.806933 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.607 seconds
[0m23:20:27.834216 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:20:27.960195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a79df66-1299-488b-a501-de3a0373d652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054a5190>]}
[0m23:20:27.961439 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.79s]
[0m23:20:27.962153 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:20:27.963660 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:20:27.963914 [debug] [MainThread]: Connection 'model.weather_dbt.openweather_join' was properly closed.
[0m23:20:27.964150 [info ] [MainThread]: 
[0m23:20:27.964360 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m23:20:27.964846 [debug] [MainThread]: Command end result
[0m23:20:27.987412 [info ] [MainThread]: 
[0m23:20:27.987756 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:20:27.987955 [info ] [MainThread]: 
[0m23:20:27.988162 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:20:27.989890 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.720691, "process_in_blocks": "0", "process_kernel_time": 0.20967, "process_mem_max_rss": "138559488", "process_out_blocks": "0", "process_user_time": 1.269377}
[0m23:20:27.990234 [debug] [MainThread]: Command `dbt run` succeeded at 23:20:27.990173 after 2.72 seconds
[0m23:20:27.990447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054d0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3ddb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3e8f0>]}
[0m23:20:27.990651 [debug] [MainThread]: Flushing usage events
[0m23:26:16.536826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111813b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111813d90>]}


============================== 23:26:16.539829 | 9bd3d72d-cac7-4a2f-a4f3-c1adf0447163 ==============================
[0m23:26:16.539829 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:26:16.540143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:26:16.773722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bd3d72d-cac7-4a2f-a4f3-c1adf0447163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112786520>]}
[0m23:26:16.799326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bd3d72d-cac7-4a2f-a4f3-c1adf0447163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126f8050>]}
[0m23:26:16.800094 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:26:16.861648 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:26:16.920807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:26:16.921160 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/input/openweather_join.sql
[0m23:26:17.021178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bd3d72d-cac7-4a2f-a4f3-c1adf0447163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112673250>]}
[0m23:26:17.065464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bd3d72d-cac7-4a2f-a4f3-c1adf0447163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a04140>]}
[0m23:26:17.065760 [info ] [MainThread]: Found 1 model, 2 sources, 459 macros
[0m23:26:17.065920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bd3d72d-cac7-4a2f-a4f3-c1adf0447163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b3c2f0>]}
[0m23:26:17.066771 [info ] [MainThread]: 
[0m23:26:17.067047 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:26:17.067492 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:26:17.073488 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:26:17.073642 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:26:17.073759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:17.720994 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.647 seconds
[0m23:26:17.723785 [debug] [ThreadPool]: On list_openweather: Close
[0m23:26:17.841718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:26:17.851967 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:26:17.852303 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:26:17.852584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:18.362326 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.509 seconds
[0m23:26:18.366634 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:26:18.535974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bd3d72d-cac7-4a2f-a4f3-c1adf0447163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ae4c80>]}
[0m23:26:18.536636 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:26:18.536883 [info ] [MainThread]: 
[0m23:26:18.539805 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:26:18.540139 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:26:18.540383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.openweather_join)
[0m23:26:18.540548 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:26:18.544771 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:26:18.545204 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:26:18.564431 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:26:18.565462 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:26:18.565761 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,  -- Use quotes for case-sensitive column names
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m23:26:18.566011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:19.378224 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.812 seconds
[0m23:26:19.406541 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:26:19.521485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd3d72d-cac7-4a2f-a4f3-c1adf0447163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130a5850>]}
[0m23:26:19.522500 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.98s]
[0m23:26:19.523345 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:26:19.525069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:26:19.525446 [debug] [MainThread]: Connection 'model.weather_dbt.openweather_join' was properly closed.
[0m23:26:19.525780 [info ] [MainThread]: 
[0m23:26:19.526101 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.46 seconds (2.46s).
[0m23:26:19.526808 [debug] [MainThread]: Command end result
[0m23:26:19.550994 [info ] [MainThread]: 
[0m23:26:19.551321 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:26:19.551524 [info ] [MainThread]: 
[0m23:26:19.551749 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:26:19.553478 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0553112, "process_in_blocks": "0", "process_kernel_time": 0.248936, "process_mem_max_rss": "139558912", "process_out_blocks": "0", "process_user_time": 1.257798}
[0m23:26:19.553821 [debug] [MainThread]: Command `dbt run` succeeded at 23:26:19.553760 after 3.06 seconds
[0m23:26:19.554040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130c05d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a220d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a22a30>]}
[0m23:26:19.554243 [debug] [MainThread]: Flushing usage events
[0m23:40:29.092513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027f0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f3d90>]}


============================== 23:40:29.095960 | 33c3869e-ee2d-45b5-a338-3d21c3dae4ac ==============================
[0m23:40:29.095960 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:40:29.096364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:40:29.320892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33c3869e-ee2d-45b5-a338-3d21c3dae4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d4e520>]}
[0m23:40:29.345520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33c3869e-ee2d-45b5-a338-3d21c3dae4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c48050>]}
[0m23:40:29.346163 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:40:29.409940 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:40:29.450463 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:40:29.450724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '33c3869e-ee2d-45b5-a338-3d21c3dae4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc1350>]}
[0m23:40:29.935802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33c3869e-ee2d-45b5-a338-3d21c3dae4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105066120>]}
[0m23:40:29.976973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33c3869e-ee2d-45b5-a338-3d21c3dae4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ac050>]}
[0m23:40:29.977221 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m23:40:29.977367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33c3869e-ee2d-45b5-a338-3d21c3dae4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050de0d0>]}
[0m23:40:29.978250 [info ] [MainThread]: 
[0m23:40:29.978492 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:40:29.980566 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:40:29.987527 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:40:29.987685 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:40:29.987797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:30.532405 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.544 seconds
[0m23:40:30.535609 [debug] [ThreadPool]: On list_openweather: Close
[0m23:40:30.674315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:40:30.683271 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:40:30.683651 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:40:30.683906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:40:31.188358 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.504 seconds
[0m23:40:31.191934 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:40:31.319514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33c3869e-ee2d-45b5-a338-3d21c3dae4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105458290>]}
[0m23:40:31.320339 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:40:31.320742 [info ] [MainThread]: 
[0m23:40:31.323583 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m23:40:31.324057 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m23:40:31.324395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m23:40:31.324637 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m23:40:31.330756 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:40:31.331430 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m23:40:31.349009 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:40:31.350034 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m23:40:31.350277 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m23:40:31.350470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:33.322137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.971 seconds
[0m23:40:33.345684 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m23:40:33.488560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33c3869e-ee2d-45b5-a338-3d21c3dae4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10559d020>]}
[0m23:40:33.489710 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 2.16s]
[0m23:40:33.490558 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m23:40:33.491163 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m23:40:33.491868 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m23:40:33.492432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m23:40:33.492837 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m23:40:33.496626 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m23:40:33.497703 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m23:40:33.500026 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m23:40:33.502623 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m23:40:33.503170 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20
ORDER BY
    w.DATE_TIME, c."Name"
        );
[0m23:40:33.503516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:34.974812 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.471 seconds
[0m23:40:34.979072 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m23:40:35.121939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33c3869e-ee2d-45b5-a338-3d21c3dae4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054fdef0>]}
[0m23:40:35.123386 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.63s]
[0m23:40:35.124206 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m23:40:35.124795 [debug] [Thread-1 (]: Began running node model.weather_dbt.geo_weather_overview
[0m23:40:35.125554 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.geo_weather_overview .................... [RUN]
[0m23:40:35.126242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.geo_weather_overview)
[0m23:40:35.126642 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.geo_weather_overview
[0m23:40:35.130555 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.geo_weather_overview"
[0m23:40:35.131712 [debug] [Thread-1 (]: Began executing node model.weather_dbt.geo_weather_overview
[0m23:40:35.133983 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.geo_weather_overview"
[0m23:40:35.135300 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.geo_weather_overview"
[0m23:40:35.135659 [debug] [Thread-1 (]: On model.weather_dbt.geo_weather_overview: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.geo_weather_overview"} */
create or replace transient table openweather.analytics.geo_weather_overview
         as
        (SELECT
    c.CITY_ID,
    c."Name" AS CITY_NAME,
    c.LATITUDE,
    c.LONGITUDE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    c.CITY_ID, c."Name", c.LATITUDE, c.LONGITUDE
ORDER BY
    AVG_TEMP_FAHRENHEIT DESC
        );
[0m23:40:35.135983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:35.552397 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a4c-0004-3868-0002-59430003866a
[0m23:40:35.553094 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 4
invalid identifier 'C.LATITUDE'
[0m23:40:35.553646 [debug] [Thread-1 (]: On model.weather_dbt.geo_weather_overview: Close
[0m23:40:35.746426 [debug] [Thread-1 (]: Database Error in model geo_weather_overview (models/output/geo_weather_overview.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/output/geo_weather_overview.sql
[0m23:40:35.747285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33c3869e-ee2d-45b5-a338-3d21c3dae4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054541d0>]}
[0m23:40:35.748076 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model analytics.geo_weather_overview ........... [[31mERROR[0m in 0.62s]
[0m23:40:35.748715 [debug] [Thread-1 (]: Finished running node model.weather_dbt.geo_weather_overview
[0m23:40:35.749098 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:40:35.750346 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:40:35.750827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.geo_weather_overview, now model.weather_dbt.openweather_join)
[0m23:40:35.751158 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:40:35.754434 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:40:35.755195 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:40:35.771998 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:40:35.772886 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:40:35.773129 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m23:40:35.773348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:36.526639 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.753 seconds
[0m23:40:36.535173 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:40:36.657607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33c3869e-ee2d-45b5-a338-3d21c3dae4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10560aeb0>]}
[0m23:40:36.658668 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.91s]
[0m23:40:36.659436 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:40:36.659980 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m23:40:36.660704 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m23:40:36.661361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m23:40:36.661806 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m23:40:36.665436 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m23:40:36.666618 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m23:40:36.668911 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m23:40:36.670026 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m23:40:36.670371 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN
ORDER BY
    CONDITION_COUNT DESC, c."Name"
        );
[0m23:40:36.670676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:37.903981 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.233 seconds
[0m23:40:37.907280 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m23:40:38.017319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33c3869e-ee2d-45b5-a338-3d21c3dae4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056dc8f0>]}
[0m23:40:38.018348 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.36s]
[0m23:40:38.019159 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m23:40:38.020993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:40:38.021454 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m23:40:38.021933 [info ] [MainThread]: 
[0m23:40:38.022310 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 8.04 seconds (8.04s).
[0m23:40:38.023546 [debug] [MainThread]: Command end result
[0m23:40:38.051191 [info ] [MainThread]: 
[0m23:40:38.051487 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:40:38.051672 [info ] [MainThread]: 
[0m23:40:38.051933 [error] [MainThread]:   Database Error in model geo_weather_overview (models/output/geo_weather_overview.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/output/geo_weather_overview.sql
[0m23:40:38.052155 [info ] [MainThread]: 
[0m23:40:38.052360 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:40:38.053967 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.00236, "process_in_blocks": "0", "process_kernel_time": 0.278855, "process_mem_max_rss": "145473536", "process_out_blocks": "0", "process_user_time": 1.872912}
[0m23:40:38.054325 [debug] [MainThread]: Command `dbt run` failed at 23:40:38.054264 after 9.00 seconds
[0m23:40:38.054549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552e570>]}
[0m23:40:38.054754 [debug] [MainThread]: Flushing usage events
[0m23:42:33.046382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fe4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10890fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10890fd90>]}


============================== 23:42:33.049671 | 6006374a-43ac-437a-9e1d-1c3656cf1f3b ==============================
[0m23:42:33.049671 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:42:33.050000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:42:33.275494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6006374a-43ac-437a-9e1d-1c3656cf1f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10956a520>]}
[0m23:42:33.299862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6006374a-43ac-437a-9e1d-1c3656cf1f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109464050>]}
[0m23:42:33.301246 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:42:33.361626 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:42:33.402274 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:42:33.402520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6006374a-43ac-437a-9e1d-1c3656cf1f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093dd350>]}
[0m23:42:33.887249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6006374a-43ac-437a-9e1d-1c3656cf1f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109897b60>]}
[0m23:42:33.928233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6006374a-43ac-437a-9e1d-1c3656cf1f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d78130>]}
[0m23:42:33.928478 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m23:42:33.928624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6006374a-43ac-437a-9e1d-1c3656cf1f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099060d0>]}
[0m23:42:33.929547 [info ] [MainThread]: 
[0m23:42:33.929804 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:42:33.931869 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:42:33.938763 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:42:33.938919 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:42:33.939041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:34.541086 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.602 seconds
[0m23:42:34.545299 [debug] [ThreadPool]: On list_openweather: Close
[0m23:42:34.671436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:42:34.682516 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:42:34.682875 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:42:34.683171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:42:35.234022 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.551 seconds
[0m23:42:35.237522 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:42:35.398915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6006374a-43ac-437a-9e1d-1c3656cf1f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a938290>]}
[0m23:42:35.400108 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:42:35.400569 [info ] [MainThread]: 
[0m23:42:35.405528 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m23:42:35.406198 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m23:42:35.406679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m23:42:35.406990 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m23:42:35.416711 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:42:35.417707 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m23:42:35.439659 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:42:35.440616 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m23:42:35.440848 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m23:42:35.441050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:36.596841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.155 seconds
[0m23:42:36.623537 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m23:42:36.796678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6006374a-43ac-437a-9e1d-1c3656cf1f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa74cb0>]}
[0m23:42:36.797332 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.39s]
[0m23:42:36.797771 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m23:42:36.798074 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m23:42:36.798494 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m23:42:36.798880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m23:42:36.799136 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m23:42:36.801369 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m23:42:36.802045 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m23:42:36.804159 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m23:42:36.805224 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m23:42:36.805645 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20
ORDER BY
    w.DATE_TIME, c."Name"
        );
[0m23:42:36.806035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:38.186681 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.380 seconds
[0m23:42:38.190987 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m23:42:38.361091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6006374a-43ac-437a-9e1d-1c3656cf1f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9d7610>]}
[0m23:42:38.362244 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.56s]
[0m23:42:38.363062 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m23:42:38.363604 [debug] [Thread-1 (]: Began running node model.weather_dbt.geo_weather_overview
[0m23:42:38.364139 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.geo_weather_overview .................... [RUN]
[0m23:42:38.364836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.geo_weather_overview)
[0m23:42:38.365414 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.geo_weather_overview
[0m23:42:38.369370 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.geo_weather_overview"
[0m23:42:38.370464 [debug] [Thread-1 (]: Began executing node model.weather_dbt.geo_weather_overview
[0m23:42:38.372851 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.geo_weather_overview"
[0m23:42:38.374095 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.geo_weather_overview"
[0m23:42:38.374438 [debug] [Thread-1 (]: On model.weather_dbt.geo_weather_overview: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.geo_weather_overview"} */
create or replace transient table openweather.analytics.geo_weather_overview
         as
        (SELECT
    c.CITY_ID,
    c."Name" AS CITY_NAME,
    c.LATITUDE,
    c.LONGITUDE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    c.CITY_ID, c."Name", c.LATITUDE, c.LONGITUDE
ORDER BY
    AVG_TEMP_FAHRENHEIT DESC
        );
[0m23:42:38.374768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:38.949186 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a4e-0004-386c-0002-5943000376d2
[0m23:42:38.949712 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 4
invalid identifier 'C.LATITUDE'
[0m23:42:38.950183 [debug] [Thread-1 (]: On model.weather_dbt.geo_weather_overview: Close
[0m23:42:39.086705 [debug] [Thread-1 (]: Database Error in model geo_weather_overview (models/output/geo_weather_overview.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/output/geo_weather_overview.sql
[0m23:42:39.087389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6006374a-43ac-437a-9e1d-1c3656cf1f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bbf850>]}
[0m23:42:39.088042 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model analytics.geo_weather_overview ........... [[31mERROR[0m in 0.72s]
[0m23:42:39.088620 [debug] [Thread-1 (]: Finished running node model.weather_dbt.geo_weather_overview
[0m23:42:39.089026 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:42:39.089461 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:42:39.089881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.geo_weather_overview, now model.weather_dbt.openweather_join)
[0m23:42:39.090177 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:42:39.093164 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:42:39.094680 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:42:39.112217 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:42:39.113184 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:42:39.113490 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m23:42:39.113716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:39.852890 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.739 seconds
[0m23:42:39.857612 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:42:39.972140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6006374a-43ac-437a-9e1d-1c3656cf1f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f488a0>]}
[0m23:42:39.973275 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.88s]
[0m23:42:39.974068 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:42:39.974621 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m23:42:39.975275 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m23:42:39.975890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m23:42:39.976350 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m23:42:39.980043 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m23:42:39.981122 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m23:42:39.983513 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m23:42:39.984649 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m23:42:39.985025 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN
ORDER BY
    CONDITION_COUNT DESC, c."Name"
        );
[0m23:42:39.985368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:41.414846 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.429 seconds
[0m23:42:41.418379 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m23:42:41.599561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6006374a-43ac-437a-9e1d-1c3656cf1f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adb4530>]}
[0m23:42:41.600734 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.62s]
[0m23:42:41.601562 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m23:42:41.603382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:42:41.603686 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m23:42:41.604074 [info ] [MainThread]: 
[0m23:42:41.604387 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 7.67 seconds (7.67s).
[0m23:42:41.605631 [debug] [MainThread]: Command end result
[0m23:42:41.633126 [info ] [MainThread]: 
[0m23:42:41.633390 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:42:41.633568 [info ] [MainThread]: 
[0m23:42:41.633790 [error] [MainThread]:   Database Error in model geo_weather_overview (models/output/geo_weather_overview.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/output/geo_weather_overview.sql
[0m23:42:41.633964 [info ] [MainThread]: 
[0m23:42:41.634137 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:42:41.635887 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.630753, "process_in_blocks": "0", "process_kernel_time": 0.278458, "process_mem_max_rss": "145162240", "process_out_blocks": "0", "process_user_time": 1.89999}
[0m23:42:41.636206 [debug] [MainThread]: Command `dbt run` failed at 23:42:41.636150 after 8.63 seconds
[0m23:42:41.636415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107769670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aad7b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aad4ad0>]}
[0m23:42:41.636614 [debug] [MainThread]: Flushing usage events
[0m23:43:58.210840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029b8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042bfb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042bfd90>]}


============================== 23:43:58.213871 | bb5cc7fb-4801-4662-b43e-a4ea407a2af7 ==============================
[0m23:43:58.213871 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:43:58.214170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:43:58.428051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb5cc7fb-4801-4662-b43e-a4ea407a2af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f12520>]}
[0m23:43:58.451610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb5cc7fb-4801-4662-b43e-a4ea407a2af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e10050>]}
[0m23:43:58.452273 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:43:58.510868 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:43:58.571152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:43:58.571568 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/geo_weather_overview.sql
[0m23:43:58.672264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb5cc7fb-4801-4662-b43e-a4ea407a2af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d8b450>]}
[0m23:43:58.717122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb5cc7fb-4801-4662-b43e-a4ea407a2af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5fe30>]}
[0m23:43:58.717390 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m23:43:58.717550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb5cc7fb-4801-4662-b43e-a4ea407a2af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d4750>]}
[0m23:43:58.718535 [info ] [MainThread]: 
[0m23:43:58.718820 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:43:58.720951 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:43:58.727103 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:43:58.727268 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:43:58.727397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:59.312579 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.585 seconds
[0m23:43:59.314604 [debug] [ThreadPool]: On list_openweather: Close
[0m23:43:59.453724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:43:59.465115 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:43:59.465490 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:43:59.465755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:44:00.068925 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.603 seconds
[0m23:44:00.073809 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:44:00.211691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb5cc7fb-4801-4662-b43e-a4ea407a2af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040a53d0>]}
[0m23:44:00.212686 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:44:00.213115 [info ] [MainThread]: 
[0m23:44:00.217540 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m23:44:00.218168 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m23:44:00.218637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m23:44:00.218984 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m23:44:00.227293 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:44:00.228104 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m23:44:00.250039 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:44:00.250991 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m23:44:00.251237 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m23:44:00.251457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:01.585574 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.334 seconds
[0m23:44:01.606886 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m23:44:01.727578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5cc7fb-4801-4662-b43e-a4ea407a2af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10559c050>]}
[0m23:44:01.728776 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.51s]
[0m23:44:01.729754 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m23:44:01.730416 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m23:44:01.731136 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m23:44:01.731765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m23:44:01.732148 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m23:44:01.735773 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m23:44:01.736786 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m23:44:01.739902 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m23:44:01.741389 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m23:44:01.741770 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20
ORDER BY
    w.DATE_TIME, c."Name"
        );
[0m23:44:01.742102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:02.826368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.084 seconds
[0m23:44:02.830591 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m23:44:03.033291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5cc7fb-4801-4662-b43e-a4ea407a2af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10428e150>]}
[0m23:44:03.034621 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.30s]
[0m23:44:03.035436 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m23:44:03.035979 [debug] [Thread-1 (]: Began running node model.weather_dbt.geo_weather_overview
[0m23:44:03.036719 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.geo_weather_overview .................... [RUN]
[0m23:44:03.037348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.geo_weather_overview)
[0m23:44:03.037732 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.geo_weather_overview
[0m23:44:03.041575 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.geo_weather_overview"
[0m23:44:03.042691 [debug] [Thread-1 (]: Began executing node model.weather_dbt.geo_weather_overview
[0m23:44:03.045700 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.geo_weather_overview"
[0m23:44:03.046851 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.geo_weather_overview"
[0m23:44:03.047186 [debug] [Thread-1 (]: On model.weather_dbt.geo_weather_overview: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.geo_weather_overview"} */
create or replace transient table openweather.analytics.geo_weather_overview
         as
        (SELECT
    c.CITY_ID,
    c."Name" AS CITY_NAME,
    c."LATITUDE",
    c."LONGITUDE",
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    c.CITY_ID, c."Name", c.LATITUDE, c.LONGITUDE
ORDER BY
    AVG_TEMP_FAHRENHEIT DESC
        );
[0m23:44:03.047501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:03.484321 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a50-0004-386b-0002-59430003b65a
[0m23:44:03.485008 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 4
invalid identifier 'C.LATITUDE'
[0m23:44:03.485575 [debug] [Thread-1 (]: On model.weather_dbt.geo_weather_overview: Close
[0m23:44:03.614100 [debug] [Thread-1 (]: Database Error in model geo_weather_overview (models/output/geo_weather_overview.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/output/geo_weather_overview.sql
[0m23:44:03.614962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5cc7fb-4801-4662-b43e-a4ea407a2af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10566d130>]}
[0m23:44:03.615795 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model analytics.geo_weather_overview ........... [[31mERROR[0m in 0.58s]
[0m23:44:03.616378 [debug] [Thread-1 (]: Finished running node model.weather_dbt.geo_weather_overview
[0m23:44:03.616771 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:44:03.618010 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:44:03.618502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.geo_weather_overview, now model.weather_dbt.openweather_join)
[0m23:44:03.618837 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:44:03.622038 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:44:03.622770 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:44:03.639483 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:44:03.640350 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:44:03.640598 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m23:44:03.640812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:04.441963 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.801 seconds
[0m23:44:04.446692 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:44:04.576116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5cc7fb-4801-4662-b43e-a4ea407a2af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10201eb50>]}
[0m23:44:04.577293 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.96s]
[0m23:44:04.578102 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:44:04.578652 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m23:44:04.579354 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m23:44:04.580006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m23:44:04.580464 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m23:44:04.584278 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m23:44:04.585331 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m23:44:04.588442 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m23:44:04.589576 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m23:44:04.589913 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN
ORDER BY
    CONDITION_COUNT DESC, c."Name"
        );
[0m23:44:04.590222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:05.777550 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.187 seconds
[0m23:44:05.781707 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m23:44:05.911100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5cc7fb-4801-4662-b43e-a4ea407a2af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057844b0>]}
[0m23:44:05.912415 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.33s]
[0m23:44:05.913225 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m23:44:05.915041 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:44:05.915419 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m23:44:05.915856 [info ] [MainThread]: 
[0m23:44:05.916230 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 7.20 seconds (7.20s).
[0m23:44:05.917624 [debug] [MainThread]: Command end result
[0m23:44:05.946969 [info ] [MainThread]: 
[0m23:44:05.947284 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:44:05.947470 [info ] [MainThread]: 
[0m23:44:05.947704 [error] [MainThread]:   Database Error in model geo_weather_overview (models/output/geo_weather_overview.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/output/geo_weather_overview.sql
[0m23:44:05.947887 [info ] [MainThread]: 
[0m23:44:05.948068 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:44:05.949561 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.7750583, "process_in_blocks": "0", "process_kernel_time": 0.272976, "process_mem_max_rss": "140935168", "process_out_blocks": "0", "process_user_time": 1.557957}
[0m23:44:05.949910 [debug] [MainThread]: Command `dbt run` failed at 23:44:05.949851 after 7.78 seconds
[0m23:44:05.950138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f430b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552bbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552b4d0>]}
[0m23:44:05.950344 [debug] [MainThread]: Flushing usage events
[0m23:44:45.390222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10326cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b97b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b97d90>]}


============================== 23:44:45.393382 | beca5c23-9957-4912-9b63-78194aca3386 ==============================
[0m23:44:45.393382 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:44:45.393693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:44:45.609681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'beca5c23-9957-4912-9b63-78194aca3386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057f2520>]}
[0m23:44:45.632472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'beca5c23-9957-4912-9b63-78194aca3386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056f4050>]}
[0m23:44:45.633049 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:44:45.690929 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:44:45.751699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:44:45.752041 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/geo_weather_overview.sql
[0m23:44:45.853808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'beca5c23-9957-4912-9b63-78194aca3386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10566b450>]}
[0m23:44:45.897945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'beca5c23-9957-4912-9b63-78194aca3386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10563be30>]}
[0m23:44:45.898235 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m23:44:45.898393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'beca5c23-9957-4912-9b63-78194aca3386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb42f0>]}
[0m23:44:45.899355 [info ] [MainThread]: 
[0m23:44:45.899633 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:44:45.901750 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:44:45.907853 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:44:45.908017 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:44:45.908322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:44:46.456225 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.548 seconds
[0m23:44:46.459972 [debug] [ThreadPool]: On list_openweather: Close
[0m23:44:46.585482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:44:46.596596 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:44:46.596968 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:44:46.597235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:44:47.066096 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.469 seconds
[0m23:44:47.071109 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:44:47.203658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'beca5c23-9957-4912-9b63-78194aca3386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049813d0>]}
[0m23:44:47.204610 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:44:47.205053 [info ] [MainThread]: 
[0m23:44:47.209581 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m23:44:47.210215 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m23:44:47.210717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m23:44:47.211076 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m23:44:47.219404 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:44:47.220298 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m23:44:47.242567 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:44:47.243647 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m23:44:47.243913 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m23:44:47.244145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:48.448401 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.203 seconds
[0m23:44:48.474047 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m23:44:48.607478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'beca5c23-9957-4912-9b63-78194aca3386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e7b950>]}
[0m23:44:48.608673 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.40s]
[0m23:44:48.609736 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m23:44:48.610296 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m23:44:48.610981 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m23:44:48.611613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m23:44:48.612017 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m23:44:48.615839 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m23:44:48.616895 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m23:44:48.619979 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m23:44:48.621433 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m23:44:48.621815 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20
ORDER BY
    w.DATE_TIME, c."Name"
        );
[0m23:44:48.622165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:49.952169 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.329 seconds
[0m23:44:49.956302 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m23:44:50.072371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'beca5c23-9957-4912-9b63-78194aca3386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b66150>]}
[0m23:44:50.073385 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.46s]
[0m23:44:50.074193 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m23:44:50.074766 [debug] [Thread-1 (]: Began running node model.weather_dbt.geo_weather_overview
[0m23:44:50.075529 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.geo_weather_overview .................... [RUN]
[0m23:44:50.076239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.geo_weather_overview)
[0m23:44:50.076707 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.geo_weather_overview
[0m23:44:50.080482 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.geo_weather_overview"
[0m23:44:50.081398 [debug] [Thread-1 (]: Began executing node model.weather_dbt.geo_weather_overview
[0m23:44:50.084426 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.geo_weather_overview"
[0m23:44:50.085416 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.geo_weather_overview"
[0m23:44:50.085660 [debug] [Thread-1 (]: On model.weather_dbt.geo_weather_overview: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.geo_weather_overview"} */
create or replace transient table openweather.analytics.geo_weather_overview
         as
        (SELECT
    c.CITY_ID,
    c."Name" AS CITY_NAME,
    c."Latitude",
    c."Longitude",
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    c.CITY_ID, c."Name", c.LATITUDE, c.LONGITUDE
ORDER BY
    AVG_TEMP_FAHRENHEIT DESC
        );
[0m23:44:50.085870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:50.521394 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a50-0004-386b-0002-59430003b65e
[0m23:44:50.522098 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 18 at position 25
invalid identifier 'C.LATITUDE'
[0m23:44:50.522627 [debug] [Thread-1 (]: On model.weather_dbt.geo_weather_overview: Close
[0m23:44:50.640647 [debug] [Thread-1 (]: Database Error in model geo_weather_overview (models/output/geo_weather_overview.sql)
  000904 (42000): SQL compilation error: error line 18 at position 25
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/output/geo_weather_overview.sql
[0m23:44:50.641520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'beca5c23-9957-4912-9b63-78194aca3386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106171130>]}
[0m23:44:50.642364 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model analytics.geo_weather_overview ........... [[31mERROR[0m in 0.57s]
[0m23:44:50.642972 [debug] [Thread-1 (]: Finished running node model.weather_dbt.geo_weather_overview
[0m23:44:50.643382 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:44:50.644757 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:44:50.645519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.geo_weather_overview, now model.weather_dbt.openweather_join)
[0m23:44:50.645962 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:44:50.649401 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:44:50.650303 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:44:50.667565 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:44:50.668548 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:44:50.668800 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m23:44:50.669023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:51.281597 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m23:44:51.285862 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:44:51.400566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'beca5c23-9957-4912-9b63-78194aca3386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028fab50>]}
[0m23:44:51.401815 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.75s]
[0m23:44:51.402788 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:44:51.403420 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m23:44:51.403994 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m23:44:51.404368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m23:44:51.404636 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m23:44:51.407539 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m23:44:51.408331 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m23:44:51.410836 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m23:44:51.411736 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m23:44:51.411999 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN
ORDER BY
    CONDITION_COUNT DESC, c."Name"
        );
[0m23:44:51.412239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:52.709096 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.296 seconds
[0m23:44:52.713517 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m23:44:52.889092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'beca5c23-9957-4912-9b63-78194aca3386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d882f0>]}
[0m23:44:52.890168 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.48s]
[0m23:44:52.890754 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m23:44:52.892277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:44:52.892548 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m23:44:52.892907 [info ] [MainThread]: 
[0m23:44:52.893191 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 6.99 seconds (6.99s).
[0m23:44:52.894291 [debug] [MainThread]: Command end result
[0m23:44:52.922248 [info ] [MainThread]: 
[0m23:44:52.922541 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:44:52.922716 [info ] [MainThread]: 
[0m23:44:52.922947 [error] [MainThread]:   Database Error in model geo_weather_overview (models/output/geo_weather_overview.sql)
  000904 (42000): SQL compilation error: error line 18 at position 25
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/output/geo_weather_overview.sql
[0m23:44:52.923120 [info ] [MainThread]: 
[0m23:44:52.923303 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:44:52.924811 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.5730495, "process_in_blocks": "0", "process_kernel_time": 0.253356, "process_mem_max_rss": "142082048", "process_out_blocks": "0", "process_user_time": 1.574268}
[0m23:44:52.925141 [debug] [MainThread]: Command `dbt run` failed at 23:44:52.925079 after 7.57 seconds
[0m23:44:52.925367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106032b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039f70b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c5c70>]}
[0m23:44:52.925579 [debug] [MainThread]: Flushing usage events
[0m23:45:48.506406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bf0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451bd90>]}


============================== 23:45:48.509764 | 192b4867-cbf5-4dab-804d-7faea34b6197 ==============================
[0m23:45:48.509764 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:45:48.510110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:45:48.718007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '192b4867-cbf5-4dab-804d-7faea34b6197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105176520>]}
[0m23:45:48.740742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '192b4867-cbf5-4dab-804d-7faea34b6197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105078050>]}
[0m23:45:48.741983 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:45:48.800693 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:45:48.861607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:45:48.861989 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/geo_weather_overview.sql
[0m23:45:48.976714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '192b4867-cbf5-4dab-804d-7faea34b6197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104feb450>]}
[0m23:45:49.019830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '192b4867-cbf5-4dab-804d-7faea34b6197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fbfe30>]}
[0m23:45:49.020105 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m23:45:49.020265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '192b4867-cbf5-4dab-804d-7faea34b6197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055383d0>]}
[0m23:45:49.021195 [info ] [MainThread]: 
[0m23:45:49.021461 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:45:49.023552 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:45:49.029517 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:45:49.029676 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:45:49.029803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:49.552973 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.523 seconds
[0m23:45:49.556011 [debug] [ThreadPool]: On list_openweather: Close
[0m23:45:49.708025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:45:49.718268 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:45:49.718617 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:45:49.718882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:45:50.196487 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.477 seconds
[0m23:45:50.200737 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:45:50.322781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '192b4867-cbf5-4dab-804d-7faea34b6197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043053d0>]}
[0m23:45:50.323768 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:45:50.324232 [info ] [MainThread]: 
[0m23:45:50.328974 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m23:45:50.329827 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m23:45:50.330400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m23:45:50.330717 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m23:45:50.338690 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:45:50.339892 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m23:45:50.362746 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:45:50.363690 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m23:45:50.363923 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m23:45:50.364132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:51.423275 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.058 seconds
[0m23:45:51.449717 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m23:45:51.561824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '192b4867-cbf5-4dab-804d-7faea34b6197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d7950>]}
[0m23:45:51.562939 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.23s]
[0m23:45:51.564047 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m23:45:51.564665 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m23:45:51.565530 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m23:45:51.566028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m23:45:51.566271 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m23:45:51.569474 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m23:45:51.570607 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m23:45:51.573214 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m23:45:51.574296 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m23:45:51.574576 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20
ORDER BY
    w.DATE_TIME, c."Name"
        );
[0m23:45:51.574835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:52.643500 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.068 seconds
[0m23:45:52.647273 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m23:45:52.782632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '192b4867-cbf5-4dab-804d-7faea34b6197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ea150>]}
[0m23:45:52.783589 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.22s]
[0m23:45:52.784398 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m23:45:52.784956 [debug] [Thread-1 (]: Began running node model.weather_dbt.geo_weather_overview
[0m23:45:52.785725 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.geo_weather_overview .................... [RUN]
[0m23:45:52.786393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.geo_weather_overview)
[0m23:45:52.786864 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.geo_weather_overview
[0m23:45:52.790666 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.geo_weather_overview"
[0m23:45:52.791654 [debug] [Thread-1 (]: Began executing node model.weather_dbt.geo_weather_overview
[0m23:45:52.794667 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.geo_weather_overview"
[0m23:45:52.795888 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.geo_weather_overview"
[0m23:45:52.796234 [debug] [Thread-1 (]: On model.weather_dbt.geo_weather_overview: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.geo_weather_overview"} */
create or replace transient table openweather.analytics.geo_weather_overview
         as
        (SELECT
    c.CITY_ID,
    c."Name" AS CITY_NAME,
    c.latitude AS LATITUDE,  -- Replace with actual column name
    c.longitude AS LONGITUDE, -- Replace with actual column name
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    c.CITY_ID, c."Name", c.latitude, c.longitude
ORDER BY
    AVG_TEMP_FAHRENHEIT DESC;
[0m23:45:52.796556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:53.264826 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a51-0004-3863-0002-594300036666
[0m23:45:53.265513 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 28 unexpected ';'.
[0m23:45:53.266038 [debug] [Thread-1 (]: On model.weather_dbt.geo_weather_overview: Close
[0m23:45:53.411513 [debug] [Thread-1 (]: Database Error in model geo_weather_overview (models/output/geo_weather_overview.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 28 unexpected ';'.
  compiled code at target/run/weather_dbt/models/output/geo_weather_overview.sql
[0m23:45:53.412172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '192b4867-cbf5-4dab-804d-7faea34b6197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058d1130>]}
[0m23:45:53.412805 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model analytics.geo_weather_overview ........... [[31mERROR[0m in 0.63s]
[0m23:45:53.413317 [debug] [Thread-1 (]: Finished running node model.weather_dbt.geo_weather_overview
[0m23:45:53.413668 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:45:53.414798 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:45:53.415249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.geo_weather_overview, now model.weather_dbt.openweather_join)
[0m23:45:53.415542 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:45:53.418438 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:45:53.419324 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:45:53.437217 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:45:53.438272 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:45:53.438521 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m23:45:53.438741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:54.039071 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m23:45:54.043410 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:45:54.169284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '192b4867-cbf5-4dab-804d-7faea34b6197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10227eb50>]}
[0m23:45:54.170253 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.75s]
[0m23:45:54.170980 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:45:54.171429 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m23:45:54.172006 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m23:45:54.172536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m23:45:54.172919 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m23:45:54.176534 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m23:45:54.177602 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m23:45:54.180594 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m23:45:54.181724 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m23:45:54.182065 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN
ORDER BY
    CONDITION_COUNT DESC, c."Name"
        );
[0m23:45:54.182376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:55.177643 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.994 seconds
[0m23:45:55.181781 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m23:45:55.320714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '192b4867-cbf5-4dab-804d-7faea34b6197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e42f0>]}
[0m23:45:55.321341 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.15s]
[0m23:45:55.322193 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m23:45:55.323562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:55.323877 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m23:45:55.324281 [info ] [MainThread]: 
[0m23:45:55.324705 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 6.30 seconds (6.30s).
[0m23:45:55.325946 [debug] [MainThread]: Command end result
[0m23:45:55.355381 [info ] [MainThread]: 
[0m23:45:55.355816 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:45:55.356020 [info ] [MainThread]: 
[0m23:45:55.356251 [error] [MainThread]:   Database Error in model geo_weather_overview (models/output/geo_weather_overview.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 28 unexpected ';'.
  compiled code at target/run/weather_dbt/models/output/geo_weather_overview.sql
[0m23:45:55.356423 [info ] [MainThread]: 
[0m23:45:55.356604 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:45:55.358353 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.8897157, "process_in_blocks": "0", "process_kernel_time": 0.263152, "process_mem_max_rss": "139968512", "process_out_blocks": "0", "process_user_time": 1.552631}
[0m23:45:55.358828 [debug] [MainThread]: Command `dbt run` failed at 23:45:55.358750 after 6.89 seconds
[0m23:45:55.359085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105789fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a71c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105818530>]}
[0m23:45:55.359295 [debug] [MainThread]: Flushing usage events
[0m23:46:04.755943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105698d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119d7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119d7d90>]}


============================== 23:46:04.758786 | 68a2a26d-483e-42b9-8ad7-d7eca7654086 ==============================
[0m23:46:04.758786 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:46:04.759086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:46:04.970463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68a2a26d-483e-42b9-8ad7-d7eca7654086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11278a520>]}
[0m23:46:04.995054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68a2a26d-483e-42b9-8ad7-d7eca7654086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11277c050>]}
[0m23:46:04.995824 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:46:05.055167 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:46:05.115525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:46:05.115925 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/geo_weather_overview.sql
[0m23:46:05.211881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68a2a26d-483e-42b9-8ad7-d7eca7654086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11266f450>]}
[0m23:46:05.255481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68a2a26d-483e-42b9-8ad7-d7eca7654086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112643e30>]}
[0m23:46:05.255751 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m23:46:05.255907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68a2a26d-483e-42b9-8ad7-d7eca7654086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cdc3d0>]}
[0m23:46:05.256838 [info ] [MainThread]: 
[0m23:46:05.257095 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:46:05.259159 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:46:05.265048 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:46:05.265196 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:46:05.265320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:05.786302 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.520 seconds
[0m23:46:05.789327 [debug] [ThreadPool]: On list_openweather: Close
[0m23:46:05.905483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:46:05.916029 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:46:05.916389 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:46:05.916644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:46:06.369917 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.453 seconds
[0m23:46:06.375286 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:46:06.664437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68a2a26d-483e-42b9-8ad7-d7eca7654086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118fd3d0>]}
[0m23:46:06.665365 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:46:06.665783 [info ] [MainThread]: 
[0m23:46:06.669952 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m23:46:06.670562 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m23:46:06.671021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m23:46:06.671365 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m23:46:06.679609 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:46:06.680404 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m23:46:06.702408 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:46:06.703377 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m23:46:06.703736 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m23:46:06.704018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:07.792240 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.088 seconds
[0m23:46:07.819754 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m23:46:07.929030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a2a26d-483e-42b9-8ad7-d7eca7654086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f7b950>]}
[0m23:46:07.930279 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.26s]
[0m23:46:07.931144 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m23:46:07.931654 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m23:46:07.932288 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m23:46:07.932885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m23:46:07.933290 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m23:46:07.936978 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m23:46:07.938017 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m23:46:07.941121 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m23:46:07.942499 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m23:46:07.942870 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20
ORDER BY
    w.DATE_TIME, c."Name"
        );
[0m23:46:07.943207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:09.345256 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.402 seconds
[0m23:46:09.350053 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m23:46:09.474840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a2a26d-483e-42b9-8ad7-d7eca7654086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119a6150>]}
[0m23:46:09.475902 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.54s]
[0m23:46:09.476723 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m23:46:09.477290 [debug] [Thread-1 (]: Began running node model.weather_dbt.geo_weather_overview
[0m23:46:09.478032 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.geo_weather_overview .................... [RUN]
[0m23:46:09.478705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.geo_weather_overview)
[0m23:46:09.479187 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.geo_weather_overview
[0m23:46:09.483065 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.geo_weather_overview"
[0m23:46:09.484103 [debug] [Thread-1 (]: Began executing node model.weather_dbt.geo_weather_overview
[0m23:46:09.487220 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.geo_weather_overview"
[0m23:46:09.488518 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.geo_weather_overview"
[0m23:46:09.488871 [debug] [Thread-1 (]: On model.weather_dbt.geo_weather_overview: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.geo_weather_overview"} */
create or replace transient table openweather.analytics.geo_weather_overview
         as
        (SELECT
    c.CITY_ID,
    c."Name" AS CITY_NAME,
    c.latitude AS LATITUDE,  -- Replace with actual column name
    c.longitude AS LONGITUDE, -- Replace with actual column name
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    c.CITY_ID, c."Name", c.latitude, c.longitude
ORDER BY
    AVG_TEMP_FAHRENHEIT DESC
        );
[0m23:46:09.489203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:09.902265 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a52-0004-3987-0002-59430003d126
[0m23:46:09.903001 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 4
invalid identifier 'C.LATITUDE'
[0m23:46:09.903581 [debug] [Thread-1 (]: On model.weather_dbt.geo_weather_overview: Close
[0m23:46:10.028851 [debug] [Thread-1 (]: Database Error in model geo_weather_overview (models/output/geo_weather_overview.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/output/geo_weather_overview.sql
[0m23:46:10.029611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a2a26d-483e-42b9-8ad7-d7eca7654086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a3d130>]}
[0m23:46:10.030393 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model analytics.geo_weather_overview ........... [[31mERROR[0m in 0.55s]
[0m23:46:10.031048 [debug] [Thread-1 (]: Finished running node model.weather_dbt.geo_weather_overview
[0m23:46:10.031428 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:46:10.031809 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:46:10.033215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.geo_weather_overview, now model.weather_dbt.openweather_join)
[0m23:46:10.033793 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:46:10.037176 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:46:10.038049 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:46:10.056152 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:46:10.057234 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:46:10.057491 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m23:46:10.057717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:10.660803 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.602 seconds
[0m23:46:10.665633 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:46:10.962667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a2a26d-483e-42b9-8ad7-d7eca7654086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11197fb50>]}
[0m23:46:10.963658 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.93s]
[0m23:46:10.964421 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:46:10.964959 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m23:46:10.965656 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m23:46:10.966327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m23:46:10.966811 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m23:46:10.970535 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m23:46:10.971547 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m23:46:10.974599 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m23:46:10.975700 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m23:46:10.976045 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN
ORDER BY
    CONDITION_COUNT DESC, c."Name"
        );
[0m23:46:10.976372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:12.131373 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.154 seconds
[0m23:46:12.136098 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m23:46:12.257082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a2a26d-483e-42b9-8ad7-d7eca7654086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a7a430>]}
[0m23:46:12.257995 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.29s]
[0m23:46:12.258479 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m23:46:12.259827 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:12.260082 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m23:46:12.260383 [info ] [MainThread]: 
[0m23:46:12.260621 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 7.00 seconds (7.00s).
[0m23:46:12.261487 [debug] [MainThread]: Command end result
[0m23:46:12.288146 [info ] [MainThread]: 
[0m23:46:12.288476 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:46:12.288677 [info ] [MainThread]: 
[0m23:46:12.288928 [error] [MainThread]:   Database Error in model geo_weather_overview (models/output/geo_weather_overview.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/output/geo_weather_overview.sql
[0m23:46:12.289107 [info ] [MainThread]: 
[0m23:46:12.289310 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:46:12.290864 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.572382, "process_in_blocks": "0", "process_kernel_time": 0.2499, "process_mem_max_rss": "142753792", "process_out_blocks": "0", "process_user_time": 1.552225}
[0m23:46:12.291181 [debug] [MainThread]: Command `dbt run` failed at 23:46:12.291123 after 7.57 seconds
[0m23:46:12.291391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a85c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130c69f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130c6bd0>]}
[0m23:46:12.291592 [debug] [MainThread]: Flushing usage events
[0m23:48:34.738361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107498d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138d7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138d7d90>]}


============================== 23:48:34.741690 | 3b0e11bd-39eb-48f6-be2e-dae152f387ff ==============================
[0m23:48:34.741690 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:48:34.742007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:48:34.958090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b0e11bd-39eb-48f6-be2e-dae152f387ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11481a520>]}
[0m23:48:34.980478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b0e11bd-39eb-48f6-be2e-dae152f387ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145f4050>]}
[0m23:48:34.981004 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:48:35.041208 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:48:35.101275 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m23:48:35.101589 [debug] [MainThread]: Partial parsing: added file: weather_dbt://models/output/hourly_weather_patterns.sql
[0m23:48:35.101718 [debug] [MainThread]: Partial parsing: deleted file: weather_dbt://models/output/geo_weather_overview.sql
[0m23:48:35.200240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b0e11bd-39eb-48f6-be2e-dae152f387ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11456f450>]}
[0m23:48:35.245280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b0e11bd-39eb-48f6-be2e-dae152f387ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114543e30>]}
[0m23:48:35.245557 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m23:48:35.245706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b0e11bd-39eb-48f6-be2e-dae152f387ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114bdc3d0>]}
[0m23:48:35.246698 [info ] [MainThread]: 
[0m23:48:35.246972 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:48:35.249045 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:48:35.254967 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:48:35.255116 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:48:35.255234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:35.891816 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.636 seconds
[0m23:48:35.895619 [debug] [ThreadPool]: On list_openweather: Close
[0m23:48:36.024633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:48:36.035457 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:48:36.035802 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:48:36.036070 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:48:36.531874 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.496 seconds
[0m23:48:36.535504 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:48:36.663451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b0e11bd-39eb-48f6-be2e-dae152f387ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f393d0>]}
[0m23:48:36.664386 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:48:36.664790 [info ] [MainThread]: 
[0m23:48:36.669545 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m23:48:36.670210 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m23:48:36.670694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m23:48:36.671082 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m23:48:36.678612 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:48:36.679487 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m23:48:36.701494 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:48:36.702459 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m23:48:36.702720 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m23:48:36.702946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:37.906120 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.203 seconds
[0m23:48:37.932783 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m23:48:38.088071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0e11bd-39eb-48f6-be2e-dae152f387ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e7b950>]}
[0m23:48:38.089357 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.42s]
[0m23:48:38.090320 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m23:48:38.091445 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m23:48:38.092203 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m23:48:38.092767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m23:48:38.093149 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m23:48:38.096822 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m23:48:38.097761 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m23:48:38.100742 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m23:48:38.102170 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m23:48:38.102555 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20
ORDER BY
    w.DATE_TIME, c."Name"
        );
[0m23:48:38.102864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:39.287780 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.185 seconds
[0m23:48:39.291182 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m23:48:39.431984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0e11bd-39eb-48f6-be2e-dae152f387ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138a6150>]}
[0m23:48:39.433189 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.34s]
[0m23:48:39.433784 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m23:48:39.434198 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m23:48:39.434715 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m23:48:39.435251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m23:48:39.435744 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m23:48:39.439358 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m23:48:39.440422 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m23:48:39.443410 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m23:48:39.444832 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m23:48:39.445189 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (

SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,  -- Include city name for better insights
    EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
ORDER BY
    c."Name", HOUR_OF_DAY;
[0m23:48:39.445514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:39.906511 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a54-0004-386b-0002-59430003b666
[0m23:48:39.907233 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 21 at position 25 unexpected ';'.
[0m23:48:39.907768 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m23:48:40.042514 [debug] [Thread-1 (]: Database Error in model hourly_weather_patterns (models/output/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 25 unexpected ';'.
  compiled code at target/run/weather_dbt/models/output/hourly_weather_patterns.sql
[0m23:48:40.043391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0e11bd-39eb-48f6-be2e-dae152f387ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11594d130>]}
[0m23:48:40.044138 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model analytics.hourly_weather_patterns ........ [[31mERROR[0m in 0.61s]
[0m23:48:40.044680 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m23:48:40.045038 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:48:40.046184 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:48:40.046682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m23:48:40.047017 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:48:40.050170 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:48:40.051325 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:48:40.068266 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:48:40.069152 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:48:40.069399 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m23:48:40.069615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:40.772625 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.702 seconds
[0m23:48:40.777618 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:48:40.899775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0e11bd-39eb-48f6-be2e-dae152f387ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11387fd50>]}
[0m23:48:40.901063 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.85s]
[0m23:48:40.901850 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:48:40.902328 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m23:48:40.902883 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m23:48:40.903384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m23:48:40.903761 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m23:48:40.907539 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m23:48:40.908589 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m23:48:40.911562 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m23:48:40.912680 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m23:48:40.913030 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN
ORDER BY
    CONDITION_COUNT DESC, c."Name"
        );
[0m23:48:40.913347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:42.381371 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.465 seconds
[0m23:48:42.386723 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m23:48:42.522307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0e11bd-39eb-48f6-be2e-dae152f387ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115d884b0>]}
[0m23:48:42.523490 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.62s]
[0m23:48:42.524176 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m23:48:42.525812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:42.526192 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m23:48:42.526629 [info ] [MainThread]: 
[0m23:48:42.526968 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 7.28 seconds (7.28s).
[0m23:48:42.528034 [debug] [MainThread]: Command end result
[0m23:48:42.555589 [info ] [MainThread]: 
[0m23:48:42.555884 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:48:42.556063 [info ] [MainThread]: 
[0m23:48:42.556290 [error] [MainThread]:   Database Error in model hourly_weather_patterns (models/output/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 25 unexpected ';'.
  compiled code at target/run/weather_dbt/models/output/hourly_weather_patterns.sql
[0m23:48:42.556462 [info ] [MainThread]: 
[0m23:48:42.556640 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:48:42.558058 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.8584814, "process_in_blocks": "0", "process_kernel_time": 0.272668, "process_mem_max_rss": "140214272", "process_out_blocks": "0", "process_user_time": 1.541709}
[0m23:48:42.558373 [debug] [MainThread]: Command `dbt run` failed at 23:48:42.558320 after 7.86 seconds
[0m23:48:42.558582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f2edb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115d25bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159a8a10>]}
[0m23:48:42.558765 [debug] [MainThread]: Flushing usage events
[0m23:48:50.603139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e14d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104717b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104717d90>]}


============================== 23:48:50.605933 | a8cab9a5-845c-4175-8991-441d93789001 ==============================
[0m23:48:50.605933 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:48:50.606235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:48:50.811292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8cab9a5-845c-4175-8991-441d93789001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105372520>]}
[0m23:48:50.835686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8cab9a5-845c-4175-8991-441d93789001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10526c050>]}
[0m23:48:50.837209 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:48:50.897255 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:48:50.959026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:48:50.959394 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/hourly_weather_patterns.sql
[0m23:48:51.056990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8cab9a5-845c-4175-8991-441d93789001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e7450>]}
[0m23:48:51.103162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8cab9a5-845c-4175-8991-441d93789001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051bbe30>]}
[0m23:48:51.103459 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m23:48:51.103616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8cab9a5-845c-4175-8991-441d93789001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057343d0>]}
[0m23:48:51.104597 [info ] [MainThread]: 
[0m23:48:51.104878 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:48:51.107235 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:48:51.113737 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:48:51.113974 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:48:51.114103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:51.604278 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.490 seconds
[0m23:48:51.607831 [debug] [ThreadPool]: On list_openweather: Close
[0m23:48:51.741094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:48:51.752066 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:48:51.752407 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:48:51.752666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:48:52.250262 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.497 seconds
[0m23:48:52.253444 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:48:52.368195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8cab9a5-845c-4175-8991-441d93789001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045013d0>]}
[0m23:48:52.368998 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:48:52.369421 [info ] [MainThread]: 
[0m23:48:52.373888 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m23:48:52.374589 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m23:48:52.375111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m23:48:52.375487 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m23:48:52.383577 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:48:52.384432 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m23:48:52.407190 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:48:52.408279 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m23:48:52.408548 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m23:48:52.408769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:53.522069 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.113 seconds
[0m23:48:53.547913 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m23:48:53.672278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8cab9a5-845c-4175-8991-441d93789001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058cf950>]}
[0m23:48:53.673461 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.30s]
[0m23:48:53.674329 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m23:48:53.674914 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m23:48:53.675563 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m23:48:53.676176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m23:48:53.676572 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m23:48:53.680156 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m23:48:53.681177 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m23:48:53.684601 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m23:48:53.686493 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m23:48:53.686919 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20
ORDER BY
    w.DATE_TIME, c."Name"
        );
[0m23:48:53.687216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:54.896859 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.209 seconds
[0m23:48:54.900618 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m23:48:55.026440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8cab9a5-845c-4175-8991-441d93789001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ea150>]}
[0m23:48:55.027562 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.35s]
[0m23:48:55.028164 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m23:48:55.028598 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m23:48:55.029155 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m23:48:55.029656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m23:48:55.029994 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m23:48:55.033591 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m23:48:55.034605 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m23:48:55.037813 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m23:48:55.039356 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m23:48:55.039737 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (

SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,  -- Include city name for better insights
    EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
ORDER BY
    c."Name", HOUR_OF_DAY
        );
[0m23:48:55.040067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:56.151580 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.111 seconds
[0m23:48:56.156192 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m23:48:56.280548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8cab9a5-845c-4175-8991-441d93789001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac99f0>]}
[0m23:48:56.281548 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.hourly_weather_patterns ............ [[32mSUCCESS 1[0m in 1.25s]
[0m23:48:56.282341 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m23:48:56.282880 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:48:56.283586 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:48:56.284255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m23:48:56.284718 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:48:56.288467 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:48:56.289547 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:48:56.308458 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:48:56.309494 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:48:56.309774 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m23:48:56.310035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:57.002798 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.692 seconds
[0m23:48:57.007114 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:48:57.157870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8cab9a5-845c-4175-8991-441d93789001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105177850>]}
[0m23:48:57.159061 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.87s]
[0m23:48:57.159734 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:48:57.160193 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m23:48:57.160702 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m23:48:57.161179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m23:48:57.161518 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m23:48:57.164871 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m23:48:57.165846 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m23:48:57.168520 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m23:48:57.169519 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m23:48:57.169815 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN
ORDER BY
    CONDITION_COUNT DESC, c."Name"
        );
[0m23:48:57.170096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:58.267209 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.097 seconds
[0m23:48:58.270516 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m23:48:58.389778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8cab9a5-845c-4175-8991-441d93789001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d508a0>]}
[0m23:48:58.390578 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.23s]
[0m23:48:58.391125 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m23:48:58.392501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:58.392768 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m23:48:58.393052 [info ] [MainThread]: 
[0m23:48:58.393276 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 7.29 seconds (7.29s).
[0m23:48:58.394113 [debug] [MainThread]: Command end result
[0m23:48:58.420584 [info ] [MainThread]: 
[0m23:48:58.420924 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:48:58.421134 [info ] [MainThread]: 
[0m23:48:58.421349 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m23:48:58.422879 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.857598, "process_in_blocks": "0", "process_kernel_time": 0.235602, "process_mem_max_rss": "142049280", "process_out_blocks": "0", "process_user_time": 1.554788}
[0m23:48:58.423205 [debug] [MainThread]: Command `dbt run` succeeded at 23:48:58.423146 after 7.86 seconds
[0m23:48:58.423423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105986990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034d9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105af5070>]}
[0m23:48:58.423626 [debug] [MainThread]: Flushing usage events
[0m23:54:11.608006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105598d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f13b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f13d90>]}


============================== 23:54:11.611157 | f1c63ae5-7a31-45ae-b254-8d32cd548005 ==============================
[0m23:54:11.611157 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:54:11.611504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:54:11.665598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1c63ae5-7a31-45ae-b254-8d32cd548005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687f360>]}
[0m23:54:11.676768 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.10731396, "process_in_blocks": "0", "process_kernel_time": 0.129333, "process_mem_max_rss": "99926016", "process_out_blocks": "0", "process_user_time": 0.616944}
[0m23:54:11.677048 [debug] [MainThread]: Command `dbt clean` succeeded at 23:54:11.676995 after 0.11 seconds
[0m23:54:11.677213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10903e580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10903e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dde950>]}
[0m23:54:11.677762 [debug] [MainThread]: Flushing usage events
[0m23:54:15.975282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fbb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fbd90>]}


============================== 23:54:15.978184 | 4ccc3943-a7cc-4857-ad69-5eb109aefd48 ==============================
[0m23:54:15.978184 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:54:15.978474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:54:16.197176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ccc3943-a7cc-4857-ad69-5eb109aefd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e56520>]}
[0m23:54:16.221113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ccc3943-a7cc-4857-ad69-5eb109aefd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d50050>]}
[0m23:54:16.222661 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:54:16.283873 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:54:16.284398 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:54:16.284570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4ccc3943-a7cc-4857-ad69-5eb109aefd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc8a50>]}
[0m23:54:16.812191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ccc3943-a7cc-4857-ad69-5eb109aefd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f29220>]}
[0m23:54:16.854728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ccc3943-a7cc-4857-ad69-5eb109aefd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070619b0>]}
[0m23:54:16.855047 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m23:54:16.855215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ccc3943-a7cc-4857-ad69-5eb109aefd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e3380>]}
[0m23:54:16.856565 [info ] [MainThread]: 
[0m23:54:16.856866 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:54:16.859064 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:54:16.865544 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:54:16.865738 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:54:16.865864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:17.389924 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.524 seconds
[0m23:54:17.393362 [debug] [ThreadPool]: On list_openweather: Close
[0m23:54:17.542019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:54:17.553081 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:54:17.553689 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:54:17.553964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:54:18.127304 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.573 seconds
[0m23:54:18.131478 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:54:18.264894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ccc3943-a7cc-4857-ad69-5eb109aefd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10741e810>]}
[0m23:54:18.265784 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:54:18.266203 [info ] [MainThread]: 
[0m23:54:18.270903 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m23:54:18.271605 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m23:54:18.272124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m23:54:18.272510 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m23:54:18.281087 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:54:18.282406 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m23:54:18.305283 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:54:18.306620 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m23:54:18.306866 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m23:54:18.307084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:19.319174 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.012 seconds
[0m23:54:19.340102 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m23:54:19.478708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ccc3943-a7cc-4857-ad69-5eb109aefd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ca0a0>]}
[0m23:54:19.479812 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.21s]
[0m23:54:19.480873 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m23:54:19.481521 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m23:54:19.482556 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m23:54:19.483296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m23:54:19.483712 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m23:54:19.487666 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m23:54:19.488502 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m23:54:19.490728 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m23:54:19.492292 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m23:54:19.492757 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m23:54:19.493125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:20.621137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.128 seconds
[0m23:54:20.625817 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m23:54:20.743766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ccc3943-a7cc-4857-ad69-5eb109aefd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10754bf70>]}
[0m23:54:20.744957 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.26s]
[0m23:54:20.745662 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m23:54:20.746162 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m23:54:20.746836 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m23:54:20.747512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m23:54:20.748006 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m23:54:20.752111 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m23:54:20.753265 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m23:54:20.755636 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m23:54:20.757062 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m23:54:20.757449 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    *
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY
        );
[0m23:54:20.757778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:21.998277 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.240 seconds
[0m23:54:22.001091 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m23:54:22.203170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ccc3943-a7cc-4857-ad69-5eb109aefd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700b250>]}
[0m23:54:22.204441 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.hourly_weather_patterns ............ [[32mSUCCESS 1[0m in 1.46s]
[0m23:54:22.205301 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m23:54:22.205848 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:54:22.206182 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:54:22.206499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m23:54:22.206702 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:54:22.208542 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:54:22.209138 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:54:22.229899 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:54:22.231005 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:54:22.231279 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m23:54:22.231526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:22.894108 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.662 seconds
[0m23:54:22.898770 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:54:23.046350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ccc3943-a7cc-4857-ad69-5eb109aefd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048348a0>]}
[0m23:54:23.047605 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.84s]
[0m23:54:23.048467 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:54:23.049273 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m23:54:23.050153 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m23:54:23.050738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m23:54:23.051125 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m23:54:23.055117 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m23:54:23.056271 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m23:54:23.058539 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m23:54:23.059856 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m23:54:23.060209 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    *
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME
        );
[0m23:54:23.060530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:24.066656 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.006 seconds
[0m23:54:24.071013 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m23:54:24.191027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ccc3943-a7cc-4857-ad69-5eb109aefd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107864050>]}
[0m23:54:24.192139 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.14s]
[0m23:54:24.193144 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m23:54:24.195002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:24.195390 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m23:54:24.195787 [info ] [MainThread]: 
[0m23:54:24.196565 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 7.34 seconds (7.34s).
[0m23:54:24.198057 [debug] [MainThread]: Command end result
[0m23:54:24.224004 [info ] [MainThread]: 
[0m23:54:24.224373 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:54:24.224571 [info ] [MainThread]: 
[0m23:54:24.224776 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m23:54:24.226374 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.286973, "process_in_blocks": "0", "process_kernel_time": 0.246594, "process_mem_max_rss": "142704640", "process_out_blocks": "0", "process_user_time": 1.853131}
[0m23:54:24.226706 [debug] [MainThread]: Command `dbt run` succeeded at 23:54:24.226645 after 8.29 seconds
[0m23:54:24.226924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107867e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107867e30>]}
[0m23:54:24.227132 [debug] [MainThread]: Flushing usage events
[0m23:57:14.323737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ecd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f3d90>]}


============================== 23:57:14.327516 | d5397da7-e7f4-4cab-836c-585cb6ba1097 ==============================
[0m23:57:14.327516 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:57:14.328093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:57:14.555101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5397da7-e7f4-4cab-836c-585cb6ba1097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b61a520>]}
[0m23:57:14.577840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5397da7-e7f4-4cab-836c-585cb6ba1097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b60c050>]}
[0m23:57:14.578436 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:57:14.636234 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:57:14.697709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m23:57:14.698038 [debug] [MainThread]: Partial parsing: added file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m23:57:14.698181 [debug] [MainThread]: Partial parsing: added file: weather_dbt://snapshots/weather_conditions_frequency.sql
[0m23:57:14.698303 [debug] [MainThread]: Partial parsing: added file: weather_dbt://snapshots/hourly_weather_patterns.sql
[0m23:57:14.698419 [debug] [MainThread]: Partial parsing: added file: weather_dbt://snapshots/extreme_weather_events.sql
[0m23:57:14.821817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5397da7-e7f4-4cab-836c-585cb6ba1097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b950a50>]}
[0m23:57:14.913295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5397da7-e7f4-4cab-836c-585cb6ba1097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b543f20>]}
[0m23:57:14.913585 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m23:57:14.913744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5397da7-e7f4-4cab-836c-585cb6ba1097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9dc590>]}
[0m23:57:14.914918 [info ] [MainThread]: 
[0m23:57:14.915291 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:57:14.917602 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:57:14.923967 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:57:14.924161 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:57:14.924288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:15.480280 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.556 seconds
[0m23:57:15.484425 [debug] [ThreadPool]: On list_openweather: Close
[0m23:57:15.610155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now create_openweather_your_target_schema)
[0m23:57:15.611334 [debug] [ThreadPool]: Creating schema "database: "openweather"
schema: "your_target_schema"
"
[0m23:57:15.615935 [debug] [ThreadPool]: Using snowflake connection "create_openweather_your_target_schema"
[0m23:57:15.616228 [debug] [ThreadPool]: On create_openweather_your_target_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "create_openweather_your_target_schema"} */
create schema if not exists openweather.your_target_schema
[0m23:57:15.616450 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:57:16.084920 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.468 seconds
[0m23:57:16.087219 [debug] [ThreadPool]: On create_openweather_your_target_schema: Close
[0m23:57:16.236516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_openweather_your_target_schema, now list_openweather_your_target_schema)
[0m23:57:16.247071 [debug] [ThreadPool]: Using snowflake connection "list_openweather_your_target_schema"
[0m23:57:16.247413 [debug] [ThreadPool]: On list_openweather_your_target_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_your_target_schema"} */
show objects in openweather.your_target_schema limit 10000
[0m23:57:16.247664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:57:16.730716 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.483 seconds
[0m23:57:16.733378 [debug] [ThreadPool]: On list_openweather_your_target_schema: Close
[0m23:57:16.844565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_your_target_schema, now list_openweather_analytics)
[0m23:57:16.847091 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:57:16.847474 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:57:16.847765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:57:17.355832 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.508 seconds
[0m23:57:17.359318 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:57:17.478661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5397da7-e7f4-4cab-836c-585cb6ba1097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc75a50>]}
[0m23:57:17.479479 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:57:17.479930 [info ] [MainThread]: 
[0m23:57:17.484652 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_trend
[0m23:57:17.485120 [info ] [Thread-1 (]: 1 of 4 START snapshot your_target_schema.daily_average_weather_trend ........... [RUN]
[0m23:57:17.485427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now snapshot.weather_dbt.daily_average_weather_trend)
[0m23:57:17.485631 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_trend
[0m23:57:17.491609 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_trend
[0m23:57:17.541044 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_trend"
[0m23:57:17.541377 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_DATE as varchar ), '')
         || '|' || coalesce(cast(WEATHER_DATE as varchar ), '')
        ) as dbt_scd_id,
        WEATHER_DATE as dbt_updated_at,
        WEATHER_DATE as dbt_valid_from,
        
  
  coalesce(nullif(WEATHER_DATE, WEATHER_DATE), null)
  as dbt_valid_to
from (
        
    

    WITH Daily_Average_Weather_Trend AS (
        SELECT
            w.CITY_ID,
            c."Name" AS CITY_NAME,
            DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
            AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
            AVG(w.HUMIDITY) AS AVG_HUMIDITY
        FROM
            openweather.raw_data.WEATHER_FACT_TABLE w
        JOIN
            openweather.raw_data.CITY_DIMENSION_TABLE c
        ON
            w.CITY_ID = c.CITY_ID
        GROUP BY
            w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
    )

    SELECT
        *
    FROM
        Daily_Average_Weather_Trend
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:57:17.541582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:57:18.009683 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a5d-0004-3869-0002-59430003a6a6
[0m23:57:18.010396 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m23:57:18.010961 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: Close
[0m23:57:18.150298 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m23:57:18.152262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5397da7-e7f4-4cab-836c-585cb6ba1097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd08e90>]}
[0m23:57:18.153206 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting your_target_schema.daily_average_weather_trend ....... [[31mERROR[0m in 0.67s]
[0m23:57:18.153820 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_trend
[0m23:57:18.154235 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m23:57:18.155524 [info ] [Thread-1 (]: 2 of 4 START snapshot your_target_schema.extreme_weather_events ................ [RUN]
[0m23:57:18.156122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_trend, now snapshot.weather_dbt.extreme_weather_events)
[0m23:57:18.156416 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m23:57:18.159605 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m23:57:18.163689 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m23:57:18.164098 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        
    

    WITH Extreme_Weather_Events AS (
        SELECT
            w.CITY_ID,
            c."Name" AS CITY_NAME,
            w.DATE_TIME,
            ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
            w.WIND_SPEED,
            CASE
                WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
                WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
                WHEN w.WIND_SPEED > 20 THEN 'High Winds'
                ELSE 'Normal'
            END AS WEATHER_ALERT
        FROM
            openweather.raw_data.WEATHER_FACT_TABLE w
        JOIN
            openweather.raw_data.CITY_DIMENSION_TABLE c
        ON
            w.CITY_ID = c.CITY_ID
        WHERE
            ((w.TEMP - 273.15) * 9/5 + 32) > 100
            OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
            OR w.WIND_SPEED > 20
    )

    SELECT
        *
    FROM
        Extreme_Weather_Events
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:57:18.164413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:57:18.670735 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a5d-0004-3987-0002-59430003d166
[0m23:57:18.671516 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m23:57:18.672183 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m23:57:18.823960 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m23:57:18.824705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5397da7-e7f4-4cab-836c-585cb6ba1097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be22830>]}
[0m23:57:18.825689 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting your_target_schema.extreme_weather_events ............ [[31mERROR[0m in 0.67s]
[0m23:57:18.826327 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m23:57:18.826721 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m23:57:18.827290 [info ] [Thread-1 (]: 3 of 4 START snapshot your_target_schema.hourly_weather_patterns ............... [RUN]
[0m23:57:18.827755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m23:57:18.828092 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m23:57:18.831830 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m23:57:18.835289 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m23:57:18.835663 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        
    

    WITH Hourly_Weather_Patterns AS (
        SELECT
            w.CITY_ID,
            c."Name" AS CITY_NAME, -- Include city name for better insights
            EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
            AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
            AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
            AVG(w.HUMIDITY) AS AVG_HUMIDITY
        FROM
            openweather.raw_data.WEATHER_FACT_TABLE w
        JOIN
            openweather.raw_data.CITY_DIMENSION_TABLE c
        ON
            w.CITY_ID = c.CITY_ID
        GROUP BY
            w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
    )

    SELECT
        *
    FROM
        Hourly_Weather_Patterns
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:57:18.835993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:57:19.312001 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a5d-0004-386c-0002-59430003771a
[0m23:57:19.312612 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m23:57:19.313243 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m23:57:19.440999 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m23:57:19.441626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5397da7-e7f4-4cab-836c-585cb6ba1097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bec1e50>]}
[0m23:57:19.442477 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting your_target_schema.hourly_weather_patterns ........... [[31mERROR[0m in 0.61s]
[0m23:57:19.443108 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m23:57:19.443524 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m23:57:19.444115 [info ] [Thread-1 (]: 4 of 4 START snapshot your_target_schema.weather_conditions_frequency .......... [RUN]
[0m23:57:19.444882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m23:57:19.445400 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m23:57:19.448849 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m23:57:19.452298 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m23:57:19.452658 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        
    

    WITH Weather_Conditions_Frequency AS (
        SELECT
            w.CITY_ID,
            c."Name" AS CITY_NAME,
            w.WEATHER_MAIN,
            COUNT(*) AS CONDITION_COUNT
        FROM
            openweather.raw_data.WEATHER_FACT_TABLE w
        JOIN
            openweather.raw_data.CITY_DIMENSION_TABLE c
        ON
            w.CITY_ID = c.CITY_ID
        GROUP BY
            w.CITY_ID, c."Name", w.WEATHER_MAIN
    )

    SELECT
        *
    FROM
        Weather_Conditions_Frequency
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:57:19.452980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:57:19.892674 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a5d-0004-3867-0002-5943000356ae
[0m23:57:19.893625 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m23:57:19.894311 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m23:57:20.019694 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m23:57:20.020365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5397da7-e7f4-4cab-836c-585cb6ba1097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074a8e50>]}
[0m23:57:20.021291 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting your_target_schema.weather_conditions_frequency ...... [[31mERROR[0m in 0.58s]
[0m23:57:20.022054 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m23:57:20.023472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:57:20.023744 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m23:57:20.024011 [info ] [MainThread]: 
[0m23:57:20.024269 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 5.11 seconds (5.11s).
[0m23:57:20.025209 [debug] [MainThread]: Command end result
[0m23:57:20.047841 [info ] [MainThread]: 
[0m23:57:20.048129 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m23:57:20.048477 [info ] [MainThread]: 
[0m23:57:20.048761 [error] [MainThread]:   Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m23:57:20.048936 [info ] [MainThread]: 
[0m23:57:20.049147 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m23:57:20.049302 [info ] [MainThread]: 
[0m23:57:20.049496 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m23:57:20.049646 [info ] [MainThread]: 
[0m23:57:20.049833 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m23:57:20.049990 [info ] [MainThread]: 
[0m23:57:20.050187 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m23:57:20.051983 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.7687163, "process_in_blocks": "0", "process_kernel_time": 0.284246, "process_mem_max_rss": "142491648", "process_out_blocks": "0", "process_user_time": 1.664025}
[0m23:57:20.052403 [debug] [MainThread]: Command `dbt snapshot` failed at 23:57:20.052333 after 5.77 seconds
[0m23:57:20.052634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a06c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d4dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107842870>]}
[0m23:57:20.052834 [debug] [MainThread]: Flushing usage events
[0m23:58:54.350740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107220d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b23b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b23d90>]}


============================== 23:58:54.354310 | 242278a9-2e28-451e-93c6-64c01a68baea ==============================
[0m23:58:54.354310 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:58:54.354652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m23:58:54.574526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '242278a9-2e28-451e-93c6-64c01a68baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b41a520>]}
[0m23:58:54.596885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '242278a9-2e28-451e-93c6-64c01a68baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1f4050>]}
[0m23:58:54.597477 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:58:54.656931 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:58:54.727531 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m23:58:54.727895 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/hourly_weather_patterns.sql
[0m23:58:54.728066 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/weather_conditions_frequency.sql
[0m23:58:54.728221 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m23:58:54.728365 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/extreme_weather_events.sql
[0m23:58:54.849089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '242278a9-2e28-451e-93c6-64c01a68baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6d0950>]}
[0m23:58:54.933438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '242278a9-2e28-451e-93c6-64c01a68baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b143f20>]}
[0m23:58:54.933723 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m23:58:54.933877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '242278a9-2e28-451e-93c6-64c01a68baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4aaf90>]}
[0m23:58:54.934875 [info ] [MainThread]: 
[0m23:58:54.935138 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:58:54.937364 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:58:54.943428 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:58:54.943589 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:58:54.943714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:55.486041 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.542 seconds
[0m23:58:55.488799 [debug] [ThreadPool]: On list_openweather: Close
[0m23:58:55.621718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_your_target_schema)
[0m23:58:55.628884 [debug] [ThreadPool]: Using snowflake connection "list_openweather_your_target_schema"
[0m23:58:55.629168 [debug] [ThreadPool]: On list_openweather_your_target_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_your_target_schema"} */
show objects in openweather.your_target_schema limit 10000
[0m23:58:55.629334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:58:56.107146 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.477 seconds
[0m23:58:56.112494 [debug] [ThreadPool]: On list_openweather_your_target_schema: Close
[0m23:58:56.230918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_your_target_schema, now list_openweather_analytics)
[0m23:58:56.233989 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:58:56.234384 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:58:56.234680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:58:56.665917 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.431 seconds
[0m23:58:56.673090 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:58:56.811061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '242278a9-2e28-451e-93c6-64c01a68baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10890d3d0>]}
[0m23:58:56.811898 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:58:56.812310 [info ] [MainThread]: 
[0m23:58:56.815945 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_trend
[0m23:58:56.816558 [info ] [Thread-1 (]: 1 of 4 START snapshot your_target_schema.daily_average_weather_trend ........... [RUN]
[0m23:58:56.817034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now snapshot.weather_dbt.daily_average_weather_trend)
[0m23:58:56.817399 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_trend
[0m23:58:56.825393 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_trend
[0m23:58:56.873679 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_trend"
[0m23:58:56.873988 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_DATE as varchar ), '')
         || '|' || coalesce(cast(WEATHER_DATE as varchar ), '')
        ) as dbt_scd_id,
        WEATHER_DATE as dbt_updated_at,
        WEATHER_DATE as dbt_valid_from,
        
  
  coalesce(nullif(WEATHER_DATE, WEATHER_DATE), null)
  as dbt_valid_to
from (
        
    

    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:58:56.874190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:58:57.349232 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a5e-0004-3865-0002-59430003973a
[0m23:58:57.349913 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m23:58:57.350472 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: Close
[0m23:58:57.493008 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m23:58:57.495060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '242278a9-2e28-451e-93c6-64c01a68baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb19fd0>]}
[0m23:58:57.495980 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting your_target_schema.daily_average_weather_trend ....... [[31mERROR[0m in 0.68s]
[0m23:58:57.496596 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_trend
[0m23:58:57.497009 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m23:58:57.498086 [info ] [Thread-1 (]: 2 of 4 START snapshot your_target_schema.extreme_weather_events ................ [RUN]
[0m23:58:57.498509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_trend, now snapshot.weather_dbt.extreme_weather_events)
[0m23:58:57.498798 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m23:58:57.502086 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m23:58:57.506188 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m23:58:57.506524 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        
    

    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:58:57.506824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:58:57.939938 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a5e-0004-3864-0002-594300033fca
[0m23:58:57.940736 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m23:58:57.941403 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m23:58:58.061028 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m23:58:58.062005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '242278a9-2e28-451e-93c6-64c01a68baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc2e8e0>]}
[0m23:58:58.063426 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting your_target_schema.extreme_weather_events ............ [[31mERROR[0m in 0.56s]
[0m23:58:58.064074 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m23:58:58.064471 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m23:58:58.064884 [info ] [Thread-1 (]: 3 of 4 START snapshot your_target_schema.hourly_weather_patterns ............... [RUN]
[0m23:58:58.065341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m23:58:58.065983 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m23:58:58.070346 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m23:58:58.075137 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m23:58:58.075551 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        
    

    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:58:58.076042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:58:58.608601 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a5e-0004-386c-0002-59430003771e
[0m23:58:58.610001 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m23:58:58.610891 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m23:58:58.753378 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m23:58:58.754031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '242278a9-2e28-451e-93c6-64c01a68baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbeab70>]}
[0m23:58:58.754891 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting your_target_schema.hourly_weather_patterns ........... [[31mERROR[0m in 0.69s]
[0m23:58:58.755466 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m23:58:58.755838 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m23:58:58.756380 [info ] [Thread-1 (]: 4 of 4 START snapshot your_target_schema.weather_conditions_frequency .......... [RUN]
[0m23:58:58.756870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m23:58:58.757203 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m23:58:58.760821 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m23:58:58.769167 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m23:58:58.769540 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        
    

    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:58:58.769853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:58:59.184880 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a5e-0004-3869-0002-59430003a6aa
[0m23:58:59.185805 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m23:58:59.186262 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m23:58:59.310810 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m23:58:59.311680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '242278a9-2e28-451e-93c6-64c01a68baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b993b50>]}
[0m23:58:59.312693 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting your_target_schema.weather_conditions_frequency ...... [[31mERROR[0m in 0.55s]
[0m23:58:59.313584 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m23:58:59.315716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:58:59.316180 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m23:58:59.316504 [info ] [MainThread]: 
[0m23:58:59.316804 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 4.38 seconds (4.38s).
[0m23:58:59.317938 [debug] [MainThread]: Command end result
[0m23:58:59.341686 [info ] [MainThread]: 
[0m23:58:59.342100 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m23:58:59.342318 [info ] [MainThread]: 
[0m23:58:59.342601 [error] [MainThread]:   Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m23:58:59.342779 [info ] [MainThread]: 
[0m23:58:59.343019 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m23:58:59.343177 [info ] [MainThread]: 
[0m23:58:59.343371 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m23:58:59.343522 [info ] [MainThread]: 
[0m23:58:59.343714 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m23:58:59.343867 [info ] [MainThread]: 
[0m23:58:59.344150 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m23:58:59.345730 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.0356827, "process_in_blocks": "0", "process_kernel_time": 0.272773, "process_mem_max_rss": "140247040", "process_out_blocks": "0", "process_user_time": 1.582719}
[0m23:58:59.346086 [debug] [MainThread]: Command `dbt snapshot` failed at 23:58:59.346026 after 5.04 seconds
[0m23:58:59.346332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e81d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf7bd20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107979bb0>]}
[0m23:58:59.346526 [debug] [MainThread]: Flushing usage events
[0m23:59:30.624027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b04d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105417b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105417d90>]}


============================== 23:59:30.626536 | d53720d3-af31-4da8-a693-2e07bf204971 ==============================
[0m23:59:30.626536 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:59:30.626838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:59:30.788702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd53720d3-af31-4da8-a693-2e07bf204971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621a520>]}
[0m23:59:30.813296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd53720d3-af31-4da8-a693-2e07bf204971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fc050>]}
[0m23:59:30.813820 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:59:30.868168 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:59:30.927207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:59:30.927438 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:59:30.947427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd53720d3-af31-4da8-a693-2e07bf204971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10616b850>]}
[0m23:59:30.995335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd53720d3-af31-4da8-a693-2e07bf204971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106141310>]}
[0m23:59:30.995637 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m23:59:30.995790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd53720d3-af31-4da8-a693-2e07bf204971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671cc90>]}
[0m23:59:30.996755 [info ] [MainThread]: 
[0m23:59:30.997047 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:59:30.999186 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:59:31.005970 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:59:31.006137 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:59:31.006263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:31.490740 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.484 seconds
[0m23:59:31.494266 [debug] [ThreadPool]: On list_openweather: Close
[0m23:59:31.619317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_your_target_schema)
[0m23:59:31.630283 [debug] [ThreadPool]: Using snowflake connection "list_openweather_your_target_schema"
[0m23:59:31.630658 [debug] [ThreadPool]: On list_openweather_your_target_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_your_target_schema"} */
show objects in openweather.your_target_schema limit 10000
[0m23:59:31.630910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:59:32.290846 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.659 seconds
[0m23:59:32.294064 [debug] [ThreadPool]: On list_openweather_your_target_schema: Close
[0m23:59:32.431627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_your_target_schema, now list_openweather_analytics)
[0m23:59:32.434404 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:59:32.434754 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:59:32.435036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:59:32.974638 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.539 seconds
[0m23:59:32.978118 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:59:33.116746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd53720d3-af31-4da8-a693-2e07bf204971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066efad0>]}
[0m23:59:33.117626 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:59:33.117996 [info ] [MainThread]: 
[0m23:59:33.122202 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_trend
[0m23:59:33.122942 [info ] [Thread-1 (]: 1 of 4 START snapshot your_target_schema.daily_average_weather_trend ........... [RUN]
[0m23:59:33.123479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now snapshot.weather_dbt.daily_average_weather_trend)
[0m23:59:33.123902 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_trend
[0m23:59:33.190873 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_trend
[0m23:59:33.226841 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_trend"
[0m23:59:33.227143 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_DATE as varchar ), '')
         || '|' || coalesce(cast(WEATHER_DATE as varchar ), '')
        ) as dbt_scd_id,
        WEATHER_DATE as dbt_updated_at,
        WEATHER_DATE as dbt_valid_from,
        
  
  coalesce(nullif(WEATHER_DATE, WEATHER_DATE), null)
  as dbt_valid_to
from (
        
    

    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:59:33.227326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:33.688968 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a5f-0004-3863-0002-5943000366d2
[0m23:59:33.689679 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m23:59:33.690278 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: Close
[0m23:59:33.822680 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m23:59:33.824749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53720d3-af31-4da8-a693-2e07bf204971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ff710>]}
[0m23:59:33.825793 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting your_target_schema.daily_average_weather_trend ....... [[31mERROR[0m in 0.70s]
[0m23:59:33.826435 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_trend
[0m23:59:33.826864 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m23:59:33.828052 [info ] [Thread-1 (]: 2 of 4 START snapshot your_target_schema.extreme_weather_events ................ [RUN]
[0m23:59:33.828486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_trend, now snapshot.weather_dbt.extreme_weather_events)
[0m23:59:33.828856 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m23:59:33.832226 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m23:59:33.836457 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m23:59:33.836837 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        
    

    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:59:33.837139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:34.223225 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a5f-0004-386b-0002-59430003b6a6
[0m23:59:34.224032 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m23:59:34.224695 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m23:59:34.359037 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m23:59:34.359908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53720d3-af31-4da8-a693-2e07bf204971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf9700>]}
[0m23:59:34.360925 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting your_target_schema.extreme_weather_events ............ [[31mERROR[0m in 0.53s]
[0m23:59:34.361536 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m23:59:34.361942 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m23:59:34.362365 [info ] [Thread-1 (]: 3 of 4 START snapshot your_target_schema.hourly_weather_patterns ............... [RUN]
[0m23:59:34.362858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m23:59:34.363593 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m23:59:34.366075 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m23:59:34.368434 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m23:59:34.368708 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        
    

    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:59:34.368936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:34.773457 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a5f-0004-386a-0002-5943000346aa
[0m23:59:34.774271 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m23:59:34.774960 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m23:59:34.901062 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m23:59:34.901827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53720d3-af31-4da8-a693-2e07bf204971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f8410>]}
[0m23:59:34.902739 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting your_target_schema.hourly_weather_patterns ........... [[31mERROR[0m in 0.54s]
[0m23:59:34.903329 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m23:59:34.903729 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m23:59:34.904075 [info ] [Thread-1 (]: 4 of 4 START snapshot your_target_schema.weather_conditions_frequency .......... [RUN]
[0m23:59:34.904421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m23:59:34.904692 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m23:59:34.908059 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m23:59:34.911390 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m23:59:34.911862 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        
    

    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:59:34.912228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:35.348086 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a5f-0004-3864-0002-594300033fd2
[0m23:59:35.349387 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m23:59:35.350033 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m23:59:35.469145 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m23:59:35.470048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53720d3-af31-4da8-a693-2e07bf204971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107686ed0>]}
[0m23:59:35.470950 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting your_target_schema.weather_conditions_frequency ...... [[31mERROR[0m in 0.57s]
[0m23:59:35.471558 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m23:59:35.473196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:59:35.473661 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m23:59:35.474016 [info ] [MainThread]: 
[0m23:59:35.474324 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m23:59:35.475376 [debug] [MainThread]: Command end result
[0m23:59:35.497816 [info ] [MainThread]: 
[0m23:59:35.498164 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m23:59:35.498360 [info ] [MainThread]: 
[0m23:59:35.498617 [error] [MainThread]:   Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m23:59:35.498789 [info ] [MainThread]: 
[0m23:59:35.498973 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m23:59:35.499114 [info ] [MainThread]: 
[0m23:59:35.499289 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m23:59:35.499423 [info ] [MainThread]: 
[0m23:59:35.499593 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m23:59:35.499732 [info ] [MainThread]: 
[0m23:59:35.499880 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m23:59:35.501672 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 4.9115443, "process_in_blocks": "0", "process_kernel_time": 0.236563, "process_mem_max_rss": "139231232", "process_out_blocks": "0", "process_user_time": 1.479516}
[0m23:59:35.502006 [debug] [MainThread]: Command `dbt snapshot` failed at 23:59:35.501946 after 4.91 seconds
[0m23:59:35.502234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10542ac80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10078dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105251250>]}
[0m23:59:35.502436 [debug] [MainThread]: Flushing usage events
[0m00:03:07.840948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107698d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113813b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113813d90>]}


============================== 00:03:07.844695 | deae0a0f-d5b9-42df-aa20-fb148f47f439 ==============================
[0m00:03:07.844695 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:03:07.845133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m00:03:08.076333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'deae0a0f-d5b9-42df-aa20-fb148f47f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11481a520>]}
[0m00:03:08.099677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'deae0a0f-d5b9-42df-aa20-fb148f47f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145fc050>]}
[0m00:03:08.100332 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:03:08.162312 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:03:08.233951 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m00:03:08.234324 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/extreme_weather_events.sql
[0m00:03:08.234500 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/weather_conditions_frequency.sql
[0m00:03:08.234650 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:03:08.234800 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/hourly_weather_patterns.sql
[0m00:03:08.358597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'deae0a0f-d5b9-42df-aa20-fb148f47f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ad0950>]}
[0m00:03:08.452381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'deae0a0f-d5b9-42df-aa20-fb148f47f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114543f20>]}
[0m00:03:08.452669 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m00:03:08.452824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deae0a0f-d5b9-42df-aa20-fb148f47f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148aaf90>]}
[0m00:03:08.453825 [info ] [MainThread]: 
[0m00:03:08.454114 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:03:08.456619 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m00:03:08.463163 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m00:03:08.463358 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m00:03:08.463485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:09.082238 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.618 seconds
[0m00:03:09.084982 [debug] [ThreadPool]: On list_openweather: Close
[0m00:03:09.253176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_snapshot)
[0m00:03:09.263833 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m00:03:09.264129 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m00:03:09.264316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:09.767938 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.503 seconds
[0m00:03:09.771757 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m00:03:09.919463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m00:03:09.923019 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m00:03:09.923521 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m00:03:09.923900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:10.467595 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.543 seconds
[0m00:03:10.471070 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m00:03:10.599660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deae0a0f-d5b9-42df-aa20-fb148f47f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137393d0>]}
[0m00:03:10.600633 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:03:10.601003 [info ] [MainThread]: 
[0m00:03:10.604782 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:03:10.605556 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.daily_average_weather_trend ..................... [RUN]
[0m00:03:10.606058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now snapshot.weather_dbt.daily_average_weather_trend)
[0m00:03:10.606429 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_trend
[0m00:03:10.615569 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_trend
[0m00:03:10.665012 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_trend"
[0m00:03:10.665354 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_DATE as varchar ), '')
         || '|' || coalesce(cast(WEATHER_DATE as varchar ), '')
        ) as dbt_scd_id,
        WEATHER_DATE as dbt_updated_at,
        WEATHER_DATE as dbt_valid_from,
        
  
  coalesce(nullif(WEATHER_DATE, WEATHER_DATE), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:03:10.665550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:11.153361 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a63-0004-3864-0002-594300033fd6
[0m00:03:11.153922 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:03:11.154378 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: Close
[0m00:03:11.299054 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:03:11.300959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deae0a0f-d5b9-42df-aa20-fb148f47f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a18590>]}
[0m00:03:11.301811 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshot.daily_average_weather_trend ................. [[31mERROR[0m in 0.69s]
[0m00:03:11.302408 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:03:11.302800 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m00:03:11.303203 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.extreme_weather_events .......................... [RUN]
[0m00:03:11.304879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_trend, now snapshot.weather_dbt.extreme_weather_events)
[0m00:03:11.305279 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m00:03:11.308525 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m00:03:11.312667 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m00:03:11.313042 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:03:11.313364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:11.742320 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a63-0004-386a-0002-5943000346ae
[0m00:03:11.743278 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m00:03:11.743981 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m00:03:11.902821 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:03:11.903604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deae0a0f-d5b9-42df-aa20-fb148f47f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b32a40>]}
[0m00:03:11.904595 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshot.extreme_weather_events ...................... [[31mERROR[0m in 0.60s]
[0m00:03:11.905269 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m00:03:11.905742 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:03:11.906369 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.hourly_weather_patterns ......................... [RUN]
[0m00:03:11.906879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m00:03:11.907221 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m00:03:11.911005 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m00:03:11.915225 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m00:03:11.915579 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME, -- Include city name for better insights
    EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:03:11.915897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:12.333780 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a63-0004-3867-0002-5943000356ba
[0m00:03:12.335188 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m00:03:12.336400 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m00:03:12.577877 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:03:12.578871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deae0a0f-d5b9-42df-aa20-fb148f47f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ca0690>]}
[0m00:03:12.579877 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshot.hourly_weather_patterns ..................... [[31mERROR[0m in 0.67s]
[0m00:03:12.580465 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:03:12.580870 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:03:12.581528 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.weather_conditions_frequency .................... [RUN]
[0m00:03:12.582094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m00:03:12.582448 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m00:03:12.586367 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m00:03:12.596117 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m00:03:12.596615 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:03:12.596911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:13.080016 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a63-0004-3867-0002-5943000356be
[0m00:03:13.080706 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:03:13.081420 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m00:03:13.207220 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:03:13.208087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deae0a0f-d5b9-42df-aa20-fb148f47f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ac1450>]}
[0m00:03:13.209179 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshot.weather_conditions_frequency ................ [[31mERROR[0m in 0.63s]
[0m00:03:13.209878 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:03:13.211387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:13.211647 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m00:03:13.211931 [info ] [MainThread]: 
[0m00:03:13.212191 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 4.76 seconds (4.76s).
[0m00:03:13.213244 [debug] [MainThread]: Command end result
[0m00:03:13.236498 [info ] [MainThread]: 
[0m00:03:13.236817 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:03:13.237060 [info ] [MainThread]: 
[0m00:03:13.237309 [error] [MainThread]:   Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:03:13.237504 [info ] [MainThread]: 
[0m00:03:13.237707 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:03:13.237863 [info ] [MainThread]: 
[0m00:03:13.238054 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:03:13.238268 [info ] [MainThread]: 
[0m00:03:13.238567 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:03:13.238760 [info ] [MainThread]: 
[0m00:03:13.238943 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:03:13.240508 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.44247, "process_in_blocks": "0", "process_kernel_time": 0.273168, "process_mem_max_rss": "140951552", "process_out_blocks": "0", "process_user_time": 1.634638}
[0m00:03:13.240838 [debug] [MainThread]: Command `dbt snapshot` failed at 00:03:13.240779 after 5.44 seconds
[0m00:03:13.241049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10478dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ba7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102818b0>]}
[0m00:03:13.241252 [debug] [MainThread]: Flushing usage events
[0m00:06:14.639925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a98d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b17b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b17d90>]}


============================== 00:06:14.643359 | 3ff30693-afca-49b7-b5e6-d2f8f79e31f3 ==============================
[0m00:06:14.643359 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:06:14.643722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:06:14.870351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ff30693-afca-49b7-b5e6-d2f8f79e31f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11831a520>]}
[0m00:06:14.894444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ff30693-afca-49b7-b5e6-d2f8f79e31f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180fc050>]}
[0m00:06:14.895135 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:06:14.955804 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:06:15.030330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:06:15.030723 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:06:15.030894 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/hourly_weather_patterns.sql
[0m00:06:15.145494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ff30693-afca-49b7-b5e6-d2f8f79e31f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1185b4150>]}
[0m00:06:15.230428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ff30693-afca-49b7-b5e6-d2f8f79e31f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118043f20>]}
[0m00:06:15.230732 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m00:06:15.230894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ff30693-afca-49b7-b5e6-d2f8f79e31f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1186f4050>]}
[0m00:06:15.231908 [info ] [MainThread]: 
[0m00:06:15.232169 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:06:15.234243 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m00:06:15.240425 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m00:06:15.240576 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m00:06:15.240701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:06:15.865455 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.624 seconds
[0m00:06:15.869411 [debug] [ThreadPool]: On list_openweather: Close
[0m00:06:16.025368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m00:06:16.036193 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m00:06:16.036563 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m00:06:16.036827 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:06:16.526229 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.489 seconds
[0m00:06:16.530295 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m00:06:16.662604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m00:06:16.667169 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m00:06:16.667544 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m00:06:16.667836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:06:17.224891 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.557 seconds
[0m00:06:17.228084 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m00:06:17.359048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ff30693-afca-49b7-b5e6-d2f8f79e31f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11881b2b0>]}
[0m00:06:17.359981 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:06:17.360428 [info ] [MainThread]: 
[0m00:06:17.365619 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:06:17.366241 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.daily_average_weather_trend ..................... [RUN]
[0m00:06:17.366710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now snapshot.weather_dbt.daily_average_weather_trend)
[0m00:06:17.367068 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_trend
[0m00:06:17.376786 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_trend
[0m00:06:17.424803 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_trend"
[0m00:06:17.425117 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_DATE as varchar ), '')
         || '|' || coalesce(cast(WEATHER_DATE as varchar ), '')
        ) as dbt_scd_id,
        WEATHER_DATE as dbt_updated_at,
        WEATHER_DATE as dbt_valid_from,
        
  
  coalesce(nullif(WEATHER_DATE, WEATHER_DATE), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    DATE_TRUNC('DAY', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('DAY', w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:06:17.425331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:17.912565 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a66-0004-3863-0002-5943000366d6
[0m00:06:17.913287 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:06:17.913887 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: Close
[0m00:06:18.055783 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:06:18.057826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ff30693-afca-49b7-b5e6-d2f8f79e31f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a15cd0>]}
[0m00:06:18.058788 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshot.daily_average_weather_trend ................. [[31mERROR[0m in 0.69s]
[0m00:06:18.059397 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:06:18.059804 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m00:06:18.060954 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.extreme_weather_events .......................... [RUN]
[0m00:06:18.061387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_trend, now snapshot.weather_dbt.extreme_weather_events)
[0m00:06:18.061686 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m00:06:18.065092 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m00:06:18.069353 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m00:06:18.069731 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:06:18.070031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:18.536341 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a66-0004-3987-0002-59430003d16e
[0m00:06:18.537799 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m00:06:18.538660 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m00:06:18.694338 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:06:18.695160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ff30693-afca-49b7-b5e6-d2f8f79e31f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b32ba0>]}
[0m00:06:18.695917 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshot.extreme_weather_events ...................... [[31mERROR[0m in 0.63s]
[0m00:06:18.696353 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m00:06:18.696660 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:06:18.697085 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.hourly_weather_patterns ......................... [RUN]
[0m00:06:18.697663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m00:06:18.698052 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m00:06:18.701743 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m00:06:18.705183 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m00:06:18.705582 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:06:18.705928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:19.112547 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a66-0004-3868-0002-5943000386c6
[0m00:06:19.113466 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m00:06:19.114114 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m00:06:19.241817 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:06:19.242413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ff30693-afca-49b7-b5e6-d2f8f79e31f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118be5810>]}
[0m00:06:19.243384 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshot.hourly_weather_patterns ..................... [[31mERROR[0m in 0.54s]
[0m00:06:19.244004 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:06:19.244389 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:06:19.244907 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.weather_conditions_frequency .................... [RUN]
[0m00:06:19.245358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m00:06:19.245677 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m00:06:19.249392 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m00:06:19.257886 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m00:06:19.258256 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:06:19.258530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:19.628586 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a66-0004-3868-0002-5943000386ca
[0m00:06:19.629465 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:06:19.630207 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m00:06:19.778831 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:06:19.779569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ff30693-afca-49b7-b5e6-d2f8f79e31f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180f36d0>]}
[0m00:06:19.780525 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshot.weather_conditions_frequency ................ [[31mERROR[0m in 0.53s]
[0m00:06:19.781103 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:06:19.782555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:06:19.782876 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m00:06:19.783190 [info ] [MainThread]: 
[0m00:06:19.783475 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 4.55 seconds (4.55s).
[0m00:06:19.784471 [debug] [MainThread]: Command end result
[0m00:06:19.808113 [info ] [MainThread]: 
[0m00:06:19.808376 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:06:19.808548 [info ] [MainThread]: 
[0m00:06:19.808767 [error] [MainThread]:   Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:06:19.808933 [info ] [MainThread]: 
[0m00:06:19.809128 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:06:19.809282 [info ] [MainThread]: 
[0m00:06:19.809474 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:06:19.809621 [info ] [MainThread]: 
[0m00:06:19.809807 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:06:19.809960 [info ] [MainThread]: 
[0m00:06:19.810127 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:06:19.811599 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.212215, "process_in_blocks": "0", "process_kernel_time": 0.28024, "process_mem_max_rss": "142196736", "process_out_blocks": "0", "process_user_time": 1.605539}
[0m00:06:19.811975 [debug] [MainThread]: Command `dbt snapshot` failed at 00:06:19.811912 after 5.21 seconds
[0m00:06:19.812178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100bd1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118bc31c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040d04d0>]}
[0m00:06:19.812362 [debug] [MainThread]: Flushing usage events
[0m00:06:26.189980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10729cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b9fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b9fd90>]}


============================== 00:06:26.192318 | a13daea7-3e62-4dac-bbd4-d44ea27d45dc ==============================
[0m00:06:26.192318 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:06:26.192620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:06:26.240443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a13daea7-3e62-4dac-bbd4-d44ea27d45dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a0b360>]}
[0m00:06:26.251406 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.09727796, "process_in_blocks": "0", "process_kernel_time": 0.08744, "process_mem_max_rss": "100941824", "process_out_blocks": "0", "process_user_time": 0.617971}
[0m00:06:26.251685 [debug] [MainThread]: Command `dbt clean` succeeded at 00:06:26.251630 after 0.10 seconds
[0m00:06:26.251850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cca580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cca690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108932950>]}
[0m00:06:26.252019 [debug] [MainThread]: Flushing usage events
[0m00:06:32.158556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103498d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c13b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c13d90>]}


============================== 00:06:32.160937 | 1cf90c60-c4d7-4228-9fc4-102de40e61ff ==============================
[0m00:06:32.160937 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:06:32.161242 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:06:32.342043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cf90c60-c4d7-4228-9fc4-102de40e61ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106afa520>]}
[0m00:06:32.366473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cf90c60-c4d7-4228-9fc4-102de40e61ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f4050>]}
[0m00:06:32.366957 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:06:32.423861 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:06:32.424512 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:06:32.424701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1cf90c60-c4d7-4228-9fc4-102de40e61ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106968a50>]}
[0m00:06:33.011927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cf90c60-c4d7-4228-9fc4-102de40e61ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e85040>]}
[0m00:06:33.058342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cf90c60-c4d7-4228-9fc4-102de40e61ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c698d0>]}
[0m00:06:33.058620 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m00:06:33.058778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cf90c60-c4d7-4228-9fc4-102de40e61ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c97790>]}
[0m00:06:33.059902 [info ] [MainThread]: 
[0m00:06:33.060253 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:06:33.062552 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m00:06:33.068886 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m00:06:33.069073 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m00:06:33.069194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:06:33.660540 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.591 seconds
[0m00:06:33.663417 [debug] [ThreadPool]: On list_openweather: Close
[0m00:06:33.780074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_snapshot)
[0m00:06:33.792029 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m00:06:33.792383 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m00:06:33.792640 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:06:34.388420 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.596 seconds
[0m00:06:34.391636 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m00:06:34.536958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m00:06:34.539855 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m00:06:34.540237 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m00:06:34.540535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:06:35.090096 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.549 seconds
[0m00:06:35.094236 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m00:06:35.218192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cf90c60-c4d7-4228-9fc4-102de40e61ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d2f890>]}
[0m00:06:35.219275 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:06:35.219740 [info ] [MainThread]: 
[0m00:06:35.223391 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:06:35.224066 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.daily_average_weather_trend ..................... [RUN]
[0m00:06:35.224562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now snapshot.weather_dbt.daily_average_weather_trend)
[0m00:06:35.224938 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_trend
[0m00:06:35.233729 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_trend
[0m00:06:35.281979 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_trend"
[0m00:06:35.282294 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_DATE as varchar ), '')
         || '|' || coalesce(cast(WEATHER_DATE as varchar ), '')
        ) as dbt_scd_id,
        WEATHER_DATE as dbt_updated_at,
        WEATHER_DATE as dbt_valid_from,
        
  
  coalesce(nullif(WEATHER_DATE, WEATHER_DATE), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    DATE_TRUNC('DAY', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('DAY', w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:06:35.282489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:35.729684 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a66-0004-3987-0002-59430003d172
[0m00:06:35.730354 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:06:35.730933 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: Close
[0m00:06:35.876233 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:06:35.877972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cf90c60-c4d7-4228-9fc4-102de40e61ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108868520>]}
[0m00:06:35.878902 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshot.daily_average_weather_trend ................. [[31mERROR[0m in 0.65s]
[0m00:06:35.879518 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:06:35.879900 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m00:06:35.880972 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.extreme_weather_events .......................... [RUN]
[0m00:06:35.881401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_trend, now snapshot.weather_dbt.extreme_weather_events)
[0m00:06:35.881698 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m00:06:35.885090 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m00:06:35.888331 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m00:06:35.888645 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:06:35.888941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:36.363470 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a66-0004-386c-0002-594300037726
[0m00:06:36.364384 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m00:06:36.365123 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m00:06:36.492086 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:06:36.492921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cf90c60-c4d7-4228-9fc4-102de40e61ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108856cb0>]}
[0m00:06:36.493887 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshot.extreme_weather_events ...................... [[31mERROR[0m in 0.61s]
[0m00:06:36.494493 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m00:06:36.494901 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:06:36.495501 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.hourly_weather_patterns ......................... [RUN]
[0m00:06:36.496023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m00:06:36.496364 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m00:06:36.500288 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m00:06:36.503786 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m00:06:36.504135 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:06:36.504452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:36.939515 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a66-0004-386b-0002-59430003b6ae
[0m00:06:36.940128 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m00:06:36.940772 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m00:06:37.107639 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:06:37.108228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cf90c60-c4d7-4228-9fc4-102de40e61ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9dd50>]}
[0m00:06:37.109064 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshot.hourly_weather_patterns ..................... [[31mERROR[0m in 0.61s]
[0m00:06:37.109678 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:06:37.110081 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:06:37.110682 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.weather_conditions_frequency .................... [RUN]
[0m00:06:37.111071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m00:06:37.111312 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m00:06:37.113597 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m00:06:37.116120 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m00:06:37.116411 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:06:37.116652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:37.659640 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a66-0004-3869-0002-59430003a6ae
[0m00:06:37.661014 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:06:37.661805 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m00:06:37.802878 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:06:37.803695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cf90c60-c4d7-4228-9fc4-102de40e61ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103935b70>]}
[0m00:06:37.804721 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshot.weather_conditions_frequency ................ [[31mERROR[0m in 0.69s]
[0m00:06:37.805299 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:06:37.806760 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:06:37.807022 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m00:06:37.807304 [info ] [MainThread]: 
[0m00:06:37.807571 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 4.75 seconds (4.75s).
[0m00:06:37.808557 [debug] [MainThread]: Command end result
[0m00:06:37.831010 [info ] [MainThread]: 
[0m00:06:37.831290 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:06:37.831473 [info ] [MainThread]: 
[0m00:06:37.831703 [error] [MainThread]:   Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:06:37.831870 [info ] [MainThread]: 
[0m00:06:37.832066 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:06:37.832219 [info ] [MainThread]: 
[0m00:06:37.832412 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:06:37.832557 [info ] [MainThread]: 
[0m00:06:37.832745 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:06:37.832894 [info ] [MainThread]: 
[0m00:06:37.833067 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:06:37.834429 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.7102885, "process_in_blocks": "0", "process_kernel_time": 0.234564, "process_mem_max_rss": "144965632", "process_out_blocks": "0", "process_user_time": 1.959329}
[0m00:06:37.834713 [debug] [MainThread]: Command `dbt snapshot` failed at 00:06:37.834663 after 5.71 seconds
[0m00:06:37.834907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac2870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c17e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c17dd0>]}
[0m00:06:37.835081 [debug] [MainThread]: Flushing usage events
[0m00:07:30.285143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105198d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107017b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107017d90>]}


============================== 00:07:30.288380 | b0154c93-0f94-4ac5-9178-6cb67ded32df ==============================
[0m00:07:30.288380 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:07:30.288697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:07:30.504906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0154c93-0f94-4ac5-9178-6cb67ded32df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f8a520>]}
[0m00:07:30.528090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0154c93-0f94-4ac5-9178-6cb67ded32df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ef4050>]}
[0m00:07:30.528681 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:07:30.589297 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:07:30.660314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:07:30.660727 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:07:30.773623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0154c93-0f94-4ac5-9178-6cb67ded32df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12123ce50>]}
[0m00:07:30.826719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0154c93-0f94-4ac5-9178-6cb67ded32df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120e43e30>]}
[0m00:07:30.827015 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m00:07:30.827178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0154c93-0f94-4ac5-9178-6cb67ded32df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121368ad0>]}
[0m00:07:30.828184 [info ] [MainThread]: 
[0m00:07:30.828459 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:07:30.830524 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m00:07:30.836563 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m00:07:30.836723 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m00:07:30.836848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:31.415044 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.578 seconds
[0m00:07:31.418968 [debug] [ThreadPool]: On list_openweather: Close
[0m00:07:31.562392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_snapshot)
[0m00:07:31.567903 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m00:07:31.568118 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m00:07:31.568274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:32.053239 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.485 seconds
[0m00:07:32.057600 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m00:07:32.188534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m00:07:32.192212 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m00:07:32.192717 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m00:07:32.193041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:32.706490 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.513 seconds
[0m00:07:32.712396 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m00:07:32.831589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0154c93-0f94-4ac5-9178-6cb67ded32df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121713930>]}
[0m00:07:32.832015 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:07:32.832209 [info ] [MainThread]: 
[0m00:07:32.833972 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:07:32.834271 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.daily_average_weather_trend ..................... [RUN]
[0m00:07:32.834491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now snapshot.weather_dbt.daily_average_weather_trend)
[0m00:07:32.834655 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_trend
[0m00:07:32.839206 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_trend
[0m00:07:32.882724 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_trend"
[0m00:07:32.883096 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_DATE as varchar ), '')
         || '|' || coalesce(cast(WEATHER_DATE as varchar ), '')
        ) as dbt_scd_id,
        WEATHER_DATE as dbt_updated_at,
        WEATHER_DATE as dbt_valid_from,
        
  
  coalesce(nullif(WEATHER_DATE, WEATHER_DATE), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    DATE_TRUNC('DAY', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('DAY', w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:07:32.883326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:33.350585 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a67-0004-3868-0002-5943000386ce
[0m00:07:33.351155 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:07:33.351590 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: Close
[0m00:07:33.559585 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:07:33.561965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0154c93-0f94-4ac5-9178-6cb67ded32df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121910dd0>]}
[0m00:07:33.562927 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshot.daily_average_weather_trend ................. [[31mERROR[0m in 0.73s]
[0m00:07:33.563574 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:07:33.564002 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m00:07:33.565230 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.extreme_weather_events .......................... [RUN]
[0m00:07:33.565725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_trend, now snapshot.weather_dbt.extreme_weather_events)
[0m00:07:33.566073 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m00:07:33.569601 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m00:07:33.573793 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m00:07:33.574166 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:07:33.574498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:34.111983 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a67-0004-3863-0002-5943000366da
[0m00:07:34.113284 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m00:07:34.114093 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m00:07:34.275403 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:07:34.276214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0154c93-0f94-4ac5-9178-6cb67ded32df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a2aba0>]}
[0m00:07:34.277169 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshot.extreme_weather_events ...................... [[31mERROR[0m in 0.71s]
[0m00:07:34.277740 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m00:07:34.278127 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:07:34.278689 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.hourly_weather_patterns ......................... [RUN]
[0m00:07:34.279166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m00:07:34.279511 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m00:07:34.283237 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m00:07:34.287242 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m00:07:34.287595 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:07:34.287911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:34.834729 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a67-0004-3864-0002-594300033fde
[0m00:07:34.835983 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m00:07:34.836997 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m00:07:35.028484 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:07:35.029183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0154c93-0f94-4ac5-9178-6cb67ded32df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ae8f50>]}
[0m00:07:35.030128 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshot.hourly_weather_patterns ..................... [[31mERROR[0m in 0.75s]
[0m00:07:35.030703 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:07:35.031095 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:07:35.031634 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.weather_conditions_frequency .................... [RUN]
[0m00:07:35.032090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m00:07:35.032412 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m00:07:35.036155 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m00:07:35.040321 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m00:07:35.040685 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:07:35.040997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:35.492504 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a67-0004-3868-0002-5943000386d2
[0m00:07:35.493161 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:07:35.493702 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m00:07:35.632114 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:07:35.632835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0154c93-0f94-4ac5-9178-6cb67ded32df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121406c50>]}
[0m00:07:35.633714 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshot.weather_conditions_frequency ................ [[31mERROR[0m in 0.60s]
[0m00:07:35.634245 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:07:35.635786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:07:35.636117 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m00:07:35.636417 [info ] [MainThread]: 
[0m00:07:35.636740 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 4.81 seconds (4.81s).
[0m00:07:35.637783 [debug] [MainThread]: Command end result
[0m00:07:35.664819 [info ] [MainThread]: 
[0m00:07:35.665128 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:07:35.665310 [info ] [MainThread]: 
[0m00:07:35.665543 [error] [MainThread]:   Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:07:35.665714 [info ] [MainThread]: 
[0m00:07:35.665913 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:07:35.666070 [info ] [MainThread]: 
[0m00:07:35.666255 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:07:35.666387 [info ] [MainThread]: 
[0m00:07:35.666560 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:07:35.666697 [info ] [MainThread]: 
[0m00:07:35.666847 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:07:35.668354 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.422462, "process_in_blocks": "0", "process_kernel_time": 0.275516, "process_mem_max_rss": "143245312", "process_out_blocks": "0", "process_user_time": 1.561627}
[0m00:07:35.668793 [debug] [MainThread]: Command `dbt snapshot` failed at 00:07:35.668722 after 5.42 seconds
[0m00:07:35.669023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702ac80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102aa1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a726f0>]}
[0m00:07:35.669228 [debug] [MainThread]: Flushing usage events
[0m00:08:18.619215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f98d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106adbb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106adbd90>]}


============================== 00:08:18.622323 | 5ab88985-f658-4012-8038-e64e8622605a ==============================
[0m00:08:18.622323 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:08:18.622626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:08:18.836478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ab88985-f658-4012-8038-e64e8622605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10791a520>]}
[0m00:08:18.861261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ab88985-f658-4012-8038-e64e8622605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f4050>]}
[0m00:08:18.862165 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:08:18.920872 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:08:18.987227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m00:08:18.987601 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/extreme_weather_events.sql
[0m00:08:18.987770 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/hourly_weather_patterns.sql
[0m00:08:18.987927 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/weather_conditions_frequency.sql
[0m00:08:19.105522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ab88985-f658-4012-8038-e64e8622605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd0850>]}
[0m00:08:19.188911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ab88985-f658-4012-8038-e64e8622605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107843f20>]}
[0m00:08:19.189194 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m00:08:19.189349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ab88985-f658-4012-8038-e64e8622605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079aef90>]}
[0m00:08:19.190317 [info ] [MainThread]: 
[0m00:08:19.190588 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:08:19.192789 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m00:08:19.199554 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m00:08:19.199758 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m00:08:19.199891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:08:19.803901 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.604 seconds
[0m00:08:19.806712 [debug] [ThreadPool]: On list_openweather: Close
[0m00:08:19.957878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m00:08:19.968672 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m00:08:19.969156 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m00:08:19.969417 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:08:20.505709 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.536 seconds
[0m00:08:20.509717 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m00:08:20.632535 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m00:08:20.637298 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m00:08:20.637873 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m00:08:20.638205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:08:21.119836 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.481 seconds
[0m00:08:21.122941 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m00:08:21.236058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ab88985-f658-4012-8038-e64e8622605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069fd3d0>]}
[0m00:08:21.236941 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:08:21.237412 [info ] [MainThread]: 
[0m00:08:21.241788 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:08:21.242418 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.daily_average_weather_trend ..................... [RUN]
[0m00:08:21.242887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now snapshot.weather_dbt.daily_average_weather_trend)
[0m00:08:21.243243 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_trend
[0m00:08:21.253055 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_trend
[0m00:08:21.301121 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_trend"
[0m00:08:21.301420 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_DATE as varchar ), '')
         || '|' || coalesce(cast(WEATHER_DATE as varchar ), '')
        ) as dbt_scd_id,
        WEATHER_DATE as dbt_updated_at,
        WEATHER_DATE as dbt_valid_from,
        
  
  coalesce(nullif(WEATHER_DATE, WEATHER_DATE), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    DATE_TRUNC('DAY', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('DAY', w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:08:21.301611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:21.760956 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a68-0004-3867-0002-5943000356c6
[0m00:08:21.761669 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:08:21.762234 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: Close
[0m00:08:21.896527 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:08:21.898332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ab88985-f658-4012-8038-e64e8622605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108114dd0>]}
[0m00:08:21.899186 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshot.daily_average_weather_trend ................. [[31mERROR[0m in 0.65s]
[0m00:08:21.899736 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:08:21.900121 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m00:08:21.901331 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.extreme_weather_events .......................... [RUN]
[0m00:08:21.901801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_trend, now snapshot.weather_dbt.extreme_weather_events)
[0m00:08:21.902132 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m00:08:21.905657 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m00:08:21.909884 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m00:08:21.910226 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:08:21.910524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:22.486238 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a68-0004-3868-0002-5943000386d6
[0m00:08:22.487471 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m00:08:22.488215 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m00:08:22.615932 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:08:22.616827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ab88985-f658-4012-8038-e64e8622605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108232ba0>]}
[0m00:08:22.617865 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshot.extreme_weather_events ...................... [[31mERROR[0m in 0.71s]
[0m00:08:22.618480 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m00:08:22.618863 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:08:22.619423 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.hourly_weather_patterns ......................... [RUN]
[0m00:08:22.619883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m00:08:22.620211 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m00:08:22.623900 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m00:08:22.628138 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m00:08:22.628486 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:08:22.628809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:23.009893 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a68-0004-3869-0002-59430003a6b6
[0m00:08:23.010999 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m00:08:23.011963 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m00:08:23.144451 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:08:23.145214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ab88985-f658-4012-8038-e64e8622605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a7430>]}
[0m00:08:23.146192 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshot.hourly_weather_patterns ..................... [[31mERROR[0m in 0.53s]
[0m00:08:23.146759 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:08:23.147146 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:08:23.147692 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.weather_conditions_frequency .................... [RUN]
[0m00:08:23.148195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m00:08:23.148528 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m00:08:23.152258 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m00:08:23.160698 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m00:08:23.161089 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:08:23.161367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:23.618272 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a68-0004-3865-0002-594300039746
[0m00:08:23.619301 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:08:23.620053 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m00:08:23.759006 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:08:23.759466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ab88985-f658-4012-8038-e64e8622605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ff91d0>]}
[0m00:08:23.760109 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshot.weather_conditions_frequency ................ [[31mERROR[0m in 0.61s]
[0m00:08:23.760602 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:08:23.761932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:08:23.762220 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m00:08:23.762489 [info ] [MainThread]: 
[0m00:08:23.762730 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m00:08:23.763660 [debug] [MainThread]: Command end result
[0m00:08:23.788361 [info ] [MainThread]: 
[0m00:08:23.788699 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:08:23.788948 [info ] [MainThread]: 
[0m00:08:23.789209 [error] [MainThread]:   Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:08:23.789383 [info ] [MainThread]: 
[0m00:08:23.789635 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:08:23.789878 [info ] [MainThread]: 
[0m00:08:23.790147 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:08:23.790334 [info ] [MainThread]: 
[0m00:08:23.790556 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:08:23.790728 [info ] [MainThread]: 
[0m00:08:23.790907 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:08:23.792441 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.210549, "process_in_blocks": "0", "process_kernel_time": 0.261804, "process_mem_max_rss": "140083200", "process_out_blocks": "0", "process_user_time": 1.609904}
[0m00:08:23.792759 [debug] [MainThread]: Command `dbt snapshot` failed at 00:08:23.792702 after 5.21 seconds
[0m00:08:23.792966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1009d5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b81a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056b3890>]}
[0m00:08:23.793156 [debug] [MainThread]: Flushing usage events
[0m00:09:04.345867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031fcd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104affd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104affb10>]}


============================== 00:09:04.348993 | be8cd700-ba7e-4663-912e-5855d8ccfea9 ==============================
[0m00:09:04.348993 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:09:04.349306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:09:04.595623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be8cd700-ba7e-4663-912e-5855d8ccfea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575a520>]}
[0m00:09:04.621102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be8cd700-ba7e-4663-912e-5855d8ccfea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10565c050>]}
[0m00:09:04.621849 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:09:04.681235 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:09:04.755085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:09:04.755336 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:09:04.776427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be8cd700-ba7e-4663-912e-5855d8ccfea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055cf850>]}
[0m00:09:04.835222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be8cd700-ba7e-4663-912e-5855d8ccfea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a1310>]}
[0m00:09:04.835521 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m00:09:04.835822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be8cd700-ba7e-4663-912e-5855d8ccfea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b64c90>]}
[0m00:09:04.836969 [info ] [MainThread]: 
[0m00:09:04.837279 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:09:04.839422 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m00:09:04.846717 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m00:09:04.846933 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m00:09:04.847078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:09:05.575234 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.728 seconds
[0m00:09:05.578346 [debug] [ThreadPool]: On list_openweather: Close
[0m00:09:05.735013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m00:09:05.750471 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m00:09:05.750967 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m00:09:05.751217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:09:06.248923 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.498 seconds
[0m00:09:06.250433 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m00:09:06.391378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m00:09:06.395549 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m00:09:06.396175 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m00:09:06.396670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:09:06.943863 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.547 seconds
[0m00:09:06.946892 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m00:09:07.060911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be8cd700-ba7e-4663-912e-5855d8ccfea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b37ad0>]}
[0m00:09:07.061339 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:09:07.061994 [info ] [MainThread]: 
[0m00:09:07.064471 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:09:07.064800 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.daily_average_weather_trend ..................... [RUN]
[0m00:09:07.065043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now snapshot.weather_dbt.daily_average_weather_trend)
[0m00:09:07.065205 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_trend
[0m00:09:07.071517 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_trend
[0m00:09:07.117061 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_trend"
[0m00:09:07.117386 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_DATE as varchar ), '')
         || '|' || coalesce(cast(WEATHER_DATE as varchar ), '')
        ) as dbt_scd_id,
        WEATHER_DATE as dbt_updated_at,
        WEATHER_DATE as dbt_valid_from,
        
  
  coalesce(nullif(WEATHER_DATE, WEATHER_DATE), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    DATE_TRUNC('DAY', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('DAY', w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:09:07.117588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:09:07.567368 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a69-0004-3863-0002-5943000366de
[0m00:09:07.568130 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:09:07.568759 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: Close
[0m00:09:07.703065 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:09:07.705163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be8cd700-ba7e-4663-912e-5855d8ccfea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105db0c50>]}
[0m00:09:07.705850 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshot.daily_average_weather_trend ................. [[31mERROR[0m in 0.64s]
[0m00:09:07.706491 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:09:07.707014 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m00:09:07.707814 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.extreme_weather_events .......................... [RUN]
[0m00:09:07.708224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_trend, now snapshot.weather_dbt.extreme_weather_events)
[0m00:09:07.708432 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m00:09:07.711328 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m00:09:07.715514 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m00:09:07.715876 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:09:07.716169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:09:08.123452 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a69-0004-3864-0002-594300033fe6
[0m00:09:08.124452 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m00:09:08.125085 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m00:09:08.284653 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:09:08.285483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be8cd700-ba7e-4663-912e-5855d8ccfea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e39860>]}
[0m00:09:08.286444 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshot.extreme_weather_events ...................... [[31mERROR[0m in 0.58s]
[0m00:09:08.287070 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m00:09:08.287506 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:09:08.287918 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.hourly_weather_patterns ......................... [RUN]
[0m00:09:08.288514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m00:09:08.288952 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m00:09:08.292655 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m00:09:08.297420 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m00:09:08.297921 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:09:08.298257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:09:08.787270 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a69-0004-3987-0002-59430003d182
[0m00:09:08.788789 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m00:09:08.789750 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m00:09:08.921785 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:09:08.922762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be8cd700-ba7e-4663-912e-5855d8ccfea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a28550>]}
[0m00:09:08.923688 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshot.hourly_weather_patterns ..................... [[31mERROR[0m in 0.63s]
[0m00:09:08.924300 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:09:08.924712 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:09:08.925299 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.weather_conditions_frequency .................... [RUN]
[0m00:09:08.925842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m00:09:08.926200 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m00:09:08.929842 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m00:09:08.934493 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m00:09:08.935008 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:09:08.935653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:09:09.569368 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a69-0004-3864-0002-594300033fea
[0m00:09:09.570040 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:09:09.570540 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m00:09:09.708861 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:09:09.709508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be8cd700-ba7e-4663-912e-5855d8ccfea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10595f950>]}
[0m00:09:09.710413 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshot.weather_conditions_frequency ................ [[31mERROR[0m in 0.78s]
[0m00:09:09.711063 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:09:09.712078 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:09:09.712345 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m00:09:09.712547 [info ] [MainThread]: 
[0m00:09:09.712740 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 4.88 seconds (4.88s).
[0m00:09:09.713356 [debug] [MainThread]: Command end result
[0m00:09:09.734605 [info ] [MainThread]: 
[0m00:09:09.734957 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:09:09.735153 [info ] [MainThread]: 
[0m00:09:09.735405 [error] [MainThread]:   Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:09:09.735588 [info ] [MainThread]: 
[0m00:09:09.735806 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:09:09.735975 [info ] [MainThread]: 
[0m00:09:09.736183 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:09:09.736410 [info ] [MainThread]: 
[0m00:09:09.736814 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:09:09.737028 [info ] [MainThread]: 
[0m00:09:09.737234 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:09:09.738921 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.4373384, "process_in_blocks": "0", "process_kernel_time": 0.29061, "process_mem_max_rss": "140001280", "process_out_blocks": "0", "process_user_time": 1.568577}
[0m00:09:09.739399 [debug] [MainThread]: Command `dbt snapshot` failed at 00:09:09.739325 after 5.44 seconds
[0m00:09:09.739700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b12ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e69d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10395d310>]}
[0m00:09:09.740063 [debug] [MainThread]: Flushing usage events
[0m00:10:38.189803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107398d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095d7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095d7b10>]}


============================== 00:10:38.192889 | 744557ae-21e8-4a69-8329-8f2b4fbd1edc ==============================
[0m00:10:38.192889 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:10:38.193227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:10:38.429635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '744557ae-21e8-4a69-8329-8f2b4fbd1edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae1a520>]}
[0m00:10:38.452547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '744557ae-21e8-4a69-8329-8f2b4fbd1edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adfc050>]}
[0m00:10:38.453349 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:10:38.513012 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:10:38.585764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:10:38.586148 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/daily_avg_weather_trend.sql
[0m00:10:38.658133 [error] [MainThread]: Encountered an error:
Compilation Error in model daily_avg_weather_trend (models/output/daily_avg_weather_trend.sql)
  Encountered unknown tag 'snapshot'.
    line 3
      {% snapshot daily_average_weather_trend %}
[0m00:10:38.659456 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.508638, "process_in_blocks": "0", "process_kernel_time": 0.211623, "process_mem_max_rss": "126255104", "process_out_blocks": "0", "process_user_time": 0.904915}
[0m00:10:38.659793 [debug] [MainThread]: Command `dbt snapshot` failed at 00:10:38.659719 after 0.51 seconds
[0m00:10:38.660036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad6fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad6f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8b68a0>]}
[0m00:10:38.660242 [debug] [MainThread]: Flushing usage events
[0m00:11:06.456716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a13d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a13b10>]}


============================== 00:11:06.460244 | ced90705-1b58-4f8f-9b43-28b77d2f51ce ==============================
[0m00:11:06.460244 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:11:06.460587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:11:06.688904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ced90705-1b58-4f8f-9b43-28b77d2f51ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a8a520>]}
[0m00:11:06.713664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ced90705-1b58-4f8f-9b43-28b77d2f51ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099fc050>]}
[0m00:11:06.715066 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:11:06.774046 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:11:06.846498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:11:06.846881 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/daily_avg_weather_trend.sql
[0m00:11:06.922458 [error] [MainThread]: Encountered an error:
Compilation Error in model daily_avg_weather_trend (models/output/daily_avg_weather_trend.sql)
  Encountered unknown tag 'snapshot'.
    line 1
      {% snapshot daily_average_weather_trend %}
[0m00:11:06.923827 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.50682014, "process_in_blocks": "0", "process_kernel_time": 0.190948, "process_mem_max_rss": "128253952", "process_out_blocks": "0", "process_user_time": 0.920071}
[0m00:11:06.924115 [debug] [MainThread]: Command `dbt snapshot` failed at 00:11:06.924062 after 0.51 seconds
[0m00:11:06.924435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10996fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10996f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d268a0>]}
[0m00:11:06.924726 [debug] [MainThread]: Flushing usage events
[0m00:11:25.404516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cacd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b3b10>]}


============================== 00:11:25.407002 | 07359f07-3aa3-4580-b6e2-465dd41a7e7b ==============================
[0m00:11:25.407002 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:11:25.407322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:11:25.577121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07359f07-3aa3-4580-b6e2-465dd41a7e7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10588a520>]}
[0m00:11:25.602176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07359f07-3aa3-4580-b6e2-465dd41a7e7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057fc050>]}
[0m00:11:25.603038 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:11:25.662754 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:11:25.737541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:11:25.737974 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/daily_avg_weather_trend.sql
[0m00:11:25.815997 [error] [MainThread]: Encountered an error:
Compilation Error in model daily_avg_weather_trend (models/output/daily_avg_weather_trend.sql)
  Encountered unknown tag 'snapshot'.
    line 1
      {% snapshot daily_avg_weather_trend %}
[0m00:11:25.817843 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.45083046, "process_in_blocks": "0", "process_kernel_time": 0.15508, "process_mem_max_rss": "125665280", "process_out_blocks": "0", "process_user_time": 0.92163}
[0m00:11:25.818195 [debug] [MainThread]: Command `dbt snapshot` failed at 00:11:25.818137 after 0.45 seconds
[0m00:11:25.818420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10576fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10576f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb68a0>]}
[0m00:11:25.818592 [debug] [MainThread]: Flushing usage events
[0m00:13:15.050612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b7b10>]}


============================== 00:13:15.054188 | 11f9aab4-582d-400a-ab23-59cd57ea95c3 ==============================
[0m00:13:15.054188 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:13:15.054622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:13:15.297506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11f9aab4-582d-400a-ab23-59cd57ea95c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10921a520>]}
[0m00:13:15.322468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11f9aab4-582d-400a-ab23-59cd57ea95c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091fc050>]}
[0m00:13:15.323250 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:13:15.384959 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:13:15.460098 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:13:15.460555 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:13:15.580568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11f9aab4-582d-400a-ab23-59cd57ea95c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094d0e50>]}
[0m00:13:15.636615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11f9aab4-582d-400a-ab23-59cd57ea95c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b8320>]}
[0m00:13:15.636929 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m00:13:15.637100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11f9aab4-582d-400a-ab23-59cd57ea95c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095f8c90>]}
[0m00:13:15.638112 [info ] [MainThread]: 
[0m00:13:15.638537 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:13:15.640674 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m00:13:15.647069 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m00:13:15.647235 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m00:13:15.647363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:16.316866 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.669 seconds
[0m00:13:16.320855 [debug] [ThreadPool]: On list_openweather: Close
[0m00:13:16.457545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m00:13:16.467046 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m00:13:16.467452 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m00:13:16.467732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:16.978546 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.511 seconds
[0m00:13:16.981816 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m00:13:17.116798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m00:13:17.118518 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m00:13:17.118775 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m00:13:17.119001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:17.679746 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.560 seconds
[0m00:13:17.682673 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m00:13:17.834667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11f9aab4-582d-400a-ab23-59cd57ea95c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10829d3d0>]}
[0m00:13:17.835680 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:13:17.836039 [info ] [MainThread]: 
[0m00:13:17.838670 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:13:17.838942 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.daily_average_weather_trend ..................... [RUN]
[0m00:13:17.839155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now snapshot.weather_dbt.daily_average_weather_trend)
[0m00:13:17.839314 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_trend
[0m00:13:17.843959 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_trend
[0m00:13:17.894261 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_trend"
[0m00:13:17.894604 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_DATE as varchar ), '')
         || '|' || coalesce(cast(WEATHER_DATE as varchar ), '')
        ) as dbt_scd_id,
        WEATHER_DATE as dbt_updated_at,
        WEATHER_DATE as dbt_valid_from,
        
  
  coalesce(nullif(WEATHER_DATE, WEATHER_DATE), null)
  as dbt_valid_to
from (
        



WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:13:17.894818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:18.304531 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a6d-0004-3867-0002-5943000356ce
[0m00:13:18.305209 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:13:18.305806 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: Close
[0m00:13:18.436979 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:13:18.445376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11f9aab4-582d-400a-ab23-59cd57ea95c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a10d10>]}
[0m00:13:18.451745 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshot.daily_average_weather_trend ................. [[31mERROR[0m in 0.60s]
[0m00:13:18.452202 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:13:18.452473 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m00:13:18.452740 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.extreme_weather_events .......................... [RUN]
[0m00:13:18.453011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_trend, now snapshot.weather_dbt.extreme_weather_events)
[0m00:13:18.453209 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m00:13:18.455347 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m00:13:18.458744 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m00:13:18.459029 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:13:18.459225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:18.951949 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a6d-0004-3863-0002-5943000366e2
[0m00:13:18.952745 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m00:13:18.953444 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m00:13:19.089456 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:13:19.089987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11f9aab4-582d-400a-ab23-59cd57ea95c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a62ec50>]}
[0m00:13:19.090593 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshot.extreme_weather_events ...................... [[31mERROR[0m in 0.64s]
[0m00:13:19.091006 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m00:13:19.091269 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:13:19.091645 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.hourly_weather_patterns ......................... [RUN]
[0m00:13:19.091976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m00:13:19.092215 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m00:13:19.094500 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m00:13:19.097859 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m00:13:19.098307 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:13:19.098671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:19.537874 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a6d-0004-386b-0002-59430003b6b2
[0m00:13:19.539256 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m00:13:19.540183 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m00:13:19.672160 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:13:19.672663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11f9aab4-582d-400a-ab23-59cd57ea95c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6e1090>]}
[0m00:13:19.673282 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshot.hourly_weather_patterns ..................... [[31mERROR[0m in 0.58s]
[0m00:13:19.673893 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:13:19.674211 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:13:19.674673 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.weather_conditions_frequency .................... [RUN]
[0m00:13:19.675105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m00:13:19.675331 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m00:13:19.677575 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m00:13:19.681215 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m00:13:19.681717 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:13:19.682064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:20.016237 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a6d-0004-3869-0002-59430003a6be
[0m00:13:20.016718 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:13:20.017068 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m00:13:20.146143 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:13:20.146798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11f9aab4-582d-400a-ab23-59cd57ea95c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084d37d0>]}
[0m00:13:20.147802 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshot.weather_conditions_frequency ................ [[31mERROR[0m in 0.47s]
[0m00:13:20.148400 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:13:20.149915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:13:20.150255 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m00:13:20.150582 [info ] [MainThread]: 
[0m00:13:20.150880 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m00:13:20.151900 [debug] [MainThread]: Command end result
[0m00:13:20.178728 [info ] [MainThread]: 
[0m00:13:20.179059 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:13:20.179242 [info ] [MainThread]: 
[0m00:13:20.179475 [error] [MainThread]:   Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:13:20.179639 [info ] [MainThread]: 
[0m00:13:20.179847 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:13:20.180174 [info ] [MainThread]: 
[0m00:13:20.180429 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:13:20.180606 [info ] [MainThread]: 
[0m00:13:20.180805 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:13:20.180967 [info ] [MainThread]: 
[0m00:13:20.181136 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:13:20.182654 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.1743827, "process_in_blocks": "0", "process_kernel_time": 0.291317, "process_mem_max_rss": "141950976", "process_out_blocks": "0", "process_user_time": 1.579343}
[0m00:13:20.183009 [debug] [MainThread]: Command `dbt snapshot` failed at 00:13:20.182951 after 5.17 seconds
[0m00:13:20.183246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084caba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10481dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f53d10>]}
[0m00:13:20.183461 [debug] [MainThread]: Flushing usage events
[0m00:14:39.564764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107513d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107513b10>]}


============================== 00:14:39.568393 | 719e2d25-ee3b-42b2-b000-a65ab740e552 ==============================
[0m00:14:39.568393 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:14:39.568783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:14:39.810964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '719e2d25-ee3b-42b2-b000-a65ab740e552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11158a520>]}
[0m00:14:39.835993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '719e2d25-ee3b-42b2-b000-a65ab740e552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114fc050>]}
[0m00:14:39.836718 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:14:39.903485 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:14:39.976774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:14:39.977017 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:14:39.997991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '719e2d25-ee3b-42b2-b000-a65ab740e552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111473850>]}
[0m00:14:40.052566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '719e2d25-ee3b-42b2-b000-a65ab740e552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111443e30>]}
[0m00:14:40.052863 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m00:14:40.053037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '719e2d25-ee3b-42b2-b000-a65ab740e552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119949f0>]}
[0m00:14:40.054085 [info ] [MainThread]: 
[0m00:14:40.054389 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:14:40.056502 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m00:14:40.064140 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m00:14:40.064351 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m00:14:40.064487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:40.592791 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.528 seconds
[0m00:14:40.597880 [debug] [ThreadPool]: On list_openweather: Close
[0m00:14:40.717658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m00:14:40.732877 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m00:14:40.733298 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m00:14:40.733547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:41.166125 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.432 seconds
[0m00:14:41.169421 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m00:14:41.287253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m00:14:41.291025 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m00:14:41.291388 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m00:14:41.291758 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:41.786280 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.494 seconds
[0m00:14:41.789752 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m00:14:41.941863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '719e2d25-ee3b-42b2-b000-a65ab740e552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111967860>]}
[0m00:14:41.942844 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:14:41.943143 [info ] [MainThread]: 
[0m00:14:41.948011 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m00:14:41.948631 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m00:14:41.949107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now model.weather_dbt.daily_avg_weather_trend)
[0m00:14:41.949798 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m00:14:41.958991 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m00:14:41.960879 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m00:14:41.984514 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m00:14:41.985779 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m00:14:41.986041 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m00:14:41.986263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:43.598327 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.612 seconds
[0m00:14:43.612248 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m00:14:43.763500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '719e2d25-ee3b-42b2-b000-a65ab740e552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c07950>]}
[0m00:14:43.764388 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.81s]
[0m00:14:43.764948 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m00:14:43.765355 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m00:14:43.765843 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m00:14:43.766302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m00:14:43.766629 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m00:14:43.769534 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m00:14:43.770538 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m00:14:43.773353 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m00:14:43.774898 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m00:14:43.775242 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m00:14:43.775534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:45.160100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.384 seconds
[0m00:14:45.163693 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m00:14:45.291886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '719e2d25-ee3b-42b2-b000-a65ab740e552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e1ff0>]}
[0m00:14:45.293024 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.53s]
[0m00:14:45.293733 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m00:14:45.294221 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m00:14:45.294997 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m00:14:45.295732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m00:14:45.296133 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m00:14:45.299456 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m00:14:45.300780 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m00:14:45.302871 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m00:14:45.304316 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m00:14:45.304663 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    *
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY
        );
[0m00:14:45.305403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:46.583249 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.278 seconds
[0m00:14:46.586841 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m00:14:46.707433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '719e2d25-ee3b-42b2-b000-a65ab740e552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107440230>]}
[0m00:14:46.708373 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.hourly_weather_patterns ............ [[32mSUCCESS 1[0m in 1.41s]
[0m00:14:46.708871 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m00:14:46.709216 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m00:14:46.709539 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m00:14:46.709864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m00:14:46.710127 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m00:14:46.712830 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m00:14:46.713917 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m00:14:46.733325 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m00:14:46.734641 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m00:14:46.734952 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m00:14:46.735230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:47.308615 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.573 seconds
[0m00:14:47.311082 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m00:14:47.419576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '719e2d25-ee3b-42b2-b000-a65ab740e552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111661c50>]}
[0m00:14:47.420632 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.71s]
[0m00:14:47.421444 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m00:14:47.422003 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m00:14:47.422744 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m00:14:47.423450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m00:14:47.423874 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m00:14:47.427946 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m00:14:47.429326 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m00:14:47.431850 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m00:14:47.433442 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m00:14:47.433945 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    *
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME
        );
[0m00:14:47.434291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:48.885267 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.450 seconds
[0m00:14:48.889591 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m00:14:49.013976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '719e2d25-ee3b-42b2-b000-a65ab740e552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bfc8a0>]}
[0m00:14:49.014766 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.59s]
[0m00:14:49.015180 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m00:14:49.016341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:49.016556 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m00:14:49.016787 [info ] [MainThread]: 
[0m00:14:49.016978 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 8.96 seconds (8.96s).
[0m00:14:49.017767 [debug] [MainThread]: Command end result
[0m00:14:49.043445 [info ] [MainThread]: 
[0m00:14:49.043831 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:14:49.044059 [info ] [MainThread]: 
[0m00:14:49.044268 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m00:14:49.046280 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.520364, "process_in_blocks": "0", "process_kernel_time": 0.290166, "process_mem_max_rss": "138887168", "process_out_blocks": "0", "process_user_time": 1.578893}
[0m00:14:49.046692 [debug] [MainThread]: Command `dbt run` succeeded at 00:14:49.046629 after 9.52 seconds
[0m00:14:49.046959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ce7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d3d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10753cd10>]}
[0m00:14:49.047202 [debug] [MainThread]: Flushing usage events
[0m00:18:31.734234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106858d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108187d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108187b10>]}


============================== 00:18:31.737316 | f8ffcf9e-6771-4ecd-8d64-18f10f63c155 ==============================
[0m00:18:31.737316 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:18:31.737648 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:18:31.792563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8ffcf9e-6771-4ecd-8d64-18f10f63c155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fef360>]}
[0m00:18:31.804087 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.10985263, "process_in_blocks": "0", "process_kernel_time": 0.132219, "process_mem_max_rss": "98959360", "process_out_blocks": "0", "process_user_time": 0.63936}
[0m00:18:31.804377 [debug] [MainThread]: Command `dbt clean` succeeded at 00:18:31.804326 after 0.11 seconds
[0m00:18:31.804553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ae580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ae690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f16950>]}
[0m00:18:31.804720 [debug] [MainThread]: Flushing usage events
[0m00:20:08.114539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f98d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105813d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105813b10>]}


============================== 00:20:08.117498 | 2b844597-c779-4e2d-a36a-4f96c4180516 ==============================
[0m00:20:08.117498 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:20:08.117822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:20:08.170672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b844597-c779-4e2d-a36a-4f96c4180516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a7f360>]}
[0m00:20:08.179984 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.10194683, "process_in_blocks": "0", "process_kernel_time": 0.121471, "process_mem_max_rss": "98598912", "process_out_blocks": "0", "process_user_time": 0.618503}
[0m00:20:08.180306 [debug] [MainThread]: Command `dbt clean` succeeded at 00:20:08.180253 after 0.10 seconds
[0m00:20:08.180482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b02580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b02690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056de950>]}
[0m00:20:08.180638 [debug] [MainThread]: Flushing usage events
[0m00:20:15.314139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107617d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107617b10>]}


============================== 00:20:15.317584 | 9f409379-ce54-4985-afda-b406263d96ee ==============================
[0m00:20:15.317584 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:20:15.317990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m00:20:15.557499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f409379-ce54-4985-afda-b406263d96ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104fa520>]}
[0m00:20:15.584261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f409379-ce54-4985-afda-b406263d96ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103fc050>]}
[0m00:20:15.585242 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:20:15.645230 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:20:15.645802 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:20:15.645988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9f409379-ce54-4985-afda-b406263d96ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11036ca50>]}
[0m00:20:16.259982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f409379-ce54-4985-afda-b406263d96ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110885040>]}
[0m00:20:16.311011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f409379-ce54-4985-afda-b406263d96ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e498d0>]}
[0m00:20:16.311276 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m00:20:16.311444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f409379-ce54-4985-afda-b406263d96ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e83790>]}
[0m00:20:16.312366 [info ] [MainThread]: 
[0m00:20:16.312635 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:20:16.314698 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m00:20:16.321211 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m00:20:16.321413 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m00:20:16.321538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:16.884304 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.563 seconds
[0m00:20:16.885742 [debug] [ThreadPool]: On list_openweather: Close
[0m00:20:17.021852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m00:20:17.031245 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m00:20:17.031615 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m00:20:17.031843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:20:17.527468 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.496 seconds
[0m00:20:17.529909 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m00:20:17.667030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m00:20:17.670935 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m00:20:17.671381 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m00:20:17.671677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:20:18.205267 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.533 seconds
[0m00:20:18.207770 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m00:20:18.337818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f409379-ce54-4985-afda-b406263d96ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111177d0>]}
[0m00:20:18.338595 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:20:18.338900 [info ] [MainThread]: 
[0m00:20:18.343089 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:20:18.343659 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.daily_average_weather_trend ..................... [RUN]
[0m00:20:18.344072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now snapshot.weather_dbt.daily_average_weather_trend)
[0m00:20:18.344886 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_trend
[0m00:20:18.354299 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_trend
[0m00:20:18.403297 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_trend"
[0m00:20:18.403637 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_DATE as varchar ), '')
         || '|' || coalesce(cast(WEATHER_DATE as varchar ), '')
        ) as dbt_scd_id,
        WEATHER_DATE as dbt_updated_at,
        WEATHER_DATE as dbt_valid_from,
        
  
  coalesce(nullif(WEATHER_DATE, WEATHER_DATE), null)
  as dbt_valid_to
from (
        



WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:20:18.403850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:18.854621 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a74-0004-3987-0002-59430003d19e
[0m00:20:18.855320 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:20:18.855886 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: Close
[0m00:20:18.973245 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:20:18.974998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f409379-ce54-4985-afda-b406263d96ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d68520>]}
[0m00:20:18.975785 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshot.daily_average_weather_trend ................. [[31mERROR[0m in 0.63s]
[0m00:20:18.976357 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:20:18.976793 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m00:20:18.978020 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.extreme_weather_events .......................... [RUN]
[0m00:20:18.978534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_trend, now snapshot.weather_dbt.extreme_weather_events)
[0m00:20:18.978900 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m00:20:18.982954 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m00:20:18.986979 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m00:20:18.987373 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:20:18.987708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:19.412479 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a74-0004-3865-0002-594300039766
[0m00:20:19.413255 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m00:20:19.413702 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m00:20:19.560424 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:20:19.561000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f409379-ce54-4985-afda-b406263d96ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d5df90>]}
[0m00:20:19.561785 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshot.extreme_weather_events ...................... [[31mERROR[0m in 0.58s]
[0m00:20:19.562450 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m00:20:19.562894 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:20:19.563526 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.hourly_weather_patterns ......................... [RUN]
[0m00:20:19.564095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m00:20:19.564498 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m00:20:19.568341 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m00:20:19.572599 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m00:20:19.573104 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:20:19.573692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:20.028475 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a74-0004-3864-0002-59430003e01e
[0m00:20:20.029321 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m00:20:20.029995 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m00:20:20.150629 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:20:20.151673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f409379-ce54-4985-afda-b406263d96ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c4d050>]}
[0m00:20:20.152665 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshot.hourly_weather_patterns ..................... [[31mERROR[0m in 0.59s]
[0m00:20:20.153283 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:20:20.153660 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:20:20.154173 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.weather_conditions_frequency .................... [RUN]
[0m00:20:20.154635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m00:20:20.154951 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m00:20:20.158687 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m00:20:20.162095 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m00:20:20.162480 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:20:20.162808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:20.604153 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a74-0004-3864-0002-59430003e022
[0m00:20:20.604973 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:20:20.606112 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m00:20:20.746431 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:20:20.747133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f409379-ce54-4985-afda-b406263d96ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c6eeb0>]}
[0m00:20:20.748053 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshot.weather_conditions_frequency ................ [[31mERROR[0m in 0.59s]
[0m00:20:20.748759 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:20:20.750109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:20:20.750385 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m00:20:20.750619 [info ] [MainThread]: 
[0m00:20:20.750835 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 4.44 seconds (4.44s).
[0m00:20:20.751527 [debug] [MainThread]: Command end result
[0m00:20:20.770024 [info ] [MainThread]: 
[0m00:20:20.770351 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:20:20.770517 [info ] [MainThread]: 
[0m00:20:20.770741 [error] [MainThread]:   Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:20:20.770977 [info ] [MainThread]: 
[0m00:20:20.771392 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:20:20.771625 [info ] [MainThread]: 
[0m00:20:20.771823 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:20:20.771973 [info ] [MainThread]: 
[0m00:20:20.772147 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:20:20.772287 [info ] [MainThread]: 
[0m00:20:20.772439 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:20:20.773966 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.4988823, "process_in_blocks": "0", "process_kernel_time": 0.253541, "process_mem_max_rss": "145735680", "process_out_blocks": "0", "process_user_time": 1.944916}
[0m00:20:20.774369 [debug] [MainThread]: Command `dbt snapshot` failed at 00:20:20.774310 after 5.50 seconds
[0m00:20:20.774601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a7f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f17ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f17e90>]}
[0m00:20:20.774790 [debug] [MainThread]: Flushing usage events
[0m00:21:50.914481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033bcd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cbfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cbfb10>]}


============================== 00:21:50.917474 | 4884ad75-3cf8-4fee-830c-dca46cf6db3c ==============================
[0m00:21:50.917474 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:21:50.917786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:21:50.970915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4884ad75-3cf8-4fee-830c-dca46cf6db3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b2b360>]}
[0m00:21:50.980450 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.104379624, "process_in_blocks": "0", "process_kernel_time": 0.12207, "process_mem_max_rss": "99188736", "process_out_blocks": "0", "process_user_time": 0.615749}
[0m00:21:50.980735 [debug] [MainThread]: Command `dbt clean` succeeded at 00:21:50.980684 after 0.10 seconds
[0m00:21:50.980918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dea580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dea690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a52950>]}
[0m00:21:50.981075 [debug] [MainThread]: Flushing usage events
[0m00:21:55.279050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102580d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e87d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e87b10>]}


============================== 00:21:55.281543 | f4d0e76d-fe09-4909-bfb4-8d56fc8fca65 ==============================
[0m00:21:55.281543 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:21:55.281868 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:21:55.501195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4d0e76d-fe09-4909-bfb4-8d56fc8fca65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ade520>]}
[0m00:21:55.524110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4d0e76d-fe09-4909-bfb4-8d56fc8fca65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e0050>]}
[0m00:21:55.525474 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:21:55.588411 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:21:55.589207 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:21:55.589607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f4d0e76d-fe09-4909-bfb4-8d56fc8fca65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104954a50>]}
[0m00:21:56.177325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4d0e76d-fe09-4909-bfb4-8d56fc8fca65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d4d040>]}
[0m00:21:56.225840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4d0e76d-fe09-4909-bfb4-8d56fc8fca65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510dc50>]}
[0m00:21:56.226130 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m00:21:56.226295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4d0e76d-fe09-4909-bfb4-8d56fc8fca65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105147c70>]}
[0m00:21:56.227272 [info ] [MainThread]: 
[0m00:21:56.227552 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:21:56.229779 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m00:21:56.236806 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m00:21:56.237013 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m00:21:56.237139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:56.797582 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.560 seconds
[0m00:21:56.799585 [debug] [ThreadPool]: On list_openweather: Close
[0m00:21:56.949635 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m00:21:56.962051 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m00:21:56.962518 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m00:21:56.962806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:57.475112 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.512 seconds
[0m00:21:57.477759 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m00:21:57.620701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m00:21:57.625037 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m00:21:57.625424 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m00:21:57.625730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:58.026479 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.401 seconds
[0m00:21:58.028170 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m00:21:58.146418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4d0e76d-fe09-4909-bfb4-8d56fc8fca65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051df590>]}
[0m00:21:58.147523 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:21:58.147969 [info ] [MainThread]: 
[0m00:21:58.151595 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m00:21:58.152402 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m00:21:58.152970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now model.weather_dbt.daily_avg_weather_trend)
[0m00:21:58.153715 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m00:21:58.162818 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m00:21:58.164084 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m00:21:58.187167 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m00:21:58.188448 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m00:21:58.188708 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m00:21:58.188928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:59.566028 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.377 seconds
[0m00:21:59.582243 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m00:21:59.703511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d0e76d-fe09-4909-bfb4-8d56fc8fca65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e55f40>]}
[0m00:21:59.704553 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.55s]
[0m00:21:59.705309 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m00:21:59.705780 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m00:21:59.706397 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m00:21:59.706932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m00:21:59.707269 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m00:21:59.710125 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m00:21:59.711037 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m00:21:59.714398 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m00:21:59.716312 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m00:21:59.716776 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m00:21:59.717189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:00.767792 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.050 seconds
[0m00:22:00.771923 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m00:22:00.893973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d0e76d-fe09-4909-bfb4-8d56fc8fca65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105334c30>]}
[0m00:22:00.894894 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.19s]
[0m00:22:00.895438 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m00:22:00.895818 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m00:22:00.896315 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m00:22:00.896775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m00:22:00.897089 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m00:22:00.900216 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m00:22:00.901235 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m00:22:00.910222 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m00:22:00.911892 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m00:22:00.912255 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    *
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY
        );
[0m00:22:00.912573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:02.182888 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.270 seconds
[0m00:22:02.188889 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m00:22:02.332855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d0e76d-fe09-4909-bfb4-8d56fc8fca65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102902750>]}
[0m00:22:02.333986 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.hourly_weather_patterns ............ [[32mSUCCESS 1[0m in 1.44s]
[0m00:22:02.334825 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m00:22:02.335399 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m00:22:02.336138 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m00:22:02.336855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m00:22:02.337281 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m00:22:02.341379 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m00:22:02.342846 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m00:22:02.364908 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m00:22:02.366651 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m00:22:02.366932 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m00:22:02.367179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:02.954511 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.587 seconds
[0m00:22:02.959286 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m00:22:03.087060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d0e76d-fe09-4909-bfb4-8d56fc8fca65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024bc8a0>]}
[0m00:22:03.088093 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.75s]
[0m00:22:03.088726 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m00:22:03.089196 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m00:22:03.089621 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m00:22:03.090177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m00:22:03.090598 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m00:22:03.094342 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m00:22:03.095617 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m00:22:03.099135 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m00:22:03.100673 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m00:22:03.101130 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    *
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME
        );
[0m00:22:03.101508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:04.259375 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.157 seconds
[0m00:22:04.262795 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m00:22:04.398671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d0e76d-fe09-4909-bfb4-8d56fc8fca65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10155ec90>]}
[0m00:22:04.399914 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.31s]
[0m00:22:04.400713 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m00:22:04.402332 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:22:04.402709 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m00:22:04.403097 [info ] [MainThread]: 
[0m00:22:04.403409 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 8.18 seconds (8.18s).
[0m00:22:04.404527 [debug] [MainThread]: Command end result
[0m00:22:04.430837 [info ] [MainThread]: 
[0m00:22:04.431184 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:22:04.431385 [info ] [MainThread]: 
[0m00:22:04.431602 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m00:22:04.433144 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.193825, "process_in_blocks": "0", "process_kernel_time": 0.253893, "process_mem_max_rss": "145817600", "process_out_blocks": "0", "process_user_time": 2.028863}
[0m00:22:04.433533 [debug] [MainThread]: Command `dbt run` succeeded at 00:22:04.433468 after 9.19 seconds
[0m00:22:04.433782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028a18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105367170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105364cb0>]}
[0m00:22:04.434007 [debug] [MainThread]: Flushing usage events
[0m00:22:54.149609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105120d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a23d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a23b10>]}


============================== 00:22:54.152618 | f9633ac9-278d-46ec-bab9-c96b469b2bd9 ==============================
[0m00:22:54.152618 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:22:54.152950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:22:54.382849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9633ac9-278d-46ec-bab9-c96b469b2bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10767e520>]}
[0m00:22:54.406480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9633ac9-278d-46ec-bab9-c96b469b2bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107580050>]}
[0m00:22:54.407154 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:22:54.468981 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:22:54.537259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:22:54.537483 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:22:54.556748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9633ac9-278d-46ec-bab9-c96b469b2bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f3850>]}
[0m00:22:54.607580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9633ac9-278d-46ec-bab9-c96b469b2bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c5310>]}
[0m00:22:54.607847 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m00:22:54.608013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9633ac9-278d-46ec-bab9-c96b469b2bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a88c90>]}
[0m00:22:54.609046 [info ] [MainThread]: 
[0m00:22:54.609332 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:22:54.611371 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m00:22:54.618804 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m00:22:54.619027 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m00:22:54.619168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:55.136400 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.517 seconds
[0m00:22:55.139840 [debug] [ThreadPool]: On list_openweather: Close
[0m00:22:55.268788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m00:22:55.282799 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m00:22:55.283179 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m00:22:55.283404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:22:55.852807 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.569 seconds
[0m00:22:55.856279 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m00:22:55.974018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m00:22:55.978280 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m00:22:55.978658 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m00:22:55.978959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:22:56.496821 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.517 seconds
[0m00:22:56.501634 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m00:22:56.615800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9633ac9-278d-46ec-bab9-c96b469b2bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a57ad0>]}
[0m00:22:56.616539 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:22:56.616836 [info ] [MainThread]: 
[0m00:22:56.620891 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:22:56.621427 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.daily_average_weather_trend ..................... [RUN]
[0m00:22:56.621834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now snapshot.weather_dbt.daily_average_weather_trend)
[0m00:22:56.622439 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_trend
[0m00:22:56.630334 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_trend
[0m00:22:56.684314 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_trend"
[0m00:22:56.684676 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_DATE as varchar ), '')
         || '|' || coalesce(cast(WEATHER_DATE as varchar ), '')
        ) as dbt_scd_id,
        WEATHER_DATE as dbt_updated_at,
        WEATHER_DATE as dbt_valid_from,
        
  
  coalesce(nullif(WEATHER_DATE, WEATHER_DATE), null)
  as dbt_valid_to
from (
        



WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:22:56.684885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:57.112075 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a76-0004-386a-0002-59430003473e
[0m00:22:57.112736 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:22:57.113296 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: Close
[0m00:22:57.252677 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:22:57.253920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9633ac9-278d-46ec-bab9-c96b469b2bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd8c50>]}
[0m00:22:57.254540 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshot.daily_average_weather_trend ................. [[31mERROR[0m in 0.63s]
[0m00:22:57.255016 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:22:57.255305 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m00:22:57.256542 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.extreme_weather_events .......................... [RUN]
[0m00:22:57.257434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_trend, now snapshot.weather_dbt.extreme_weather_events)
[0m00:22:57.257711 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m00:22:57.260154 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m00:22:57.264319 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m00:22:57.264708 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:22:57.265087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:57.710999 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a76-0004-3987-0002-59430003d1fa
[0m00:22:57.711765 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m00:22:57.712279 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m00:22:57.863980 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:22:57.864741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9633ac9-278d-46ec-bab9-c96b469b2bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d61860>]}
[0m00:22:57.865762 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshot.extreme_weather_events ...................... [[31mERROR[0m in 0.61s]
[0m00:22:57.866382 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m00:22:57.866803 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:22:57.867384 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.hourly_weather_patterns ......................... [RUN]
[0m00:22:57.867879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m00:22:57.868226 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m00:22:57.871979 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m00:22:57.877183 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m00:22:57.877891 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:22:57.878285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:58.425298 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a76-0004-3987-0002-59430003d1fe
[0m00:22:58.426558 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m00:22:58.427321 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m00:22:58.578993 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:22:58.579699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9633ac9-278d-46ec-bab9-c96b469b2bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795c690>]}
[0m00:22:58.580635 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshot.hourly_weather_patterns ..................... [[31mERROR[0m in 0.71s]
[0m00:22:58.581243 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:22:58.581622 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:22:58.582140 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.weather_conditions_frequency .................... [RUN]
[0m00:22:58.582651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m00:22:58.582968 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m00:22:58.586424 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m00:22:58.590947 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m00:22:58.591339 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:22:58.591629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:59.081110 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a76-0004-386c-0002-59430003778e
[0m00:22:59.082669 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:22:59.083324 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m00:22:59.212758 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:22:59.213276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9633ac9-278d-46ec-bab9-c96b469b2bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078839d0>]}
[0m00:22:59.213964 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshot.weather_conditions_frequency ................ [[31mERROR[0m in 0.63s]
[0m00:22:59.214454 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:22:59.215543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:22:59.215851 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m00:22:59.216123 [info ] [MainThread]: 
[0m00:22:59.216384 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 4.61 seconds (4.61s).
[0m00:22:59.217223 [debug] [MainThread]: Command end result
[0m00:22:59.240728 [info ] [MainThread]: 
[0m00:22:59.241079 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:22:59.241272 [info ] [MainThread]: 
[0m00:22:59.241523 [error] [MainThread]:   Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:22:59.241697 [info ] [MainThread]: 
[0m00:22:59.241911 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:22:59.242073 [info ] [MainThread]: 
[0m00:22:59.242284 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:22:59.242443 [info ] [MainThread]: 
[0m00:22:59.242641 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:22:59.242808 [info ] [MainThread]: 
[0m00:22:59.242989 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:22:59.244765 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.1322002, "process_in_blocks": "0", "process_kernel_time": 0.269164, "process_mem_max_rss": "141377536", "process_out_blocks": "0", "process_user_time": 1.523748}
[0m00:22:59.245128 [debug] [MainThread]: Command `dbt snapshot` failed at 00:22:59.245071 after 5.13 seconds
[0m00:22:59.245366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a36ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d8dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10582d4f0>]}
[0m00:22:59.245580 [debug] [MainThread]: Flushing usage events
[0m00:23:44.634262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d98d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112617d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112617b10>]}


============================== 00:23:44.637466 | 16b0a7c6-6c7d-4771-a6b8-afd9231332b9 ==============================
[0m00:23:44.637466 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:23:44.637790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:23:44.894861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16b0a7c6-6c7d-4771-a6b8-afd9231332b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11468a520>]}
[0m00:23:44.921433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16b0a7c6-6c7d-4771-a6b8-afd9231332b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11467c050>]}
[0m00:23:44.922215 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:23:44.985159 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:23:45.061182 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:23:45.061631 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:23:45.066710 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected string, got "day', w.DATE_TIME)
  )
  SELECT
      CITY_ID,
      CITY_NAME,
      WEATHER_DATE,
      AVG_TEMP_FAHRENHEIT,
      AVG_HUMIDITY,
      unique_key_column
  FROM
      Daily_Average_Weather_Trend
  ORDER BY
      WEATHER_DATE, CITY_NAME
  
  {% endsnapshot %}"
[0m00:23:45.068511 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.47720367, "process_in_blocks": "0", "process_kernel_time": 0.227614, "process_mem_max_rss": "122814464", "process_out_blocks": "0", "process_user_time": 0.863333}
[0m00:23:45.068878 [debug] [MainThread]: Command `dbt snapshot` failed at 00:23:45.068815 after 0.48 seconds
[0m00:23:45.069096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114924450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114924750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11490c320>]}
[0m00:23:45.069286 [debug] [MainThread]: Flushing usage events
[0m00:24:39.060741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ecd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108117d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108117b10>]}


============================== 00:24:39.064668 | de41bdff-038e-42ff-af04-ddb8085c405d ==============================
[0m00:24:39.064668 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:24:39.065011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:24:39.291235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de41bdff-038e-42ff-af04-ddb8085c405d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d72520>]}
[0m00:24:39.315078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de41bdff-038e-42ff-af04-ddb8085c405d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c74050>]}
[0m00:24:39.315879 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:24:39.377725 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:24:39.447995 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:24:39.448374 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:24:39.489078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de41bdff-038e-42ff-af04-ddb8085c405d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109024750>]}
[0m00:24:39.537898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de41bdff-038e-42ff-af04-ddb8085c405d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb9310>]}
[0m00:24:39.538159 [info ] [MainThread]: Found 5 models, 3 snapshots, 2 sources, 459 macros
[0m00:24:39.538332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de41bdff-038e-42ff-af04-ddb8085c405d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091c11d0>]}
[0m00:24:39.539261 [info ] [MainThread]: 
[0m00:24:39.539545 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:24:39.541527 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m00:24:39.547977 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m00:24:39.548188 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m00:24:39.548322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:40.225388 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.677 seconds
[0m00:24:40.232274 [debug] [ThreadPool]: On list_openweather: Close
[0m00:24:40.388861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m00:24:40.400427 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m00:24:40.400879 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m00:24:40.401123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:24:40.923851 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.522 seconds
[0m00:24:40.928039 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m00:24:41.061209 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m00:24:41.064824 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m00:24:41.065223 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m00:24:41.065532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:24:41.552770 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.487 seconds
[0m00:24:41.554573 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m00:24:41.679902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de41bdff-038e-42ff-af04-ddb8085c405d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e7040>]}
[0m00:24:41.680447 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:24:41.680717 [info ] [MainThread]: 
[0m00:24:41.684069 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m00:24:41.684479 [info ] [Thread-1 (]: 1 of 3 START snapshot snapshot.extreme_weather_events .......................... [RUN]
[0m00:24:41.684785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now snapshot.weather_dbt.extreme_weather_events)
[0m00:24:41.685032 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m00:24:41.691423 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m00:24:41.736639 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m00:24:41.736959 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:24:41.737164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:42.196446 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a78-0004-3869-0002-59430003a72a
[0m00:24:42.197173 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m00:24:42.197738 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m00:24:42.542834 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:24:42.544746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de41bdff-038e-42ff-af04-ddb8085c405d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10939dc10>]}
[0m00:24:42.545531 [error] [Thread-1 (]: 1 of 3 ERROR snapshotting snapshot.extreme_weather_events ...................... [[31mERROR[0m in 0.86s]
[0m00:24:42.546061 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m00:24:42.546419 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:24:42.547449 [info ] [Thread-1 (]: 2 of 3 START snapshot snapshot.hourly_weather_patterns ......................... [RUN]
[0m00:24:42.547870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m00:24:42.548158 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m00:24:42.551251 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m00:24:42.555419 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m00:24:42.555850 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:24:42.556140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:43.001503 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a78-0004-3869-0002-59430003a72e
[0m00:24:43.002117 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m00:24:43.002590 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m00:24:43.134875 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:24:43.135674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de41bdff-038e-42ff-af04-ddb8085c405d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10945e0a0>]}
[0m00:24:43.136646 [error] [Thread-1 (]: 2 of 3 ERROR snapshotting snapshot.hourly_weather_patterns ..................... [[31mERROR[0m in 0.59s]
[0m00:24:43.137265 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:24:43.137674 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:24:43.138292 [info ] [Thread-1 (]: 3 of 3 START snapshot snapshot.weather_conditions_frequency .................... [RUN]
[0m00:24:43.138822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m00:24:43.139179 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m00:24:43.143094 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m00:24:43.146875 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m00:24:43.147264 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:24:43.147586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:43.665776 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a78-0004-3868-0002-59430003875a
[0m00:24:43.667023 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:24:43.667771 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m00:24:43.792535 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:24:43.793280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de41bdff-038e-42ff-af04-ddb8085c405d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c6c410>]}
[0m00:24:43.794238 [error] [Thread-1 (]: 3 of 3 ERROR snapshotting snapshot.weather_conditions_frequency ................ [[31mERROR[0m in 0.65s]
[0m00:24:43.794852 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:24:43.796384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:24:43.796732 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m00:24:43.797068 [info ] [MainThread]: 
[0m00:24:43.797373 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m00:24:43.798182 [debug] [MainThread]: Command end result
[0m00:24:43.822593 [info ] [MainThread]: 
[0m00:24:43.822948 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m00:24:43.823124 [info ] [MainThread]: 
[0m00:24:43.823356 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:24:43.823532 [info ] [MainThread]: 
[0m00:24:43.823747 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:24:43.823915 [info ] [MainThread]: 
[0m00:24:43.824102 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:24:43.824260 [info ] [MainThread]: 
[0m00:24:43.824417 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m00:24:43.825846 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 4.801056, "process_in_blocks": "0", "process_kernel_time": 0.256181, "process_mem_max_rss": "139182080", "process_out_blocks": "0", "process_user_time": 1.43653}
[0m00:24:43.826179 [debug] [MainThread]: Command `dbt snapshot` failed at 00:24:43.826123 after 4.80 seconds
[0m00:24:43.826402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a744d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c3e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812aba0>]}
[0m00:24:43.826601 [debug] [MainThread]: Flushing usage events
[0m00:25:12.504794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c88d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104813d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104813b10>]}


============================== 00:25:12.507891 | 07e61b3b-16e7-4a68-a770-74b5fa7140f3 ==============================
[0m00:25:12.507891 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:25:12.508210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:25:12.738676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07e61b3b-16e7-4a68-a770-74b5fa7140f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1a520>]}
[0m00:25:12.763481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07e61b3b-16e7-4a68-a770-74b5fa7140f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cfc050>]}
[0m00:25:12.764230 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:25:12.826444 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:25:12.898339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:25:12.898717 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:25:12.904961 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected string, got "day', w.DATE_TIME)
  )
  SELECT
      CITY_ID,
      CITY_NAME,
      WEATHER_DATE,
      AVG_TEMP_FAHRENHEIT,
      AVG_HUMIDITY,
      unique_key_column
  FROM
      Daily_Average_Weather_Trend
  ORDER BY
      WEATHER_DATE, CITY_NAME
  
  {% endsnapshot %}"
[0m00:25:12.906859 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.44016853, "process_in_blocks": "0", "process_kernel_time": 0.21745, "process_mem_max_rss": "124518400", "process_out_blocks": "0", "process_user_time": 0.848359}
[0m00:25:12.907256 [debug] [MainThread]: Command `dbt snapshot` failed at 00:25:12.907192 after 0.44 seconds
[0m00:25:12.907480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106274150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106274450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cc320>]}
[0m00:25:12.907659 [debug] [MainThread]: Flushing usage events
[0m00:25:41.380597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ce8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ebb10>]}


============================== 00:25:41.383830 | f3ad6d98-95fd-46c3-8332-382511cb94df ==============================
[0m00:25:41.383830 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:25:41.384178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:25:41.621119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3ad6d98-95fd-46c3-8332-382511cb94df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105246520>]}
[0m00:25:41.646449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3ad6d98-95fd-46c3-8332-382511cb94df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105148050>]}
[0m00:25:41.647216 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:25:41.705995 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:25:41.772988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:25:41.773325 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:25:41.777922 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected string, got "day', w.DATE_TIME)
  )
  SELECT
      CITY_ID,
      CITY_NAME,
      WEATHER_DATE,
      AVG_TEMP_FAHRENHEIT,
      AVG_HUMIDITY,
      unique_key_column
  FROM
      Daily_Average_Weather_Trend
  ORDER BY
      WEATHER_DATE, CITY_NAME
  
  {% endsnapshot %}"
[0m00:25:41.779473 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.43931308, "process_in_blocks": "0", "process_kernel_time": 0.212389, "process_mem_max_rss": "122503168", "process_out_blocks": "0", "process_user_time": 0.844457}
[0m00:25:41.779765 [debug] [MainThread]: Command `dbt snapshot` failed at 00:25:41.779712 after 0.44 seconds
[0m00:25:41.779955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10548c150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10548c450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054dc320>]}
[0m00:25:41.780116 [debug] [MainThread]: Flushing usage events
[0m00:26:36.959103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104734d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106037d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106037b10>]}


============================== 00:26:36.962503 | f5d32579-fb83-43b4-bd91-1bc83b1c45e2 ==============================
[0m00:26:36.962503 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:26:36.962838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:26:37.202768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5d32579-fb83-43b4-bd91-1bc83b1c45e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c92520>]}
[0m00:26:37.227808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5d32579-fb83-43b4-bd91-1bc83b1c45e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b94050>]}
[0m00:26:37.228552 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:26:37.289578 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:26:37.365843 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:26:37.366263 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/daily_avg_weather_trend.sql
[0m00:26:37.366452 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:26:37.451072 [error] [MainThread]: Encountered an error:
Compilation Error in model daily_avg_weather_trend (models/output/daily_avg_weather_trend.sql)
  Encountered unknown tag 'snapshot'.
    line 1
      {% snapshot daily_average_weather_trend %}
[0m00:26:37.452806 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.536031, "process_in_blocks": "0", "process_kernel_time": 0.224081, "process_mem_max_rss": "127320064", "process_out_blocks": "0", "process_user_time": 0.953524}
[0m00:26:37.453122 [debug] [MainThread]: Command `dbt snapshot` failed at 00:26:37.453069 after 0.54 seconds
[0m00:26:37.453353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b07750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b07650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f4a8a0>]}
[0m00:26:37.453533 [debug] [MainThread]: Flushing usage events
[0m00:27:06.040658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ac7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ac7b10>]}


============================== 00:27:06.043780 | 4ce36162-0262-415a-a0d5-882c088f577c ==============================
[0m00:27:06.043780 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:27:06.044111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:27:06.276368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ce36162-0262-415a-a0d5-882c088f577c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109722520>]}
[0m00:27:06.301756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ce36162-0262-415a-a0d5-882c088f577c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109624050>]}
[0m00:27:06.302956 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:27:06.364681 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:27:06.438886 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:27:06.439389 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:27:06.439595 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/daily_avg_weather_trend.sql
[0m00:27:06.517302 [error] [MainThread]: Encountered an error:
Compilation Error in model daily_avg_weather_trend (models/output/daily_avg_weather_trend.sql)
  Encountered unknown tag 'snapshot'.
    line 1
      {% snapshot daily_avg_weather_trend %}
[0m00:27:06.519108 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.5156612, "process_in_blocks": "0", "process_kernel_time": 0.216893, "process_mem_max_rss": "126894080", "process_out_blocks": "0", "process_user_time": 0.942417}
[0m00:27:06.519480 [debug] [MainThread]: Command `dbt snapshot` failed at 00:27:06.519421 after 0.52 seconds
[0m00:27:06.519704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109597750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109597650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099d68a0>]}
[0m00:27:06.519874 [debug] [MainThread]: Flushing usage events
[0m00:27:30.609520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031e4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ae7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ae7b10>]}


============================== 00:27:30.612689 | 08cf5b2e-695e-4a7e-ac27-3694b882efb8 ==============================
[0m00:27:30.612689 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:27:30.613038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:27:30.846553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08cf5b2e-695e-4a7e-ac27-3694b882efb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105742520>]}
[0m00:27:30.871993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08cf5b2e-695e-4a7e-ac27-3694b882efb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105644050>]}
[0m00:27:30.873456 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:27:30.933849 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:27:31.009480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:27:31.009867 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/daily_avg_weather_trend.sql
[0m00:27:31.010049 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:27:31.086783 [error] [MainThread]: Encountered an error:
Compilation Error in model daily_avg_weather_trend (models/output/daily_avg_weather_trend.sql)
  Encountered unknown tag 'snapshot'.
    line 1
      {% snapshot snapshot_daily_avg_weather_trend %}
[0m00:27:31.088257 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.51787555, "process_in_blocks": "0", "process_kernel_time": 0.222347, "process_mem_max_rss": "127909888", "process_out_blocks": "0", "process_user_time": 0.946858}
[0m00:27:31.088692 [debug] [MainThread]: Command `dbt snapshot` failed at 00:27:31.088583 after 0.52 seconds
[0m00:27:31.088959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b7750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059f68a0>]}
[0m00:27:31.089146 [debug] [MainThread]: Flushing usage events
[0m00:28:21.837729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d7b10>]}


============================== 00:28:21.840870 | c05ca363-93bf-4035-81fa-e0ae08848c67 ==============================
[0m00:28:21.840870 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:28:21.841188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:28:22.076770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c05ca363-93bf-4035-81fa-e0ae08848c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064fa520>]}
[0m00:28:22.101799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c05ca363-93bf-4035-81fa-e0ae08848c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063fc050>]}
[0m00:28:22.102516 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:28:22.165785 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:28:22.239725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:28:22.240199 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:28:22.301917 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_daily_avg_weather_trend (snapshots/daily_avg_weather_trend.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m00:28:22.303483 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.5060365, "process_in_blocks": "0", "process_kernel_time": 0.213257, "process_mem_max_rss": "125566976", "process_out_blocks": "0", "process_user_time": 0.919776}
[0m00:28:22.303853 [debug] [MainThread]: Command `dbt snapshot` failed at 00:28:22.303792 after 0.51 seconds
[0m00:28:22.304078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10636f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10636f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b0320>]}
[0m00:28:22.304262 [debug] [MainThread]: Flushing usage events
[0m00:29:15.618321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106298d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c17d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c17b10>]}


============================== 00:29:15.621244 | 96330a38-6f80-4c8f-b6d0-24ac91fe1eaf ==============================
[0m00:29:15.621244 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:29:15.621556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:29:15.845200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96330a38-6f80-4c8f-b6d0-24ac91fe1eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a38a520>]}
[0m00:29:15.868496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96330a38-6f80-4c8f-b6d0-24ac91fe1eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2fc050>]}
[0m00:29:15.869157 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:29:15.930969 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:29:16.001601 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:29:16.002061 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:29:16.077372 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: Snapshots must be configured with a 'strategy', 'unique_key', and 'target_schema'.
[0m00:29:16.079058 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.49682474, "process_in_blocks": "0", "process_kernel_time": 0.199622, "process_mem_max_rss": "128598016", "process_out_blocks": "0", "process_user_time": 0.889588}
[0m00:29:16.079399 [debug] [MainThread]: Command `dbt snapshot` failed at 00:29:16.079340 after 0.50 seconds
[0m00:29:16.079632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a26f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a26f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a620320>]}
[0m00:29:16.079811 [debug] [MainThread]: Flushing usage events
[0m08:55:23.367954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e68d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10676fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10676fb10>]}


============================== 08:55:23.371018 | 6b550a69-f113-4374-a6de-d201cccb8957 ==============================
[0m08:55:23.371018 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:55:23.371342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m08:55:23.577507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b550a69-f113-4374-a6de-d201cccb8957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dfa520>]}
[0m08:55:23.601415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b550a69-f113-4374-a6de-d201cccb8957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cfc050>]}
[0m08:55:23.602881 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:55:23.681928 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:55:23.747277 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:55:23.747611 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m08:55:23.818665 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: Snapshots must be configured with a 'strategy', 'unique_key', and 'target_schema'.
[0m08:55:23.820112 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.48643988, "process_in_blocks": "0", "process_kernel_time": 0.185205, "process_mem_max_rss": "126173184", "process_out_blocks": "0", "process_user_time": 0.874637}
[0m08:55:23.820410 [debug] [MainThread]: Command `dbt snapshot` failed at 08:55:23.820362 after 0.49 seconds
[0m08:55:23.820611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084d0320>]}
[0m08:55:23.820771 [debug] [MainThread]: Flushing usage events
[0m08:56:03.308756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d78d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667bb10>]}


============================== 08:56:03.311147 | f847912b-cb4e-4eb3-b1ff-ec963794417d ==============================
[0m08:56:03.311147 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:56:03.311549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:56:03.475073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f847912b-cb4e-4eb3-b1ff-ec963794417d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fa520>]}
[0m08:56:03.498041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f847912b-cb4e-4eb3-b1ff-ec963794417d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073fc050>]}
[0m08:56:03.498469 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:56:03.554038 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:56:03.618046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:56:03.618392 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m08:56:03.697714 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: Snapshots must be configured with a 'strategy', 'unique_key', and 'target_schema'.
[0m08:56:03.698788 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.42254022, "process_in_blocks": "0", "process_kernel_time": 0.158646, "process_mem_max_rss": "125124608", "process_out_blocks": "0", "process_user_time": 0.877503}
[0m08:56:03.699085 [debug] [MainThread]: Command `dbt snapshot` failed at 08:56:03.699036 after 0.42 seconds
[0m08:56:03.699283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10736f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10736f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079b0320>]}
[0m08:56:03.699445 [debug] [MainThread]: Flushing usage events
[0m08:57:18.549610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f74d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10889fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10889fb10>]}


============================== 08:57:18.552237 | 62eb1933-2d4a-4563-bcd6-51db5871d7b2 ==============================
[0m08:57:18.552237 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:57:18.552578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:57:18.718086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62eb1933-2d4a-4563-bcd6-51db5871d7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096fa520>]}
[0m08:57:18.740959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62eb1933-2d4a-4563-bcd6-51db5871d7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096ec050>]}
[0m08:57:18.741366 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:57:18.797184 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:57:18.855365 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:57:18.855680 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m08:57:18.930756 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: Snapshots must be configured with a 'strategy', 'unique_key', and 'target_schema'.
[0m08:57:18.931749 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.4152856, "process_in_blocks": "0", "process_kernel_time": 0.157385, "process_mem_max_rss": "123518976", "process_out_blocks": "0", "process_user_time": 0.870538}
[0m08:57:18.932040 [debug] [MainThread]: Command `dbt snapshot` failed at 08:57:18.931988 after 0.42 seconds
[0m08:57:18.932251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10956f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10956f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099b0320>]}
[0m08:57:18.932421 [debug] [MainThread]: Flushing usage events
[0m08:57:36.596952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b7b10>]}


============================== 08:57:36.599221 | d06ce2a6-54ff-4e6a-973d-2be0c1f36c3b ==============================
[0m08:57:36.599221 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:57:36.599537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:57:36.756911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd06ce2a6-54ff-4e6a-973d-2be0c1f36c3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10941a520>]}
[0m08:57:36.779522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd06ce2a6-54ff-4e6a-973d-2be0c1f36c3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10940c050>]}
[0m08:57:36.779944 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:57:36.835587 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:57:36.893383 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:57:36.893728 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m08:57:36.964670 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: Snapshots must be configured with a 'strategy', 'unique_key', and 'target_schema'.
[0m08:57:36.965650 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.40101224, "process_in_blocks": "0", "process_kernel_time": 0.131998, "process_mem_max_rss": "124239872", "process_out_blocks": "0", "process_user_time": 0.863378}
[0m08:57:36.965955 [debug] [MainThread]: Command `dbt snapshot` failed at 08:57:36.965902 after 0.40 seconds
[0m08:57:36.966164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10936f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10936f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096cc320>]}
[0m08:57:36.966333 [debug] [MainThread]: Flushing usage events
[0m08:58:18.839960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fcd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108003d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108003b10>]}


============================== 08:58:18.842299 | cbb10c22-7268-4975-87ae-2c7ea8d8e684 ==============================
[0m08:58:18.842299 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:58:18.842610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:58:18.892622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbb10c22-7268-4975-87ae-2c7ea8d8e684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e6b360>]}
[0m08:58:18.904342 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.09748008, "process_in_blocks": "0", "process_kernel_time": 0.093698, "process_mem_max_rss": "100237312", "process_out_blocks": "0", "process_user_time": 0.60384}
[0m08:58:18.904692 [debug] [MainThread]: Command `dbt clean` succeeded at 08:58:18.904628 after 0.10 seconds
[0m08:58:18.904875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812a580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d92950>]}
[0m08:58:18.905037 [debug] [MainThread]: Flushing usage events
[0m08:58:23.169726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033ecd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c17d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c17b10>]}


============================== 08:58:23.171978 | 52ea9380-ece3-4008-9224-01a919ebf151 ==============================
[0m08:58:23.171978 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:58:23.172282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:58:23.340197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52ea9380-ece3-4008-9224-01a919ebf151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b8a520>]}
[0m08:58:23.363518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52ea9380-ece3-4008-9224-01a919ebf151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106afc050>]}
[0m08:58:23.363928 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:58:23.420209 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:58:23.420722 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:58:23.420920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '52ea9380-ece3-4008-9224-01a919ebf151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a70a50>]}
[0m08:58:23.905718 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: Snapshots must be configured with a 'strategy', 'unique_key', and 'target_schema'.
[0m08:58:23.906854 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7691011, "process_in_blocks": "0", "process_kernel_time": 0.161672, "process_mem_max_rss": "125599744", "process_out_blocks": "0", "process_user_time": 1.21241}
[0m08:58:23.907126 [debug] [MainThread]: Command `dbt run` failed at 08:58:23.907080 after 0.77 seconds
[0m08:58:23.907300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107022a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107089b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c1fe70>]}
[0m08:58:23.907462 [debug] [MainThread]: Flushing usage events
[0m08:59:15.516370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085dfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085dfb10>]}


============================== 08:59:15.518631 | d566c550-5bc4-47d2-8109-f9b59765cf15 ==============================
[0m08:59:15.518631 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:59:15.518941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:59:15.685149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd566c550-5bc4-47d2-8109-f9b59765cf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109236520>]}
[0m08:59:15.707876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd566c550-5bc4-47d2-8109-f9b59765cf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109138050>]}
[0m08:59:15.708271 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:59:15.763931 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:59:15.764427 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:59:15.764614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd566c550-5bc4-47d2-8109-f9b59765cf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090aca50>]}
[0m08:59:16.258094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd566c550-5bc4-47d2-8109-f9b59765cf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107305220>]}
[0m08:59:16.297413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd566c550-5bc4-47d2-8109-f9b59765cf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10943d9b0>]}
[0m08:59:16.297666 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m08:59:16.297825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd566c550-5bc4-47d2-8109-f9b59765cf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094c3380>]}
[0m08:59:16.299048 [info ] [MainThread]: 
[0m08:59:16.299313 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:59:16.301402 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m08:59:16.308398 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m08:59:16.308663 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m08:59:16.308809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:59:17.066613 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.758 seconds
[0m08:59:17.069680 [debug] [ThreadPool]: On list_openweather: Close
[0m08:59:17.254097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m08:59:17.262625 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m08:59:17.262873 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m08:59:17.263058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:17.923350 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.660 seconds
[0m08:59:17.926923 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m08:59:18.109606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd566c550-5bc4-47d2-8109-f9b59765cf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109806750>]}
[0m08:59:18.110531 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:59:18.110997 [info ] [MainThread]: 
[0m08:59:18.115542 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m08:59:18.116247 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m08:59:18.116781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m08:59:18.117450 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m08:59:18.125332 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m08:59:18.126971 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m08:59:18.149972 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m08:59:18.151321 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m08:59:18.151582 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m08:59:18.151804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:21.873930 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.721 seconds
[0m08:59:21.903110 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m08:59:22.059362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd566c550-5bc4-47d2-8109-f9b59765cf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085adf40>]}
[0m08:59:22.060460 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 3.94s]
[0m08:59:22.061217 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m08:59:22.061739 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m08:59:22.062406 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m08:59:22.063008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m08:59:22.063430 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m08:59:22.068228 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m08:59:22.069539 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m08:59:22.072019 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m08:59:22.074013 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m08:59:22.074413 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m08:59:22.074890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:23.514845 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.439 seconds
[0m08:59:23.523702 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m08:59:23.639835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd566c550-5bc4-47d2-8109-f9b59765cf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10992bb10>]}
[0m08:59:23.640367 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.58s]
[0m08:59:23.640744 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m08:59:23.640992 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m08:59:23.641324 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m08:59:23.641631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m08:59:23.641856 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m08:59:23.643767 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m08:59:23.644295 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m08:59:23.645633 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m08:59:23.646486 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m08:59:23.646734 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    *
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY
        );
[0m08:59:23.647099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:25.140665 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.493 seconds
[0m08:59:25.143011 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m08:59:25.295517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd566c550-5bc4-47d2-8109-f9b59765cf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109101fd0>]}
[0m08:59:25.297649 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.hourly_weather_patterns ............ [[32mSUCCESS 1[0m in 1.65s]
[0m08:59:25.298141 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m08:59:25.298418 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m08:59:25.298784 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m08:59:25.299100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m08:59:25.299300 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m08:59:25.301570 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m08:59:25.302161 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m08:59:25.314249 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m08:59:25.315107 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m08:59:25.315308 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m08:59:25.315473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:26.196151 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.880 seconds
[0m08:59:26.200247 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m08:59:26.346389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd566c550-5bc4-47d2-8109-f9b59765cf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c14910>]}
[0m08:59:26.347374 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 1.05s]
[0m08:59:26.347992 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m08:59:26.348471 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m08:59:26.348987 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m08:59:26.349494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m08:59:26.349849 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m08:59:26.353007 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m08:59:26.353955 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m08:59:26.356228 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m08:59:26.357393 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m08:59:26.357713 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    *
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME
        );
[0m08:59:26.358004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:27.504951 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.146 seconds
[0m08:59:27.509515 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m08:59:27.634210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd566c550-5bc4-47d2-8109-f9b59765cf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a805f0>]}
[0m08:59:27.635290 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.28s]
[0m08:59:27.636114 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m08:59:27.637995 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:59:27.638503 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m08:59:27.638943 [info ] [MainThread]: 
[0m08:59:27.639302 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 11.34 seconds (11.34s).
[0m08:59:27.640575 [debug] [MainThread]: Command end result
[0m08:59:27.665589 [info ] [MainThread]: 
[0m08:59:27.665948 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:59:27.666328 [info ] [MainThread]: 
[0m08:59:27.666544 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:59:27.667746 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.184326, "process_in_blocks": "0", "process_kernel_time": 0.21693, "process_mem_max_rss": "140836864", "process_out_blocks": "0", "process_user_time": 1.820842}
[0m08:59:27.668135 [debug] [MainThread]: Command `dbt run` succeeded at 08:59:27.668025 after 12.18 seconds
[0m08:59:27.668399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b31df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a83dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a83d70>]}
[0m08:59:27.668641 [debug] [MainThread]: Flushing usage events
[0m09:02:51.982764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f17d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f17b10>]}


============================== 09:02:51.985170 | a95ebb14-2adb-4274-ad9c-205ce32c112b ==============================
[0m09:02:51.985170 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:02:51.985523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m09:02:52.147597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a95ebb14-2adb-4274-ad9c-205ce32c112b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d8a520>]}
[0m09:02:52.170197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a95ebb14-2adb-4274-ad9c-205ce32c112b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cfc050>]}
[0m09:02:52.170584 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:02:52.225014 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:02:52.275507 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:02:52.275783 [debug] [MainThread]: Partial parsing: added file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m09:02:52.280223 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected string, got "day', w.DATE_TIME)
  )
  SELECT
      CITY_ID,
      CITY_NAME,
      WEATHER_DATE,
      AVG_TEMP_FAHRENHEIT,
      AVG_HUMIDITY,
      CURRENT_TIMESTAMP AS LAST_UPDATED  -- Add a field to track when the snapshot was taken
  FROM
      Daily_Average_Weather_Trend
  ORDER BY
      WEATHER_DATE, CITY_NAME
  
  {% endsnapshot %}"
[0m09:02:52.281223 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.33151895, "process_in_blocks": "0", "process_kernel_time": 0.152899, "process_mem_max_rss": "122306560", "process_out_blocks": "0", "process_user_time": 0.779661}
[0m09:02:52.281507 [debug] [MainThread]: Command `dbt snapshot` failed at 09:02:52.281461 after 0.33 seconds
[0m09:02:52.281705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107180320>]}
[0m09:02:52.281872 [debug] [MainThread]: Flushing usage events
[0m09:04:36.241715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106013d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106013b10>]}


============================== 09:04:36.244182 | b90438a9-4d71-4388-8ce3-9398e4986530 ==============================
[0m09:04:36.244182 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:04:36.244524 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:04:36.417057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b90438a9-4d71-4388-8ce3-9398e4986530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f8a520>]}
[0m09:04:36.443435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b90438a9-4d71-4388-8ce3-9398e4986530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f7c050>]}
[0m09:04:36.444027 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:04:36.501742 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:04:36.555963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:04:36.556309 [debug] [MainThread]: Partial parsing: added file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m09:04:36.561257 [error] [MainThread]: Encountered an error:
Compilation Error
  Reached EOF without finding a close tag for snapshot (searched from line 1)
[0m09:04:36.562373 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.3545403, "process_in_blocks": "0", "process_kernel_time": 0.162597, "process_mem_max_rss": "125599744", "process_out_blocks": "0", "process_user_time": 0.808}
[0m09:04:36.562793 [debug] [MainThread]: Command `dbt snapshot` failed at 09:04:36.562735 after 0.36 seconds
[0m09:04:36.563003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e6d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e6d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10720c320>]}
[0m09:04:36.563178 [debug] [MainThread]: Flushing usage events
[0m09:04:57.769092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103034d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104937d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104937b10>]}


============================== 09:04:57.771376 | f4791e8d-9b24-4e48-88a9-aa2823e96b9f ==============================
[0m09:04:57.771376 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:04:57.771690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:04:57.946167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4791e8d-9b24-4e48-88a9-aa2823e96b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105592520>]}
[0m09:04:57.971611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4791e8d-9b24-4e48-88a9-aa2823e96b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105494050>]}
[0m09:04:57.972086 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:04:58.029055 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:04:58.083996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:04:58.084351 [debug] [MainThread]: Partial parsing: added file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m09:04:58.147389 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot daily_average_weather_snapshot (snapshots/daily_avg_weather_trend.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m09:04:58.148523 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.41162583, "process_in_blocks": "0", "process_kernel_time": 0.165449, "process_mem_max_rss": "126337024", "process_out_blocks": "0", "process_user_time": 0.859518}
[0m09:04:58.148925 [debug] [MainThread]: Command `dbt snapshot` failed at 09:04:58.148863 after 0.41 seconds
[0m09:04:58.149142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105405550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105407950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105814320>]}
[0m09:04:58.149317 [debug] [MainThread]: Flushing usage events
[0m09:05:24.772599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032bcd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d7b10>]}


============================== 09:05:24.774905 | 1fc4b6ad-c6ff-42ad-9234-66ba3472bc1a ==============================
[0m09:05:24.774905 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:05:24.775228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:05:24.929816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fc4b6ad-c6ff-42ad-9234-66ba3472bc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678a520>]}
[0m09:05:24.952450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fc4b6ad-c6ff-42ad-9234-66ba3472bc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fc050>]}
[0m09:05:24.952841 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:05:25.008962 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:05:25.060824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:05:25.061133 [debug] [MainThread]: Partial parsing: added file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m09:05:25.116848 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot daily_average_weather_snapshot (snapshots/daily_avg_weather_trend.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m09:05:25.117817 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.37766755, "process_in_blocks": "0", "process_kernel_time": 0.135417, "process_mem_max_rss": "124698624", "process_out_blocks": "0", "process_user_time": 0.839969}
[0m09:05:25.118100 [debug] [MainThread]: Command `dbt snapshot` failed at 09:05:25.118050 after 0.38 seconds
[0m09:05:25.118288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10666d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10666f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b9c320>]}
[0m09:05:25.118453 [debug] [MainThread]: Flushing usage events
[0m09:06:09.857763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d38d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad7b10>]}


============================== 09:06:09.860309 | 1e4a1fd7-ad28-46fa-a19a-277f0d4c2076 ==============================
[0m09:06:09.860309 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:06:09.860617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:06:10.037143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e4a1fd7-ad28-46fa-a19a-277f0d4c2076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11021a520>]}
[0m09:06:10.062183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e4a1fd7-ad28-46fa-a19a-277f0d4c2076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100fc050>]}
[0m09:06:10.062611 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:06:10.120298 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:06:10.175011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:06:10.175317 [debug] [MainThread]: Partial parsing: added file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m09:06:10.237953 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot daily_average_weather_snapshot (snapshots/daily_avg_weather_trend.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m09:06:10.238921 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.41356963, "process_in_blocks": "0", "process_kernel_time": 0.166296, "process_mem_max_rss": "126631936", "process_out_blocks": "0", "process_user_time": 0.865811}
[0m09:06:10.239213 [debug] [MainThread]: Command `dbt snapshot` failed at 09:06:10.239164 after 0.41 seconds
[0m09:06:10.239412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11006d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11006f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11049c320>]}
[0m09:06:10.239577 [debug] [MainThread]: Flushing usage events
[0m09:08:37.513666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d0cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106513d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106513b10>]}


============================== 09:08:37.516036 | 56f09159-1504-4158-978a-de3511de8244 ==============================
[0m09:08:37.516036 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:08:37.516510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:08:37.565777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56f09159-1504-4158-978a-de3511de8244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10347b360>]}
[0m09:08:37.573118 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.092629835, "process_in_blocks": "0", "process_kernel_time": 0.095113, "process_mem_max_rss": "100614144", "process_out_blocks": "0", "process_user_time": 0.615357}
[0m09:08:37.573410 [debug] [MainThread]: Command `dbt clean` succeeded at 09:08:37.573361 after 0.09 seconds
[0m09:08:37.573589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106802580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106802690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e2950>]}
[0m09:08:37.573740 [debug] [MainThread]: Flushing usage events
[0m09:08:41.723536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108edbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108edbb10>]}


============================== 09:08:41.725839 | e9483b2e-635c-4cd5-a269-f0c7da656244 ==============================
[0m09:08:41.725839 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:08:41.726138 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:08:41.900343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9483b2e-635c-4cd5-a269-f0c7da656244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c8a520>]}
[0m09:08:41.925650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9483b2e-635c-4cd5-a269-f0c7da656244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bf4050>]}
[0m09:08:41.926208 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:08:41.985225 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:08:41.985726 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:08:41.985921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e9483b2e-635c-4cd5-a269-f0c7da656244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b6ca50>]}
[0m09:08:42.475307 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot daily_average_weather_snapshot (snapshots/daily_avg_weather_trend.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m09:08:42.476266 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7850301, "process_in_blocks": "0", "process_kernel_time": 0.174903, "process_mem_max_rss": "126615552", "process_out_blocks": "0", "process_user_time": 1.225282}
[0m09:08:42.476532 [debug] [MainThread]: Command `dbt run` failed at 09:08:42.476485 after 0.79 seconds
[0m09:08:42.476705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a122a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1896d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee3e70>]}
[0m09:08:42.476860 [debug] [MainThread]: Flushing usage events
[0m09:09:00.805971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10243cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d3fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d3fb10>]}


============================== 09:09:00.808380 | cab761a5-dad6-4f08-849e-329b1ffe050b ==============================
[0m09:09:00.808380 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:09:00.808698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:09:00.857628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cab761a5-dad6-4f08-849e-329b1ffe050b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bab360>]}
[0m09:09:00.863575 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.08999866, "process_in_blocks": "0", "process_kernel_time": 0.092318, "process_mem_max_rss": "97746944", "process_out_blocks": "0", "process_user_time": 0.605197}
[0m09:09:00.863881 [debug] [MainThread]: Command `dbt clean` succeeded at 09:09:00.863826 after 0.09 seconds
[0m09:09:00.864058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e6a580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e6a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ad2950>]}
[0m09:09:00.864313 [debug] [MainThread]: Flushing usage events
[0m09:09:04.099950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cfcd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ffd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ffb10>]}


============================== 09:09:04.102236 | 8bcab9a5-3eb9-47aa-9772-eb115c801b71 ==============================
[0m09:09:04.102236 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:09:04.102563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:09:04.150666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bcab9a5-3eb9-47aa-9772-eb115c801b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10546b360>]}
[0m09:09:04.156149 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.08854225, "process_in_blocks": "0", "process_kernel_time": 0.08033, "process_mem_max_rss": "99303424", "process_out_blocks": "0", "process_user_time": 0.608905}
[0m09:09:04.156462 [debug] [MainThread]: Command `dbt clean` succeeded at 09:09:04.156413 after 0.09 seconds
[0m09:09:04.156640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10672a580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10672a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106392950>]}
[0m09:09:04.156803 [debug] [MainThread]: Flushing usage events
[0m09:09:08.703203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109513d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109513b10>]}


============================== 09:09:08.705826 | 75a701fd-a211-4507-99aa-0d538d123737 ==============================
[0m09:09:08.705826 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:09:08.706152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:09:08.870138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75a701fd-a211-4507-99aa-0d538d123737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adfa520>]}
[0m09:09:08.892722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75a701fd-a211-4507-99aa-0d538d123737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acfc050>]}
[0m09:09:08.893130 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:09:08.948071 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:09:08.948603 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:09:08.948793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '75a701fd-a211-4507-99aa-0d538d123737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac70a50>]}
[0m09:09:09.443942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75a701fd-a211-4507-99aa-0d538d123737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3d220>]}
[0m09:09:09.481561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75a701fd-a211-4507-99aa-0d538d123737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0019b0>]}
[0m09:09:09.481803 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m09:09:09.481954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75a701fd-a211-4507-99aa-0d538d123737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b087380>]}
[0m09:09:09.483129 [info ] [MainThread]: 
[0m09:09:09.483395 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:09:09.485462 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m09:09:09.491824 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m09:09:09.492061 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m09:09:09.492191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:09:10.182369 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.690 seconds
[0m09:09:10.184159 [debug] [ThreadPool]: On list_openweather: Close
[0m09:09:10.338693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m09:09:10.350217 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m09:09:10.350584 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m09:09:10.350858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:09:11.051881 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.701 seconds
[0m09:09:11.056795 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m09:09:11.225913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75a701fd-a211-4507-99aa-0d538d123737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5e6750>]}
[0m09:09:11.226688 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:09:11.227076 [info ] [MainThread]: 
[0m09:09:11.230001 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m09:09:11.230634 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m09:09:11.231122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m09:09:11.231491 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m09:09:11.240163 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m09:09:11.241803 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m09:09:11.264980 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m09:09:11.267444 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m09:09:11.267716 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m09:09:11.267938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:09:12.815322 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.547 seconds
[0m09:09:12.840776 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m09:09:13.066399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a701fd-a211-4507-99aa-0d538d123737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094e1f40>]}
[0m09:09:13.067516 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.83s]
[0m09:09:13.068414 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m09:09:13.068926 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m09:09:13.069558 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m09:09:13.070141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m09:09:13.070552 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m09:09:13.075164 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m09:09:13.076375 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m09:09:13.079005 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m09:09:13.081270 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m09:09:13.081652 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m09:09:13.081976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:09:14.584468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.502 seconds
[0m09:09:14.588112 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m09:09:14.725542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a701fd-a211-4507-99aa-0d538d123737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c10fb10>]}
[0m09:09:14.726598 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.66s]
[0m09:09:14.727426 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m09:09:14.728002 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m09:09:14.728789 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m09:09:14.729429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m09:09:14.729852 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m09:09:14.733843 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m09:09:14.735304 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m09:09:14.737829 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m09:09:14.739273 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m09:09:14.739661 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    *
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY
        );
[0m09:09:14.740015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:09:16.338597 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.598 seconds
[0m09:09:16.345665 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m09:09:16.864327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a701fd-a211-4507-99aa-0d538d123737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acc5850>]}
[0m09:09:16.865506 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.hourly_weather_patterns ............ [[32mSUCCESS 1[0m in 2.13s]
[0m09:09:16.866209 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m09:09:16.866688 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m09:09:16.867315 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m09:09:16.867888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m09:09:16.868296 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m09:09:16.872195 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m09:09:16.873474 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m09:09:16.893080 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m09:09:16.894217 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m09:09:16.894493 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m09:09:16.894723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:09:18.271108 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.376 seconds
[0m09:09:18.275745 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m09:09:18.408718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a701fd-a211-4507-99aa-0d538d123737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107424910>]}
[0m09:09:18.409654 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 1.54s]
[0m09:09:18.410355 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m09:09:18.410834 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m09:09:18.411426 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m09:09:18.411985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m09:09:18.412382 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m09:09:18.416456 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m09:09:18.417642 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m09:09:18.420055 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m09:09:18.421460 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m09:09:18.421879 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    *
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME
        );
[0m09:09:18.422228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:09:19.999390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.575 seconds
[0m09:09:20.003636 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m09:09:20.129131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a701fd-a211-4507-99aa-0d538d123737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c464230>]}
[0m09:09:20.130206 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.72s]
[0m09:09:20.130979 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m09:09:20.132621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:09:20.133015 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m09:09:20.133454 [info ] [MainThread]: 
[0m09:09:20.133818 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 10.65 seconds (10.65s).
[0m09:09:20.135105 [debug] [MainThread]: Command end result
[0m09:09:20.161421 [info ] [MainThread]: 
[0m09:09:20.161852 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:09:20.162056 [info ] [MainThread]: 
[0m09:09:20.162276 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m09:09:20.164439 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.493248, "process_in_blocks": "0", "process_kernel_time": 0.20673, "process_mem_max_rss": "141164544", "process_out_blocks": "0", "process_user_time": 1.895124}
[0m09:09:20.165009 [debug] [MainThread]: Command `dbt run` succeeded at 09:09:20.164923 after 11.49 seconds
[0m09:09:20.165286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ebc7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c467ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c467dd0>]}
[0m09:09:20.165533 [debug] [MainThread]: Flushing usage events
[0m09:13:14.517460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072a4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba7b10>]}


============================== 09:13:14.519977 | 41ebb632-285f-4b95-8a55-7ce2894bb991 ==============================
[0m09:13:14.519977 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:13:14.520292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m09:13:14.706678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41ebb632-285f-4b95-8a55-7ce2894bb991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab1a520>]}
[0m09:13:14.731316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41ebb632-285f-4b95-8a55-7ce2894bb991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aafc050>]}
[0m09:13:14.731818 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:13:14.789107 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:13:14.845971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:13:14.846306 [debug] [MainThread]: Partial parsing: added file: weather_dbt://snapshots/daily_average_weather_trend.sql
[0m09:13:14.973044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41ebb632-285f-4b95-8a55-7ce2894bb991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae48a50>]}
[0m09:13:15.022260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41ebb632-285f-4b95-8a55-7ce2894bb991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad9e4e0>]}
[0m09:13:15.022565 [info ] [MainThread]: Found 5 models, 1 snapshot, 2 sources, 459 macros
[0m09:13:15.022735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41ebb632-285f-4b95-8a55-7ce2894bb991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aedc910>]}
[0m09:13:15.023640 [info ] [MainThread]: 
[0m09:13:15.023929 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:13:15.024345 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m09:13:15.030923 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m09:13:15.031166 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m09:13:15.031307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:13:15.813271 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.781 seconds
[0m09:13:15.816763 [debug] [ThreadPool]: On list_openweather: Close
[0m09:13:15.944315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now create_openweather_snapshots)
[0m09:13:15.945126 [debug] [ThreadPool]: Creating schema "database: "openweather"
schema: "snapshots"
"
[0m09:13:15.951131 [debug] [ThreadPool]: Using snowflake connection "create_openweather_snapshots"
[0m09:13:15.951518 [debug] [ThreadPool]: On create_openweather_snapshots: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "create_openweather_snapshots"} */
create schema if not exists openweather.snapshots
[0m09:13:15.951832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:13:16.543917 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.592 seconds
[0m09:13:16.546877 [debug] [ThreadPool]: On create_openweather_snapshots: Close
[0m09:13:16.695502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_openweather_snapshots, now list_openweather_analytics)
[0m09:13:16.703279 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m09:13:16.703632 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m09:13:16.703895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:13:17.259278 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.555 seconds
[0m09:13:17.262810 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m09:13:17.405168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshots)
[0m09:13:17.410530 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshots"
[0m09:13:17.410927 [debug] [ThreadPool]: On list_openweather_snapshots: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshots"} */
show objects in openweather.snapshots limit 10000
[0m09:13:17.411238 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:13:18.007599 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.596 seconds
[0m09:13:18.010757 [debug] [ThreadPool]: On list_openweather_snapshots: Close
[0m09:13:18.148504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41ebb632-285f-4b95-8a55-7ce2894bb991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af9a9c0>]}
[0m09:13:18.149357 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:13:18.149826 [info ] [MainThread]: 
[0m09:13:18.152801 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_snapshot
[0m09:13:18.153474 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.daily_average_weather_snapshot ................. [RUN]
[0m09:13:18.153947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshots, now snapshot.weather_dbt.daily_average_weather_snapshot)
[0m09:13:18.154323 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_snapshot
[0m09:13:18.163929 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_snapshot
[0m09:13:18.214754 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m09:13:18.215100 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
from (
        



WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    CITY_ID,
    CITY_NAME,
    WEATHER_DATE,
    AVG_TEMP_FAHRENHEIT,
    AVG_HUMIDITY,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m09:13:18.215317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:13:18.790387 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.574 seconds
[0m09:13:18.799291 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m09:13:18.799841 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m09:13:18.940160 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.140 seconds
[0m09:13:18.941883 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m09:13:18.945185 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m09:13:18.945819 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
create or replace transient table openweather.snapshots.daily_average_weather_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
from (
        



WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    CITY_ID,
    CITY_NAME,
    WEATHER_DATE,
    AVG_TEMP_FAHRENHEIT,
    AVG_HUMIDITY,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME

    ) sbq



        );
[0m09:13:20.017458 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.071 seconds
[0m09:13:20.045731 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: Close
[0m09:13:20.179129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41ebb632-285f-4b95-8a55-7ce2894bb991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b40aed0>]}
[0m09:13:20.180416 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.daily_average_weather_snapshot ................. [[32mSUCCESS 1[0m in 2.02s]
[0m09:13:20.181311 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_snapshot
[0m09:13:20.183120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:13:20.183629 [debug] [MainThread]: Connection 'snapshot.weather_dbt.daily_average_weather_snapshot' was properly closed.
[0m09:13:20.183987 [info ] [MainThread]: 
[0m09:13:20.184358 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.16 seconds (5.16s).
[0m09:13:20.185112 [debug] [MainThread]: Command end result
[0m09:13:20.214405 [info ] [MainThread]: 
[0m09:13:20.214776 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:13:20.214976 [info ] [MainThread]: 
[0m09:13:20.215164 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:13:20.216348 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 5.7365937, "process_in_blocks": "0", "process_kernel_time": 0.222789, "process_mem_max_rss": "139657216", "process_out_blocks": "0", "process_user_time": 1.515088}
[0m09:13:20.216708 [debug] [MainThread]: Command `dbt snapshot` succeeded at 09:13:20.216644 after 5.74 seconds
[0m09:13:20.216944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0b2620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b563390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b562350>]}
[0m09:13:20.217293 [debug] [MainThread]: Flushing usage events
[0m09:16:11.574700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de3b10>]}


============================== 09:16:11.577012 | 82dd2ad5-b720-43b6-92a4-db27c3a9228c ==============================
[0m09:16:11.577012 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:16:11.577314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:16:11.626521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82dd2ad5-b720-43b6-92a4-db27c3a9228c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c4f360>]}
[0m09:16:11.634350 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.092043, "process_in_blocks": "0", "process_kernel_time": 0.095041, "process_mem_max_rss": "100696064", "process_out_blocks": "0", "process_user_time": 0.606275}
[0m09:16:11.634630 [debug] [MainThread]: Command `dbt clean` succeeded at 09:16:11.634581 after 0.09 seconds
[0m09:16:11.634791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f0e580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f0e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b76950>]}
[0m09:16:11.634940 [debug] [MainThread]: Flushing usage events
[0m09:16:16.716682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033d8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d07d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d07b10>]}


============================== 09:16:16.719448 | c582f82a-5ba1-49fe-b50b-27cf9e580f14 ==============================
[0m09:16:16.719448 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:16:16.719916 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:16:16.895653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c582f82a-5ba1-49fe-b50b-27cf9e580f14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b8a520>]}
[0m09:16:16.920396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c582f82a-5ba1-49fe-b50b-27cf9e580f14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105afc050>]}
[0m09:16:16.920862 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:16:16.978708 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:16:16.979266 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:16:16.979568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c582f82a-5ba1-49fe-b50b-27cf9e580f14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a70a50>]}
[0m09:16:17.469317 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot hourly_weather_patterns_snapshot (snapshots/hourly_weather_patterns_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m09:16:17.470473 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7917517, "process_in_blocks": "0", "process_kernel_time": 0.171686, "process_mem_max_rss": "126697472", "process_out_blocks": "0", "process_user_time": 1.228426}
[0m09:16:17.470830 [debug] [MainThread]: Command `dbt run` failed at 09:16:17.470780 after 0.79 seconds
[0m09:16:17.471019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f26a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f896d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0fe70>]}
[0m09:16:17.471194 [debug] [MainThread]: Flushing usage events
[0m09:17:47.466894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052a0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bcbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bcbb10>]}


============================== 09:17:47.469154 | 42401824-403b-420c-a0ac-50b0e151fe4e ==============================
[0m09:17:47.469154 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:17:47.469462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:17:47.636423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42401824-403b-420c-a0ac-50b0e151fe4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107826520>]}
[0m09:17:47.658975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42401824-403b-420c-a0ac-50b0e151fe4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107728050>]}
[0m09:17:47.659382 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:17:47.715876 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:17:47.716393 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:17:47.716574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '42401824-403b-420c-a0ac-50b0e151fe4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10769ca50>]}
[0m09:17:48.179011 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot hourly_weather_patterns_snapshot (snapshots/hourly_weather_patterns_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m09:17:48.180037 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7448215, "process_in_blocks": "0", "process_kernel_time": 0.164626, "process_mem_max_rss": "126287872", "process_out_blocks": "0", "process_user_time": 1.193506}
[0m09:17:48.180294 [debug] [MainThread]: Command `dbt run` failed at 09:17:48.180245 after 0.75 seconds
[0m09:17:48.180467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a2ea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a956d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd3e70>]}
[0m09:17:48.180634 [debug] [MainThread]: Flushing usage events
[0m09:18:50.222150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c38d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653bb10>]}


============================== 09:18:50.224512 | 4519ec98-7629-4e4b-907d-cf34a36656a3 ==============================
[0m09:18:50.224512 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:18:50.224835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:18:50.395313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4519ec98-7629-4e4b-907d-cf34a36656a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107196520>]}
[0m09:18:50.420425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4519ec98-7629-4e4b-907d-cf34a36656a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107098050>]}
[0m09:18:50.420952 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:18:50.478751 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:18:50.479450 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:18:50.479675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4519ec98-7629-4e4b-907d-cf34a36656a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700ca50>]}
[0m09:18:50.970020 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot hourly_weather_patterns_snapshot (snapshots/hourly_weather_patterns_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m09:18:50.971004 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.78152186, "process_in_blocks": "0", "process_kernel_time": 0.174336, "process_mem_max_rss": "128401408", "process_out_blocks": "0", "process_user_time": 1.225647}
[0m09:18:50.971294 [debug] [MainThread]: Command `dbt run` failed at 09:18:50.971227 after 0.78 seconds
[0m09:18:50.971471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10739ea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074056d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106543e70>]}
[0m09:18:50.971638 [debug] [MainThread]: Flushing usage events
[0m09:19:03.540290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098dbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098dbb10>]}


============================== 09:19:03.542559 | 60d60207-d8e8-4443-b3c4-4e7d9157f1c5 ==============================
[0m09:19:03.542559 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:19:03.542862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:19:03.707496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60d60207-d8e8-4443-b3c4-4e7d9157f1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a58a520>]}
[0m09:19:03.730167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60d60207-d8e8-4443-b3c4-4e7d9157f1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4fc050>]}
[0m09:19:03.730577 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:19:03.787125 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:19:03.787655 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:19:03.787835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '60d60207-d8e8-4443-b3c4-4e7d9157f1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a470a50>]}
[0m09:19:04.243837 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot extreme_weather_events_snapshot (snapshots/extreme_weather_events_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m09:19:04.244847 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.73681813, "process_in_blocks": "0", "process_kernel_time": 0.160166, "process_mem_max_rss": "127303680", "process_out_blocks": "0", "process_user_time": 1.177182}
[0m09:19:04.245114 [debug] [MainThread]: Command `dbt run` failed at 09:19:04.245067 after 0.74 seconds
[0m09:19:04.245287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb26a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb896d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098e3e70>]}
[0m09:19:04.245449 [debug] [MainThread]: Flushing usage events
[0m09:19:34.884316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089ebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089ebb10>]}


============================== 09:19:34.886584 | 7ed1ad11-1ee8-4437-ac58-7f0b4d4c1136 ==============================
[0m09:19:34.886584 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:19:34.886889 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:19:35.054179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ed1ad11-1ee8-4437-ac58-7f0b4d4c1136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109646520>]}
[0m09:19:35.079652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ed1ad11-1ee8-4437-ac58-7f0b4d4c1136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109548050>]}
[0m09:19:35.080153 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:19:35.135569 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:19:35.136225 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:19:35.136413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7ed1ad11-1ee8-4437-ac58-7f0b4d4c1136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094bca50>]}
[0m09:19:35.654226 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot weather_conditions_frequency_snapshot (snapshots/weather_condition_freq_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m09:19:35.655212 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.80281705, "process_in_blocks": "0", "process_kernel_time": 0.149245, "process_mem_max_rss": "129548288", "process_out_blocks": "0", "process_user_time": 1.251333}
[0m09:19:35.655481 [debug] [MainThread]: Command `dbt run` failed at 09:19:35.655432 after 0.80 seconds
[0m09:19:35.655651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10984aa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098b49b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f3e70>]}
[0m09:19:35.655814 [debug] [MainThread]: Flushing usage events
[0m09:19:57.734748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106810d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086dbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086dbb10>]}


============================== 09:19:57.737369 | eab96a69-eb5d-452c-bdb0-9316bb55479a ==============================
[0m09:19:57.737369 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:19:57.737754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:19:57.915948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eab96a69-eb5d-452c-bdb0-9316bb55479a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094fa520>]}
[0m09:19:57.940860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eab96a69-eb5d-452c-bdb0-9316bb55479a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093fc050>]}
[0m09:19:57.941481 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:19:57.999248 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:19:57.999759 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:19:57.999936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eab96a69-eb5d-452c-bdb0-9316bb55479a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109370a50>]}
[0m09:19:58.608015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eab96a69-eb5d-452c-bdb0-9316bb55479a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098234d0>]}
[0m09:19:58.656923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eab96a69-eb5d-452c-bdb0-9316bb55479a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ab9710>]}
[0m09:19:58.657197 [info ] [MainThread]: Found 5 models, 3 snapshots, 2 sources, 459 macros
[0m09:19:58.657360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eab96a69-eb5d-452c-bdb0-9316bb55479a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a4bb0>]}
[0m09:19:58.658324 [info ] [MainThread]: 
[0m09:19:58.658597 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:19:58.660920 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m09:19:58.667405 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m09:19:58.667626 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m09:19:58.667760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:19:59.302759 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.635 seconds
[0m09:19:59.304900 [debug] [ThreadPool]: On list_openweather: Close
[0m09:19:59.410222 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m09:19:59.421748 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m09:19:59.422253 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m09:19:59.422546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:19:59.988269 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.566 seconds
[0m09:19:59.991548 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m09:20:00.114502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m09:20:00.119202 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m09:20:00.119749 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m09:20:00.120085 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:20:00.643082 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.523 seconds
[0m09:20:00.645725 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m09:20:00.778868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eab96a69-eb5d-452c-bdb0-9316bb55479a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0d3410>]}
[0m09:20:00.779786 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:20:00.780182 [info ] [MainThread]: 
[0m09:20:00.783022 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m09:20:00.783684 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m09:20:00.784521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now model.weather_dbt.daily_avg_weather_trend)
[0m09:20:00.785040 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m09:20:00.792720 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m09:20:00.794051 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m09:20:00.816692 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m09:20:00.818243 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m09:20:00.818523 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m09:20:00.818746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:20:02.328911 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.510 seconds
[0m09:20:02.355788 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m09:20:02.491620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eab96a69-eb5d-452c-bdb0-9316bb55479a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086adf40>]}
[0m09:20:02.492980 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.71s]
[0m09:20:02.493881 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m09:20:02.494402 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m09:20:02.495160 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m09:20:02.495850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m09:20:02.496279 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m09:20:02.499973 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m09:20:02.501308 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m09:20:02.504722 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m09:20:02.506189 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m09:20:02.506549 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m09:20:02.506954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:20:03.685143 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.178 seconds
[0m09:20:03.688826 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m09:20:03.808217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eab96a69-eb5d-452c-bdb0-9316bb55479a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b625c70>]}
[0m09:20:03.809539 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.31s]
[0m09:20:03.810471 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m09:20:03.811045 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m09:20:03.811864 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m09:20:03.812485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m09:20:03.812900 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m09:20:03.816881 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m09:20:03.817953 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m09:20:03.827375 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m09:20:03.829262 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m09:20:03.829620 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    *
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY
        );
[0m09:20:03.829929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:20:05.053376 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.223 seconds
[0m09:20:05.056915 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m09:20:05.188719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eab96a69-eb5d-452c-bdb0-9316bb55479a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cd0d50>]}
[0m09:20:05.189804 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.hourly_weather_patterns ............ [[32mSUCCESS 1[0m in 1.38s]
[0m09:20:05.190522 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m09:20:05.190996 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m09:20:05.191632 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m09:20:05.192508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m09:20:05.192956 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m09:20:05.196900 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m09:20:05.198075 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m09:20:05.219028 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m09:20:05.220213 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m09:20:05.220489 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m09:20:05.220737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:20:06.236816 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.016 seconds
[0m09:20:06.240596 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m09:20:06.367743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eab96a69-eb5d-452c-bdb0-9316bb55479a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6197f0>]}
[0m09:20:06.368838 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 1.18s]
[0m09:20:06.369548 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m09:20:06.370135 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m09:20:06.371123 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m09:20:06.372018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m09:20:06.372532 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m09:20:06.376937 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m09:20:06.378127 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m09:20:06.381899 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m09:20:06.383667 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m09:20:06.384189 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    *
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME
        );
[0m09:20:06.384524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:20:07.873189 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.488 seconds
[0m09:20:07.878172 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m09:20:08.005044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eab96a69-eb5d-452c-bdb0-9316bb55479a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042fac30>]}
[0m09:20:08.006139 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.63s]
[0m09:20:08.006857 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m09:20:08.008413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:20:08.008887 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m09:20:08.009586 [info ] [MainThread]: 
[0m09:20:08.009986 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 9.35 seconds (9.35s).
[0m09:20:08.011305 [debug] [MainThread]: Command end result
[0m09:20:08.037263 [info ] [MainThread]: 
[0m09:20:08.037666 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:20:08.037869 [info ] [MainThread]: 
[0m09:20:08.038182 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m09:20:08.039738 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.341154, "process_in_blocks": "0", "process_kernel_time": 0.256282, "process_mem_max_rss": "145899520", "process_out_blocks": "0", "process_user_time": 2.08483}
[0m09:20:08.040166 [debug] [MainThread]: Command `dbt run` succeeded at 09:20:08.040095 after 10.34 seconds
[0m09:20:08.040445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c858b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b39f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b39e930>]}
[0m09:20:08.040723 [debug] [MainThread]: Flushing usage events
[0m09:21:08.117687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104898d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107013d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107013b10>]}


============================== 09:21:08.120095 | f8c00544-529b-4fc1-8245-aea7407ce3dd ==============================
[0m09:21:08.120095 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:21:08.120411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:21:08.286112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8c00544-529b-4fc1-8245-aea7407ce3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888a520>]}
[0m09:21:08.308791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8c00544-529b-4fc1-8245-aea7407ce3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10887c050>]}
[0m09:21:08.309168 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:21:08.365469 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:21:08.424145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:21:08.424440 [debug] [MainThread]: Partial parsing: added file: weather_dbt://snapshots/hourly_weather_patterns_snapshot.sql
[0m09:21:08.536103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8c00544-529b-4fc1-8245-aea7407ce3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad0d50>]}
[0m09:21:08.582273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8c00544-529b-4fc1-8245-aea7407ce3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b224e0>]}
[0m09:21:08.582552 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m09:21:08.582727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8c00544-529b-4fc1-8245-aea7407ce3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108df4c90>]}
[0m09:21:08.583704 [info ] [MainThread]: 
[0m09:21:08.583988 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:21:08.586055 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m09:21:08.592483 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m09:21:08.592693 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m09:21:08.592828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:21:09.168093 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.575 seconds
[0m09:21:09.171484 [debug] [ThreadPool]: On list_openweather: Close
[0m09:21:09.324904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m09:21:09.335372 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m09:21:09.335756 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m09:21:09.336044 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:09.911466 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.575 seconds
[0m09:21:09.917301 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m09:21:10.034339 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m09:21:10.038456 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m09:21:10.038735 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m09:21:10.038966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:10.542863 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.503 seconds
[0m09:21:10.546232 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m09:21:10.666744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8c00544-529b-4fc1-8245-aea7407ce3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f393d0>]}
[0m09:21:10.667135 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:21:10.667313 [info ] [MainThread]: 
[0m09:21:10.668538 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_snapshot
[0m09:21:10.668840 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.daily_average_weather_snapshot .................. [RUN]
[0m09:21:10.669079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now snapshot.weather_dbt.daily_average_weather_snapshot)
[0m09:21:10.669259 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_snapshot
[0m09:21:10.674149 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_snapshot
[0m09:21:10.711840 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m09:21:10.712160 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
from (
        



WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    CITY_ID,
    CITY_NAME,
    WEATHER_DATE,
    AVG_TEMP_FAHRENHEIT,
    AVG_HUMIDITY,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m09:21:10.712368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:11.686371 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.972 seconds
[0m09:21:11.698461 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m09:21:11.699105 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m09:21:12.135923 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.436 seconds
[0m09:21:12.137589 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m09:21:12.141186 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m09:21:12.141956 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
create or replace transient table openweather.snapshot.daily_average_weather_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
from (
        



WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    CITY_ID,
    CITY_NAME,
    WEATHER_DATE,
    AVG_TEMP_FAHRENHEIT,
    AVG_HUMIDITY,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME

    ) sbq



        );
[0m09:21:13.411613 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.268 seconds
[0m09:21:13.437652 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: Close
[0m09:21:13.565071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c00544-529b-4fc1-8245-aea7407ce3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109114dd0>]}
[0m09:21:13.566222 [info ] [Thread-1 (]: 1 of 4 OK snapshotted snapshot.daily_average_weather_snapshot .................. [[32mSUCCESS 1[0m in 2.89s]
[0m09:21:13.566988 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_snapshot
[0m09:21:13.567508 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events_snapshot
[0m09:21:13.568189 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.extreme_weather_events_snapshot ................. [RUN]
[0m09:21:13.568775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_snapshot, now snapshot.weather_dbt.extreme_weather_events_snapshot)
[0m09:21:13.569193 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events_snapshot
[0m09:21:13.573212 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events_snapshot
[0m09:21:13.577655 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m09:21:13.578278 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
from (
        



WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    CITY_ID,
    CITY_NAME,
    DATE_TIME,
    TEMP_FAHRENHEIT,
    WIND_SPEED,
    WEATHER_ALERT,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m09:21:13.578659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:14.332424 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.753 seconds
[0m09:21:14.335104 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m09:21:14.335773 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m09:21:14.465652 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.129 seconds
[0m09:21:14.467581 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m09:21:14.470592 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m09:21:14.471154 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
create or replace transient table openweather.snapshot.extreme_weather_events_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
from (
        



WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    CITY_ID,
    CITY_NAME,
    DATE_TIME,
    TEMP_FAHRENHEIT,
    WIND_SPEED,
    WEATHER_ALERT,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME

    ) sbq



        );
[0m09:21:15.254544 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.782 seconds
[0m09:21:15.259711 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: Close
[0m09:21:15.369021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c00544-529b-4fc1-8245-aea7407ce3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109afedb0>]}
[0m09:21:15.370063 [info ] [Thread-1 (]: 2 of 4 OK snapshotted snapshot.extreme_weather_events_snapshot ................. [[32mSUCCESS 1[0m in 1.80s]
[0m09:21:15.370584 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events_snapshot
[0m09:21:15.370935 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns_snapshot
[0m09:21:15.371376 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.hourly_weather_patterns_snapshot ................ [RUN]
[0m09:21:15.371775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events_snapshot, now snapshot.weather_dbt.hourly_weather_patterns_snapshot)
[0m09:21:15.372062 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns_snapshot
[0m09:21:15.375260 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns_snapshot
[0m09:21:15.379424 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m09:21:15.379871 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
from (
        



WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    CITY_ID,
    CITY_NAME,
    HOUR_OF_DAY,
    AVG_TEMP_FAHRENHEIT,
    AVG_WIND_SPEED,
    AVG_HUMIDITY,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m09:21:15.380167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:16.072590 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.692 seconds
[0m09:21:16.075645 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m09:21:16.076216 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m09:21:16.185467 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.108 seconds
[0m09:21:16.189842 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m09:21:16.192980 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m09:21:16.193596 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
create or replace transient table openweather.snapshot.hourly_weather_patterns_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
from (
        



WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    CITY_ID,
    CITY_NAME,
    HOUR_OF_DAY,
    AVG_TEMP_FAHRENHEIT,
    AVG_WIND_SPEED,
    AVG_HUMIDITY,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY

    ) sbq



        );
[0m09:21:17.305277 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.111 seconds
[0m09:21:17.309799 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: Close
[0m09:21:17.441408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c00544-529b-4fc1-8245-aea7407ce3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089a62b0>]}
[0m09:21:17.442326 [info ] [Thread-1 (]: 3 of 4 OK snapshotted snapshot.hourly_weather_patterns_snapshot ................ [[32mSUCCESS 1[0m in 2.07s]
[0m09:21:17.442960 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns_snapshot
[0m09:21:17.443387 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency_snapshot
[0m09:21:17.443911 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.weather_conditions_frequency_snapshot ........... [RUN]
[0m09:21:17.444401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns_snapshot, now snapshot.weather_dbt.weather_conditions_frequency_snapshot)
[0m09:21:17.444755 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency_snapshot
[0m09:21:17.448511 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency_snapshot
[0m09:21:17.458323 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m09:21:17.458856 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
from (
        



WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    CITY_ID,
    CITY_NAME,
    WEATHER_MAIN,
    CONDITION_COUNT,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m09:21:17.459179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:17.905669 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.446 seconds
[0m09:21:17.910109 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m09:21:17.910621 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m09:21:17.980565 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.069 seconds
[0m09:21:17.981391 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m09:21:17.983888 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m09:21:17.984372 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
create or replace transient table openweather.snapshot.weather_conditions_frequency_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
from (
        



WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    CITY_ID,
    CITY_NAME,
    WEATHER_MAIN,
    CONDITION_COUNT,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME

    ) sbq



        );
[0m09:21:18.663762 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.678 seconds
[0m09:21:18.667790 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: Close
[0m09:21:18.780915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c00544-529b-4fc1-8245-aea7407ce3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d8fd0>]}
[0m09:21:18.781828 [info ] [Thread-1 (]: 4 of 4 OK snapshotted snapshot.weather_conditions_frequency_snapshot ........... [[32mSUCCESS 1[0m in 1.34s]
[0m09:21:18.782441 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency_snapshot
[0m09:21:18.783886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:21:18.784224 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency_snapshot' was properly closed.
[0m09:21:18.784546 [info ] [MainThread]: 
[0m09:21:18.784844 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 10.20 seconds (10.20s).
[0m09:21:18.785823 [debug] [MainThread]: Command end result
[0m09:21:18.809288 [info ] [MainThread]: 
[0m09:21:18.809637 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:21:18.809846 [info ] [MainThread]: 
[0m09:21:18.810047 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:21:18.811221 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 10.726472, "process_in_blocks": "0", "process_kernel_time": 0.224204, "process_mem_max_rss": "140017664", "process_out_blocks": "0", "process_user_time": 1.640337}
[0m09:21:18.811548 [debug] [MainThread]: Command `dbt snapshot` succeeded at 09:21:18.811490 after 10.73 seconds
[0m09:21:18.811760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107026c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100df9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e7d550>]}
[0m09:21:18.811976 [debug] [MainThread]: Flushing usage events
[0m09:48:04.990356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106613d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106613b10>]}


============================== 09:48:04.992634 | e9ebebc5-4603-4805-a22f-1aee12006dae ==============================
[0m09:48:04.992634 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:48:04.992949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:48:05.160916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9ebebc5-4603-4805-a22f-1aee12006dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10758a520>]}
[0m09:48:05.183470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9ebebc5-4603-4805-a22f-1aee12006dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fc050>]}
[0m09:48:05.183871 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:48:05.239870 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:48:05.298161 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:48:05.298478 [debug] [MainThread]: Partial parsing: added file: weather_dbt://models/schema.yml
[0m09:48:05.322521 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m09:48:05.322780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e9ebebc5-4603-4805-a22f-1aee12006dae', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107470d50>]}
[0m09:48:05.327951 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'daily_average_weather_trend' in the 'models' section of file 'models/schema.yml'
[0m09:48:05.396368 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_daily_average_weather_trend_city_id.28e0ed22c6' (models/schema.yml) depends on a node named 'daily_average_weather_trend' in package '' which was not found
[0m09:48:05.396694 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.unique_daily_average_weather_trend_city_id.c81911e991' (models/schema.yml) depends on a node named 'daily_average_weather_trend' in package '' which was not found
[0m09:48:05.396897 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_daily_average_weather_trend_weather_date.f3f17cdb15' (models/schema.yml) depends on a node named 'daily_average_weather_trend' in package '' which was not found
[0m09:48:05.397137 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.unique_combination_of_daily_average_weather_trend_weather_date__city_id__weather_date.1fb397e231' (models/schema.yml) depends on a node named 'daily_average_weather_trend' in package '' which was not found
[0m09:48:05.397310 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_daily_average_weather_trend_avg_temp_fahrenheit.c064852024' (models/schema.yml) depends on a node named 'daily_average_weather_trend' in package '' which was not found
[0m09:48:05.397472 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.accepted_range_daily_average_weather_trend_avg_temp_fahrenheit__130___50.242bec3406' (models/schema.yml) depends on a node named 'daily_average_weather_trend' in package '' which was not found
[0m09:48:05.397610 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_daily_average_weather_trend_avg_humidity.a1b0ff7cea' (models/schema.yml) depends on a node named 'daily_average_weather_trend' in package '' which was not found
[0m09:48:05.397747 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.accepted_range_daily_average_weather_trend_avg_humidity__100__0.491f26385c' (models/schema.yml) depends on a node named 'daily_average_weather_trend' in package '' which was not found
[0m09:48:05.435156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9ebebc5-4603-4805-a22f-1aee12006dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b9fa70>]}
[0m09:48:05.531496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9ebebc5-4603-4805-a22f-1aee12006dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b7850>]}
[0m09:48:05.531744 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m09:48:05.531898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9ebebc5-4603-4805-a22f-1aee12006dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109950d50>]}
[0m09:48:05.532677 [info ] [MainThread]: 
[0m09:48:05.532834 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:48:05.533041 [debug] [MainThread]: Command end result
[0m09:48:05.546693 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5883394, "process_in_blocks": "0", "process_kernel_time": 0.166083, "process_mem_max_rss": "129269760", "process_out_blocks": "0", "process_user_time": 1.026531}
[0m09:48:05.547086 [debug] [MainThread]: Command `dbt test` succeeded at 09:48:05.546964 after 0.59 seconds
[0m09:48:05.547376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098bf750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098bf6a0>]}
[0m09:48:05.547575 [debug] [MainThread]: Flushing usage events
[0m09:51:18.770306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d98d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af13d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af13b10>]}


============================== 09:51:18.772672 | 9dfa6fbb-488f-434e-b92b-65b9d9ddd322 ==============================
[0m09:51:18.772672 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:51:18.772987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:51:18.947853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9dfa6fbb-488f-434e-b92b-65b9d9ddd322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be8a520>]}
[0m09:51:18.972937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9dfa6fbb-488f-434e-b92b-65b9d9ddd322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdfc050>]}
[0m09:51:18.973350 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:51:19.030389 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:51:19.102669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:51:19.103107 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/schema.yml
[0m09:51:19.129696 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m09:51:19.130050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9dfa6fbb-488f-434e-b92b-65b9d9ddd322', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd73750>]}
[0m09:51:19.235577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dfa6fbb-488f-434e-b92b-65b9d9ddd322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3be990>]}
[0m09:51:19.337050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9dfa6fbb-488f-434e-b92b-65b9d9ddd322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdb7850>]}
[0m09:51:19.337311 [info ] [MainThread]: Found 5 models, 4 snapshots, 8 data tests, 2 sources, 459 macros
[0m09:51:19.337463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dfa6fbb-488f-434e-b92b-65b9d9ddd322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d069230>]}
[0m09:51:19.338470 [info ] [MainThread]: 
[0m09:51:19.338755 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:51:19.341264 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_analytics'
[0m09:51:19.349057 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m09:51:19.349234 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m09:51:19.349361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:51:19.983760 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.634 seconds
[0m09:51:19.987911 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m09:51:20.105102 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m09:51:20.109395 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m09:51:20.109813 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m09:51:20.110139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:51:21.348724 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.239 seconds
[0m09:51:21.350061 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m09:51:21.486569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dfa6fbb-488f-434e-b92b-65b9d9ddd322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3f0b90>]}
[0m09:51:21.487246 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:51:21.487604 [info ] [MainThread]: 
[0m09:51:21.490296 [debug] [Thread-1 (]: Began running node test.weather_dbt.accepted_range_daily_avg_weather_trend_avg_humidity__100__0.f4f648b7a9
[0m09:51:21.490767 [info ] [Thread-1 (]: 1 of 8 START test accepted_range_daily_avg_weather_trend_avg_humidity__100__0 .. [RUN]
[0m09:51:21.491213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now test.weather_dbt.accepted_range_daily_avg_weather_trend_avg_humidity__100__0.f4f648b7a9)
[0m09:51:21.491547 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.accepted_range_daily_avg_weather_trend_avg_humidity__100__0.f4f648b7a9
[0m09:51:21.508762 [debug] [Thread-1 (]: Compilation Error in test accepted_range_daily_avg_weather_trend_avg_humidity__100__0 (models/schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:51:21.509329 [error] [Thread-1 (]: 1 of 8 ERROR accepted_range_daily_avg_weather_trend_avg_humidity__100__0 ....... [[31mERROR[0m in 0.02s]
[0m09:51:21.509755 [debug] [Thread-1 (]: Finished running node test.weather_dbt.accepted_range_daily_avg_weather_trend_avg_humidity__100__0.f4f648b7a9
[0m09:51:21.510081 [debug] [Thread-1 (]: Began running node test.weather_dbt.accepted_range_daily_avg_weather_trend_avg_temp_fahrenheit__130___50.13a4c71e5b
[0m09:51:21.511097 [info ] [Thread-1 (]: 2 of 8 START test accepted_range_daily_avg_weather_trend_avg_temp_fahrenheit__130___50  [RUN]
[0m09:51:21.511665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.accepted_range_daily_avg_weather_trend_avg_humidity__100__0.f4f648b7a9, now test.weather_dbt.accepted_range_daily_avg_weather_trend_avg_temp_fahrenheit__130___50.13a4c71e5b)
[0m09:51:21.512028 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.accepted_range_daily_avg_weather_trend_avg_temp_fahrenheit__130___50.13a4c71e5b
[0m09:51:21.521465 [debug] [Thread-1 (]: Compilation Error in test accepted_range_daily_avg_weather_trend_avg_temp_fahrenheit__130___50 (models/schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:51:21.521902 [error] [Thread-1 (]: 2 of 8 ERROR accepted_range_daily_avg_weather_trend_avg_temp_fahrenheit__130___50  [[31mERROR[0m in 0.01s]
[0m09:51:21.522262 [debug] [Thread-1 (]: Finished running node test.weather_dbt.accepted_range_daily_avg_weather_trend_avg_temp_fahrenheit__130___50.13a4c71e5b
[0m09:51:21.522510 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:51:21.522854 [info ] [Thread-1 (]: 3 of 8 START test not_null_daily_avg_weather_trend_avg_humidity ................ [RUN]
[0m09:51:21.523228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.accepted_range_daily_avg_weather_trend_avg_temp_fahrenheit__130___50.13a4c71e5b, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07)
[0m09:51:21.523435 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:51:21.529045 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:51:21.529748 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:51:21.541396 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:51:21.542127 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:51:21.542327 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_humidity
from openweather.analytics.daily_avg_weather_trend
where avg_humidity is null



      
    ) dbt_internal_test
[0m09:51:21.542498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:22.627089 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.084 seconds
[0m09:51:22.641224 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: Close
[0m09:51:22.920972 [info ] [Thread-1 (]: 3 of 8 PASS not_null_daily_avg_weather_trend_avg_humidity ...................... [[32mPASS[0m in 1.40s]
[0m09:51:22.921879 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:51:22.922378 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:51:22.922885 [info ] [Thread-1 (]: 4 of 8 START test not_null_daily_avg_weather_trend_avg_temp_fahrenheit ......... [RUN]
[0m09:51:22.923461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372)
[0m09:51:22.923879 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:51:22.928789 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:51:22.929832 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:51:22.932592 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:51:22.934259 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:51:22.934801 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp_fahrenheit
from openweather.analytics.daily_avg_weather_trend
where avg_temp_fahrenheit is null



      
    ) dbt_internal_test
[0m09:51:22.935134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:23.653320 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.718 seconds
[0m09:51:23.657034 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: Close
[0m09:51:23.780946 [info ] [Thread-1 (]: 4 of 8 PASS not_null_daily_avg_weather_trend_avg_temp_fahrenheit ............... [[32mPASS[0m in 0.86s]
[0m09:51:23.782217 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:51:23.782642 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:51:23.783054 [info ] [Thread-1 (]: 5 of 8 START test not_null_daily_avg_weather_trend_city_id ..................... [RUN]
[0m09:51:23.783490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372, now test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790)
[0m09:51:23.783803 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:51:23.787837 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:51:23.788804 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:51:23.790864 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:51:23.792035 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:51:23.792338 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_id
from openweather.analytics.daily_avg_weather_trend
where city_id is null



      
    ) dbt_internal_test
[0m09:51:23.792592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:24.514523 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.721 seconds
[0m09:51:24.524382 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: Close
[0m09:51:24.652406 [info ] [Thread-1 (]: 5 of 8 PASS not_null_daily_avg_weather_trend_city_id ........................... [[32mPASS[0m in 0.87s]
[0m09:51:24.653427 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:51:24.654014 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:51:24.654848 [info ] [Thread-1 (]: 6 of 8 START test not_null_daily_avg_weather_trend_weather_date ................ [RUN]
[0m09:51:24.655335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790, now test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b)
[0m09:51:24.655717 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:51:24.660685 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:51:24.662429 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:51:24.665765 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:51:24.667249 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:51:24.667812 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_date
from openweather.analytics.daily_avg_weather_trend
where weather_date is null



      
    ) dbt_internal_test
[0m09:51:24.668129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:25.097456 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.429 seconds
[0m09:51:25.098857 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: Close
[0m09:51:25.236155 [info ] [Thread-1 (]: 6 of 8 PASS not_null_daily_avg_weather_trend_weather_date ...................... [[32mPASS[0m in 0.58s]
[0m09:51:25.236843 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:51:25.237258 [debug] [Thread-1 (]: Began running node test.weather_dbt.unique_combination_of_daily_avg_weather_trend_weather_date__city_id__weather_date.46c8898a72
[0m09:51:25.237577 [info ] [Thread-1 (]: 7 of 8 START test unique_combination_of_daily_avg_weather_trend_weather_date__city_id__weather_date  [RUN]
[0m09:51:25.237931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b, now test.weather_dbt.unique_combination_of_daily_avg_weather_trend_weather_date__city_id__weather_date.46c8898a72)
[0m09:51:25.238179 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.unique_combination_of_daily_avg_weather_trend_weather_date__city_id__weather_date.46c8898a72
[0m09:51:25.242408 [debug] [Thread-1 (]: Compilation Error in test unique_combination_of_daily_avg_weather_trend_weather_date__city_id__weather_date (models/schema.yml)
  'test_unique_combination_of' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:51:25.242728 [error] [Thread-1 (]: 7 of 8 ERROR unique_combination_of_daily_avg_weather_trend_weather_date__city_id__weather_date  [[31mERROR[0m in 0.00s]
[0m09:51:25.243038 [debug] [Thread-1 (]: Finished running node test.weather_dbt.unique_combination_of_daily_avg_weather_trend_weather_date__city_id__weather_date.46c8898a72
[0m09:51:25.243258 [debug] [Thread-1 (]: Began running node test.weather_dbt.unique_daily_avg_weather_trend_city_id.95007610c0
[0m09:51:25.243450 [info ] [Thread-1 (]: 8 of 8 START test unique_daily_avg_weather_trend_city_id ....................... [RUN]
[0m09:51:25.243813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.unique_combination_of_daily_avg_weather_trend_weather_date__city_id__weather_date.46c8898a72, now test.weather_dbt.unique_daily_avg_weather_trend_city_id.95007610c0)
[0m09:51:25.244174 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.unique_daily_avg_weather_trend_city_id.95007610c0
[0m09:51:25.248035 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.unique_daily_avg_weather_trend_city_id.95007610c0"
[0m09:51:25.248746 [debug] [Thread-1 (]: Began executing node test.weather_dbt.unique_daily_avg_weather_trend_city_id.95007610c0
[0m09:51:25.250486 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.unique_daily_avg_weather_trend_city_id.95007610c0"
[0m09:51:25.251169 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.unique_daily_avg_weather_trend_city_id.95007610c0"
[0m09:51:25.251392 [debug] [Thread-1 (]: On test.weather_dbt.unique_daily_avg_weather_trend_city_id.95007610c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.unique_daily_avg_weather_trend_city_id.95007610c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    city_id as unique_field,
    count(*) as n_records

from openweather.analytics.daily_avg_weather_trend
where city_id is not null
group by city_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:51:25.251577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:26.002867 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.751 seconds
[0m09:51:26.004536 [debug] [Thread-1 (]: On test.weather_dbt.unique_daily_avg_weather_trend_city_id.95007610c0: Close
[0m09:51:26.130997 [error] [Thread-1 (]: 8 of 8 FAIL 459 unique_daily_avg_weather_trend_city_id ......................... [[31mFAIL 459[0m in 0.89s]
[0m09:51:26.131441 [debug] [Thread-1 (]: Finished running node test.weather_dbt.unique_daily_avg_weather_trend_city_id.95007610c0
[0m09:51:26.132163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:51:26.132354 [debug] [MainThread]: Connection 'test.weather_dbt.unique_daily_avg_weather_trend_city_id.95007610c0' was properly closed.
[0m09:51:26.132530 [info ] [MainThread]: 
[0m09:51:26.132698 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 6.79 seconds (6.79s).
[0m09:51:26.133431 [debug] [MainThread]: Command end result
[0m09:51:26.150728 [info ] [MainThread]: 
[0m09:51:26.151001 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m09:51:26.151150 [info ] [MainThread]: 
[0m09:51:26.151337 [error] [MainThread]:   Compilation Error in test accepted_range_daily_avg_weather_trend_avg_humidity__100__0 (models/schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:51:26.151466 [info ] [MainThread]: 
[0m09:51:26.151628 [error] [MainThread]:   Compilation Error in test accepted_range_daily_avg_weather_trend_avg_temp_fahrenheit__130___50 (models/schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:51:26.151747 [info ] [MainThread]: 
[0m09:51:26.151897 [error] [MainThread]:   Compilation Error in test unique_combination_of_daily_avg_weather_trend_weather_date__city_id__weather_date (models/schema.yml)
  'test_unique_combination_of' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:51:26.152129 [info ] [MainThread]: 
[0m09:51:26.152402 [error] [MainThread]: [31mFailure in test unique_daily_avg_weather_trend_city_id (models/schema.yml)[0m
[0m09:51:26.152552 [error] [MainThread]:   Got 459 results, configured to fail if != 0
[0m09:51:26.152668 [info ] [MainThread]: 
[0m09:51:26.152808 [info ] [MainThread]:   compiled code at target/compiled/weather_dbt/models/schema.yml/unique_daily_avg_weather_trend_city_id.sql
[0m09:51:26.152928 [info ] [MainThread]: 
[0m09:51:26.153068 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=0 TOTAL=8
[0m09:51:26.153957 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 7.41605, "process_in_blocks": "0", "process_kernel_time": 0.230118, "process_mem_max_rss": "143982592", "process_out_blocks": "0", "process_user_time": 1.551356}
[0m09:51:26.154210 [debug] [MainThread]: Command `dbt test` failed at 09:51:26.154166 after 7.42 seconds
[0m09:51:26.154395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d54d5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4a8ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4a9090>]}
[0m09:51:26.154557 [debug] [MainThread]: Flushing usage events
[0m09:52:12.229128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105317d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105317b10>]}


============================== 09:52:12.231468 | 6dd3fb51-35e3-4a87-a723-bd5a87b4aaad ==============================
[0m09:52:12.231468 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:52:12.231788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m09:52:12.389436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dd3fb51-35e3-4a87-a723-bd5a87b4aaad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fa520>]}
[0m09:52:12.412102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dd3fb51-35e3-4a87-a723-bd5a87b4aaad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060fc050>]}
[0m09:52:12.412504 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:52:12.466941 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:52:12.534072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:52:12.534500 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/schema.yml
[0m09:52:12.628970 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m09:52:12.629282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6dd3fb51-35e3-4a87-a723-bd5a87b4aaad', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067dcd50>]}
[0m09:52:12.748105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dd3fb51-35e3-4a87-a723-bd5a87b4aaad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106042120>]}
[0m09:52:12.804358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dd3fb51-35e3-4a87-a723-bd5a87b4aaad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10684e890>]}
[0m09:52:12.804600 [info ] [MainThread]: Found 5 models, 4 snapshots, 4 data tests, 2 sources, 459 macros
[0m09:52:12.804763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dd3fb51-35e3-4a87-a723-bd5a87b4aaad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b6340>]}
[0m09:52:12.805691 [info ] [MainThread]: 
[0m09:52:12.805947 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:52:12.808075 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_snapshot'
[0m09:52:12.815757 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m09:52:12.815970 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m09:52:12.816110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:13.430666 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.614 seconds
[0m09:52:13.438501 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m09:52:13.580803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m09:52:13.584449 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m09:52:13.584834 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m09:52:13.585141 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:14.043920 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.458 seconds
[0m09:52:14.049365 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m09:52:14.170156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dd3fb51-35e3-4a87-a723-bd5a87b4aaad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110094890>]}
[0m09:52:14.170888 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:52:14.171269 [info ] [MainThread]: 
[0m09:52:14.174138 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:52:14.174667 [info ] [Thread-1 (]: 1 of 4 START test not_null_daily_avg_weather_trend_avg_humidity ................ [RUN]
[0m09:52:14.175188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07)
[0m09:52:14.175593 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:52:14.191569 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:52:14.192840 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:52:14.207932 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:52:14.208717 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:52:14.208963 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_humidity
from openweather.analytics.daily_avg_weather_trend
where avg_humidity is null



      
    ) dbt_internal_test
[0m09:52:14.209176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:14.674840 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.465 seconds
[0m09:52:14.691494 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: Close
[0m09:52:14.852881 [info ] [Thread-1 (]: 1 of 4 PASS not_null_daily_avg_weather_trend_avg_humidity ...................... [[32mPASS[0m in 0.68s]
[0m09:52:14.855417 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:52:14.856689 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:52:14.857465 [info ] [Thread-1 (]: 2 of 4 START test not_null_daily_avg_weather_trend_avg_temp_fahrenheit ......... [RUN]
[0m09:52:14.858196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372)
[0m09:52:14.858711 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:52:14.863867 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:52:14.864892 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:52:14.868714 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:52:14.870300 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:52:14.870715 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp_fahrenheit
from openweather.analytics.daily_avg_weather_trend
where avg_temp_fahrenheit is null



      
    ) dbt_internal_test
[0m09:52:14.871083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:15.385927 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.515 seconds
[0m09:52:15.388578 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: Close
[0m09:52:15.516465 [info ] [Thread-1 (]: 2 of 4 PASS not_null_daily_avg_weather_trend_avg_temp_fahrenheit ............... [[32mPASS[0m in 0.66s]
[0m09:52:15.517342 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:52:15.517820 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:52:15.518347 [info ] [Thread-1 (]: 3 of 4 START test not_null_daily_avg_weather_trend_city_id ..................... [RUN]
[0m09:52:15.518922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372, now test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790)
[0m09:52:15.519343 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:52:15.524615 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:52:15.525548 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:52:15.528490 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:52:15.529581 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:52:15.529910 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_id
from openweather.analytics.daily_avg_weather_trend
where city_id is null



      
    ) dbt_internal_test
[0m09:52:15.530206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:15.963509 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.433 seconds
[0m09:52:15.969575 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: Close
[0m09:52:16.090111 [info ] [Thread-1 (]: 3 of 4 PASS not_null_daily_avg_weather_trend_city_id ........................... [[32mPASS[0m in 0.57s]
[0m09:52:16.090875 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:52:16.091305 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:52:16.091702 [info ] [Thread-1 (]: 4 of 4 START test not_null_daily_avg_weather_trend_weather_date ................ [RUN]
[0m09:52:16.092145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790, now test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b)
[0m09:52:16.092456 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:52:16.096408 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:52:16.097428 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:52:16.099910 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:52:16.100777 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:52:16.101058 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_date
from openweather.analytics.daily_avg_weather_trend
where weather_date is null



      
    ) dbt_internal_test
[0m09:52:16.101306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:16.633616 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.532 seconds
[0m09:52:16.639187 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: Close
[0m09:52:16.747092 [info ] [Thread-1 (]: 4 of 4 PASS not_null_daily_avg_weather_trend_weather_date ...................... [[32mPASS[0m in 0.65s]
[0m09:52:16.747994 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:52:16.749855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:16.750318 [debug] [MainThread]: Connection 'test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b' was properly closed.
[0m09:52:16.750695 [info ] [MainThread]: 
[0m09:52:16.751055 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 3.94 seconds (3.94s).
[0m09:52:16.752194 [debug] [MainThread]: Command end result
[0m09:52:16.779194 [info ] [MainThread]: 
[0m09:52:16.779476 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:52:16.779625 [info ] [MainThread]: 
[0m09:52:16.779780 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:52:16.780860 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.5837994, "process_in_blocks": "0", "process_kernel_time": 0.192712, "process_mem_max_rss": "145031168", "process_out_blocks": "0", "process_user_time": 1.580402}
[0m09:52:16.781208 [debug] [MainThread]: Command `dbt test` succeeded at 09:52:16.781145 after 4.58 seconds
[0m09:52:16.781437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101ed910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110139db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110138690>]}
[0m09:52:16.781666 [debug] [MainThread]: Flushing usage events
[0m09:53:39.738615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a78d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043a3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043a3b10>]}


============================== 09:53:39.741354 | 0706d016-38b4-4c5a-8371-6fb29144c7e5 ==============================
[0m09:53:39.741354 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:53:39.741694 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:53:39.919697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0706d016-38b4-4c5a-8371-6fb29144c7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10511a520>]}
[0m09:53:39.945095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0706d016-38b4-4c5a-8371-6fb29144c7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510c050>]}
[0m09:53:39.945663 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:53:40.002730 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:53:40.073698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:53:40.074016 [debug] [MainThread]: Partial parsing: added file: weather_dbt://tests/daily_avg_weather_test.sql
[0m09:53:40.133043 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.daily_avg_weather_test' (tests/daily_avg_weather_test.sql) depends on a node named 'daily_average_weather_trend' in package '' which was not found
[0m09:53:40.173226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0706d016-38b4-4c5a-8371-6fb29144c7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055dca50>]}
[0m09:53:40.277677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0706d016-38b4-4c5a-8371-6fb29144c7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059746e0>]}
[0m09:53:40.278024 [info ] [MainThread]: Found 5 models, 4 snapshots, 4 data tests, 2 sources, 459 macros
[0m09:53:40.278280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0706d016-38b4-4c5a-8371-6fb29144c7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105032b30>]}
[0m09:53:40.279279 [info ] [MainThread]: 
[0m09:53:40.279547 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:53:40.281818 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_snapshot'
[0m09:53:40.289692 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m09:53:40.289884 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m09:53:40.290011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:40.921070 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.631 seconds
[0m09:53:40.924718 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m09:53:41.039198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m09:53:41.042346 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m09:53:41.042791 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m09:53:41.043063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:53:41.564761 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.521 seconds
[0m09:53:41.568282 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m09:53:41.707037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0706d016-38b4-4c5a-8371-6fb29144c7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10596a8f0>]}
[0m09:53:41.708124 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:53:41.708555 [info ] [MainThread]: 
[0m09:53:41.711900 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:53:41.712461 [info ] [Thread-1 (]: 1 of 4 START test not_null_daily_avg_weather_trend_avg_humidity ................ [RUN]
[0m09:53:41.713000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07)
[0m09:53:41.713329 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:53:41.729138 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:53:41.730148 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:53:41.743791 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:53:41.744506 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:53:41.744745 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_humidity
from openweather.analytics.daily_avg_weather_trend
where avg_humidity is null



      
    ) dbt_internal_test
[0m09:53:41.744951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:42.195869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.450 seconds
[0m09:53:42.208875 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: Close
[0m09:53:42.327743 [info ] [Thread-1 (]: 1 of 4 PASS not_null_daily_avg_weather_trend_avg_humidity ...................... [[32mPASS[0m in 0.61s]
[0m09:53:42.328591 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:53:42.329077 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:53:42.329561 [info ] [Thread-1 (]: 2 of 4 START test not_null_daily_avg_weather_trend_avg_temp_fahrenheit ......... [RUN]
[0m09:53:42.330063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372)
[0m09:53:42.330421 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:53:42.334729 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:53:42.335758 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:53:42.338932 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:53:42.340114 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:53:42.340450 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp_fahrenheit
from openweather.analytics.daily_avg_weather_trend
where avg_temp_fahrenheit is null



      
    ) dbt_internal_test
[0m09:53:42.340745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:42.827718 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.486 seconds
[0m09:53:42.834948 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: Close
[0m09:53:42.973895 [info ] [Thread-1 (]: 2 of 4 PASS not_null_daily_avg_weather_trend_avg_temp_fahrenheit ............... [[32mPASS[0m in 0.64s]
[0m09:53:42.974673 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:53:42.975168 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:53:42.975716 [info ] [Thread-1 (]: 3 of 4 START test not_null_daily_avg_weather_trend_city_id ..................... [RUN]
[0m09:53:42.976335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372, now test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790)
[0m09:53:42.976754 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:53:42.981517 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:53:42.982550 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:53:42.985462 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:53:42.986912 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:53:42.987313 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_id
from openweather.analytics.daily_avg_weather_trend
where city_id is null



      
    ) dbt_internal_test
[0m09:53:42.987622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:43.607179 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.619 seconds
[0m09:53:43.611663 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: Close
[0m09:53:43.725792 [info ] [Thread-1 (]: 3 of 4 PASS not_null_daily_avg_weather_trend_city_id ........................... [[32mPASS[0m in 0.75s]
[0m09:53:43.726745 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:53:43.727333 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:53:43.727951 [info ] [Thread-1 (]: 4 of 4 START test not_null_daily_avg_weather_trend_weather_date ................ [RUN]
[0m09:53:43.728663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790, now test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b)
[0m09:53:43.729119 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:53:43.734773 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:53:43.735821 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:53:43.738168 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:53:43.739817 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:53:43.740490 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_date
from openweather.analytics.daily_avg_weather_trend
where weather_date is null



      
    ) dbt_internal_test
[0m09:53:43.741091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:44.198673 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.457 seconds
[0m09:53:44.205192 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: Close
[0m09:53:44.351783 [info ] [Thread-1 (]: 4 of 4 PASS not_null_daily_avg_weather_trend_weather_date ...................... [[32mPASS[0m in 0.62s]
[0m09:53:44.352733 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:53:44.354503 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:44.354911 [debug] [MainThread]: Connection 'test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b' was properly closed.
[0m09:53:44.355326 [info ] [MainThread]: 
[0m09:53:44.355694 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 4.08 seconds (4.08s).
[0m09:53:44.356827 [debug] [MainThread]: Command end result
[0m09:53:44.385092 [info ] [MainThread]: 
[0m09:53:44.385447 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:53:44.385650 [info ] [MainThread]: 
[0m09:53:44.385862 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:53:44.387029 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.6858783, "process_in_blocks": "0", "process_kernel_time": 0.233892, "process_mem_max_rss": "143605760", "process_out_blocks": "0", "process_user_time": 1.515474}
[0m09:53:44.387376 [debug] [MainThread]: Command `dbt test` succeeded at 09:53:44.387315 after 4.69 seconds
[0m09:53:44.387617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10415d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104375ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106714940>]}
[0m09:53:44.387837 [debug] [MainThread]: Flushing usage events
[0m09:54:06.287303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107158d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a5fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a5fb10>]}


============================== 09:54:06.289826 | 452c8212-01cd-4e3c-a7e8-7be1e6a98931 ==============================
[0m09:54:06.289826 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:54:06.290136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:54:06.464535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '452c8212-01cd-4e3c-a7e8-7be1e6a98931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c01a520>]}
[0m09:54:06.488869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '452c8212-01cd-4e3c-a7e8-7be1e6a98931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aefc050>]}
[0m09:54:06.489313 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:54:06.546207 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:54:06.621435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:54:06.621838 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://tests/daily_avg_weather_test.sql
[0m09:54:06.716814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '452c8212-01cd-4e3c-a7e8-7be1e6a98931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3d8a50>]}
[0m09:54:06.823259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '452c8212-01cd-4e3c-a7e8-7be1e6a98931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6706e0>]}
[0m09:54:06.823573 [info ] [MainThread]: Found 5 models, 4 snapshots, 5 data tests, 2 sources, 459 macros
[0m09:54:06.823740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '452c8212-01cd-4e3c-a7e8-7be1e6a98931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0a98d0>]}
[0m09:54:06.824874 [info ] [MainThread]: 
[0m09:54:06.825187 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:54:06.827731 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_analytics'
[0m09:54:06.835520 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m09:54:06.835713 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m09:54:06.835841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:07.362992 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.527 seconds
[0m09:54:07.367264 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m09:54:07.497679 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m09:54:07.502013 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m09:54:07.502454 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m09:54:07.502766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:54:07.954708 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.452 seconds
[0m09:54:07.958100 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m09:54:08.095815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '452c8212-01cd-4e3c-a7e8-7be1e6a98931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c666a90>]}
[0m09:54:08.097005 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:54:08.097444 [info ] [MainThread]: 
[0m09:54:08.100830 [debug] [Thread-1 (]: Began running node test.weather_dbt.daily_avg_weather_test
[0m09:54:08.101404 [info ] [Thread-1 (]: 1 of 5 START test daily_avg_weather_test ....................................... [RUN]
[0m09:54:08.101944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now test.weather_dbt.daily_avg_weather_test)
[0m09:54:08.102342 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.daily_avg_weather_test
[0m09:54:08.110016 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.daily_avg_weather_test"
[0m09:54:08.111461 [debug] [Thread-1 (]: Began executing node test.weather_dbt.daily_avg_weather_test
[0m09:54:08.129615 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.daily_avg_weather_test"
[0m09:54:08.130671 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.daily_avg_weather_test"
[0m09:54:08.131088 [debug] [Thread-1 (]: On test.weather_dbt.daily_avg_weather_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.daily_avg_weather_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT CITY_ID, WEATHER_DATE, COUNT(*)
FROM openweather.analytics.daily_avg_weather_trend
GROUP BY CITY_ID, WEATHER_DATE
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m09:54:08.131460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:08.821847 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m09:54:08.832404 [debug] [Thread-1 (]: On test.weather_dbt.daily_avg_weather_test: Close
[0m09:54:08.953193 [info ] [Thread-1 (]: 1 of 5 PASS daily_avg_weather_test ............................................. [[32mPASS[0m in 0.85s]
[0m09:54:08.954243 [debug] [Thread-1 (]: Finished running node test.weather_dbt.daily_avg_weather_test
[0m09:54:08.954866 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:54:08.955632 [info ] [Thread-1 (]: 2 of 5 START test not_null_daily_avg_weather_trend_avg_humidity ................ [RUN]
[0m09:54:08.956476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.daily_avg_weather_test, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07)
[0m09:54:08.956923 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:54:08.967879 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:54:08.968862 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:54:08.971417 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:54:08.972305 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:54:08.972667 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_humidity
from openweather.analytics.daily_avg_weather_trend
where avg_humidity is null



      
    ) dbt_internal_test
[0m09:54:08.972967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:09.411885 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.439 seconds
[0m09:54:09.414566 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: Close
[0m09:54:09.561837 [info ] [Thread-1 (]: 2 of 5 PASS not_null_daily_avg_weather_trend_avg_humidity ...................... [[32mPASS[0m in 0.61s]
[0m09:54:09.562446 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:54:09.562761 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:54:09.563074 [info ] [Thread-1 (]: 3 of 5 START test not_null_daily_avg_weather_trend_avg_temp_fahrenheit ......... [RUN]
[0m09:54:09.563445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372)
[0m09:54:09.563753 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:54:09.566686 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:54:09.567359 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:54:09.569630 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:54:09.570211 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:54:09.570437 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp_fahrenheit
from openweather.analytics.daily_avg_weather_trend
where avg_temp_fahrenheit is null



      
    ) dbt_internal_test
[0m09:54:09.570641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:10.009470 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.439 seconds
[0m09:54:10.013097 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: Close
[0m09:54:10.143489 [info ] [Thread-1 (]: 3 of 5 PASS not_null_daily_avg_weather_trend_avg_temp_fahrenheit ............... [[32mPASS[0m in 0.58s]
[0m09:54:10.144582 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:54:10.145175 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:54:10.145800 [info ] [Thread-1 (]: 4 of 5 START test not_null_daily_avg_weather_trend_city_id ..................... [RUN]
[0m09:54:10.146782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372, now test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790)
[0m09:54:10.147250 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:54:10.152271 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:54:10.153304 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:54:10.155346 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:54:10.156814 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:54:10.157351 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_id
from openweather.analytics.daily_avg_weather_trend
where city_id is null



      
    ) dbt_internal_test
[0m09:54:10.157783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:10.625461 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.464 seconds
[0m09:54:10.630862 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: Close
[0m09:54:10.749988 [info ] [Thread-1 (]: 4 of 5 PASS not_null_daily_avg_weather_trend_city_id ........................... [[32mPASS[0m in 0.60s]
[0m09:54:10.750808 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:54:10.751295 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:54:10.751801 [info ] [Thread-1 (]: 5 of 5 START test not_null_daily_avg_weather_trend_weather_date ................ [RUN]
[0m09:54:10.752375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790, now test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b)
[0m09:54:10.752796 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:54:10.758336 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:54:10.759416 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:54:10.761578 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:54:10.762976 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:54:10.763373 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_date
from openweather.analytics.daily_avg_weather_trend
where weather_date is null



      
    ) dbt_internal_test
[0m09:54:10.763676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:11.129171 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.365 seconds
[0m09:54:11.134336 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: Close
[0m09:54:11.260847 [info ] [Thread-1 (]: 5 of 5 PASS not_null_daily_avg_weather_trend_weather_date ...................... [[32mPASS[0m in 0.51s]
[0m09:54:11.261484 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:54:11.262776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:54:11.263068 [debug] [MainThread]: Connection 'test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b' was properly closed.
[0m09:54:11.263349 [info ] [MainThread]: 
[0m09:54:11.263602 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 4.44 seconds (4.44s).
[0m09:54:11.264569 [debug] [MainThread]: Command end result
[0m09:54:11.287469 [info ] [MainThread]: 
[0m09:54:11.287795 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:54:11.287987 [info ] [MainThread]: 
[0m09:54:11.288171 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m09:54:11.289254 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.0384827, "process_in_blocks": "0", "process_kernel_time": 0.23251, "process_mem_max_rss": "142622720", "process_out_blocks": "0", "process_user_time": 1.553336}
[0m09:54:11.289570 [debug] [MainThread]: Command `dbt test` succeeded at 09:54:11.289513 after 5.04 seconds
[0m09:54:11.289786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108815910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb14680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb15650>]}
[0m09:54:11.289990 [debug] [MainThread]: Flushing usage events
[0m09:55:19.097488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107140d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a43d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a43b10>]}


============================== 09:55:19.099875 | 86b99e56-8eeb-4f6a-b1e4-219d1f233193 ==============================
[0m09:55:19.099875 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:55:19.100208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:55:19.275441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86b99e56-8eeb-4f6a-b1e4-219d1f233193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097fa520>]}
[0m09:55:19.301040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86b99e56-8eeb-4f6a-b1e4-219d1f233193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096fc050>]}
[0m09:55:19.301544 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:55:19.359245 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:55:19.437617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:55:19.438053 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://tests/daily_avg_weather_test.sql
[0m09:55:19.532986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86b99e56-8eeb-4f6a-b1e4-219d1f233193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cd8a50>]}
[0m09:55:19.637762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86b99e56-8eeb-4f6a-b1e4-219d1f233193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f706e0>]}
[0m09:55:19.638076 [info ] [MainThread]: Found 5 models, 4 snapshots, 5 data tests, 2 sources, 459 macros
[0m09:55:19.638252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86b99e56-8eeb-4f6a-b1e4-219d1f233193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109636b30>]}
[0m09:55:19.639307 [info ] [MainThread]: 
[0m09:55:19.639596 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:55:19.641861 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_snapshot'
[0m09:55:19.649785 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m09:55:19.650010 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m09:55:19.650144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:20.300808 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.650 seconds
[0m09:55:20.305497 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m09:55:20.433026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m09:55:20.436206 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m09:55:20.436539 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m09:55:20.436804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:55:20.938757 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.501 seconds
[0m09:55:20.945801 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m09:55:21.089917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86b99e56-8eeb-4f6a-b1e4-219d1f233193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e03ba0>]}
[0m09:55:21.090609 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:55:21.090868 [info ] [MainThread]: 
[0m09:55:21.093301 [debug] [Thread-1 (]: Began running node test.weather_dbt.daily_avg_weather_test
[0m09:55:21.093810 [info ] [Thread-1 (]: 1 of 5 START test daily_avg_weather_test ....................................... [RUN]
[0m09:55:21.094336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now test.weather_dbt.daily_avg_weather_test)
[0m09:55:21.094723 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.daily_avg_weather_test
[0m09:55:21.104546 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.daily_avg_weather_test"
[0m09:55:21.105511 [debug] [Thread-1 (]: Began executing node test.weather_dbt.daily_avg_weather_test
[0m09:55:21.123536 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.daily_avg_weather_test"
[0m09:55:21.124860 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.daily_avg_weather_test"
[0m09:55:21.125155 [debug] [Thread-1 (]: On test.weather_dbt.daily_avg_weather_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.daily_avg_weather_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- duplicate record test
SELECT CITY_ID, WEATHER_DATE, COUNT(*)
FROM openweather.analytics.daily_avg_weather_trend
GROUP BY CITY_ID, WEATHER_DATE
HAVING COUNT(*) > 1

-- temperature range
SELECT *
FROM openweather.analytics.daily_avg_weather_trend
WHERE AVG_TEMP_FAHRENHEIT < -50 OR AVG_TEMP_FAHRENHEIT > 130

-- humidity range
SELECT *
FROM openweather.analytics.daily_avg_weather_trend
WHERE AVG_HUMIDITY < 0 OR AVG_HUMIDITY > 100
      
    ) dbt_internal_test
[0m09:55:21.125407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:21.653905 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89cb3-0004-3867-0002-594300035fae
[0m09:55:21.654662 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected 'SELECT'.
syntax error line 18 at position 0 unexpected 'SELECT'.
syntax error line 22 at position 4 unexpected ')'.
[0m09:55:21.655267 [debug] [Thread-1 (]: On test.weather_dbt.daily_avg_weather_test: Close
[0m09:55:21.771845 [debug] [Thread-1 (]: Database Error in test daily_avg_weather_test (tests/daily_avg_weather_test.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected 'SELECT'.
  syntax error line 18 at position 0 unexpected 'SELECT'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target/run/weather_dbt/tests/daily_avg_weather_test.sql
[0m09:55:21.772382 [error] [Thread-1 (]: 1 of 5 ERROR daily_avg_weather_test ............................................ [[31mERROR[0m in 0.68s]
[0m09:55:21.772855 [debug] [Thread-1 (]: Finished running node test.weather_dbt.daily_avg_weather_test
[0m09:55:21.773193 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:55:21.774073 [info ] [Thread-1 (]: 2 of 5 START test not_null_daily_avg_weather_trend_avg_humidity ................ [RUN]
[0m09:55:21.774435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.daily_avg_weather_test, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07)
[0m09:55:21.774679 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:55:21.781819 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:55:21.782499 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:55:21.784361 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:55:21.784966 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:55:21.785197 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_humidity
from openweather.analytics.daily_avg_weather_trend
where avg_humidity is null



      
    ) dbt_internal_test
[0m09:55:21.785403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:22.302209 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.516 seconds
[0m09:55:22.317834 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: Close
[0m09:55:22.486076 [info ] [Thread-1 (]: 2 of 5 PASS not_null_daily_avg_weather_trend_avg_humidity ...................... [[32mPASS[0m in 0.71s]
[0m09:55:22.487836 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:55:22.488515 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:55:22.489345 [info ] [Thread-1 (]: 3 of 5 START test not_null_daily_avg_weather_trend_avg_temp_fahrenheit ......... [RUN]
[0m09:55:22.490165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372)
[0m09:55:22.490707 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:55:22.496138 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:55:22.497260 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:55:22.501458 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:55:22.502708 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:55:22.503143 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp_fahrenheit
from openweather.analytics.daily_avg_weather_trend
where avg_temp_fahrenheit is null



      
    ) dbt_internal_test
[0m09:55:22.503491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:22.978710 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.474 seconds
[0m09:55:22.984032 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: Close
[0m09:55:23.124184 [info ] [Thread-1 (]: 3 of 5 PASS not_null_daily_avg_weather_trend_avg_temp_fahrenheit ............... [[32mPASS[0m in 0.63s]
[0m09:55:23.125601 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:55:23.126000 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:55:23.126388 [info ] [Thread-1 (]: 4 of 5 START test not_null_daily_avg_weather_trend_city_id ..................... [RUN]
[0m09:55:23.126830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372, now test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790)
[0m09:55:23.127113 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:55:23.130973 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:55:23.131916 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:55:23.133998 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:55:23.140284 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:55:23.140672 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_id
from openweather.analytics.daily_avg_weather_trend
where city_id is null



      
    ) dbt_internal_test
[0m09:55:23.140938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:23.618757 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.478 seconds
[0m09:55:23.620998 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: Close
[0m09:55:23.791181 [info ] [Thread-1 (]: 4 of 5 PASS not_null_daily_avg_weather_trend_city_id ........................... [[32mPASS[0m in 0.66s]
[0m09:55:23.792579 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:55:23.793016 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:55:23.793433 [info ] [Thread-1 (]: 5 of 5 START test not_null_daily_avg_weather_trend_weather_date ................ [RUN]
[0m09:55:23.793923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790, now test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b)
[0m09:55:23.794213 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:55:23.798391 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:55:23.799288 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:55:23.801091 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:55:23.801888 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:55:23.802138 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_date
from openweather.analytics.daily_avg_weather_trend
where weather_date is null



      
    ) dbt_internal_test
[0m09:55:23.802360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:24.229871 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.427 seconds
[0m09:55:24.237147 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: Close
[0m09:55:24.368624 [info ] [Thread-1 (]: 5 of 5 PASS not_null_daily_avg_weather_trend_weather_date ...................... [[32mPASS[0m in 0.57s]
[0m09:55:24.369988 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:55:24.371185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:55:24.371391 [debug] [MainThread]: Connection 'test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b' was properly closed.
[0m09:55:24.371614 [info ] [MainThread]: 
[0m09:55:24.371833 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 4.73 seconds (4.73s).
[0m09:55:24.372578 [debug] [MainThread]: Command end result
[0m09:55:24.391013 [info ] [MainThread]: 
[0m09:55:24.391290 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:55:24.391446 [info ] [MainThread]: 
[0m09:55:24.391655 [error] [MainThread]:   Database Error in test daily_avg_weather_test (tests/daily_avg_weather_test.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected 'SELECT'.
  syntax error line 18 at position 0 unexpected 'SELECT'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target/run/weather_dbt/tests/daily_avg_weather_test.sql
[0m09:55:24.391917 [info ] [MainThread]: 
[0m09:55:24.392120 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m09:55:24.393062 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 5.330937, "process_in_blocks": "0", "process_kernel_time": 0.233696, "process_mem_max_rss": "143130624", "process_out_blocks": "0", "process_user_time": 1.603361}
[0m09:55:24.393343 [debug] [MainThread]: Command `dbt test` failed at 09:55:24.393297 after 5.33 seconds
[0m09:55:24.393534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087fd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac59c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac59440>]}
[0m09:55:24.393708 [debug] [MainThread]: Flushing usage events
[0m09:56:58.056153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7dbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7dbb10>]}


============================== 09:56:58.058507 | 38c63dae-d05b-409d-a195-7256160dc443 ==============================
[0m09:56:58.058507 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:56:58.058825 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:56:58.222873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38c63dae-d05b-409d-a195-7256160dc443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b58a520>]}
[0m09:56:58.245421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38c63dae-d05b-409d-a195-7256160dc443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4fc050>]}
[0m09:56:58.245840 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:56:58.301122 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:56:58.374687 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 0 files changed.
[0m09:56:58.375026 [debug] [MainThread]: Partial parsing: added file: weather_dbt://tests/humidity_range_daily_avg.sql
[0m09:56:58.375177 [debug] [MainThread]: Partial parsing: added file: weather_dbt://tests/duplication_record_test_daily_avg.sql
[0m09:56:58.375310 [debug] [MainThread]: Partial parsing: added file: weather_dbt://tests/temp_range_daily_avg.sql
[0m09:56:58.375425 [debug] [MainThread]: Partial parsing: deleted file: weather_dbt://tests/daily_avg_weather_test.sql
[0m09:56:58.465323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38c63dae-d05b-409d-a195-7256160dc443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bad9150>]}
[0m09:56:58.561281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38c63dae-d05b-409d-a195-7256160dc443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd246e0>]}
[0m09:56:58.561545 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m09:56:58.561705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38c63dae-d05b-409d-a195-7256160dc443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b573af0>]}
[0m09:56:58.562685 [info ] [MainThread]: 
[0m09:56:58.562950 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:56:58.565095 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_analytics'
[0m09:56:58.572675 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m09:56:58.572907 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m09:56:58.573040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:59.227989 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.655 seconds
[0m09:56:59.232333 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m09:56:59.360044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m09:56:59.364146 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m09:56:59.364549 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m09:56:59.364865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:56:59.898040 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.533 seconds
[0m09:56:59.899321 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m09:57:00.196717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38c63dae-d05b-409d-a195-7256160dc443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd02dd0>]}
[0m09:57:00.197856 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:57:00.198317 [info ] [MainThread]: 
[0m09:57:00.201376 [debug] [Thread-1 (]: Began running node test.weather_dbt.duplication_record_test_daily_avg
[0m09:57:00.201847 [info ] [Thread-1 (]: 1 of 7 START test duplication_record_test_daily_avg ............................ [RUN]
[0m09:57:00.202333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now test.weather_dbt.duplication_record_test_daily_avg)
[0m09:57:00.202702 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.duplication_record_test_daily_avg
[0m09:57:00.210963 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.duplication_record_test_daily_avg"
[0m09:57:00.212710 [debug] [Thread-1 (]: Began executing node test.weather_dbt.duplication_record_test_daily_avg
[0m09:57:00.231365 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.duplication_record_test_daily_avg"
[0m09:57:00.232271 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.duplication_record_test_daily_avg"
[0m09:57:00.232541 [debug] [Thread-1 (]: On test.weather_dbt.duplication_record_test_daily_avg: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.duplication_record_test_daily_avg"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- duplicate record test
SELECT CITY_ID, WEATHER_DATE, COUNT(*)
FROM openweather.analytics.daily_avg_weather_trend
GROUP BY CITY_ID, WEATHER_DATE
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m09:57:00.232773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:00.739597 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.506 seconds
[0m09:57:00.758936 [debug] [Thread-1 (]: On test.weather_dbt.duplication_record_test_daily_avg: Close
[0m09:57:00.880897 [info ] [Thread-1 (]: 1 of 7 PASS duplication_record_test_daily_avg .................................. [[32mPASS[0m in 0.68s]
[0m09:57:00.881853 [debug] [Thread-1 (]: Finished running node test.weather_dbt.duplication_record_test_daily_avg
[0m09:57:00.882443 [debug] [Thread-1 (]: Began running node test.weather_dbt.humidity_range_daily_avg
[0m09:57:00.883076 [info ] [Thread-1 (]: 2 of 7 START test humidity_range_daily_avg ..................................... [RUN]
[0m09:57:00.883756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.duplication_record_test_daily_avg, now test.weather_dbt.humidity_range_daily_avg)
[0m09:57:00.884220 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.humidity_range_daily_avg
[0m09:57:00.887390 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.humidity_range_daily_avg"
[0m09:57:00.888345 [debug] [Thread-1 (]: Began executing node test.weather_dbt.humidity_range_daily_avg
[0m09:57:00.891686 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.humidity_range_daily_avg"
[0m09:57:00.892708 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.humidity_range_daily_avg"
[0m09:57:00.893382 [debug] [Thread-1 (]: On test.weather_dbt.humidity_range_daily_avg: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.humidity_range_daily_avg"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- humidity range
SELECT *
FROM openweather.analytics.daily_avg_weather_trend
WHERE AVG_HUMIDITY < 0 OR AVG_HUMIDITY > 100
      
    ) dbt_internal_test
[0m09:57:00.893994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:02.257594 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.362 seconds
[0m09:57:02.265042 [debug] [Thread-1 (]: On test.weather_dbt.humidity_range_daily_avg: Close
[0m09:57:02.377511 [info ] [Thread-1 (]: 2 of 7 PASS humidity_range_daily_avg ........................................... [[32mPASS[0m in 1.49s]
[0m09:57:02.378609 [debug] [Thread-1 (]: Finished running node test.weather_dbt.humidity_range_daily_avg
[0m09:57:02.379234 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:57:02.379830 [info ] [Thread-1 (]: 3 of 7 START test not_null_daily_avg_weather_trend_avg_humidity ................ [RUN]
[0m09:57:02.380428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.humidity_range_daily_avg, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07)
[0m09:57:02.380838 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:57:02.393061 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:57:02.394065 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:57:02.402486 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:57:02.403614 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:57:02.403929 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_humidity
from openweather.analytics.daily_avg_weather_trend
where avg_humidity is null



      
    ) dbt_internal_test
[0m09:57:02.404197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:02.834423 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.430 seconds
[0m09:57:02.840810 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: Close
[0m09:57:02.979477 [info ] [Thread-1 (]: 3 of 7 PASS not_null_daily_avg_weather_trend_avg_humidity ...................... [[32mPASS[0m in 0.60s]
[0m09:57:02.981903 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:57:02.982998 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:57:02.983624 [info ] [Thread-1 (]: 4 of 7 START test not_null_daily_avg_weather_trend_avg_temp_fahrenheit ......... [RUN]
[0m09:57:02.984193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372)
[0m09:57:02.984674 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:57:02.990516 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:57:02.991564 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:57:02.994494 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:57:02.995571 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:57:02.995932 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp_fahrenheit
from openweather.analytics.daily_avg_weather_trend
where avg_temp_fahrenheit is null



      
    ) dbt_internal_test
[0m09:57:02.996246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:03.426377 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.430 seconds
[0m09:57:03.431214 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: Close
[0m09:57:03.585749 [info ] [Thread-1 (]: 4 of 7 PASS not_null_daily_avg_weather_trend_avg_temp_fahrenheit ............... [[32mPASS[0m in 0.60s]
[0m09:57:03.587472 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:57:03.588060 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:57:03.588602 [info ] [Thread-1 (]: 5 of 7 START test not_null_daily_avg_weather_trend_city_id ..................... [RUN]
[0m09:57:03.589173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372, now test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790)
[0m09:57:03.589563 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:57:03.594108 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:57:03.594924 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:57:03.596700 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:57:03.597503 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:57:03.597809 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_id
from openweather.analytics.daily_avg_weather_trend
where city_id is null



      
    ) dbt_internal_test
[0m09:57:03.598078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:04.031091 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.432 seconds
[0m09:57:04.035647 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: Close
[0m09:57:04.154380 [info ] [Thread-1 (]: 5 of 7 PASS not_null_daily_avg_weather_trend_city_id ........................... [[32mPASS[0m in 0.57s]
[0m09:57:04.155101 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:57:04.155442 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:57:04.155815 [info ] [Thread-1 (]: 6 of 7 START test not_null_daily_avg_weather_trend_weather_date ................ [RUN]
[0m09:57:04.156213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790, now test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b)
[0m09:57:04.156501 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:57:04.160082 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:57:04.160935 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:57:04.162642 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:57:04.163435 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:57:04.163671 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_date
from openweather.analytics.daily_avg_weather_trend
where weather_date is null



      
    ) dbt_internal_test
[0m09:57:04.163884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:04.641858 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.477 seconds
[0m09:57:04.646319 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: Close
[0m09:57:04.789923 [info ] [Thread-1 (]: 6 of 7 PASS not_null_daily_avg_weather_trend_weather_date ...................... [[32mPASS[0m in 0.63s]
[0m09:57:04.790666 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:57:04.791089 [debug] [Thread-1 (]: Began running node test.weather_dbt.temp_range_daily_avg
[0m09:57:04.791418 [info ] [Thread-1 (]: 7 of 7 START test temp_range_daily_avg ......................................... [RUN]
[0m09:57:04.791904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b, now test.weather_dbt.temp_range_daily_avg)
[0m09:57:04.792321 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.temp_range_daily_avg
[0m09:57:04.794924 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.temp_range_daily_avg"
[0m09:57:04.795641 [debug] [Thread-1 (]: Began executing node test.weather_dbt.temp_range_daily_avg
[0m09:57:04.797507 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.temp_range_daily_avg"
[0m09:57:04.798361 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.temp_range_daily_avg"
[0m09:57:04.798651 [debug] [Thread-1 (]: On test.weather_dbt.temp_range_daily_avg: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.temp_range_daily_avg"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- temperature range
SELECT *
FROM openweather.analytics.daily_avg_weather_trend
WHERE AVG_TEMP_FAHRENHEIT < -50 OR AVG_TEMP_FAHRENHEIT > 130
      
    ) dbt_internal_test
[0m09:57:04.798911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:05.434577 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.635 seconds
[0m09:57:05.438719 [debug] [Thread-1 (]: On test.weather_dbt.temp_range_daily_avg: Close
[0m09:57:05.571608 [info ] [Thread-1 (]: 7 of 7 PASS temp_range_daily_avg ............................................... [[32mPASS[0m in 0.78s]
[0m09:57:05.573049 [debug] [Thread-1 (]: Finished running node test.weather_dbt.temp_range_daily_avg
[0m09:57:05.574225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:05.574449 [debug] [MainThread]: Connection 'test.weather_dbt.temp_range_daily_avg' was properly closed.
[0m09:57:05.574682 [info ] [MainThread]: 
[0m09:57:05.574899 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 7.01 seconds (7.01s).
[0m09:57:05.575855 [debug] [MainThread]: Command end result
[0m09:57:05.595305 [info ] [MainThread]: 
[0m09:57:05.595610 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:57:05.595786 [info ] [MainThread]: 
[0m09:57:05.595960 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m09:57:05.596923 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.5727005, "process_in_blocks": "0", "process_kernel_time": 0.232196, "process_mem_max_rss": "141000704", "process_out_blocks": "0", "process_user_time": 1.713725}
[0m09:57:05.597202 [debug] [MainThread]: Command `dbt test` succeeded at 09:57:05.597151 after 7.57 seconds
[0m09:57:05.597389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3cd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb15c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb15390>]}
[0m09:57:05.597565 [debug] [MainThread]: Flushing usage events
[0m09:58:22.103339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d9cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10469fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10469fb10>]}


============================== 09:58:22.105659 | cc4eca8c-99bc-4812-b7d8-afb4713804fa ==============================
[0m09:58:22.105659 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:58:22.105973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:58:22.154107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc4eca8c-99bc-4812-b7d8-afb4713804fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10350b360>]}
[0m09:58:22.162787 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.091598295, "process_in_blocks": "0", "process_kernel_time": 0.093859, "process_mem_max_rss": "97206272", "process_out_blocks": "0", "process_user_time": 0.607778}
[0m09:58:22.163088 [debug] [MainThread]: Command `dbt clean` succeeded at 09:58:22.163035 after 0.09 seconds
[0m09:58:22.163257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ca580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ca690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104432950>]}
[0m09:58:22.163407 [debug] [MainThread]: Flushing usage events
[0m15:04:05.850199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107344d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c4bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c4bb10>]}


============================== 15:04:05.853152 | 1e67fb9c-844f-45cf-90e0-3bae3d161fe0 ==============================
[0m15:04:05.853152 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:04:05.853464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m15:04:05.905712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e67fb9c-844f-45cf-90e0-3bae3d161fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ab3360>]}
[0m15:04:05.915900 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.11942987, "process_in_blocks": "0", "process_kernel_time": 0.140813, "process_mem_max_rss": "98189312", "process_out_blocks": "0", "process_user_time": 0.614283}
[0m15:04:05.916184 [debug] [MainThread]: Command `dbt clean` succeeded at 15:04:05.916137 after 0.12 seconds
[0m15:04:05.916352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a02580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a02690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089da950>]}
[0m15:04:05.916515 [debug] [MainThread]: Flushing usage events
