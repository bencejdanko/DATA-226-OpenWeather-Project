[0m23:16:53.064798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030a8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049d3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049d3d90>]}


============================== 23:16:53.067911 | d5af214c-91f6-430e-b5bc-961c3c148280 ==============================
[0m23:16:53.067911 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:16:53.068258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:16:53.291029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5af214c-91f6-430e-b5bc-961c3c148280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10562a520>]}
[0m23:16:53.314448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5af214c-91f6-430e-b5bc-961c3c148280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105524050>]}
[0m23:16:53.315030 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:16:53.382870 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:16:53.383366 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:16:53.383531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd5af214c-91f6-430e-b5bc-961c3c148280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054a4a50>]}
[0m23:16:53.798060 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.weather_dbt.openweather_join' (models/openweather_join.sql) depends on a node named 'WEATHER_FACT_TABLE' which was not found
[0m23:16:53.799931 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.77425057, "process_in_blocks": "0", "process_kernel_time": 0.209961, "process_mem_max_rss": "125304832", "process_out_blocks": "0", "process_user_time": 1.165652}
[0m23:16:53.800239 [debug] [MainThread]: Command `dbt run` failed at 23:16:53.800186 after 0.77 seconds
[0m23:16:53.800414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10582d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10582d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049dbe70>]}
[0m23:16:53.800576 [debug] [MainThread]: Flushing usage events
[0m23:18:18.035059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110098d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113adbb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113adbd90>]}


============================== 23:18:18.038131 | 7c0f7e30-9223-4124-a035-c0c934c74b67 ==============================
[0m23:18:18.038131 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:18:18.038451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:18:18.259083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c0f7e30-9223-4124-a035-c0c934c74b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114916520>]}
[0m23:18:18.282769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c0f7e30-9223-4124-a035-c0c934c74b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147f4050>]}
[0m23:18:18.283383 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:18:18.356710 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:18:18.357205 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:18:18.357373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7c0f7e30-9223-4124-a035-c0c934c74b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11476ca50>]}
[0m23:18:18.828867 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.weather_dbt.openweather_join' (models/input/openweather_join.sql) depends on a node named 'WEATHER_FACT_TABLE' which was not found
[0m23:18:18.832303 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8348069, "process_in_blocks": "0", "process_kernel_time": 0.209025, "process_mem_max_rss": "127107072", "process_out_blocks": "0", "process_user_time": 1.206207}
[0m23:18:18.832585 [debug] [MainThread]: Command `dbt run` failed at 23:18:18.832536 after 0.84 seconds
[0m23:18:18.832759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c1b200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c1bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ae3e70>]}
[0m23:18:18.832905 [debug] [MainThread]: Flushing usage events
[0m23:18:56.613307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ea8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d3d90>]}


============================== 23:18:56.615729 | 9f95813e-ed13-4b22-8194-10b43c7786d8 ==============================
[0m23:18:56.615729 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:18:56.616035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:18:56.792912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f95813e-ed13-4b22-8194-10b43c7786d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10542a520>]}
[0m23:18:56.816570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f95813e-ed13-4b22-8194-10b43c7786d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105324050>]}
[0m23:18:56.817126 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:18:56.876904 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:18:56.877410 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:18:56.877579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9f95813e-ed13-4b22-8194-10b43c7786d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052a0a50>]}
[0m23:18:57.370383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f95813e-ed13-4b22-8194-10b43c7786d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105276a80>]}
[0m23:18:57.413635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f95813e-ed13-4b22-8194-10b43c7786d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10563ab30>]}
[0m23:18:57.413917 [info ] [MainThread]: Found 1 model, 2 sources, 459 macros
[0m23:18:57.414071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f95813e-ed13-4b22-8194-10b43c7786d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105624870>]}
[0m23:18:57.415155 [info ] [MainThread]: 
[0m23:18:57.415418 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:18:57.415823 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:18:57.421863 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:18:57.422010 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:18:57.422133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:58.518554 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.096 seconds
[0m23:18:58.522394 [debug] [ThreadPool]: On list_openweather: Close
[0m23:18:58.709413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:18:58.720358 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:18:58.720710 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:18:58.720983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:18:59.192967 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.472 seconds
[0m23:18:59.196700 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:18:59.325372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f95813e-ed13-4b22-8194-10b43c7786d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059eb110>]}
[0m23:18:59.326299 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:18:59.326651 [info ] [MainThread]: 
[0m23:18:59.331303 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:18:59.331905 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:18:59.332358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.openweather_join)
[0m23:18:59.332703 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:18:59.340858 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:18:59.342089 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:18:59.363449 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:18:59.364564 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:18:59.364819 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    

SELECT
    w.CITY_ID,
    c.Name AS CITY_NAME,
    w.DATE_TIME,
    w.TEMP,
    w.FEELS_LIKE,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM 
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN 
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON 
    w.CITY_ID = c.CITY_ID
  );
[0m23:18:59.365027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:59.879417 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a36-0004-3867-0002-59430003563e
[0m23:18:59.880146 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 4
invalid identifier 'C.NAME'
[0m23:18:59.880720 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:19:00.023588 [debug] [Thread-1 (]: Database Error in model openweather_join (models/input/openweather_join.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'C.NAME'
  compiled code at target/run/weather_dbt/models/input/openweather_join.sql
[0m23:19:00.024921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f95813e-ed13-4b22-8194-10b43c7786d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b59860>]}
[0m23:19:00.025420 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics.openweather_join ................ [[31mERROR[0m in 0.69s]
[0m23:19:00.025880 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:19:00.027200 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:19:00.027441 [debug] [MainThread]: Connection 'model.weather_dbt.openweather_join' was properly closed.
[0m23:19:00.027666 [info ] [MainThread]: 
[0m23:19:00.027884 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.61 seconds (2.61s).
[0m23:19:00.028354 [debug] [MainThread]: Command end result
[0m23:19:00.047433 [info ] [MainThread]: 
[0m23:19:00.047703 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:19:00.047876 [info ] [MainThread]: 
[0m23:19:00.048096 [error] [MainThread]:   Database Error in model openweather_join (models/input/openweather_join.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'C.NAME'
  compiled code at target/run/weather_dbt/models/input/openweather_join.sql
[0m23:19:00.048261 [info ] [MainThread]: 
[0m23:19:00.048427 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:19:00.050194 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.4708219, "process_in_blocks": "0", "process_kernel_time": 0.261096, "process_mem_max_rss": "142065664", "process_out_blocks": "0", "process_user_time": 1.614037}
[0m23:19:00.050535 [debug] [MainThread]: Command `dbt run` failed at 23:19:00.050476 after 3.47 seconds
[0m23:19:00.050744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b831b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bc3ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105931a50>]}
[0m23:19:00.050938 [debug] [MainThread]: Flushing usage events
[0m23:19:31.320294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd3d90>]}


============================== 23:19:31.322809 | 91a441e8-0a26-42a7-a741-b4d8d953748d ==============================
[0m23:19:31.322809 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:19:31.323143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:19:31.498736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91a441e8-0a26-42a7-a741-b4d8d953748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10792a520>]}
[0m23:19:31.523326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91a441e8-0a26-42a7-a741-b4d8d953748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782c050>]}
[0m23:19:31.523818 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:19:31.580224 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:19:31.634984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:19:31.635346 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/input/openweather_join.sql
[0m23:19:31.736140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91a441e8-0a26-42a7-a741-b4d8d953748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a3250>]}
[0m23:19:31.776284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91a441e8-0a26-42a7-a741-b4d8d953748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb8140>]}
[0m23:19:31.776601 [info ] [MainThread]: Found 1 model, 2 sources, 459 macros
[0m23:19:31.776775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91a441e8-0a26-42a7-a741-b4d8d953748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce0590>]}
[0m23:19:31.777667 [info ] [MainThread]: 
[0m23:19:31.777983 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:19:31.778433 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:19:31.784874 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:19:31.785077 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:19:31.785207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:32.437911 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.653 seconds
[0m23:19:32.439586 [debug] [ThreadPool]: On list_openweather: Close
[0m23:19:32.560851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:19:32.571795 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:19:32.572154 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:19:32.572410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:19:33.106466 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.534 seconds
[0m23:19:33.109223 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:19:33.260783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91a441e8-0a26-42a7-a741-b4d8d953748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c88c80>]}
[0m23:19:33.261448 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:19:33.261725 [info ] [MainThread]: 
[0m23:19:33.264080 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:19:33.264683 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:19:33.265117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.openweather_join)
[0m23:19:33.265392 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:19:33.272779 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:19:33.273606 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:19:33.296718 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:19:33.297774 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:19:33.298079 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c.Name AS CITY_NAME,
    w.DATE_TIME,
    w.TEMP,
    w.FEELS_LIKE,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM 
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN 
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON 
    w.CITY_ID = c.CITY_ID
  );
[0m23:19:33.298328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:19:33.826582 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a37-0004-386b-0002-59430003b61e
[0m23:19:33.827406 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 4
invalid identifier 'C.NAME'
[0m23:19:33.828054 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:19:33.966364 [debug] [Thread-1 (]: Database Error in model openweather_join (models/input/openweather_join.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'C.NAME'
  compiled code at target/run/weather_dbt/models/input/openweather_join.sql
[0m23:19:33.968320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91a441e8-0a26-42a7-a741-b4d8d953748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb8d10>]}
[0m23:19:33.969101 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics.openweather_join ................ [[31mERROR[0m in 0.70s]
[0m23:19:33.969712 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:19:33.971923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:19:33.972263 [debug] [MainThread]: Connection 'model.weather_dbt.openweather_join' was properly closed.
[0m23:19:33.972529 [info ] [MainThread]: 
[0m23:19:33.972780 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m23:19:33.973346 [debug] [MainThread]: Command end result
[0m23:19:33.993930 [info ] [MainThread]: 
[0m23:19:33.994272 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:19:33.994494 [info ] [MainThread]: 
[0m23:19:33.994759 [error] [MainThread]:   Database Error in model openweather_join (models/input/openweather_join.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'C.NAME'
  compiled code at target/run/weather_dbt/models/input/openweather_join.sql
[0m23:19:33.994965 [info ] [MainThread]: 
[0m23:19:33.995201 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:19:33.996410 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.7121155, "process_in_blocks": "0", "process_kernel_time": 0.207388, "process_mem_max_rss": "141279232", "process_out_blocks": "0", "process_user_time": 1.228307}
[0m23:19:33.996728 [debug] [MainThread]: Command `dbt run` failed at 23:19:33.996672 after 2.71 seconds
[0m23:19:33.996933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe8680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f9f7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f9ff70>]}
[0m23:19:33.997120 [debug] [MainThread]: Flushing usage events
[0m23:20:25.303495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024c4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103defb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103defd90>]}


============================== 23:20:25.305935 | 2a79df66-1299-488b-a501-de3a0373d652 ==============================
[0m23:20:25.305935 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:20:25.306239 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:20:25.484752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a79df66-1299-488b-a501-de3a0373d652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c82520>]}
[0m23:20:25.509968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a79df66-1299-488b-a501-de3a0373d652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf0050>]}
[0m23:20:25.510568 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:20:25.568444 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:20:25.621285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:20:25.621625 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/input/openweather_join.sql
[0m23:20:25.726141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a79df66-1299-488b-a501-de3a0373d652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b6f250>]}
[0m23:20:25.772960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a79df66-1299-488b-a501-de3a0373d652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b43c50>]}
[0m23:20:25.773263 [info ] [MainThread]: Found 1 model, 2 sources, 459 macros
[0m23:20:25.773433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a79df66-1299-488b-a501-de3a0373d652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10503c2f0>]}
[0m23:20:25.774641 [info ] [MainThread]: 
[0m23:20:25.775068 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:20:25.775717 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:20:25.782725 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:20:25.782947 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:20:25.783083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:20:26.387975 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.604 seconds
[0m23:20:26.391289 [debug] [ThreadPool]: On list_openweather: Close
[0m23:20:26.506673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:20:26.515384 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:20:26.515644 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:20:26.515830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:20:27.033357 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.517 seconds
[0m23:20:27.036331 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:20:27.158867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a79df66-1299-488b-a501-de3a0373d652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe4c80>]}
[0m23:20:27.159730 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:20:27.160151 [info ] [MainThread]: 
[0m23:20:27.164616 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:20:27.165221 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:20:27.165676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.openweather_join)
[0m23:20:27.166056 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:20:27.174339 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:20:27.175211 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:20:27.197826 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:20:27.198766 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:20:27.199029 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,  -- Use quotes for case-sensitive column names
    w.DATE_TIME,
    w.TEMP,
    w.FEELS_LIKE,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM 
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN 
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON 
    w.CITY_ID = c.CITY_ID
  );
[0m23:20:27.199270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:20:27.806933 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.607 seconds
[0m23:20:27.834216 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:20:27.960195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a79df66-1299-488b-a501-de3a0373d652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054a5190>]}
[0m23:20:27.961439 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.79s]
[0m23:20:27.962153 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:20:27.963660 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:20:27.963914 [debug] [MainThread]: Connection 'model.weather_dbt.openweather_join' was properly closed.
[0m23:20:27.964150 [info ] [MainThread]: 
[0m23:20:27.964360 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m23:20:27.964846 [debug] [MainThread]: Command end result
[0m23:20:27.987412 [info ] [MainThread]: 
[0m23:20:27.987756 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:20:27.987955 [info ] [MainThread]: 
[0m23:20:27.988162 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:20:27.989890 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.720691, "process_in_blocks": "0", "process_kernel_time": 0.20967, "process_mem_max_rss": "138559488", "process_out_blocks": "0", "process_user_time": 1.269377}
[0m23:20:27.990234 [debug] [MainThread]: Command `dbt run` succeeded at 23:20:27.990173 after 2.72 seconds
[0m23:20:27.990447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054d0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3ddb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3e8f0>]}
[0m23:20:27.990651 [debug] [MainThread]: Flushing usage events
[0m23:26:16.536826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111813b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111813d90>]}


============================== 23:26:16.539829 | 9bd3d72d-cac7-4a2f-a4f3-c1adf0447163 ==============================
[0m23:26:16.539829 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:26:16.540143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:26:16.773722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bd3d72d-cac7-4a2f-a4f3-c1adf0447163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112786520>]}
[0m23:26:16.799326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bd3d72d-cac7-4a2f-a4f3-c1adf0447163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126f8050>]}
[0m23:26:16.800094 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:26:16.861648 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:26:16.920807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:26:16.921160 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/input/openweather_join.sql
[0m23:26:17.021178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bd3d72d-cac7-4a2f-a4f3-c1adf0447163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112673250>]}
[0m23:26:17.065464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bd3d72d-cac7-4a2f-a4f3-c1adf0447163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a04140>]}
[0m23:26:17.065760 [info ] [MainThread]: Found 1 model, 2 sources, 459 macros
[0m23:26:17.065920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bd3d72d-cac7-4a2f-a4f3-c1adf0447163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b3c2f0>]}
[0m23:26:17.066771 [info ] [MainThread]: 
[0m23:26:17.067047 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:26:17.067492 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:26:17.073488 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:26:17.073642 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:26:17.073759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:17.720994 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.647 seconds
[0m23:26:17.723785 [debug] [ThreadPool]: On list_openweather: Close
[0m23:26:17.841718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:26:17.851967 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:26:17.852303 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:26:17.852584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:18.362326 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.509 seconds
[0m23:26:18.366634 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:26:18.535974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bd3d72d-cac7-4a2f-a4f3-c1adf0447163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ae4c80>]}
[0m23:26:18.536636 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:26:18.536883 [info ] [MainThread]: 
[0m23:26:18.539805 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:26:18.540139 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:26:18.540383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.openweather_join)
[0m23:26:18.540548 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:26:18.544771 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:26:18.545204 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:26:18.564431 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:26:18.565462 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:26:18.565761 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,  -- Use quotes for case-sensitive column names
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m23:26:18.566011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:26:19.378224 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.812 seconds
[0m23:26:19.406541 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:26:19.521485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd3d72d-cac7-4a2f-a4f3-c1adf0447163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130a5850>]}
[0m23:26:19.522500 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.98s]
[0m23:26:19.523345 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:26:19.525069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:26:19.525446 [debug] [MainThread]: Connection 'model.weather_dbt.openweather_join' was properly closed.
[0m23:26:19.525780 [info ] [MainThread]: 
[0m23:26:19.526101 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.46 seconds (2.46s).
[0m23:26:19.526808 [debug] [MainThread]: Command end result
[0m23:26:19.550994 [info ] [MainThread]: 
[0m23:26:19.551321 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:26:19.551524 [info ] [MainThread]: 
[0m23:26:19.551749 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:26:19.553478 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0553112, "process_in_blocks": "0", "process_kernel_time": 0.248936, "process_mem_max_rss": "139558912", "process_out_blocks": "0", "process_user_time": 1.257798}
[0m23:26:19.553821 [debug] [MainThread]: Command `dbt run` succeeded at 23:26:19.553760 after 3.06 seconds
[0m23:26:19.554040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130c05d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a220d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a22a30>]}
[0m23:26:19.554243 [debug] [MainThread]: Flushing usage events
[0m23:40:29.092513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027f0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f3d90>]}


============================== 23:40:29.095960 | 33c3869e-ee2d-45b5-a338-3d21c3dae4ac ==============================
[0m23:40:29.095960 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:40:29.096364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:40:29.320892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33c3869e-ee2d-45b5-a338-3d21c3dae4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d4e520>]}
[0m23:40:29.345520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33c3869e-ee2d-45b5-a338-3d21c3dae4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c48050>]}
[0m23:40:29.346163 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:40:29.409940 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:40:29.450463 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:40:29.450724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '33c3869e-ee2d-45b5-a338-3d21c3dae4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc1350>]}
[0m23:40:29.935802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33c3869e-ee2d-45b5-a338-3d21c3dae4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105066120>]}
[0m23:40:29.976973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33c3869e-ee2d-45b5-a338-3d21c3dae4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ac050>]}
[0m23:40:29.977221 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m23:40:29.977367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33c3869e-ee2d-45b5-a338-3d21c3dae4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050de0d0>]}
[0m23:40:29.978250 [info ] [MainThread]: 
[0m23:40:29.978492 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:40:29.980566 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:40:29.987527 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:40:29.987685 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:40:29.987797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:30.532405 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.544 seconds
[0m23:40:30.535609 [debug] [ThreadPool]: On list_openweather: Close
[0m23:40:30.674315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:40:30.683271 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:40:30.683651 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:40:30.683906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:40:31.188358 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.504 seconds
[0m23:40:31.191934 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:40:31.319514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33c3869e-ee2d-45b5-a338-3d21c3dae4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105458290>]}
[0m23:40:31.320339 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:40:31.320742 [info ] [MainThread]: 
[0m23:40:31.323583 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m23:40:31.324057 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m23:40:31.324395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m23:40:31.324637 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m23:40:31.330756 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:40:31.331430 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m23:40:31.349009 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:40:31.350034 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m23:40:31.350277 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m23:40:31.350470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:33.322137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.971 seconds
[0m23:40:33.345684 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m23:40:33.488560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33c3869e-ee2d-45b5-a338-3d21c3dae4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10559d020>]}
[0m23:40:33.489710 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 2.16s]
[0m23:40:33.490558 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m23:40:33.491163 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m23:40:33.491868 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m23:40:33.492432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m23:40:33.492837 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m23:40:33.496626 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m23:40:33.497703 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m23:40:33.500026 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m23:40:33.502623 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m23:40:33.503170 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20
ORDER BY
    w.DATE_TIME, c."Name"
        );
[0m23:40:33.503516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:34.974812 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.471 seconds
[0m23:40:34.979072 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m23:40:35.121939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33c3869e-ee2d-45b5-a338-3d21c3dae4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054fdef0>]}
[0m23:40:35.123386 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.63s]
[0m23:40:35.124206 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m23:40:35.124795 [debug] [Thread-1 (]: Began running node model.weather_dbt.geo_weather_overview
[0m23:40:35.125554 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.geo_weather_overview .................... [RUN]
[0m23:40:35.126242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.geo_weather_overview)
[0m23:40:35.126642 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.geo_weather_overview
[0m23:40:35.130555 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.geo_weather_overview"
[0m23:40:35.131712 [debug] [Thread-1 (]: Began executing node model.weather_dbt.geo_weather_overview
[0m23:40:35.133983 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.geo_weather_overview"
[0m23:40:35.135300 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.geo_weather_overview"
[0m23:40:35.135659 [debug] [Thread-1 (]: On model.weather_dbt.geo_weather_overview: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.geo_weather_overview"} */
create or replace transient table openweather.analytics.geo_weather_overview
         as
        (SELECT
    c.CITY_ID,
    c."Name" AS CITY_NAME,
    c.LATITUDE,
    c.LONGITUDE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    c.CITY_ID, c."Name", c.LATITUDE, c.LONGITUDE
ORDER BY
    AVG_TEMP_FAHRENHEIT DESC
        );
[0m23:40:35.135983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:35.552397 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a4c-0004-3868-0002-59430003866a
[0m23:40:35.553094 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 4
invalid identifier 'C.LATITUDE'
[0m23:40:35.553646 [debug] [Thread-1 (]: On model.weather_dbt.geo_weather_overview: Close
[0m23:40:35.746426 [debug] [Thread-1 (]: Database Error in model geo_weather_overview (models/output/geo_weather_overview.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/output/geo_weather_overview.sql
[0m23:40:35.747285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33c3869e-ee2d-45b5-a338-3d21c3dae4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054541d0>]}
[0m23:40:35.748076 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model analytics.geo_weather_overview ........... [[31mERROR[0m in 0.62s]
[0m23:40:35.748715 [debug] [Thread-1 (]: Finished running node model.weather_dbt.geo_weather_overview
[0m23:40:35.749098 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:40:35.750346 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:40:35.750827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.geo_weather_overview, now model.weather_dbt.openweather_join)
[0m23:40:35.751158 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:40:35.754434 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:40:35.755195 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:40:35.771998 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:40:35.772886 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:40:35.773129 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m23:40:35.773348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:36.526639 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.753 seconds
[0m23:40:36.535173 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:40:36.657607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33c3869e-ee2d-45b5-a338-3d21c3dae4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10560aeb0>]}
[0m23:40:36.658668 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.91s]
[0m23:40:36.659436 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:40:36.659980 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m23:40:36.660704 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m23:40:36.661361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m23:40:36.661806 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m23:40:36.665436 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m23:40:36.666618 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m23:40:36.668911 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m23:40:36.670026 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m23:40:36.670371 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN
ORDER BY
    CONDITION_COUNT DESC, c."Name"
        );
[0m23:40:36.670676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:37.903981 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.233 seconds
[0m23:40:37.907280 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m23:40:38.017319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33c3869e-ee2d-45b5-a338-3d21c3dae4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056dc8f0>]}
[0m23:40:38.018348 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.36s]
[0m23:40:38.019159 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m23:40:38.020993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:40:38.021454 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m23:40:38.021933 [info ] [MainThread]: 
[0m23:40:38.022310 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 8.04 seconds (8.04s).
[0m23:40:38.023546 [debug] [MainThread]: Command end result
[0m23:40:38.051191 [info ] [MainThread]: 
[0m23:40:38.051487 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:40:38.051672 [info ] [MainThread]: 
[0m23:40:38.051933 [error] [MainThread]:   Database Error in model geo_weather_overview (models/output/geo_weather_overview.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/output/geo_weather_overview.sql
[0m23:40:38.052155 [info ] [MainThread]: 
[0m23:40:38.052360 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:40:38.053967 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.00236, "process_in_blocks": "0", "process_kernel_time": 0.278855, "process_mem_max_rss": "145473536", "process_out_blocks": "0", "process_user_time": 1.872912}
[0m23:40:38.054325 [debug] [MainThread]: Command `dbt run` failed at 23:40:38.054264 after 9.00 seconds
[0m23:40:38.054549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552e570>]}
[0m23:40:38.054754 [debug] [MainThread]: Flushing usage events
[0m23:42:33.046382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fe4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10890fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10890fd90>]}


============================== 23:42:33.049671 | 6006374a-43ac-437a-9e1d-1c3656cf1f3b ==============================
[0m23:42:33.049671 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:42:33.050000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:42:33.275494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6006374a-43ac-437a-9e1d-1c3656cf1f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10956a520>]}
[0m23:42:33.299862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6006374a-43ac-437a-9e1d-1c3656cf1f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109464050>]}
[0m23:42:33.301246 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:42:33.361626 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:42:33.402274 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:42:33.402520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6006374a-43ac-437a-9e1d-1c3656cf1f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093dd350>]}
[0m23:42:33.887249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6006374a-43ac-437a-9e1d-1c3656cf1f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109897b60>]}
[0m23:42:33.928233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6006374a-43ac-437a-9e1d-1c3656cf1f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d78130>]}
[0m23:42:33.928478 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m23:42:33.928624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6006374a-43ac-437a-9e1d-1c3656cf1f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099060d0>]}
[0m23:42:33.929547 [info ] [MainThread]: 
[0m23:42:33.929804 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:42:33.931869 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:42:33.938763 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:42:33.938919 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:42:33.939041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:34.541086 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.602 seconds
[0m23:42:34.545299 [debug] [ThreadPool]: On list_openweather: Close
[0m23:42:34.671436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:42:34.682516 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:42:34.682875 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:42:34.683171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:42:35.234022 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.551 seconds
[0m23:42:35.237522 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:42:35.398915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6006374a-43ac-437a-9e1d-1c3656cf1f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a938290>]}
[0m23:42:35.400108 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:42:35.400569 [info ] [MainThread]: 
[0m23:42:35.405528 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m23:42:35.406198 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m23:42:35.406679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m23:42:35.406990 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m23:42:35.416711 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:42:35.417707 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m23:42:35.439659 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:42:35.440616 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m23:42:35.440848 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m23:42:35.441050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:36.596841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.155 seconds
[0m23:42:36.623537 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m23:42:36.796678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6006374a-43ac-437a-9e1d-1c3656cf1f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa74cb0>]}
[0m23:42:36.797332 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.39s]
[0m23:42:36.797771 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m23:42:36.798074 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m23:42:36.798494 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m23:42:36.798880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m23:42:36.799136 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m23:42:36.801369 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m23:42:36.802045 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m23:42:36.804159 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m23:42:36.805224 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m23:42:36.805645 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20
ORDER BY
    w.DATE_TIME, c."Name"
        );
[0m23:42:36.806035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:38.186681 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.380 seconds
[0m23:42:38.190987 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m23:42:38.361091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6006374a-43ac-437a-9e1d-1c3656cf1f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9d7610>]}
[0m23:42:38.362244 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.56s]
[0m23:42:38.363062 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m23:42:38.363604 [debug] [Thread-1 (]: Began running node model.weather_dbt.geo_weather_overview
[0m23:42:38.364139 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.geo_weather_overview .................... [RUN]
[0m23:42:38.364836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.geo_weather_overview)
[0m23:42:38.365414 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.geo_weather_overview
[0m23:42:38.369370 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.geo_weather_overview"
[0m23:42:38.370464 [debug] [Thread-1 (]: Began executing node model.weather_dbt.geo_weather_overview
[0m23:42:38.372851 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.geo_weather_overview"
[0m23:42:38.374095 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.geo_weather_overview"
[0m23:42:38.374438 [debug] [Thread-1 (]: On model.weather_dbt.geo_weather_overview: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.geo_weather_overview"} */
create or replace transient table openweather.analytics.geo_weather_overview
         as
        (SELECT
    c.CITY_ID,
    c."Name" AS CITY_NAME,
    c.LATITUDE,
    c.LONGITUDE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    c.CITY_ID, c."Name", c.LATITUDE, c.LONGITUDE
ORDER BY
    AVG_TEMP_FAHRENHEIT DESC
        );
[0m23:42:38.374768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:38.949186 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a4e-0004-386c-0002-5943000376d2
[0m23:42:38.949712 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 4
invalid identifier 'C.LATITUDE'
[0m23:42:38.950183 [debug] [Thread-1 (]: On model.weather_dbt.geo_weather_overview: Close
[0m23:42:39.086705 [debug] [Thread-1 (]: Database Error in model geo_weather_overview (models/output/geo_weather_overview.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/output/geo_weather_overview.sql
[0m23:42:39.087389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6006374a-43ac-437a-9e1d-1c3656cf1f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bbf850>]}
[0m23:42:39.088042 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model analytics.geo_weather_overview ........... [[31mERROR[0m in 0.72s]
[0m23:42:39.088620 [debug] [Thread-1 (]: Finished running node model.weather_dbt.geo_weather_overview
[0m23:42:39.089026 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:42:39.089461 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:42:39.089881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.geo_weather_overview, now model.weather_dbt.openweather_join)
[0m23:42:39.090177 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:42:39.093164 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:42:39.094680 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:42:39.112217 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:42:39.113184 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:42:39.113490 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m23:42:39.113716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:39.852890 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.739 seconds
[0m23:42:39.857612 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:42:39.972140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6006374a-43ac-437a-9e1d-1c3656cf1f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f488a0>]}
[0m23:42:39.973275 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.88s]
[0m23:42:39.974068 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:42:39.974621 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m23:42:39.975275 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m23:42:39.975890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m23:42:39.976350 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m23:42:39.980043 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m23:42:39.981122 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m23:42:39.983513 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m23:42:39.984649 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m23:42:39.985025 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN
ORDER BY
    CONDITION_COUNT DESC, c."Name"
        );
[0m23:42:39.985368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:41.414846 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.429 seconds
[0m23:42:41.418379 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m23:42:41.599561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6006374a-43ac-437a-9e1d-1c3656cf1f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adb4530>]}
[0m23:42:41.600734 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.62s]
[0m23:42:41.601562 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m23:42:41.603382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:42:41.603686 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m23:42:41.604074 [info ] [MainThread]: 
[0m23:42:41.604387 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 7.67 seconds (7.67s).
[0m23:42:41.605631 [debug] [MainThread]: Command end result
[0m23:42:41.633126 [info ] [MainThread]: 
[0m23:42:41.633390 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:42:41.633568 [info ] [MainThread]: 
[0m23:42:41.633790 [error] [MainThread]:   Database Error in model geo_weather_overview (models/output/geo_weather_overview.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/output/geo_weather_overview.sql
[0m23:42:41.633964 [info ] [MainThread]: 
[0m23:42:41.634137 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:42:41.635887 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.630753, "process_in_blocks": "0", "process_kernel_time": 0.278458, "process_mem_max_rss": "145162240", "process_out_blocks": "0", "process_user_time": 1.89999}
[0m23:42:41.636206 [debug] [MainThread]: Command `dbt run` failed at 23:42:41.636150 after 8.63 seconds
[0m23:42:41.636415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107769670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aad7b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aad4ad0>]}
[0m23:42:41.636614 [debug] [MainThread]: Flushing usage events
[0m23:43:58.210840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029b8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042bfb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042bfd90>]}


============================== 23:43:58.213871 | bb5cc7fb-4801-4662-b43e-a4ea407a2af7 ==============================
[0m23:43:58.213871 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:43:58.214170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:43:58.428051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb5cc7fb-4801-4662-b43e-a4ea407a2af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f12520>]}
[0m23:43:58.451610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb5cc7fb-4801-4662-b43e-a4ea407a2af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e10050>]}
[0m23:43:58.452273 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:43:58.510868 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:43:58.571152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:43:58.571568 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/geo_weather_overview.sql
[0m23:43:58.672264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb5cc7fb-4801-4662-b43e-a4ea407a2af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d8b450>]}
[0m23:43:58.717122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb5cc7fb-4801-4662-b43e-a4ea407a2af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5fe30>]}
[0m23:43:58.717390 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m23:43:58.717550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb5cc7fb-4801-4662-b43e-a4ea407a2af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d4750>]}
[0m23:43:58.718535 [info ] [MainThread]: 
[0m23:43:58.718820 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:43:58.720951 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:43:58.727103 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:43:58.727268 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:43:58.727397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:59.312579 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.585 seconds
[0m23:43:59.314604 [debug] [ThreadPool]: On list_openweather: Close
[0m23:43:59.453724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:43:59.465115 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:43:59.465490 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:43:59.465755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:44:00.068925 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.603 seconds
[0m23:44:00.073809 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:44:00.211691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb5cc7fb-4801-4662-b43e-a4ea407a2af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040a53d0>]}
[0m23:44:00.212686 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:44:00.213115 [info ] [MainThread]: 
[0m23:44:00.217540 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m23:44:00.218168 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m23:44:00.218637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m23:44:00.218984 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m23:44:00.227293 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:44:00.228104 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m23:44:00.250039 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:44:00.250991 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m23:44:00.251237 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m23:44:00.251457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:01.585574 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.334 seconds
[0m23:44:01.606886 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m23:44:01.727578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5cc7fb-4801-4662-b43e-a4ea407a2af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10559c050>]}
[0m23:44:01.728776 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.51s]
[0m23:44:01.729754 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m23:44:01.730416 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m23:44:01.731136 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m23:44:01.731765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m23:44:01.732148 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m23:44:01.735773 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m23:44:01.736786 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m23:44:01.739902 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m23:44:01.741389 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m23:44:01.741770 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20
ORDER BY
    w.DATE_TIME, c."Name"
        );
[0m23:44:01.742102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:02.826368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.084 seconds
[0m23:44:02.830591 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m23:44:03.033291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5cc7fb-4801-4662-b43e-a4ea407a2af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10428e150>]}
[0m23:44:03.034621 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.30s]
[0m23:44:03.035436 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m23:44:03.035979 [debug] [Thread-1 (]: Began running node model.weather_dbt.geo_weather_overview
[0m23:44:03.036719 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.geo_weather_overview .................... [RUN]
[0m23:44:03.037348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.geo_weather_overview)
[0m23:44:03.037732 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.geo_weather_overview
[0m23:44:03.041575 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.geo_weather_overview"
[0m23:44:03.042691 [debug] [Thread-1 (]: Began executing node model.weather_dbt.geo_weather_overview
[0m23:44:03.045700 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.geo_weather_overview"
[0m23:44:03.046851 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.geo_weather_overview"
[0m23:44:03.047186 [debug] [Thread-1 (]: On model.weather_dbt.geo_weather_overview: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.geo_weather_overview"} */
create or replace transient table openweather.analytics.geo_weather_overview
         as
        (SELECT
    c.CITY_ID,
    c."Name" AS CITY_NAME,
    c."LATITUDE",
    c."LONGITUDE",
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    c.CITY_ID, c."Name", c.LATITUDE, c.LONGITUDE
ORDER BY
    AVG_TEMP_FAHRENHEIT DESC
        );
[0m23:44:03.047501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:03.484321 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a50-0004-386b-0002-59430003b65a
[0m23:44:03.485008 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 4
invalid identifier 'C.LATITUDE'
[0m23:44:03.485575 [debug] [Thread-1 (]: On model.weather_dbt.geo_weather_overview: Close
[0m23:44:03.614100 [debug] [Thread-1 (]: Database Error in model geo_weather_overview (models/output/geo_weather_overview.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/output/geo_weather_overview.sql
[0m23:44:03.614962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5cc7fb-4801-4662-b43e-a4ea407a2af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10566d130>]}
[0m23:44:03.615795 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model analytics.geo_weather_overview ........... [[31mERROR[0m in 0.58s]
[0m23:44:03.616378 [debug] [Thread-1 (]: Finished running node model.weather_dbt.geo_weather_overview
[0m23:44:03.616771 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:44:03.618010 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:44:03.618502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.geo_weather_overview, now model.weather_dbt.openweather_join)
[0m23:44:03.618837 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:44:03.622038 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:44:03.622770 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:44:03.639483 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:44:03.640350 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:44:03.640598 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m23:44:03.640812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:04.441963 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.801 seconds
[0m23:44:04.446692 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:44:04.576116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5cc7fb-4801-4662-b43e-a4ea407a2af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10201eb50>]}
[0m23:44:04.577293 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.96s]
[0m23:44:04.578102 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:44:04.578652 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m23:44:04.579354 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m23:44:04.580006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m23:44:04.580464 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m23:44:04.584278 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m23:44:04.585331 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m23:44:04.588442 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m23:44:04.589576 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m23:44:04.589913 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN
ORDER BY
    CONDITION_COUNT DESC, c."Name"
        );
[0m23:44:04.590222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:05.777550 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.187 seconds
[0m23:44:05.781707 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m23:44:05.911100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb5cc7fb-4801-4662-b43e-a4ea407a2af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057844b0>]}
[0m23:44:05.912415 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.33s]
[0m23:44:05.913225 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m23:44:05.915041 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:44:05.915419 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m23:44:05.915856 [info ] [MainThread]: 
[0m23:44:05.916230 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 7.20 seconds (7.20s).
[0m23:44:05.917624 [debug] [MainThread]: Command end result
[0m23:44:05.946969 [info ] [MainThread]: 
[0m23:44:05.947284 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:44:05.947470 [info ] [MainThread]: 
[0m23:44:05.947704 [error] [MainThread]:   Database Error in model geo_weather_overview (models/output/geo_weather_overview.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/output/geo_weather_overview.sql
[0m23:44:05.947887 [info ] [MainThread]: 
[0m23:44:05.948068 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:44:05.949561 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.7750583, "process_in_blocks": "0", "process_kernel_time": 0.272976, "process_mem_max_rss": "140935168", "process_out_blocks": "0", "process_user_time": 1.557957}
[0m23:44:05.949910 [debug] [MainThread]: Command `dbt run` failed at 23:44:05.949851 after 7.78 seconds
[0m23:44:05.950138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f430b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552bbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552b4d0>]}
[0m23:44:05.950344 [debug] [MainThread]: Flushing usage events
[0m23:44:45.390222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10326cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b97b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b97d90>]}


============================== 23:44:45.393382 | beca5c23-9957-4912-9b63-78194aca3386 ==============================
[0m23:44:45.393382 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:44:45.393693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:44:45.609681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'beca5c23-9957-4912-9b63-78194aca3386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057f2520>]}
[0m23:44:45.632472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'beca5c23-9957-4912-9b63-78194aca3386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056f4050>]}
[0m23:44:45.633049 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:44:45.690929 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:44:45.751699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:44:45.752041 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/geo_weather_overview.sql
[0m23:44:45.853808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'beca5c23-9957-4912-9b63-78194aca3386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10566b450>]}
[0m23:44:45.897945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'beca5c23-9957-4912-9b63-78194aca3386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10563be30>]}
[0m23:44:45.898235 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m23:44:45.898393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'beca5c23-9957-4912-9b63-78194aca3386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb42f0>]}
[0m23:44:45.899355 [info ] [MainThread]: 
[0m23:44:45.899633 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:44:45.901750 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:44:45.907853 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:44:45.908017 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:44:45.908322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:44:46.456225 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.548 seconds
[0m23:44:46.459972 [debug] [ThreadPool]: On list_openweather: Close
[0m23:44:46.585482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:44:46.596596 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:44:46.596968 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:44:46.597235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:44:47.066096 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.469 seconds
[0m23:44:47.071109 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:44:47.203658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'beca5c23-9957-4912-9b63-78194aca3386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049813d0>]}
[0m23:44:47.204610 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:44:47.205053 [info ] [MainThread]: 
[0m23:44:47.209581 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m23:44:47.210215 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m23:44:47.210717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m23:44:47.211076 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m23:44:47.219404 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:44:47.220298 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m23:44:47.242567 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:44:47.243647 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m23:44:47.243913 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m23:44:47.244145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:48.448401 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.203 seconds
[0m23:44:48.474047 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m23:44:48.607478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'beca5c23-9957-4912-9b63-78194aca3386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e7b950>]}
[0m23:44:48.608673 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.40s]
[0m23:44:48.609736 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m23:44:48.610296 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m23:44:48.610981 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m23:44:48.611613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m23:44:48.612017 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m23:44:48.615839 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m23:44:48.616895 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m23:44:48.619979 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m23:44:48.621433 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m23:44:48.621815 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20
ORDER BY
    w.DATE_TIME, c."Name"
        );
[0m23:44:48.622165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:49.952169 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.329 seconds
[0m23:44:49.956302 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m23:44:50.072371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'beca5c23-9957-4912-9b63-78194aca3386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b66150>]}
[0m23:44:50.073385 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.46s]
[0m23:44:50.074193 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m23:44:50.074766 [debug] [Thread-1 (]: Began running node model.weather_dbt.geo_weather_overview
[0m23:44:50.075529 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.geo_weather_overview .................... [RUN]
[0m23:44:50.076239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.geo_weather_overview)
[0m23:44:50.076707 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.geo_weather_overview
[0m23:44:50.080482 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.geo_weather_overview"
[0m23:44:50.081398 [debug] [Thread-1 (]: Began executing node model.weather_dbt.geo_weather_overview
[0m23:44:50.084426 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.geo_weather_overview"
[0m23:44:50.085416 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.geo_weather_overview"
[0m23:44:50.085660 [debug] [Thread-1 (]: On model.weather_dbt.geo_weather_overview: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.geo_weather_overview"} */
create or replace transient table openweather.analytics.geo_weather_overview
         as
        (SELECT
    c.CITY_ID,
    c."Name" AS CITY_NAME,
    c."Latitude",
    c."Longitude",
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    c.CITY_ID, c."Name", c.LATITUDE, c.LONGITUDE
ORDER BY
    AVG_TEMP_FAHRENHEIT DESC
        );
[0m23:44:50.085870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:50.521394 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a50-0004-386b-0002-59430003b65e
[0m23:44:50.522098 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 18 at position 25
invalid identifier 'C.LATITUDE'
[0m23:44:50.522627 [debug] [Thread-1 (]: On model.weather_dbt.geo_weather_overview: Close
[0m23:44:50.640647 [debug] [Thread-1 (]: Database Error in model geo_weather_overview (models/output/geo_weather_overview.sql)
  000904 (42000): SQL compilation error: error line 18 at position 25
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/output/geo_weather_overview.sql
[0m23:44:50.641520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'beca5c23-9957-4912-9b63-78194aca3386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106171130>]}
[0m23:44:50.642364 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model analytics.geo_weather_overview ........... [[31mERROR[0m in 0.57s]
[0m23:44:50.642972 [debug] [Thread-1 (]: Finished running node model.weather_dbt.geo_weather_overview
[0m23:44:50.643382 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:44:50.644757 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:44:50.645519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.geo_weather_overview, now model.weather_dbt.openweather_join)
[0m23:44:50.645962 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:44:50.649401 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:44:50.650303 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:44:50.667565 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:44:50.668548 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:44:50.668800 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m23:44:50.669023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:51.281597 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m23:44:51.285862 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:44:51.400566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'beca5c23-9957-4912-9b63-78194aca3386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028fab50>]}
[0m23:44:51.401815 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.75s]
[0m23:44:51.402788 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:44:51.403420 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m23:44:51.403994 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m23:44:51.404368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m23:44:51.404636 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m23:44:51.407539 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m23:44:51.408331 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m23:44:51.410836 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m23:44:51.411736 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m23:44:51.411999 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN
ORDER BY
    CONDITION_COUNT DESC, c."Name"
        );
[0m23:44:51.412239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:52.709096 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.296 seconds
[0m23:44:52.713517 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m23:44:52.889092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'beca5c23-9957-4912-9b63-78194aca3386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d882f0>]}
[0m23:44:52.890168 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.48s]
[0m23:44:52.890754 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m23:44:52.892277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:44:52.892548 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m23:44:52.892907 [info ] [MainThread]: 
[0m23:44:52.893191 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 6.99 seconds (6.99s).
[0m23:44:52.894291 [debug] [MainThread]: Command end result
[0m23:44:52.922248 [info ] [MainThread]: 
[0m23:44:52.922541 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:44:52.922716 [info ] [MainThread]: 
[0m23:44:52.922947 [error] [MainThread]:   Database Error in model geo_weather_overview (models/output/geo_weather_overview.sql)
  000904 (42000): SQL compilation error: error line 18 at position 25
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/output/geo_weather_overview.sql
[0m23:44:52.923120 [info ] [MainThread]: 
[0m23:44:52.923303 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:44:52.924811 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.5730495, "process_in_blocks": "0", "process_kernel_time": 0.253356, "process_mem_max_rss": "142082048", "process_out_blocks": "0", "process_user_time": 1.574268}
[0m23:44:52.925141 [debug] [MainThread]: Command `dbt run` failed at 23:44:52.925079 after 7.57 seconds
[0m23:44:52.925367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106032b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039f70b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c5c70>]}
[0m23:44:52.925579 [debug] [MainThread]: Flushing usage events
[0m23:45:48.506406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bf0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451bd90>]}


============================== 23:45:48.509764 | 192b4867-cbf5-4dab-804d-7faea34b6197 ==============================
[0m23:45:48.509764 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:45:48.510110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:45:48.718007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '192b4867-cbf5-4dab-804d-7faea34b6197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105176520>]}
[0m23:45:48.740742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '192b4867-cbf5-4dab-804d-7faea34b6197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105078050>]}
[0m23:45:48.741983 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:45:48.800693 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:45:48.861607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:45:48.861989 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/geo_weather_overview.sql
[0m23:45:48.976714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '192b4867-cbf5-4dab-804d-7faea34b6197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104feb450>]}
[0m23:45:49.019830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '192b4867-cbf5-4dab-804d-7faea34b6197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fbfe30>]}
[0m23:45:49.020105 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m23:45:49.020265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '192b4867-cbf5-4dab-804d-7faea34b6197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055383d0>]}
[0m23:45:49.021195 [info ] [MainThread]: 
[0m23:45:49.021461 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:45:49.023552 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:45:49.029517 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:45:49.029676 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:45:49.029803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:49.552973 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.523 seconds
[0m23:45:49.556011 [debug] [ThreadPool]: On list_openweather: Close
[0m23:45:49.708025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:45:49.718268 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:45:49.718617 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:45:49.718882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:45:50.196487 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.477 seconds
[0m23:45:50.200737 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:45:50.322781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '192b4867-cbf5-4dab-804d-7faea34b6197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043053d0>]}
[0m23:45:50.323768 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:45:50.324232 [info ] [MainThread]: 
[0m23:45:50.328974 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m23:45:50.329827 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m23:45:50.330400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m23:45:50.330717 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m23:45:50.338690 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:45:50.339892 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m23:45:50.362746 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:45:50.363690 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m23:45:50.363923 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m23:45:50.364132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:51.423275 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.058 seconds
[0m23:45:51.449717 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m23:45:51.561824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '192b4867-cbf5-4dab-804d-7faea34b6197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d7950>]}
[0m23:45:51.562939 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.23s]
[0m23:45:51.564047 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m23:45:51.564665 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m23:45:51.565530 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m23:45:51.566028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m23:45:51.566271 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m23:45:51.569474 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m23:45:51.570607 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m23:45:51.573214 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m23:45:51.574296 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m23:45:51.574576 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20
ORDER BY
    w.DATE_TIME, c."Name"
        );
[0m23:45:51.574835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:52.643500 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.068 seconds
[0m23:45:52.647273 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m23:45:52.782632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '192b4867-cbf5-4dab-804d-7faea34b6197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ea150>]}
[0m23:45:52.783589 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.22s]
[0m23:45:52.784398 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m23:45:52.784956 [debug] [Thread-1 (]: Began running node model.weather_dbt.geo_weather_overview
[0m23:45:52.785725 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.geo_weather_overview .................... [RUN]
[0m23:45:52.786393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.geo_weather_overview)
[0m23:45:52.786864 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.geo_weather_overview
[0m23:45:52.790666 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.geo_weather_overview"
[0m23:45:52.791654 [debug] [Thread-1 (]: Began executing node model.weather_dbt.geo_weather_overview
[0m23:45:52.794667 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.geo_weather_overview"
[0m23:45:52.795888 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.geo_weather_overview"
[0m23:45:52.796234 [debug] [Thread-1 (]: On model.weather_dbt.geo_weather_overview: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.geo_weather_overview"} */
create or replace transient table openweather.analytics.geo_weather_overview
         as
        (SELECT
    c.CITY_ID,
    c."Name" AS CITY_NAME,
    c.latitude AS LATITUDE,  -- Replace with actual column name
    c.longitude AS LONGITUDE, -- Replace with actual column name
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    c.CITY_ID, c."Name", c.latitude, c.longitude
ORDER BY
    AVG_TEMP_FAHRENHEIT DESC;
[0m23:45:52.796556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:53.264826 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a51-0004-3863-0002-594300036666
[0m23:45:53.265513 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 28 unexpected ';'.
[0m23:45:53.266038 [debug] [Thread-1 (]: On model.weather_dbt.geo_weather_overview: Close
[0m23:45:53.411513 [debug] [Thread-1 (]: Database Error in model geo_weather_overview (models/output/geo_weather_overview.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 28 unexpected ';'.
  compiled code at target/run/weather_dbt/models/output/geo_weather_overview.sql
[0m23:45:53.412172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '192b4867-cbf5-4dab-804d-7faea34b6197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058d1130>]}
[0m23:45:53.412805 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model analytics.geo_weather_overview ........... [[31mERROR[0m in 0.63s]
[0m23:45:53.413317 [debug] [Thread-1 (]: Finished running node model.weather_dbt.geo_weather_overview
[0m23:45:53.413668 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:45:53.414798 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:45:53.415249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.geo_weather_overview, now model.weather_dbt.openweather_join)
[0m23:45:53.415542 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:45:53.418438 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:45:53.419324 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:45:53.437217 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:45:53.438272 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:45:53.438521 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m23:45:53.438741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:54.039071 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m23:45:54.043410 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:45:54.169284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '192b4867-cbf5-4dab-804d-7faea34b6197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10227eb50>]}
[0m23:45:54.170253 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.75s]
[0m23:45:54.170980 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:45:54.171429 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m23:45:54.172006 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m23:45:54.172536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m23:45:54.172919 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m23:45:54.176534 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m23:45:54.177602 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m23:45:54.180594 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m23:45:54.181724 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m23:45:54.182065 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN
ORDER BY
    CONDITION_COUNT DESC, c."Name"
        );
[0m23:45:54.182376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:55.177643 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.994 seconds
[0m23:45:55.181781 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m23:45:55.320714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '192b4867-cbf5-4dab-804d-7faea34b6197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e42f0>]}
[0m23:45:55.321341 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.15s]
[0m23:45:55.322193 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m23:45:55.323562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:55.323877 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m23:45:55.324281 [info ] [MainThread]: 
[0m23:45:55.324705 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 6.30 seconds (6.30s).
[0m23:45:55.325946 [debug] [MainThread]: Command end result
[0m23:45:55.355381 [info ] [MainThread]: 
[0m23:45:55.355816 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:45:55.356020 [info ] [MainThread]: 
[0m23:45:55.356251 [error] [MainThread]:   Database Error in model geo_weather_overview (models/output/geo_weather_overview.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 28 unexpected ';'.
  compiled code at target/run/weather_dbt/models/output/geo_weather_overview.sql
[0m23:45:55.356423 [info ] [MainThread]: 
[0m23:45:55.356604 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:45:55.358353 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.8897157, "process_in_blocks": "0", "process_kernel_time": 0.263152, "process_mem_max_rss": "139968512", "process_out_blocks": "0", "process_user_time": 1.552631}
[0m23:45:55.358828 [debug] [MainThread]: Command `dbt run` failed at 23:45:55.358750 after 6.89 seconds
[0m23:45:55.359085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105789fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a71c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105818530>]}
[0m23:45:55.359295 [debug] [MainThread]: Flushing usage events
[0m23:46:04.755943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105698d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119d7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119d7d90>]}


============================== 23:46:04.758786 | 68a2a26d-483e-42b9-8ad7-d7eca7654086 ==============================
[0m23:46:04.758786 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:46:04.759086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:46:04.970463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68a2a26d-483e-42b9-8ad7-d7eca7654086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11278a520>]}
[0m23:46:04.995054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68a2a26d-483e-42b9-8ad7-d7eca7654086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11277c050>]}
[0m23:46:04.995824 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:46:05.055167 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:46:05.115525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:46:05.115925 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/geo_weather_overview.sql
[0m23:46:05.211881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68a2a26d-483e-42b9-8ad7-d7eca7654086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11266f450>]}
[0m23:46:05.255481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68a2a26d-483e-42b9-8ad7-d7eca7654086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112643e30>]}
[0m23:46:05.255751 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m23:46:05.255907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68a2a26d-483e-42b9-8ad7-d7eca7654086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cdc3d0>]}
[0m23:46:05.256838 [info ] [MainThread]: 
[0m23:46:05.257095 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:46:05.259159 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:46:05.265048 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:46:05.265196 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:46:05.265320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:05.786302 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.520 seconds
[0m23:46:05.789327 [debug] [ThreadPool]: On list_openweather: Close
[0m23:46:05.905483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:46:05.916029 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:46:05.916389 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:46:05.916644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:46:06.369917 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.453 seconds
[0m23:46:06.375286 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:46:06.664437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68a2a26d-483e-42b9-8ad7-d7eca7654086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118fd3d0>]}
[0m23:46:06.665365 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:46:06.665783 [info ] [MainThread]: 
[0m23:46:06.669952 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m23:46:06.670562 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m23:46:06.671021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m23:46:06.671365 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m23:46:06.679609 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:46:06.680404 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m23:46:06.702408 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:46:06.703377 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m23:46:06.703736 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m23:46:06.704018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:07.792240 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.088 seconds
[0m23:46:07.819754 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m23:46:07.929030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a2a26d-483e-42b9-8ad7-d7eca7654086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f7b950>]}
[0m23:46:07.930279 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.26s]
[0m23:46:07.931144 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m23:46:07.931654 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m23:46:07.932288 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m23:46:07.932885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m23:46:07.933290 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m23:46:07.936978 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m23:46:07.938017 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m23:46:07.941121 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m23:46:07.942499 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m23:46:07.942870 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20
ORDER BY
    w.DATE_TIME, c."Name"
        );
[0m23:46:07.943207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:09.345256 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.402 seconds
[0m23:46:09.350053 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m23:46:09.474840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a2a26d-483e-42b9-8ad7-d7eca7654086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119a6150>]}
[0m23:46:09.475902 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.54s]
[0m23:46:09.476723 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m23:46:09.477290 [debug] [Thread-1 (]: Began running node model.weather_dbt.geo_weather_overview
[0m23:46:09.478032 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.geo_weather_overview .................... [RUN]
[0m23:46:09.478705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.geo_weather_overview)
[0m23:46:09.479187 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.geo_weather_overview
[0m23:46:09.483065 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.geo_weather_overview"
[0m23:46:09.484103 [debug] [Thread-1 (]: Began executing node model.weather_dbt.geo_weather_overview
[0m23:46:09.487220 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.geo_weather_overview"
[0m23:46:09.488518 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.geo_weather_overview"
[0m23:46:09.488871 [debug] [Thread-1 (]: On model.weather_dbt.geo_weather_overview: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.geo_weather_overview"} */
create or replace transient table openweather.analytics.geo_weather_overview
         as
        (SELECT
    c.CITY_ID,
    c."Name" AS CITY_NAME,
    c.latitude AS LATITUDE,  -- Replace with actual column name
    c.longitude AS LONGITUDE, -- Replace with actual column name
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    c.CITY_ID, c."Name", c.latitude, c.longitude
ORDER BY
    AVG_TEMP_FAHRENHEIT DESC
        );
[0m23:46:09.489203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:09.902265 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a52-0004-3987-0002-59430003d126
[0m23:46:09.903001 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 4
invalid identifier 'C.LATITUDE'
[0m23:46:09.903581 [debug] [Thread-1 (]: On model.weather_dbt.geo_weather_overview: Close
[0m23:46:10.028851 [debug] [Thread-1 (]: Database Error in model geo_weather_overview (models/output/geo_weather_overview.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/output/geo_weather_overview.sql
[0m23:46:10.029611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a2a26d-483e-42b9-8ad7-d7eca7654086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a3d130>]}
[0m23:46:10.030393 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model analytics.geo_weather_overview ........... [[31mERROR[0m in 0.55s]
[0m23:46:10.031048 [debug] [Thread-1 (]: Finished running node model.weather_dbt.geo_weather_overview
[0m23:46:10.031428 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:46:10.031809 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:46:10.033215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.geo_weather_overview, now model.weather_dbt.openweather_join)
[0m23:46:10.033793 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:46:10.037176 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:46:10.038049 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:46:10.056152 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:46:10.057234 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:46:10.057491 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m23:46:10.057717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:10.660803 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.602 seconds
[0m23:46:10.665633 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:46:10.962667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a2a26d-483e-42b9-8ad7-d7eca7654086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11197fb50>]}
[0m23:46:10.963658 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.93s]
[0m23:46:10.964421 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:46:10.964959 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m23:46:10.965656 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m23:46:10.966327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m23:46:10.966811 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m23:46:10.970535 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m23:46:10.971547 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m23:46:10.974599 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m23:46:10.975700 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m23:46:10.976045 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN
ORDER BY
    CONDITION_COUNT DESC, c."Name"
        );
[0m23:46:10.976372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:12.131373 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.154 seconds
[0m23:46:12.136098 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m23:46:12.257082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a2a26d-483e-42b9-8ad7-d7eca7654086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a7a430>]}
[0m23:46:12.257995 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.29s]
[0m23:46:12.258479 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m23:46:12.259827 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:12.260082 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m23:46:12.260383 [info ] [MainThread]: 
[0m23:46:12.260621 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 7.00 seconds (7.00s).
[0m23:46:12.261487 [debug] [MainThread]: Command end result
[0m23:46:12.288146 [info ] [MainThread]: 
[0m23:46:12.288476 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:46:12.288677 [info ] [MainThread]: 
[0m23:46:12.288928 [error] [MainThread]:   Database Error in model geo_weather_overview (models/output/geo_weather_overview.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/output/geo_weather_overview.sql
[0m23:46:12.289107 [info ] [MainThread]: 
[0m23:46:12.289310 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:46:12.290864 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.572382, "process_in_blocks": "0", "process_kernel_time": 0.2499, "process_mem_max_rss": "142753792", "process_out_blocks": "0", "process_user_time": 1.552225}
[0m23:46:12.291181 [debug] [MainThread]: Command `dbt run` failed at 23:46:12.291123 after 7.57 seconds
[0m23:46:12.291391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a85c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130c69f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130c6bd0>]}
[0m23:46:12.291592 [debug] [MainThread]: Flushing usage events
[0m23:48:34.738361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107498d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138d7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138d7d90>]}


============================== 23:48:34.741690 | 3b0e11bd-39eb-48f6-be2e-dae152f387ff ==============================
[0m23:48:34.741690 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:48:34.742007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:48:34.958090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b0e11bd-39eb-48f6-be2e-dae152f387ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11481a520>]}
[0m23:48:34.980478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b0e11bd-39eb-48f6-be2e-dae152f387ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145f4050>]}
[0m23:48:34.981004 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:48:35.041208 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:48:35.101275 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m23:48:35.101589 [debug] [MainThread]: Partial parsing: added file: weather_dbt://models/output/hourly_weather_patterns.sql
[0m23:48:35.101718 [debug] [MainThread]: Partial parsing: deleted file: weather_dbt://models/output/geo_weather_overview.sql
[0m23:48:35.200240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b0e11bd-39eb-48f6-be2e-dae152f387ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11456f450>]}
[0m23:48:35.245280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b0e11bd-39eb-48f6-be2e-dae152f387ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114543e30>]}
[0m23:48:35.245557 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m23:48:35.245706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b0e11bd-39eb-48f6-be2e-dae152f387ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114bdc3d0>]}
[0m23:48:35.246698 [info ] [MainThread]: 
[0m23:48:35.246972 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:48:35.249045 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:48:35.254967 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:48:35.255116 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:48:35.255234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:35.891816 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.636 seconds
[0m23:48:35.895619 [debug] [ThreadPool]: On list_openweather: Close
[0m23:48:36.024633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:48:36.035457 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:48:36.035802 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:48:36.036070 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:48:36.531874 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.496 seconds
[0m23:48:36.535504 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:48:36.663451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b0e11bd-39eb-48f6-be2e-dae152f387ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f393d0>]}
[0m23:48:36.664386 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:48:36.664790 [info ] [MainThread]: 
[0m23:48:36.669545 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m23:48:36.670210 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m23:48:36.670694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m23:48:36.671082 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m23:48:36.678612 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:48:36.679487 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m23:48:36.701494 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:48:36.702459 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m23:48:36.702720 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m23:48:36.702946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:37.906120 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.203 seconds
[0m23:48:37.932783 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m23:48:38.088071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0e11bd-39eb-48f6-be2e-dae152f387ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e7b950>]}
[0m23:48:38.089357 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.42s]
[0m23:48:38.090320 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m23:48:38.091445 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m23:48:38.092203 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m23:48:38.092767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m23:48:38.093149 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m23:48:38.096822 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m23:48:38.097761 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m23:48:38.100742 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m23:48:38.102170 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m23:48:38.102555 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20
ORDER BY
    w.DATE_TIME, c."Name"
        );
[0m23:48:38.102864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:39.287780 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.185 seconds
[0m23:48:39.291182 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m23:48:39.431984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0e11bd-39eb-48f6-be2e-dae152f387ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138a6150>]}
[0m23:48:39.433189 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.34s]
[0m23:48:39.433784 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m23:48:39.434198 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m23:48:39.434715 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m23:48:39.435251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m23:48:39.435744 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m23:48:39.439358 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m23:48:39.440422 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m23:48:39.443410 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m23:48:39.444832 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m23:48:39.445189 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (

SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,  -- Include city name for better insights
    EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
ORDER BY
    c."Name", HOUR_OF_DAY;
[0m23:48:39.445514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:39.906511 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a54-0004-386b-0002-59430003b666
[0m23:48:39.907233 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 21 at position 25 unexpected ';'.
[0m23:48:39.907768 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m23:48:40.042514 [debug] [Thread-1 (]: Database Error in model hourly_weather_patterns (models/output/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 25 unexpected ';'.
  compiled code at target/run/weather_dbt/models/output/hourly_weather_patterns.sql
[0m23:48:40.043391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0e11bd-39eb-48f6-be2e-dae152f387ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11594d130>]}
[0m23:48:40.044138 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model analytics.hourly_weather_patterns ........ [[31mERROR[0m in 0.61s]
[0m23:48:40.044680 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m23:48:40.045038 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:48:40.046184 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:48:40.046682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m23:48:40.047017 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:48:40.050170 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:48:40.051325 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:48:40.068266 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:48:40.069152 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:48:40.069399 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m23:48:40.069615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:40.772625 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.702 seconds
[0m23:48:40.777618 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:48:40.899775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0e11bd-39eb-48f6-be2e-dae152f387ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11387fd50>]}
[0m23:48:40.901063 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.85s]
[0m23:48:40.901850 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:48:40.902328 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m23:48:40.902883 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m23:48:40.903384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m23:48:40.903761 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m23:48:40.907539 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m23:48:40.908589 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m23:48:40.911562 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m23:48:40.912680 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m23:48:40.913030 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN
ORDER BY
    CONDITION_COUNT DESC, c."Name"
        );
[0m23:48:40.913347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:42.381371 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.465 seconds
[0m23:48:42.386723 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m23:48:42.522307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0e11bd-39eb-48f6-be2e-dae152f387ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115d884b0>]}
[0m23:48:42.523490 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.62s]
[0m23:48:42.524176 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m23:48:42.525812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:42.526192 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m23:48:42.526629 [info ] [MainThread]: 
[0m23:48:42.526968 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 7.28 seconds (7.28s).
[0m23:48:42.528034 [debug] [MainThread]: Command end result
[0m23:48:42.555589 [info ] [MainThread]: 
[0m23:48:42.555884 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:48:42.556063 [info ] [MainThread]: 
[0m23:48:42.556290 [error] [MainThread]:   Database Error in model hourly_weather_patterns (models/output/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 25 unexpected ';'.
  compiled code at target/run/weather_dbt/models/output/hourly_weather_patterns.sql
[0m23:48:42.556462 [info ] [MainThread]: 
[0m23:48:42.556640 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:48:42.558058 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.8584814, "process_in_blocks": "0", "process_kernel_time": 0.272668, "process_mem_max_rss": "140214272", "process_out_blocks": "0", "process_user_time": 1.541709}
[0m23:48:42.558373 [debug] [MainThread]: Command `dbt run` failed at 23:48:42.558320 after 7.86 seconds
[0m23:48:42.558582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f2edb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115d25bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159a8a10>]}
[0m23:48:42.558765 [debug] [MainThread]: Flushing usage events
[0m23:48:50.603139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e14d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104717b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104717d90>]}


============================== 23:48:50.605933 | a8cab9a5-845c-4175-8991-441d93789001 ==============================
[0m23:48:50.605933 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:48:50.606235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:48:50.811292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8cab9a5-845c-4175-8991-441d93789001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105372520>]}
[0m23:48:50.835686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8cab9a5-845c-4175-8991-441d93789001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10526c050>]}
[0m23:48:50.837209 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:48:50.897255 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:48:50.959026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:48:50.959394 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/hourly_weather_patterns.sql
[0m23:48:51.056990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8cab9a5-845c-4175-8991-441d93789001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e7450>]}
[0m23:48:51.103162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8cab9a5-845c-4175-8991-441d93789001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051bbe30>]}
[0m23:48:51.103459 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m23:48:51.103616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8cab9a5-845c-4175-8991-441d93789001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057343d0>]}
[0m23:48:51.104597 [info ] [MainThread]: 
[0m23:48:51.104878 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:48:51.107235 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:48:51.113737 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:48:51.113974 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:48:51.114103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:51.604278 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.490 seconds
[0m23:48:51.607831 [debug] [ThreadPool]: On list_openweather: Close
[0m23:48:51.741094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:48:51.752066 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:48:51.752407 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:48:51.752666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:48:52.250262 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.497 seconds
[0m23:48:52.253444 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:48:52.368195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8cab9a5-845c-4175-8991-441d93789001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045013d0>]}
[0m23:48:52.368998 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:48:52.369421 [info ] [MainThread]: 
[0m23:48:52.373888 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m23:48:52.374589 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m23:48:52.375111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m23:48:52.375487 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m23:48:52.383577 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:48:52.384432 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m23:48:52.407190 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:48:52.408279 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m23:48:52.408548 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m23:48:52.408769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:53.522069 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.113 seconds
[0m23:48:53.547913 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m23:48:53.672278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8cab9a5-845c-4175-8991-441d93789001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058cf950>]}
[0m23:48:53.673461 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.30s]
[0m23:48:53.674329 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m23:48:53.674914 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m23:48:53.675563 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m23:48:53.676176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m23:48:53.676572 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m23:48:53.680156 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m23:48:53.681177 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m23:48:53.684601 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m23:48:53.686493 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m23:48:53.686919 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20
ORDER BY
    w.DATE_TIME, c."Name"
        );
[0m23:48:53.687216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:54.896859 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.209 seconds
[0m23:48:54.900618 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m23:48:55.026440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8cab9a5-845c-4175-8991-441d93789001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ea150>]}
[0m23:48:55.027562 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.35s]
[0m23:48:55.028164 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m23:48:55.028598 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m23:48:55.029155 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m23:48:55.029656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m23:48:55.029994 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m23:48:55.033591 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m23:48:55.034605 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m23:48:55.037813 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m23:48:55.039356 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m23:48:55.039737 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (

SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,  -- Include city name for better insights
    EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
ORDER BY
    c."Name", HOUR_OF_DAY
        );
[0m23:48:55.040067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:56.151580 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.111 seconds
[0m23:48:56.156192 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m23:48:56.280548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8cab9a5-845c-4175-8991-441d93789001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac99f0>]}
[0m23:48:56.281548 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.hourly_weather_patterns ............ [[32mSUCCESS 1[0m in 1.25s]
[0m23:48:56.282341 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m23:48:56.282880 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:48:56.283586 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:48:56.284255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m23:48:56.284718 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:48:56.288467 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:48:56.289547 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:48:56.308458 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:48:56.309494 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:48:56.309774 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m23:48:56.310035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:57.002798 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.692 seconds
[0m23:48:57.007114 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:48:57.157870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8cab9a5-845c-4175-8991-441d93789001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105177850>]}
[0m23:48:57.159061 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.87s]
[0m23:48:57.159734 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:48:57.160193 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m23:48:57.160702 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m23:48:57.161179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m23:48:57.161518 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m23:48:57.164871 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m23:48:57.165846 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m23:48:57.168520 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m23:48:57.169519 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m23:48:57.169815 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN
ORDER BY
    CONDITION_COUNT DESC, c."Name"
        );
[0m23:48:57.170096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:58.267209 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.097 seconds
[0m23:48:58.270516 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m23:48:58.389778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8cab9a5-845c-4175-8991-441d93789001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d508a0>]}
[0m23:48:58.390578 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.23s]
[0m23:48:58.391125 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m23:48:58.392501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:58.392768 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m23:48:58.393052 [info ] [MainThread]: 
[0m23:48:58.393276 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 7.29 seconds (7.29s).
[0m23:48:58.394113 [debug] [MainThread]: Command end result
[0m23:48:58.420584 [info ] [MainThread]: 
[0m23:48:58.420924 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:48:58.421134 [info ] [MainThread]: 
[0m23:48:58.421349 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m23:48:58.422879 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.857598, "process_in_blocks": "0", "process_kernel_time": 0.235602, "process_mem_max_rss": "142049280", "process_out_blocks": "0", "process_user_time": 1.554788}
[0m23:48:58.423205 [debug] [MainThread]: Command `dbt run` succeeded at 23:48:58.423146 after 7.86 seconds
[0m23:48:58.423423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105986990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034d9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105af5070>]}
[0m23:48:58.423626 [debug] [MainThread]: Flushing usage events
[0m23:54:11.608006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105598d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f13b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f13d90>]}


============================== 23:54:11.611157 | f1c63ae5-7a31-45ae-b254-8d32cd548005 ==============================
[0m23:54:11.611157 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:54:11.611504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:54:11.665598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1c63ae5-7a31-45ae-b254-8d32cd548005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687f360>]}
[0m23:54:11.676768 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.10731396, "process_in_blocks": "0", "process_kernel_time": 0.129333, "process_mem_max_rss": "99926016", "process_out_blocks": "0", "process_user_time": 0.616944}
[0m23:54:11.677048 [debug] [MainThread]: Command `dbt clean` succeeded at 23:54:11.676995 after 0.11 seconds
[0m23:54:11.677213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10903e580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10903e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dde950>]}
[0m23:54:11.677762 [debug] [MainThread]: Flushing usage events
[0m23:54:15.975282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fbb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fbd90>]}


============================== 23:54:15.978184 | 4ccc3943-a7cc-4857-ad69-5eb109aefd48 ==============================
[0m23:54:15.978184 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:54:15.978474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:54:16.197176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ccc3943-a7cc-4857-ad69-5eb109aefd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e56520>]}
[0m23:54:16.221113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ccc3943-a7cc-4857-ad69-5eb109aefd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d50050>]}
[0m23:54:16.222661 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:54:16.283873 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:54:16.284398 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:54:16.284570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4ccc3943-a7cc-4857-ad69-5eb109aefd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc8a50>]}
[0m23:54:16.812191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ccc3943-a7cc-4857-ad69-5eb109aefd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f29220>]}
[0m23:54:16.854728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ccc3943-a7cc-4857-ad69-5eb109aefd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070619b0>]}
[0m23:54:16.855047 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m23:54:16.855215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ccc3943-a7cc-4857-ad69-5eb109aefd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e3380>]}
[0m23:54:16.856565 [info ] [MainThread]: 
[0m23:54:16.856866 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:54:16.859064 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:54:16.865544 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:54:16.865738 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:54:16.865864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:17.389924 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.524 seconds
[0m23:54:17.393362 [debug] [ThreadPool]: On list_openweather: Close
[0m23:54:17.542019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m23:54:17.553081 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:54:17.553689 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:54:17.553964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:54:18.127304 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.573 seconds
[0m23:54:18.131478 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:54:18.264894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ccc3943-a7cc-4857-ad69-5eb109aefd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10741e810>]}
[0m23:54:18.265784 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:54:18.266203 [info ] [MainThread]: 
[0m23:54:18.270903 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m23:54:18.271605 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m23:54:18.272124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m23:54:18.272510 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m23:54:18.281087 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:54:18.282406 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m23:54:18.305283 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m23:54:18.306620 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m23:54:18.306866 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m23:54:18.307084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:19.319174 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.012 seconds
[0m23:54:19.340102 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m23:54:19.478708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ccc3943-a7cc-4857-ad69-5eb109aefd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ca0a0>]}
[0m23:54:19.479812 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.21s]
[0m23:54:19.480873 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m23:54:19.481521 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m23:54:19.482556 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m23:54:19.483296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m23:54:19.483712 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m23:54:19.487666 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m23:54:19.488502 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m23:54:19.490728 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m23:54:19.492292 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m23:54:19.492757 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m23:54:19.493125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:20.621137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.128 seconds
[0m23:54:20.625817 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m23:54:20.743766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ccc3943-a7cc-4857-ad69-5eb109aefd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10754bf70>]}
[0m23:54:20.744957 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.26s]
[0m23:54:20.745662 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m23:54:20.746162 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m23:54:20.746836 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m23:54:20.747512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m23:54:20.748006 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m23:54:20.752111 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m23:54:20.753265 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m23:54:20.755636 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m23:54:20.757062 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m23:54:20.757449 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    *
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY
        );
[0m23:54:20.757778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:21.998277 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.240 seconds
[0m23:54:22.001091 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m23:54:22.203170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ccc3943-a7cc-4857-ad69-5eb109aefd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700b250>]}
[0m23:54:22.204441 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.hourly_weather_patterns ............ [[32mSUCCESS 1[0m in 1.46s]
[0m23:54:22.205301 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m23:54:22.205848 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m23:54:22.206182 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m23:54:22.206499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m23:54:22.206702 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m23:54:22.208542 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m23:54:22.209138 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m23:54:22.229899 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m23:54:22.231005 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m23:54:22.231279 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m23:54:22.231526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:22.894108 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.662 seconds
[0m23:54:22.898770 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m23:54:23.046350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ccc3943-a7cc-4857-ad69-5eb109aefd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048348a0>]}
[0m23:54:23.047605 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.84s]
[0m23:54:23.048467 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m23:54:23.049273 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m23:54:23.050153 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m23:54:23.050738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m23:54:23.051125 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m23:54:23.055117 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m23:54:23.056271 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m23:54:23.058539 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m23:54:23.059856 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m23:54:23.060209 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    *
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME
        );
[0m23:54:23.060530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:24.066656 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.006 seconds
[0m23:54:24.071013 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m23:54:24.191027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ccc3943-a7cc-4857-ad69-5eb109aefd48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107864050>]}
[0m23:54:24.192139 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.14s]
[0m23:54:24.193144 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m23:54:24.195002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:24.195390 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m23:54:24.195787 [info ] [MainThread]: 
[0m23:54:24.196565 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 7.34 seconds (7.34s).
[0m23:54:24.198057 [debug] [MainThread]: Command end result
[0m23:54:24.224004 [info ] [MainThread]: 
[0m23:54:24.224373 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:54:24.224571 [info ] [MainThread]: 
[0m23:54:24.224776 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m23:54:24.226374 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.286973, "process_in_blocks": "0", "process_kernel_time": 0.246594, "process_mem_max_rss": "142704640", "process_out_blocks": "0", "process_user_time": 1.853131}
[0m23:54:24.226706 [debug] [MainThread]: Command `dbt run` succeeded at 23:54:24.226645 after 8.29 seconds
[0m23:54:24.226924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107867e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107867e30>]}
[0m23:54:24.227132 [debug] [MainThread]: Flushing usage events
[0m23:57:14.323737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ecd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f3d90>]}


============================== 23:57:14.327516 | d5397da7-e7f4-4cab-836c-585cb6ba1097 ==============================
[0m23:57:14.327516 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:57:14.328093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:57:14.555101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5397da7-e7f4-4cab-836c-585cb6ba1097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b61a520>]}
[0m23:57:14.577840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5397da7-e7f4-4cab-836c-585cb6ba1097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b60c050>]}
[0m23:57:14.578436 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:57:14.636234 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:57:14.697709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m23:57:14.698038 [debug] [MainThread]: Partial parsing: added file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m23:57:14.698181 [debug] [MainThread]: Partial parsing: added file: weather_dbt://snapshots/weather_conditions_frequency.sql
[0m23:57:14.698303 [debug] [MainThread]: Partial parsing: added file: weather_dbt://snapshots/hourly_weather_patterns.sql
[0m23:57:14.698419 [debug] [MainThread]: Partial parsing: added file: weather_dbt://snapshots/extreme_weather_events.sql
[0m23:57:14.821817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5397da7-e7f4-4cab-836c-585cb6ba1097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b950a50>]}
[0m23:57:14.913295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5397da7-e7f4-4cab-836c-585cb6ba1097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b543f20>]}
[0m23:57:14.913585 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m23:57:14.913744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5397da7-e7f4-4cab-836c-585cb6ba1097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9dc590>]}
[0m23:57:14.914918 [info ] [MainThread]: 
[0m23:57:14.915291 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:57:14.917602 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:57:14.923967 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:57:14.924161 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:57:14.924288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:15.480280 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.556 seconds
[0m23:57:15.484425 [debug] [ThreadPool]: On list_openweather: Close
[0m23:57:15.610155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now create_openweather_your_target_schema)
[0m23:57:15.611334 [debug] [ThreadPool]: Creating schema "database: "openweather"
schema: "your_target_schema"
"
[0m23:57:15.615935 [debug] [ThreadPool]: Using snowflake connection "create_openweather_your_target_schema"
[0m23:57:15.616228 [debug] [ThreadPool]: On create_openweather_your_target_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "create_openweather_your_target_schema"} */
create schema if not exists openweather.your_target_schema
[0m23:57:15.616450 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:57:16.084920 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.468 seconds
[0m23:57:16.087219 [debug] [ThreadPool]: On create_openweather_your_target_schema: Close
[0m23:57:16.236516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_openweather_your_target_schema, now list_openweather_your_target_schema)
[0m23:57:16.247071 [debug] [ThreadPool]: Using snowflake connection "list_openweather_your_target_schema"
[0m23:57:16.247413 [debug] [ThreadPool]: On list_openweather_your_target_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_your_target_schema"} */
show objects in openweather.your_target_schema limit 10000
[0m23:57:16.247664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:57:16.730716 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.483 seconds
[0m23:57:16.733378 [debug] [ThreadPool]: On list_openweather_your_target_schema: Close
[0m23:57:16.844565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_your_target_schema, now list_openweather_analytics)
[0m23:57:16.847091 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:57:16.847474 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:57:16.847765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:57:17.355832 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.508 seconds
[0m23:57:17.359318 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:57:17.478661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5397da7-e7f4-4cab-836c-585cb6ba1097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc75a50>]}
[0m23:57:17.479479 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:57:17.479930 [info ] [MainThread]: 
[0m23:57:17.484652 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_trend
[0m23:57:17.485120 [info ] [Thread-1 (]: 1 of 4 START snapshot your_target_schema.daily_average_weather_trend ........... [RUN]
[0m23:57:17.485427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now snapshot.weather_dbt.daily_average_weather_trend)
[0m23:57:17.485631 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_trend
[0m23:57:17.491609 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_trend
[0m23:57:17.541044 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_trend"
[0m23:57:17.541377 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_DATE as varchar ), '')
         || '|' || coalesce(cast(WEATHER_DATE as varchar ), '')
        ) as dbt_scd_id,
        WEATHER_DATE as dbt_updated_at,
        WEATHER_DATE as dbt_valid_from,
        
  
  coalesce(nullif(WEATHER_DATE, WEATHER_DATE), null)
  as dbt_valid_to
from (
        
    

    WITH Daily_Average_Weather_Trend AS (
        SELECT
            w.CITY_ID,
            c."Name" AS CITY_NAME,
            DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
            AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
            AVG(w.HUMIDITY) AS AVG_HUMIDITY
        FROM
            openweather.raw_data.WEATHER_FACT_TABLE w
        JOIN
            openweather.raw_data.CITY_DIMENSION_TABLE c
        ON
            w.CITY_ID = c.CITY_ID
        GROUP BY
            w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
    )

    SELECT
        *
    FROM
        Daily_Average_Weather_Trend
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:57:17.541582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:57:18.009683 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a5d-0004-3869-0002-59430003a6a6
[0m23:57:18.010396 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m23:57:18.010961 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: Close
[0m23:57:18.150298 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m23:57:18.152262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5397da7-e7f4-4cab-836c-585cb6ba1097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd08e90>]}
[0m23:57:18.153206 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting your_target_schema.daily_average_weather_trend ....... [[31mERROR[0m in 0.67s]
[0m23:57:18.153820 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_trend
[0m23:57:18.154235 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m23:57:18.155524 [info ] [Thread-1 (]: 2 of 4 START snapshot your_target_schema.extreme_weather_events ................ [RUN]
[0m23:57:18.156122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_trend, now snapshot.weather_dbt.extreme_weather_events)
[0m23:57:18.156416 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m23:57:18.159605 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m23:57:18.163689 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m23:57:18.164098 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        
    

    WITH Extreme_Weather_Events AS (
        SELECT
            w.CITY_ID,
            c."Name" AS CITY_NAME,
            w.DATE_TIME,
            ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
            w.WIND_SPEED,
            CASE
                WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
                WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
                WHEN w.WIND_SPEED > 20 THEN 'High Winds'
                ELSE 'Normal'
            END AS WEATHER_ALERT
        FROM
            openweather.raw_data.WEATHER_FACT_TABLE w
        JOIN
            openweather.raw_data.CITY_DIMENSION_TABLE c
        ON
            w.CITY_ID = c.CITY_ID
        WHERE
            ((w.TEMP - 273.15) * 9/5 + 32) > 100
            OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
            OR w.WIND_SPEED > 20
    )

    SELECT
        *
    FROM
        Extreme_Weather_Events
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:57:18.164413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:57:18.670735 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a5d-0004-3987-0002-59430003d166
[0m23:57:18.671516 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m23:57:18.672183 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m23:57:18.823960 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m23:57:18.824705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5397da7-e7f4-4cab-836c-585cb6ba1097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be22830>]}
[0m23:57:18.825689 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting your_target_schema.extreme_weather_events ............ [[31mERROR[0m in 0.67s]
[0m23:57:18.826327 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m23:57:18.826721 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m23:57:18.827290 [info ] [Thread-1 (]: 3 of 4 START snapshot your_target_schema.hourly_weather_patterns ............... [RUN]
[0m23:57:18.827755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m23:57:18.828092 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m23:57:18.831830 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m23:57:18.835289 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m23:57:18.835663 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        
    

    WITH Hourly_Weather_Patterns AS (
        SELECT
            w.CITY_ID,
            c."Name" AS CITY_NAME, -- Include city name for better insights
            EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
            AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
            AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
            AVG(w.HUMIDITY) AS AVG_HUMIDITY
        FROM
            openweather.raw_data.WEATHER_FACT_TABLE w
        JOIN
            openweather.raw_data.CITY_DIMENSION_TABLE c
        ON
            w.CITY_ID = c.CITY_ID
        GROUP BY
            w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
    )

    SELECT
        *
    FROM
        Hourly_Weather_Patterns
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:57:18.835993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:57:19.312001 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a5d-0004-386c-0002-59430003771a
[0m23:57:19.312612 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m23:57:19.313243 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m23:57:19.440999 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m23:57:19.441626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5397da7-e7f4-4cab-836c-585cb6ba1097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bec1e50>]}
[0m23:57:19.442477 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting your_target_schema.hourly_weather_patterns ........... [[31mERROR[0m in 0.61s]
[0m23:57:19.443108 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m23:57:19.443524 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m23:57:19.444115 [info ] [Thread-1 (]: 4 of 4 START snapshot your_target_schema.weather_conditions_frequency .......... [RUN]
[0m23:57:19.444882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m23:57:19.445400 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m23:57:19.448849 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m23:57:19.452298 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m23:57:19.452658 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        
    

    WITH Weather_Conditions_Frequency AS (
        SELECT
            w.CITY_ID,
            c."Name" AS CITY_NAME,
            w.WEATHER_MAIN,
            COUNT(*) AS CONDITION_COUNT
        FROM
            openweather.raw_data.WEATHER_FACT_TABLE w
        JOIN
            openweather.raw_data.CITY_DIMENSION_TABLE c
        ON
            w.CITY_ID = c.CITY_ID
        GROUP BY
            w.CITY_ID, c."Name", w.WEATHER_MAIN
    )

    SELECT
        *
    FROM
        Weather_Conditions_Frequency
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:57:19.452980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:57:19.892674 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a5d-0004-3867-0002-5943000356ae
[0m23:57:19.893625 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m23:57:19.894311 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m23:57:20.019694 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m23:57:20.020365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5397da7-e7f4-4cab-836c-585cb6ba1097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074a8e50>]}
[0m23:57:20.021291 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting your_target_schema.weather_conditions_frequency ...... [[31mERROR[0m in 0.58s]
[0m23:57:20.022054 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m23:57:20.023472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:57:20.023744 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m23:57:20.024011 [info ] [MainThread]: 
[0m23:57:20.024269 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 5.11 seconds (5.11s).
[0m23:57:20.025209 [debug] [MainThread]: Command end result
[0m23:57:20.047841 [info ] [MainThread]: 
[0m23:57:20.048129 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m23:57:20.048477 [info ] [MainThread]: 
[0m23:57:20.048761 [error] [MainThread]:   Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m23:57:20.048936 [info ] [MainThread]: 
[0m23:57:20.049147 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m23:57:20.049302 [info ] [MainThread]: 
[0m23:57:20.049496 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m23:57:20.049646 [info ] [MainThread]: 
[0m23:57:20.049833 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m23:57:20.049990 [info ] [MainThread]: 
[0m23:57:20.050187 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m23:57:20.051983 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.7687163, "process_in_blocks": "0", "process_kernel_time": 0.284246, "process_mem_max_rss": "142491648", "process_out_blocks": "0", "process_user_time": 1.664025}
[0m23:57:20.052403 [debug] [MainThread]: Command `dbt snapshot` failed at 23:57:20.052333 after 5.77 seconds
[0m23:57:20.052634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a06c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d4dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107842870>]}
[0m23:57:20.052834 [debug] [MainThread]: Flushing usage events
[0m23:58:54.350740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107220d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b23b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b23d90>]}


============================== 23:58:54.354310 | 242278a9-2e28-451e-93c6-64c01a68baea ==============================
[0m23:58:54.354310 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:58:54.354652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m23:58:54.574526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '242278a9-2e28-451e-93c6-64c01a68baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b41a520>]}
[0m23:58:54.596885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '242278a9-2e28-451e-93c6-64c01a68baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1f4050>]}
[0m23:58:54.597477 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:58:54.656931 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:58:54.727531 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m23:58:54.727895 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/hourly_weather_patterns.sql
[0m23:58:54.728066 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/weather_conditions_frequency.sql
[0m23:58:54.728221 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m23:58:54.728365 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/extreme_weather_events.sql
[0m23:58:54.849089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '242278a9-2e28-451e-93c6-64c01a68baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6d0950>]}
[0m23:58:54.933438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '242278a9-2e28-451e-93c6-64c01a68baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b143f20>]}
[0m23:58:54.933723 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m23:58:54.933877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '242278a9-2e28-451e-93c6-64c01a68baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4aaf90>]}
[0m23:58:54.934875 [info ] [MainThread]: 
[0m23:58:54.935138 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:58:54.937364 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:58:54.943428 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:58:54.943589 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:58:54.943714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:55.486041 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.542 seconds
[0m23:58:55.488799 [debug] [ThreadPool]: On list_openweather: Close
[0m23:58:55.621718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_your_target_schema)
[0m23:58:55.628884 [debug] [ThreadPool]: Using snowflake connection "list_openweather_your_target_schema"
[0m23:58:55.629168 [debug] [ThreadPool]: On list_openweather_your_target_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_your_target_schema"} */
show objects in openweather.your_target_schema limit 10000
[0m23:58:55.629334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:58:56.107146 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.477 seconds
[0m23:58:56.112494 [debug] [ThreadPool]: On list_openweather_your_target_schema: Close
[0m23:58:56.230918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_your_target_schema, now list_openweather_analytics)
[0m23:58:56.233989 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:58:56.234384 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:58:56.234680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:58:56.665917 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.431 seconds
[0m23:58:56.673090 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:58:56.811061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '242278a9-2e28-451e-93c6-64c01a68baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10890d3d0>]}
[0m23:58:56.811898 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:58:56.812310 [info ] [MainThread]: 
[0m23:58:56.815945 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_trend
[0m23:58:56.816558 [info ] [Thread-1 (]: 1 of 4 START snapshot your_target_schema.daily_average_weather_trend ........... [RUN]
[0m23:58:56.817034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now snapshot.weather_dbt.daily_average_weather_trend)
[0m23:58:56.817399 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_trend
[0m23:58:56.825393 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_trend
[0m23:58:56.873679 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_trend"
[0m23:58:56.873988 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_DATE as varchar ), '')
         || '|' || coalesce(cast(WEATHER_DATE as varchar ), '')
        ) as dbt_scd_id,
        WEATHER_DATE as dbt_updated_at,
        WEATHER_DATE as dbt_valid_from,
        
  
  coalesce(nullif(WEATHER_DATE, WEATHER_DATE), null)
  as dbt_valid_to
from (
        
    

    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:58:56.874190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:58:57.349232 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a5e-0004-3865-0002-59430003973a
[0m23:58:57.349913 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m23:58:57.350472 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: Close
[0m23:58:57.493008 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m23:58:57.495060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '242278a9-2e28-451e-93c6-64c01a68baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb19fd0>]}
[0m23:58:57.495980 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting your_target_schema.daily_average_weather_trend ....... [[31mERROR[0m in 0.68s]
[0m23:58:57.496596 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_trend
[0m23:58:57.497009 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m23:58:57.498086 [info ] [Thread-1 (]: 2 of 4 START snapshot your_target_schema.extreme_weather_events ................ [RUN]
[0m23:58:57.498509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_trend, now snapshot.weather_dbt.extreme_weather_events)
[0m23:58:57.498798 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m23:58:57.502086 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m23:58:57.506188 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m23:58:57.506524 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        
    

    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:58:57.506824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:58:57.939938 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a5e-0004-3864-0002-594300033fca
[0m23:58:57.940736 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m23:58:57.941403 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m23:58:58.061028 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m23:58:58.062005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '242278a9-2e28-451e-93c6-64c01a68baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc2e8e0>]}
[0m23:58:58.063426 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting your_target_schema.extreme_weather_events ............ [[31mERROR[0m in 0.56s]
[0m23:58:58.064074 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m23:58:58.064471 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m23:58:58.064884 [info ] [Thread-1 (]: 3 of 4 START snapshot your_target_schema.hourly_weather_patterns ............... [RUN]
[0m23:58:58.065341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m23:58:58.065983 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m23:58:58.070346 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m23:58:58.075137 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m23:58:58.075551 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        
    

    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:58:58.076042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:58:58.608601 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a5e-0004-386c-0002-59430003771e
[0m23:58:58.610001 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m23:58:58.610891 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m23:58:58.753378 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m23:58:58.754031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '242278a9-2e28-451e-93c6-64c01a68baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbeab70>]}
[0m23:58:58.754891 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting your_target_schema.hourly_weather_patterns ........... [[31mERROR[0m in 0.69s]
[0m23:58:58.755466 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m23:58:58.755838 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m23:58:58.756380 [info ] [Thread-1 (]: 4 of 4 START snapshot your_target_schema.weather_conditions_frequency .......... [RUN]
[0m23:58:58.756870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m23:58:58.757203 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m23:58:58.760821 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m23:58:58.769167 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m23:58:58.769540 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        
    

    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:58:58.769853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:58:59.184880 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a5e-0004-3869-0002-59430003a6aa
[0m23:58:59.185805 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m23:58:59.186262 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m23:58:59.310810 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m23:58:59.311680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '242278a9-2e28-451e-93c6-64c01a68baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b993b50>]}
[0m23:58:59.312693 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting your_target_schema.weather_conditions_frequency ...... [[31mERROR[0m in 0.55s]
[0m23:58:59.313584 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m23:58:59.315716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:58:59.316180 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m23:58:59.316504 [info ] [MainThread]: 
[0m23:58:59.316804 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 4.38 seconds (4.38s).
[0m23:58:59.317938 [debug] [MainThread]: Command end result
[0m23:58:59.341686 [info ] [MainThread]: 
[0m23:58:59.342100 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m23:58:59.342318 [info ] [MainThread]: 
[0m23:58:59.342601 [error] [MainThread]:   Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m23:58:59.342779 [info ] [MainThread]: 
[0m23:58:59.343019 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m23:58:59.343177 [info ] [MainThread]: 
[0m23:58:59.343371 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m23:58:59.343522 [info ] [MainThread]: 
[0m23:58:59.343714 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m23:58:59.343867 [info ] [MainThread]: 
[0m23:58:59.344150 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m23:58:59.345730 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.0356827, "process_in_blocks": "0", "process_kernel_time": 0.272773, "process_mem_max_rss": "140247040", "process_out_blocks": "0", "process_user_time": 1.582719}
[0m23:58:59.346086 [debug] [MainThread]: Command `dbt snapshot` failed at 23:58:59.346026 after 5.04 seconds
[0m23:58:59.346332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e81d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf7bd20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107979bb0>]}
[0m23:58:59.346526 [debug] [MainThread]: Flushing usage events
[0m23:59:30.624027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b04d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105417b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105417d90>]}


============================== 23:59:30.626536 | d53720d3-af31-4da8-a693-2e07bf204971 ==============================
[0m23:59:30.626536 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:59:30.626838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:59:30.788702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd53720d3-af31-4da8-a693-2e07bf204971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621a520>]}
[0m23:59:30.813296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd53720d3-af31-4da8-a693-2e07bf204971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fc050>]}
[0m23:59:30.813820 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:59:30.868168 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:59:30.927207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:59:30.927438 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:59:30.947427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd53720d3-af31-4da8-a693-2e07bf204971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10616b850>]}
[0m23:59:30.995335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd53720d3-af31-4da8-a693-2e07bf204971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106141310>]}
[0m23:59:30.995637 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m23:59:30.995790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd53720d3-af31-4da8-a693-2e07bf204971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671cc90>]}
[0m23:59:30.996755 [info ] [MainThread]: 
[0m23:59:30.997047 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:59:30.999186 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m23:59:31.005970 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m23:59:31.006137 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m23:59:31.006263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:31.490740 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.484 seconds
[0m23:59:31.494266 [debug] [ThreadPool]: On list_openweather: Close
[0m23:59:31.619317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_your_target_schema)
[0m23:59:31.630283 [debug] [ThreadPool]: Using snowflake connection "list_openweather_your_target_schema"
[0m23:59:31.630658 [debug] [ThreadPool]: On list_openweather_your_target_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_your_target_schema"} */
show objects in openweather.your_target_schema limit 10000
[0m23:59:31.630910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:59:32.290846 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.659 seconds
[0m23:59:32.294064 [debug] [ThreadPool]: On list_openweather_your_target_schema: Close
[0m23:59:32.431627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_your_target_schema, now list_openweather_analytics)
[0m23:59:32.434404 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m23:59:32.434754 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m23:59:32.435036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:59:32.974638 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.539 seconds
[0m23:59:32.978118 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m23:59:33.116746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd53720d3-af31-4da8-a693-2e07bf204971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066efad0>]}
[0m23:59:33.117626 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:59:33.117996 [info ] [MainThread]: 
[0m23:59:33.122202 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_trend
[0m23:59:33.122942 [info ] [Thread-1 (]: 1 of 4 START snapshot your_target_schema.daily_average_weather_trend ........... [RUN]
[0m23:59:33.123479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now snapshot.weather_dbt.daily_average_weather_trend)
[0m23:59:33.123902 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_trend
[0m23:59:33.190873 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_trend
[0m23:59:33.226841 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_trend"
[0m23:59:33.227143 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_DATE as varchar ), '')
         || '|' || coalesce(cast(WEATHER_DATE as varchar ), '')
        ) as dbt_scd_id,
        WEATHER_DATE as dbt_updated_at,
        WEATHER_DATE as dbt_valid_from,
        
  
  coalesce(nullif(WEATHER_DATE, WEATHER_DATE), null)
  as dbt_valid_to
from (
        
    

    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:59:33.227326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:33.688968 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a5f-0004-3863-0002-5943000366d2
[0m23:59:33.689679 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m23:59:33.690278 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: Close
[0m23:59:33.822680 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m23:59:33.824749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53720d3-af31-4da8-a693-2e07bf204971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ff710>]}
[0m23:59:33.825793 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting your_target_schema.daily_average_weather_trend ....... [[31mERROR[0m in 0.70s]
[0m23:59:33.826435 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_trend
[0m23:59:33.826864 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m23:59:33.828052 [info ] [Thread-1 (]: 2 of 4 START snapshot your_target_schema.extreme_weather_events ................ [RUN]
[0m23:59:33.828486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_trend, now snapshot.weather_dbt.extreme_weather_events)
[0m23:59:33.828856 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m23:59:33.832226 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m23:59:33.836457 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m23:59:33.836837 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        
    

    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:59:33.837139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:34.223225 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a5f-0004-386b-0002-59430003b6a6
[0m23:59:34.224032 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m23:59:34.224695 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m23:59:34.359037 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m23:59:34.359908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53720d3-af31-4da8-a693-2e07bf204971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf9700>]}
[0m23:59:34.360925 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting your_target_schema.extreme_weather_events ............ [[31mERROR[0m in 0.53s]
[0m23:59:34.361536 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m23:59:34.361942 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m23:59:34.362365 [info ] [Thread-1 (]: 3 of 4 START snapshot your_target_schema.hourly_weather_patterns ............... [RUN]
[0m23:59:34.362858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m23:59:34.363593 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m23:59:34.366075 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m23:59:34.368434 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m23:59:34.368708 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        
    

    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:59:34.368936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:34.773457 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a5f-0004-386a-0002-5943000346aa
[0m23:59:34.774271 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m23:59:34.774960 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m23:59:34.901062 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m23:59:34.901827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53720d3-af31-4da8-a693-2e07bf204971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f8410>]}
[0m23:59:34.902739 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting your_target_schema.hourly_weather_patterns ........... [[31mERROR[0m in 0.54s]
[0m23:59:34.903329 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m23:59:34.903729 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m23:59:34.904075 [info ] [Thread-1 (]: 4 of 4 START snapshot your_target_schema.weather_conditions_frequency .......... [RUN]
[0m23:59:34.904421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m23:59:34.904692 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m23:59:34.908059 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m23:59:34.911390 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m23:59:34.911862 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        
    

    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:59:34.912228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:35.348086 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a5f-0004-3864-0002-594300033fd2
[0m23:59:35.349387 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m23:59:35.350033 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m23:59:35.469145 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m23:59:35.470048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53720d3-af31-4da8-a693-2e07bf204971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107686ed0>]}
[0m23:59:35.470950 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting your_target_schema.weather_conditions_frequency ...... [[31mERROR[0m in 0.57s]
[0m23:59:35.471558 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m23:59:35.473196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:59:35.473661 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m23:59:35.474016 [info ] [MainThread]: 
[0m23:59:35.474324 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m23:59:35.475376 [debug] [MainThread]: Command end result
[0m23:59:35.497816 [info ] [MainThread]: 
[0m23:59:35.498164 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m23:59:35.498360 [info ] [MainThread]: 
[0m23:59:35.498617 [error] [MainThread]:   Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m23:59:35.498789 [info ] [MainThread]: 
[0m23:59:35.498973 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m23:59:35.499114 [info ] [MainThread]: 
[0m23:59:35.499289 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m23:59:35.499423 [info ] [MainThread]: 
[0m23:59:35.499593 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m23:59:35.499732 [info ] [MainThread]: 
[0m23:59:35.499880 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m23:59:35.501672 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 4.9115443, "process_in_blocks": "0", "process_kernel_time": 0.236563, "process_mem_max_rss": "139231232", "process_out_blocks": "0", "process_user_time": 1.479516}
[0m23:59:35.502006 [debug] [MainThread]: Command `dbt snapshot` failed at 23:59:35.501946 after 4.91 seconds
[0m23:59:35.502234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10542ac80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10078dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105251250>]}
[0m23:59:35.502436 [debug] [MainThread]: Flushing usage events
[0m00:03:07.840948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107698d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113813b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113813d90>]}


============================== 00:03:07.844695 | deae0a0f-d5b9-42df-aa20-fb148f47f439 ==============================
[0m00:03:07.844695 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:03:07.845133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m00:03:08.076333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'deae0a0f-d5b9-42df-aa20-fb148f47f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11481a520>]}
[0m00:03:08.099677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'deae0a0f-d5b9-42df-aa20-fb148f47f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145fc050>]}
[0m00:03:08.100332 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:03:08.162312 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:03:08.233951 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m00:03:08.234324 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/extreme_weather_events.sql
[0m00:03:08.234500 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/weather_conditions_frequency.sql
[0m00:03:08.234650 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:03:08.234800 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/hourly_weather_patterns.sql
[0m00:03:08.358597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'deae0a0f-d5b9-42df-aa20-fb148f47f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ad0950>]}
[0m00:03:08.452381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'deae0a0f-d5b9-42df-aa20-fb148f47f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114543f20>]}
[0m00:03:08.452669 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m00:03:08.452824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deae0a0f-d5b9-42df-aa20-fb148f47f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148aaf90>]}
[0m00:03:08.453825 [info ] [MainThread]: 
[0m00:03:08.454114 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:03:08.456619 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m00:03:08.463163 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m00:03:08.463358 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m00:03:08.463485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:09.082238 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.618 seconds
[0m00:03:09.084982 [debug] [ThreadPool]: On list_openweather: Close
[0m00:03:09.253176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_snapshot)
[0m00:03:09.263833 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m00:03:09.264129 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m00:03:09.264316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:09.767938 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.503 seconds
[0m00:03:09.771757 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m00:03:09.919463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m00:03:09.923019 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m00:03:09.923521 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m00:03:09.923900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:10.467595 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.543 seconds
[0m00:03:10.471070 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m00:03:10.599660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deae0a0f-d5b9-42df-aa20-fb148f47f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137393d0>]}
[0m00:03:10.600633 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:03:10.601003 [info ] [MainThread]: 
[0m00:03:10.604782 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:03:10.605556 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.daily_average_weather_trend ..................... [RUN]
[0m00:03:10.606058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now snapshot.weather_dbt.daily_average_weather_trend)
[0m00:03:10.606429 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_trend
[0m00:03:10.615569 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_trend
[0m00:03:10.665012 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_trend"
[0m00:03:10.665354 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_DATE as varchar ), '')
         || '|' || coalesce(cast(WEATHER_DATE as varchar ), '')
        ) as dbt_scd_id,
        WEATHER_DATE as dbt_updated_at,
        WEATHER_DATE as dbt_valid_from,
        
  
  coalesce(nullif(WEATHER_DATE, WEATHER_DATE), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:03:10.665550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:11.153361 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a63-0004-3864-0002-594300033fd6
[0m00:03:11.153922 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:03:11.154378 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: Close
[0m00:03:11.299054 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:03:11.300959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deae0a0f-d5b9-42df-aa20-fb148f47f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a18590>]}
[0m00:03:11.301811 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshot.daily_average_weather_trend ................. [[31mERROR[0m in 0.69s]
[0m00:03:11.302408 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:03:11.302800 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m00:03:11.303203 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.extreme_weather_events .......................... [RUN]
[0m00:03:11.304879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_trend, now snapshot.weather_dbt.extreme_weather_events)
[0m00:03:11.305279 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m00:03:11.308525 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m00:03:11.312667 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m00:03:11.313042 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:03:11.313364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:11.742320 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a63-0004-386a-0002-5943000346ae
[0m00:03:11.743278 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m00:03:11.743981 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m00:03:11.902821 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:03:11.903604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deae0a0f-d5b9-42df-aa20-fb148f47f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b32a40>]}
[0m00:03:11.904595 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshot.extreme_weather_events ...................... [[31mERROR[0m in 0.60s]
[0m00:03:11.905269 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m00:03:11.905742 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:03:11.906369 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.hourly_weather_patterns ......................... [RUN]
[0m00:03:11.906879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m00:03:11.907221 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m00:03:11.911005 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m00:03:11.915225 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m00:03:11.915579 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME, -- Include city name for better insights
    EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:03:11.915897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:12.333780 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a63-0004-3867-0002-5943000356ba
[0m00:03:12.335188 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m00:03:12.336400 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m00:03:12.577877 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:03:12.578871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deae0a0f-d5b9-42df-aa20-fb148f47f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ca0690>]}
[0m00:03:12.579877 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshot.hourly_weather_patterns ..................... [[31mERROR[0m in 0.67s]
[0m00:03:12.580465 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:03:12.580870 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:03:12.581528 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.weather_conditions_frequency .................... [RUN]
[0m00:03:12.582094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m00:03:12.582448 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m00:03:12.586367 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m00:03:12.596117 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m00:03:12.596615 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:03:12.596911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:13.080016 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a63-0004-3867-0002-5943000356be
[0m00:03:13.080706 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:03:13.081420 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m00:03:13.207220 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:03:13.208087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deae0a0f-d5b9-42df-aa20-fb148f47f439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ac1450>]}
[0m00:03:13.209179 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshot.weather_conditions_frequency ................ [[31mERROR[0m in 0.63s]
[0m00:03:13.209878 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:03:13.211387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:13.211647 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m00:03:13.211931 [info ] [MainThread]: 
[0m00:03:13.212191 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 4.76 seconds (4.76s).
[0m00:03:13.213244 [debug] [MainThread]: Command end result
[0m00:03:13.236498 [info ] [MainThread]: 
[0m00:03:13.236817 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:03:13.237060 [info ] [MainThread]: 
[0m00:03:13.237309 [error] [MainThread]:   Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:03:13.237504 [info ] [MainThread]: 
[0m00:03:13.237707 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:03:13.237863 [info ] [MainThread]: 
[0m00:03:13.238054 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:03:13.238268 [info ] [MainThread]: 
[0m00:03:13.238567 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:03:13.238760 [info ] [MainThread]: 
[0m00:03:13.238943 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:03:13.240508 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.44247, "process_in_blocks": "0", "process_kernel_time": 0.273168, "process_mem_max_rss": "140951552", "process_out_blocks": "0", "process_user_time": 1.634638}
[0m00:03:13.240838 [debug] [MainThread]: Command `dbt snapshot` failed at 00:03:13.240779 after 5.44 seconds
[0m00:03:13.241049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10478dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ba7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102818b0>]}
[0m00:03:13.241252 [debug] [MainThread]: Flushing usage events
[0m00:06:14.639925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a98d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b17b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b17d90>]}


============================== 00:06:14.643359 | 3ff30693-afca-49b7-b5e6-d2f8f79e31f3 ==============================
[0m00:06:14.643359 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:06:14.643722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:06:14.870351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ff30693-afca-49b7-b5e6-d2f8f79e31f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11831a520>]}
[0m00:06:14.894444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ff30693-afca-49b7-b5e6-d2f8f79e31f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180fc050>]}
[0m00:06:14.895135 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:06:14.955804 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:06:15.030330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:06:15.030723 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:06:15.030894 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/hourly_weather_patterns.sql
[0m00:06:15.145494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ff30693-afca-49b7-b5e6-d2f8f79e31f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1185b4150>]}
[0m00:06:15.230428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ff30693-afca-49b7-b5e6-d2f8f79e31f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118043f20>]}
[0m00:06:15.230732 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m00:06:15.230894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ff30693-afca-49b7-b5e6-d2f8f79e31f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1186f4050>]}
[0m00:06:15.231908 [info ] [MainThread]: 
[0m00:06:15.232169 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:06:15.234243 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m00:06:15.240425 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m00:06:15.240576 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m00:06:15.240701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:06:15.865455 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.624 seconds
[0m00:06:15.869411 [debug] [ThreadPool]: On list_openweather: Close
[0m00:06:16.025368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m00:06:16.036193 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m00:06:16.036563 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m00:06:16.036827 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:06:16.526229 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.489 seconds
[0m00:06:16.530295 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m00:06:16.662604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m00:06:16.667169 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m00:06:16.667544 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m00:06:16.667836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:06:17.224891 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.557 seconds
[0m00:06:17.228084 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m00:06:17.359048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ff30693-afca-49b7-b5e6-d2f8f79e31f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11881b2b0>]}
[0m00:06:17.359981 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:06:17.360428 [info ] [MainThread]: 
[0m00:06:17.365619 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:06:17.366241 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.daily_average_weather_trend ..................... [RUN]
[0m00:06:17.366710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now snapshot.weather_dbt.daily_average_weather_trend)
[0m00:06:17.367068 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_trend
[0m00:06:17.376786 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_trend
[0m00:06:17.424803 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_trend"
[0m00:06:17.425117 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_DATE as varchar ), '')
         || '|' || coalesce(cast(WEATHER_DATE as varchar ), '')
        ) as dbt_scd_id,
        WEATHER_DATE as dbt_updated_at,
        WEATHER_DATE as dbt_valid_from,
        
  
  coalesce(nullif(WEATHER_DATE, WEATHER_DATE), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    DATE_TRUNC('DAY', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('DAY', w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:06:17.425331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:17.912565 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a66-0004-3863-0002-5943000366d6
[0m00:06:17.913287 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:06:17.913887 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: Close
[0m00:06:18.055783 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:06:18.057826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ff30693-afca-49b7-b5e6-d2f8f79e31f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a15cd0>]}
[0m00:06:18.058788 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshot.daily_average_weather_trend ................. [[31mERROR[0m in 0.69s]
[0m00:06:18.059397 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:06:18.059804 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m00:06:18.060954 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.extreme_weather_events .......................... [RUN]
[0m00:06:18.061387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_trend, now snapshot.weather_dbt.extreme_weather_events)
[0m00:06:18.061686 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m00:06:18.065092 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m00:06:18.069353 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m00:06:18.069731 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:06:18.070031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:18.536341 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a66-0004-3987-0002-59430003d16e
[0m00:06:18.537799 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m00:06:18.538660 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m00:06:18.694338 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:06:18.695160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ff30693-afca-49b7-b5e6-d2f8f79e31f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b32ba0>]}
[0m00:06:18.695917 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshot.extreme_weather_events ...................... [[31mERROR[0m in 0.63s]
[0m00:06:18.696353 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m00:06:18.696660 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:06:18.697085 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.hourly_weather_patterns ......................... [RUN]
[0m00:06:18.697663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m00:06:18.698052 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m00:06:18.701743 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m00:06:18.705183 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m00:06:18.705582 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:06:18.705928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:19.112547 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a66-0004-3868-0002-5943000386c6
[0m00:06:19.113466 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m00:06:19.114114 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m00:06:19.241817 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:06:19.242413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ff30693-afca-49b7-b5e6-d2f8f79e31f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118be5810>]}
[0m00:06:19.243384 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshot.hourly_weather_patterns ..................... [[31mERROR[0m in 0.54s]
[0m00:06:19.244004 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:06:19.244389 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:06:19.244907 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.weather_conditions_frequency .................... [RUN]
[0m00:06:19.245358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m00:06:19.245677 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m00:06:19.249392 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m00:06:19.257886 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m00:06:19.258256 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:06:19.258530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:19.628586 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a66-0004-3868-0002-5943000386ca
[0m00:06:19.629465 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:06:19.630207 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m00:06:19.778831 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:06:19.779569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ff30693-afca-49b7-b5e6-d2f8f79e31f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180f36d0>]}
[0m00:06:19.780525 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshot.weather_conditions_frequency ................ [[31mERROR[0m in 0.53s]
[0m00:06:19.781103 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:06:19.782555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:06:19.782876 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m00:06:19.783190 [info ] [MainThread]: 
[0m00:06:19.783475 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 4.55 seconds (4.55s).
[0m00:06:19.784471 [debug] [MainThread]: Command end result
[0m00:06:19.808113 [info ] [MainThread]: 
[0m00:06:19.808376 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:06:19.808548 [info ] [MainThread]: 
[0m00:06:19.808767 [error] [MainThread]:   Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:06:19.808933 [info ] [MainThread]: 
[0m00:06:19.809128 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:06:19.809282 [info ] [MainThread]: 
[0m00:06:19.809474 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:06:19.809621 [info ] [MainThread]: 
[0m00:06:19.809807 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:06:19.809960 [info ] [MainThread]: 
[0m00:06:19.810127 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:06:19.811599 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.212215, "process_in_blocks": "0", "process_kernel_time": 0.28024, "process_mem_max_rss": "142196736", "process_out_blocks": "0", "process_user_time": 1.605539}
[0m00:06:19.811975 [debug] [MainThread]: Command `dbt snapshot` failed at 00:06:19.811912 after 5.21 seconds
[0m00:06:19.812178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100bd1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118bc31c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040d04d0>]}
[0m00:06:19.812362 [debug] [MainThread]: Flushing usage events
[0m00:06:26.189980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10729cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b9fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b9fd90>]}


============================== 00:06:26.192318 | a13daea7-3e62-4dac-bbd4-d44ea27d45dc ==============================
[0m00:06:26.192318 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:06:26.192620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:06:26.240443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a13daea7-3e62-4dac-bbd4-d44ea27d45dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a0b360>]}
[0m00:06:26.251406 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.09727796, "process_in_blocks": "0", "process_kernel_time": 0.08744, "process_mem_max_rss": "100941824", "process_out_blocks": "0", "process_user_time": 0.617971}
[0m00:06:26.251685 [debug] [MainThread]: Command `dbt clean` succeeded at 00:06:26.251630 after 0.10 seconds
[0m00:06:26.251850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cca580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cca690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108932950>]}
[0m00:06:26.252019 [debug] [MainThread]: Flushing usage events
[0m00:06:32.158556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103498d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c13b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c13d90>]}


============================== 00:06:32.160937 | 1cf90c60-c4d7-4228-9fc4-102de40e61ff ==============================
[0m00:06:32.160937 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:06:32.161242 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:06:32.342043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cf90c60-c4d7-4228-9fc4-102de40e61ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106afa520>]}
[0m00:06:32.366473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cf90c60-c4d7-4228-9fc4-102de40e61ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f4050>]}
[0m00:06:32.366957 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:06:32.423861 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:06:32.424512 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:06:32.424701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1cf90c60-c4d7-4228-9fc4-102de40e61ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106968a50>]}
[0m00:06:33.011927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cf90c60-c4d7-4228-9fc4-102de40e61ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e85040>]}
[0m00:06:33.058342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cf90c60-c4d7-4228-9fc4-102de40e61ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c698d0>]}
[0m00:06:33.058620 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m00:06:33.058778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cf90c60-c4d7-4228-9fc4-102de40e61ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c97790>]}
[0m00:06:33.059902 [info ] [MainThread]: 
[0m00:06:33.060253 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:06:33.062552 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m00:06:33.068886 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m00:06:33.069073 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m00:06:33.069194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:06:33.660540 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.591 seconds
[0m00:06:33.663417 [debug] [ThreadPool]: On list_openweather: Close
[0m00:06:33.780074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_snapshot)
[0m00:06:33.792029 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m00:06:33.792383 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m00:06:33.792640 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:06:34.388420 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.596 seconds
[0m00:06:34.391636 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m00:06:34.536958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m00:06:34.539855 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m00:06:34.540237 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m00:06:34.540535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:06:35.090096 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.549 seconds
[0m00:06:35.094236 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m00:06:35.218192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cf90c60-c4d7-4228-9fc4-102de40e61ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d2f890>]}
[0m00:06:35.219275 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:06:35.219740 [info ] [MainThread]: 
[0m00:06:35.223391 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:06:35.224066 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.daily_average_weather_trend ..................... [RUN]
[0m00:06:35.224562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now snapshot.weather_dbt.daily_average_weather_trend)
[0m00:06:35.224938 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_trend
[0m00:06:35.233729 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_trend
[0m00:06:35.281979 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_trend"
[0m00:06:35.282294 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_DATE as varchar ), '')
         || '|' || coalesce(cast(WEATHER_DATE as varchar ), '')
        ) as dbt_scd_id,
        WEATHER_DATE as dbt_updated_at,
        WEATHER_DATE as dbt_valid_from,
        
  
  coalesce(nullif(WEATHER_DATE, WEATHER_DATE), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    DATE_TRUNC('DAY', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('DAY', w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:06:35.282489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:35.729684 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a66-0004-3987-0002-59430003d172
[0m00:06:35.730354 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:06:35.730933 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: Close
[0m00:06:35.876233 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:06:35.877972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cf90c60-c4d7-4228-9fc4-102de40e61ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108868520>]}
[0m00:06:35.878902 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshot.daily_average_weather_trend ................. [[31mERROR[0m in 0.65s]
[0m00:06:35.879518 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:06:35.879900 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m00:06:35.880972 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.extreme_weather_events .......................... [RUN]
[0m00:06:35.881401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_trend, now snapshot.weather_dbt.extreme_weather_events)
[0m00:06:35.881698 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m00:06:35.885090 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m00:06:35.888331 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m00:06:35.888645 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:06:35.888941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:36.363470 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a66-0004-386c-0002-594300037726
[0m00:06:36.364384 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m00:06:36.365123 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m00:06:36.492086 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:06:36.492921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cf90c60-c4d7-4228-9fc4-102de40e61ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108856cb0>]}
[0m00:06:36.493887 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshot.extreme_weather_events ...................... [[31mERROR[0m in 0.61s]
[0m00:06:36.494493 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m00:06:36.494901 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:06:36.495501 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.hourly_weather_patterns ......................... [RUN]
[0m00:06:36.496023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m00:06:36.496364 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m00:06:36.500288 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m00:06:36.503786 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m00:06:36.504135 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:06:36.504452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:36.939515 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a66-0004-386b-0002-59430003b6ae
[0m00:06:36.940128 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m00:06:36.940772 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m00:06:37.107639 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:06:37.108228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cf90c60-c4d7-4228-9fc4-102de40e61ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9dd50>]}
[0m00:06:37.109064 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshot.hourly_weather_patterns ..................... [[31mERROR[0m in 0.61s]
[0m00:06:37.109678 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:06:37.110081 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:06:37.110682 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.weather_conditions_frequency .................... [RUN]
[0m00:06:37.111071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m00:06:37.111312 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m00:06:37.113597 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m00:06:37.116120 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m00:06:37.116411 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:06:37.116652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:37.659640 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a66-0004-3869-0002-59430003a6ae
[0m00:06:37.661014 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:06:37.661805 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m00:06:37.802878 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:06:37.803695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cf90c60-c4d7-4228-9fc4-102de40e61ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103935b70>]}
[0m00:06:37.804721 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshot.weather_conditions_frequency ................ [[31mERROR[0m in 0.69s]
[0m00:06:37.805299 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:06:37.806760 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:06:37.807022 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m00:06:37.807304 [info ] [MainThread]: 
[0m00:06:37.807571 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 4.75 seconds (4.75s).
[0m00:06:37.808557 [debug] [MainThread]: Command end result
[0m00:06:37.831010 [info ] [MainThread]: 
[0m00:06:37.831290 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:06:37.831473 [info ] [MainThread]: 
[0m00:06:37.831703 [error] [MainThread]:   Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:06:37.831870 [info ] [MainThread]: 
[0m00:06:37.832066 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:06:37.832219 [info ] [MainThread]: 
[0m00:06:37.832412 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:06:37.832557 [info ] [MainThread]: 
[0m00:06:37.832745 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:06:37.832894 [info ] [MainThread]: 
[0m00:06:37.833067 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:06:37.834429 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.7102885, "process_in_blocks": "0", "process_kernel_time": 0.234564, "process_mem_max_rss": "144965632", "process_out_blocks": "0", "process_user_time": 1.959329}
[0m00:06:37.834713 [debug] [MainThread]: Command `dbt snapshot` failed at 00:06:37.834663 after 5.71 seconds
[0m00:06:37.834907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac2870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c17e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c17dd0>]}
[0m00:06:37.835081 [debug] [MainThread]: Flushing usage events
[0m00:07:30.285143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105198d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107017b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107017d90>]}


============================== 00:07:30.288380 | b0154c93-0f94-4ac5-9178-6cb67ded32df ==============================
[0m00:07:30.288380 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:07:30.288697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:07:30.504906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0154c93-0f94-4ac5-9178-6cb67ded32df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f8a520>]}
[0m00:07:30.528090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0154c93-0f94-4ac5-9178-6cb67ded32df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ef4050>]}
[0m00:07:30.528681 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:07:30.589297 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:07:30.660314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:07:30.660727 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:07:30.773623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0154c93-0f94-4ac5-9178-6cb67ded32df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12123ce50>]}
[0m00:07:30.826719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0154c93-0f94-4ac5-9178-6cb67ded32df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120e43e30>]}
[0m00:07:30.827015 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m00:07:30.827178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0154c93-0f94-4ac5-9178-6cb67ded32df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121368ad0>]}
[0m00:07:30.828184 [info ] [MainThread]: 
[0m00:07:30.828459 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:07:30.830524 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m00:07:30.836563 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m00:07:30.836723 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m00:07:30.836848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:31.415044 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.578 seconds
[0m00:07:31.418968 [debug] [ThreadPool]: On list_openweather: Close
[0m00:07:31.562392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_snapshot)
[0m00:07:31.567903 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m00:07:31.568118 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m00:07:31.568274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:32.053239 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.485 seconds
[0m00:07:32.057600 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m00:07:32.188534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m00:07:32.192212 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m00:07:32.192717 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m00:07:32.193041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:32.706490 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.513 seconds
[0m00:07:32.712396 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m00:07:32.831589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0154c93-0f94-4ac5-9178-6cb67ded32df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121713930>]}
[0m00:07:32.832015 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:07:32.832209 [info ] [MainThread]: 
[0m00:07:32.833972 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:07:32.834271 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.daily_average_weather_trend ..................... [RUN]
[0m00:07:32.834491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now snapshot.weather_dbt.daily_average_weather_trend)
[0m00:07:32.834655 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_trend
[0m00:07:32.839206 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_trend
[0m00:07:32.882724 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_trend"
[0m00:07:32.883096 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_DATE as varchar ), '')
         || '|' || coalesce(cast(WEATHER_DATE as varchar ), '')
        ) as dbt_scd_id,
        WEATHER_DATE as dbt_updated_at,
        WEATHER_DATE as dbt_valid_from,
        
  
  coalesce(nullif(WEATHER_DATE, WEATHER_DATE), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    DATE_TRUNC('DAY', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('DAY', w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:07:32.883326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:33.350585 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a67-0004-3868-0002-5943000386ce
[0m00:07:33.351155 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:07:33.351590 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: Close
[0m00:07:33.559585 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:07:33.561965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0154c93-0f94-4ac5-9178-6cb67ded32df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121910dd0>]}
[0m00:07:33.562927 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshot.daily_average_weather_trend ................. [[31mERROR[0m in 0.73s]
[0m00:07:33.563574 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:07:33.564002 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m00:07:33.565230 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.extreme_weather_events .......................... [RUN]
[0m00:07:33.565725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_trend, now snapshot.weather_dbt.extreme_weather_events)
[0m00:07:33.566073 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m00:07:33.569601 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m00:07:33.573793 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m00:07:33.574166 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:07:33.574498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:34.111983 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a67-0004-3863-0002-5943000366da
[0m00:07:34.113284 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m00:07:34.114093 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m00:07:34.275403 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:07:34.276214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0154c93-0f94-4ac5-9178-6cb67ded32df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a2aba0>]}
[0m00:07:34.277169 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshot.extreme_weather_events ...................... [[31mERROR[0m in 0.71s]
[0m00:07:34.277740 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m00:07:34.278127 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:07:34.278689 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.hourly_weather_patterns ......................... [RUN]
[0m00:07:34.279166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m00:07:34.279511 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m00:07:34.283237 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m00:07:34.287242 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m00:07:34.287595 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:07:34.287911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:34.834729 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a67-0004-3864-0002-594300033fde
[0m00:07:34.835983 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m00:07:34.836997 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m00:07:35.028484 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:07:35.029183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0154c93-0f94-4ac5-9178-6cb67ded32df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ae8f50>]}
[0m00:07:35.030128 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshot.hourly_weather_patterns ..................... [[31mERROR[0m in 0.75s]
[0m00:07:35.030703 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:07:35.031095 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:07:35.031634 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.weather_conditions_frequency .................... [RUN]
[0m00:07:35.032090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m00:07:35.032412 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m00:07:35.036155 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m00:07:35.040321 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m00:07:35.040685 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:07:35.040997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:35.492504 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a67-0004-3868-0002-5943000386d2
[0m00:07:35.493161 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:07:35.493702 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m00:07:35.632114 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:07:35.632835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0154c93-0f94-4ac5-9178-6cb67ded32df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121406c50>]}
[0m00:07:35.633714 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshot.weather_conditions_frequency ................ [[31mERROR[0m in 0.60s]
[0m00:07:35.634245 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:07:35.635786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:07:35.636117 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m00:07:35.636417 [info ] [MainThread]: 
[0m00:07:35.636740 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 4.81 seconds (4.81s).
[0m00:07:35.637783 [debug] [MainThread]: Command end result
[0m00:07:35.664819 [info ] [MainThread]: 
[0m00:07:35.665128 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:07:35.665310 [info ] [MainThread]: 
[0m00:07:35.665543 [error] [MainThread]:   Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:07:35.665714 [info ] [MainThread]: 
[0m00:07:35.665913 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:07:35.666070 [info ] [MainThread]: 
[0m00:07:35.666255 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:07:35.666387 [info ] [MainThread]: 
[0m00:07:35.666560 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:07:35.666697 [info ] [MainThread]: 
[0m00:07:35.666847 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:07:35.668354 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.422462, "process_in_blocks": "0", "process_kernel_time": 0.275516, "process_mem_max_rss": "143245312", "process_out_blocks": "0", "process_user_time": 1.561627}
[0m00:07:35.668793 [debug] [MainThread]: Command `dbt snapshot` failed at 00:07:35.668722 after 5.42 seconds
[0m00:07:35.669023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702ac80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102aa1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a726f0>]}
[0m00:07:35.669228 [debug] [MainThread]: Flushing usage events
[0m00:08:18.619215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f98d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106adbb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106adbd90>]}


============================== 00:08:18.622323 | 5ab88985-f658-4012-8038-e64e8622605a ==============================
[0m00:08:18.622323 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:08:18.622626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:08:18.836478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ab88985-f658-4012-8038-e64e8622605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10791a520>]}
[0m00:08:18.861261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ab88985-f658-4012-8038-e64e8622605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f4050>]}
[0m00:08:18.862165 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:08:18.920872 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:08:18.987227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m00:08:18.987601 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/extreme_weather_events.sql
[0m00:08:18.987770 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/hourly_weather_patterns.sql
[0m00:08:18.987927 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/weather_conditions_frequency.sql
[0m00:08:19.105522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ab88985-f658-4012-8038-e64e8622605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd0850>]}
[0m00:08:19.188911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ab88985-f658-4012-8038-e64e8622605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107843f20>]}
[0m00:08:19.189194 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m00:08:19.189349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ab88985-f658-4012-8038-e64e8622605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079aef90>]}
[0m00:08:19.190317 [info ] [MainThread]: 
[0m00:08:19.190588 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:08:19.192789 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m00:08:19.199554 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m00:08:19.199758 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m00:08:19.199891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:08:19.803901 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.604 seconds
[0m00:08:19.806712 [debug] [ThreadPool]: On list_openweather: Close
[0m00:08:19.957878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m00:08:19.968672 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m00:08:19.969156 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m00:08:19.969417 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:08:20.505709 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.536 seconds
[0m00:08:20.509717 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m00:08:20.632535 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m00:08:20.637298 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m00:08:20.637873 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m00:08:20.638205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:08:21.119836 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.481 seconds
[0m00:08:21.122941 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m00:08:21.236058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ab88985-f658-4012-8038-e64e8622605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069fd3d0>]}
[0m00:08:21.236941 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:08:21.237412 [info ] [MainThread]: 
[0m00:08:21.241788 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:08:21.242418 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.daily_average_weather_trend ..................... [RUN]
[0m00:08:21.242887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now snapshot.weather_dbt.daily_average_weather_trend)
[0m00:08:21.243243 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_trend
[0m00:08:21.253055 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_trend
[0m00:08:21.301121 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_trend"
[0m00:08:21.301420 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_DATE as varchar ), '')
         || '|' || coalesce(cast(WEATHER_DATE as varchar ), '')
        ) as dbt_scd_id,
        WEATHER_DATE as dbt_updated_at,
        WEATHER_DATE as dbt_valid_from,
        
  
  coalesce(nullif(WEATHER_DATE, WEATHER_DATE), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    DATE_TRUNC('DAY', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('DAY', w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:08:21.301611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:21.760956 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a68-0004-3867-0002-5943000356c6
[0m00:08:21.761669 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:08:21.762234 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: Close
[0m00:08:21.896527 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:08:21.898332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ab88985-f658-4012-8038-e64e8622605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108114dd0>]}
[0m00:08:21.899186 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshot.daily_average_weather_trend ................. [[31mERROR[0m in 0.65s]
[0m00:08:21.899736 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:08:21.900121 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m00:08:21.901331 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.extreme_weather_events .......................... [RUN]
[0m00:08:21.901801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_trend, now snapshot.weather_dbt.extreme_weather_events)
[0m00:08:21.902132 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m00:08:21.905657 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m00:08:21.909884 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m00:08:21.910226 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:08:21.910524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:22.486238 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a68-0004-3868-0002-5943000386d6
[0m00:08:22.487471 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m00:08:22.488215 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m00:08:22.615932 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:08:22.616827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ab88985-f658-4012-8038-e64e8622605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108232ba0>]}
[0m00:08:22.617865 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshot.extreme_weather_events ...................... [[31mERROR[0m in 0.71s]
[0m00:08:22.618480 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m00:08:22.618863 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:08:22.619423 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.hourly_weather_patterns ......................... [RUN]
[0m00:08:22.619883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m00:08:22.620211 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m00:08:22.623900 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m00:08:22.628138 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m00:08:22.628486 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:08:22.628809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:23.009893 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a68-0004-3869-0002-59430003a6b6
[0m00:08:23.010999 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m00:08:23.011963 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m00:08:23.144451 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:08:23.145214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ab88985-f658-4012-8038-e64e8622605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a7430>]}
[0m00:08:23.146192 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshot.hourly_weather_patterns ..................... [[31mERROR[0m in 0.53s]
[0m00:08:23.146759 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:08:23.147146 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:08:23.147692 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.weather_conditions_frequency .................... [RUN]
[0m00:08:23.148195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m00:08:23.148528 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m00:08:23.152258 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m00:08:23.160698 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m00:08:23.161089 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:08:23.161367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:23.618272 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a68-0004-3865-0002-594300039746
[0m00:08:23.619301 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:08:23.620053 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m00:08:23.759006 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:08:23.759466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ab88985-f658-4012-8038-e64e8622605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ff91d0>]}
[0m00:08:23.760109 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshot.weather_conditions_frequency ................ [[31mERROR[0m in 0.61s]
[0m00:08:23.760602 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:08:23.761932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:08:23.762220 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m00:08:23.762489 [info ] [MainThread]: 
[0m00:08:23.762730 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m00:08:23.763660 [debug] [MainThread]: Command end result
[0m00:08:23.788361 [info ] [MainThread]: 
[0m00:08:23.788699 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:08:23.788948 [info ] [MainThread]: 
[0m00:08:23.789209 [error] [MainThread]:   Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:08:23.789383 [info ] [MainThread]: 
[0m00:08:23.789635 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:08:23.789878 [info ] [MainThread]: 
[0m00:08:23.790147 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:08:23.790334 [info ] [MainThread]: 
[0m00:08:23.790556 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:08:23.790728 [info ] [MainThread]: 
[0m00:08:23.790907 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:08:23.792441 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.210549, "process_in_blocks": "0", "process_kernel_time": 0.261804, "process_mem_max_rss": "140083200", "process_out_blocks": "0", "process_user_time": 1.609904}
[0m00:08:23.792759 [debug] [MainThread]: Command `dbt snapshot` failed at 00:08:23.792702 after 5.21 seconds
[0m00:08:23.792966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1009d5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b81a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056b3890>]}
[0m00:08:23.793156 [debug] [MainThread]: Flushing usage events
[0m00:09:04.345867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031fcd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104affd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104affb10>]}


============================== 00:09:04.348993 | be8cd700-ba7e-4663-912e-5855d8ccfea9 ==============================
[0m00:09:04.348993 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:09:04.349306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:09:04.595623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be8cd700-ba7e-4663-912e-5855d8ccfea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575a520>]}
[0m00:09:04.621102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be8cd700-ba7e-4663-912e-5855d8ccfea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10565c050>]}
[0m00:09:04.621849 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:09:04.681235 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:09:04.755085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:09:04.755336 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:09:04.776427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be8cd700-ba7e-4663-912e-5855d8ccfea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055cf850>]}
[0m00:09:04.835222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be8cd700-ba7e-4663-912e-5855d8ccfea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a1310>]}
[0m00:09:04.835521 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m00:09:04.835822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be8cd700-ba7e-4663-912e-5855d8ccfea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b64c90>]}
[0m00:09:04.836969 [info ] [MainThread]: 
[0m00:09:04.837279 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:09:04.839422 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m00:09:04.846717 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m00:09:04.846933 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m00:09:04.847078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:09:05.575234 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.728 seconds
[0m00:09:05.578346 [debug] [ThreadPool]: On list_openweather: Close
[0m00:09:05.735013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m00:09:05.750471 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m00:09:05.750967 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m00:09:05.751217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:09:06.248923 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.498 seconds
[0m00:09:06.250433 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m00:09:06.391378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m00:09:06.395549 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m00:09:06.396175 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m00:09:06.396670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:09:06.943863 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.547 seconds
[0m00:09:06.946892 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m00:09:07.060911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be8cd700-ba7e-4663-912e-5855d8ccfea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b37ad0>]}
[0m00:09:07.061339 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:09:07.061994 [info ] [MainThread]: 
[0m00:09:07.064471 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:09:07.064800 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.daily_average_weather_trend ..................... [RUN]
[0m00:09:07.065043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now snapshot.weather_dbt.daily_average_weather_trend)
[0m00:09:07.065205 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_trend
[0m00:09:07.071517 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_trend
[0m00:09:07.117061 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_trend"
[0m00:09:07.117386 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_DATE as varchar ), '')
         || '|' || coalesce(cast(WEATHER_DATE as varchar ), '')
        ) as dbt_scd_id,
        WEATHER_DATE as dbt_updated_at,
        WEATHER_DATE as dbt_valid_from,
        
  
  coalesce(nullif(WEATHER_DATE, WEATHER_DATE), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    DATE_TRUNC('DAY', w.DATE_TIME) AS WEATHER_DATE,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", DATE_TRUNC('DAY', w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:09:07.117588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:09:07.567368 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a69-0004-3863-0002-5943000366de
[0m00:09:07.568130 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:09:07.568759 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: Close
[0m00:09:07.703065 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:09:07.705163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be8cd700-ba7e-4663-912e-5855d8ccfea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105db0c50>]}
[0m00:09:07.705850 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshot.daily_average_weather_trend ................. [[31mERROR[0m in 0.64s]
[0m00:09:07.706491 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:09:07.707014 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m00:09:07.707814 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.extreme_weather_events .......................... [RUN]
[0m00:09:07.708224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_trend, now snapshot.weather_dbt.extreme_weather_events)
[0m00:09:07.708432 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m00:09:07.711328 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m00:09:07.715514 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m00:09:07.715876 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:09:07.716169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:09:08.123452 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a69-0004-3864-0002-594300033fe6
[0m00:09:08.124452 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m00:09:08.125085 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m00:09:08.284653 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:09:08.285483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be8cd700-ba7e-4663-912e-5855d8ccfea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e39860>]}
[0m00:09:08.286444 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshot.extreme_weather_events ...................... [[31mERROR[0m in 0.58s]
[0m00:09:08.287070 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m00:09:08.287506 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:09:08.287918 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.hourly_weather_patterns ......................... [RUN]
[0m00:09:08.288514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m00:09:08.288952 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m00:09:08.292655 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m00:09:08.297420 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m00:09:08.297921 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:09:08.298257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:09:08.787270 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a69-0004-3987-0002-59430003d182
[0m00:09:08.788789 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m00:09:08.789750 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m00:09:08.921785 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:09:08.922762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be8cd700-ba7e-4663-912e-5855d8ccfea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a28550>]}
[0m00:09:08.923688 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshot.hourly_weather_patterns ..................... [[31mERROR[0m in 0.63s]
[0m00:09:08.924300 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:09:08.924712 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:09:08.925299 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.weather_conditions_frequency .................... [RUN]
[0m00:09:08.925842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m00:09:08.926200 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m00:09:08.929842 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m00:09:08.934493 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m00:09:08.935008 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:09:08.935653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:09:09.569368 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a69-0004-3864-0002-594300033fea
[0m00:09:09.570040 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:09:09.570540 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m00:09:09.708861 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:09:09.709508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be8cd700-ba7e-4663-912e-5855d8ccfea9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10595f950>]}
[0m00:09:09.710413 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshot.weather_conditions_frequency ................ [[31mERROR[0m in 0.78s]
[0m00:09:09.711063 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:09:09.712078 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:09:09.712345 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m00:09:09.712547 [info ] [MainThread]: 
[0m00:09:09.712740 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 4.88 seconds (4.88s).
[0m00:09:09.713356 [debug] [MainThread]: Command end result
[0m00:09:09.734605 [info ] [MainThread]: 
[0m00:09:09.734957 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:09:09.735153 [info ] [MainThread]: 
[0m00:09:09.735405 [error] [MainThread]:   Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:09:09.735588 [info ] [MainThread]: 
[0m00:09:09.735806 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:09:09.735975 [info ] [MainThread]: 
[0m00:09:09.736183 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:09:09.736410 [info ] [MainThread]: 
[0m00:09:09.736814 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:09:09.737028 [info ] [MainThread]: 
[0m00:09:09.737234 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:09:09.738921 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.4373384, "process_in_blocks": "0", "process_kernel_time": 0.29061, "process_mem_max_rss": "140001280", "process_out_blocks": "0", "process_user_time": 1.568577}
[0m00:09:09.739399 [debug] [MainThread]: Command `dbt snapshot` failed at 00:09:09.739325 after 5.44 seconds
[0m00:09:09.739700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b12ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e69d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10395d310>]}
[0m00:09:09.740063 [debug] [MainThread]: Flushing usage events
[0m00:10:38.189803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107398d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095d7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095d7b10>]}


============================== 00:10:38.192889 | 744557ae-21e8-4a69-8329-8f2b4fbd1edc ==============================
[0m00:10:38.192889 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:10:38.193227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:10:38.429635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '744557ae-21e8-4a69-8329-8f2b4fbd1edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae1a520>]}
[0m00:10:38.452547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '744557ae-21e8-4a69-8329-8f2b4fbd1edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adfc050>]}
[0m00:10:38.453349 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:10:38.513012 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:10:38.585764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:10:38.586148 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/daily_avg_weather_trend.sql
[0m00:10:38.658133 [error] [MainThread]: Encountered an error:
Compilation Error in model daily_avg_weather_trend (models/output/daily_avg_weather_trend.sql)
  Encountered unknown tag 'snapshot'.
    line 3
      {% snapshot daily_average_weather_trend %}
[0m00:10:38.659456 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.508638, "process_in_blocks": "0", "process_kernel_time": 0.211623, "process_mem_max_rss": "126255104", "process_out_blocks": "0", "process_user_time": 0.904915}
[0m00:10:38.659793 [debug] [MainThread]: Command `dbt snapshot` failed at 00:10:38.659719 after 0.51 seconds
[0m00:10:38.660036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad6fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad6f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8b68a0>]}
[0m00:10:38.660242 [debug] [MainThread]: Flushing usage events
[0m00:11:06.456716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a13d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a13b10>]}


============================== 00:11:06.460244 | ced90705-1b58-4f8f-9b43-28b77d2f51ce ==============================
[0m00:11:06.460244 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:11:06.460587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:11:06.688904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ced90705-1b58-4f8f-9b43-28b77d2f51ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a8a520>]}
[0m00:11:06.713664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ced90705-1b58-4f8f-9b43-28b77d2f51ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099fc050>]}
[0m00:11:06.715066 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:11:06.774046 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:11:06.846498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:11:06.846881 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/daily_avg_weather_trend.sql
[0m00:11:06.922458 [error] [MainThread]: Encountered an error:
Compilation Error in model daily_avg_weather_trend (models/output/daily_avg_weather_trend.sql)
  Encountered unknown tag 'snapshot'.
    line 1
      {% snapshot daily_average_weather_trend %}
[0m00:11:06.923827 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.50682014, "process_in_blocks": "0", "process_kernel_time": 0.190948, "process_mem_max_rss": "128253952", "process_out_blocks": "0", "process_user_time": 0.920071}
[0m00:11:06.924115 [debug] [MainThread]: Command `dbt snapshot` failed at 00:11:06.924062 after 0.51 seconds
[0m00:11:06.924435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10996fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10996f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d268a0>]}
[0m00:11:06.924726 [debug] [MainThread]: Flushing usage events
[0m00:11:25.404516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cacd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b3b10>]}


============================== 00:11:25.407002 | 07359f07-3aa3-4580-b6e2-465dd41a7e7b ==============================
[0m00:11:25.407002 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:11:25.407322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:11:25.577121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07359f07-3aa3-4580-b6e2-465dd41a7e7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10588a520>]}
[0m00:11:25.602176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07359f07-3aa3-4580-b6e2-465dd41a7e7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057fc050>]}
[0m00:11:25.603038 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:11:25.662754 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:11:25.737541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:11:25.737974 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/daily_avg_weather_trend.sql
[0m00:11:25.815997 [error] [MainThread]: Encountered an error:
Compilation Error in model daily_avg_weather_trend (models/output/daily_avg_weather_trend.sql)
  Encountered unknown tag 'snapshot'.
    line 1
      {% snapshot daily_avg_weather_trend %}
[0m00:11:25.817843 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.45083046, "process_in_blocks": "0", "process_kernel_time": 0.15508, "process_mem_max_rss": "125665280", "process_out_blocks": "0", "process_user_time": 0.92163}
[0m00:11:25.818195 [debug] [MainThread]: Command `dbt snapshot` failed at 00:11:25.818137 after 0.45 seconds
[0m00:11:25.818420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10576fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10576f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb68a0>]}
[0m00:11:25.818592 [debug] [MainThread]: Flushing usage events
[0m00:13:15.050612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b7b10>]}


============================== 00:13:15.054188 | 11f9aab4-582d-400a-ab23-59cd57ea95c3 ==============================
[0m00:13:15.054188 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:13:15.054622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:13:15.297506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11f9aab4-582d-400a-ab23-59cd57ea95c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10921a520>]}
[0m00:13:15.322468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11f9aab4-582d-400a-ab23-59cd57ea95c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091fc050>]}
[0m00:13:15.323250 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:13:15.384959 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:13:15.460098 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:13:15.460555 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:13:15.580568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11f9aab4-582d-400a-ab23-59cd57ea95c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094d0e50>]}
[0m00:13:15.636615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11f9aab4-582d-400a-ab23-59cd57ea95c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b8320>]}
[0m00:13:15.636929 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m00:13:15.637100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11f9aab4-582d-400a-ab23-59cd57ea95c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095f8c90>]}
[0m00:13:15.638112 [info ] [MainThread]: 
[0m00:13:15.638537 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:13:15.640674 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m00:13:15.647069 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m00:13:15.647235 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m00:13:15.647363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:16.316866 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.669 seconds
[0m00:13:16.320855 [debug] [ThreadPool]: On list_openweather: Close
[0m00:13:16.457545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m00:13:16.467046 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m00:13:16.467452 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m00:13:16.467732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:16.978546 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.511 seconds
[0m00:13:16.981816 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m00:13:17.116798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m00:13:17.118518 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m00:13:17.118775 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m00:13:17.119001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:17.679746 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.560 seconds
[0m00:13:17.682673 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m00:13:17.834667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11f9aab4-582d-400a-ab23-59cd57ea95c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10829d3d0>]}
[0m00:13:17.835680 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:13:17.836039 [info ] [MainThread]: 
[0m00:13:17.838670 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:13:17.838942 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.daily_average_weather_trend ..................... [RUN]
[0m00:13:17.839155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now snapshot.weather_dbt.daily_average_weather_trend)
[0m00:13:17.839314 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_trend
[0m00:13:17.843959 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_trend
[0m00:13:17.894261 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_trend"
[0m00:13:17.894604 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_DATE as varchar ), '')
         || '|' || coalesce(cast(WEATHER_DATE as varchar ), '')
        ) as dbt_scd_id,
        WEATHER_DATE as dbt_updated_at,
        WEATHER_DATE as dbt_valid_from,
        
  
  coalesce(nullif(WEATHER_DATE, WEATHER_DATE), null)
  as dbt_valid_to
from (
        



WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:13:17.894818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:18.304531 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a6d-0004-3867-0002-5943000356ce
[0m00:13:18.305209 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:13:18.305806 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: Close
[0m00:13:18.436979 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:13:18.445376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11f9aab4-582d-400a-ab23-59cd57ea95c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a10d10>]}
[0m00:13:18.451745 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshot.daily_average_weather_trend ................. [[31mERROR[0m in 0.60s]
[0m00:13:18.452202 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:13:18.452473 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m00:13:18.452740 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.extreme_weather_events .......................... [RUN]
[0m00:13:18.453011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_trend, now snapshot.weather_dbt.extreme_weather_events)
[0m00:13:18.453209 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m00:13:18.455347 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m00:13:18.458744 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m00:13:18.459029 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:13:18.459225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:18.951949 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a6d-0004-3863-0002-5943000366e2
[0m00:13:18.952745 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m00:13:18.953444 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m00:13:19.089456 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:13:19.089987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11f9aab4-582d-400a-ab23-59cd57ea95c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a62ec50>]}
[0m00:13:19.090593 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshot.extreme_weather_events ...................... [[31mERROR[0m in 0.64s]
[0m00:13:19.091006 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m00:13:19.091269 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:13:19.091645 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.hourly_weather_patterns ......................... [RUN]
[0m00:13:19.091976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m00:13:19.092215 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m00:13:19.094500 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m00:13:19.097859 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m00:13:19.098307 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:13:19.098671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:19.537874 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a6d-0004-386b-0002-59430003b6b2
[0m00:13:19.539256 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m00:13:19.540183 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m00:13:19.672160 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:13:19.672663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11f9aab4-582d-400a-ab23-59cd57ea95c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6e1090>]}
[0m00:13:19.673282 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshot.hourly_weather_patterns ..................... [[31mERROR[0m in 0.58s]
[0m00:13:19.673893 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:13:19.674211 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:13:19.674673 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.weather_conditions_frequency .................... [RUN]
[0m00:13:19.675105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m00:13:19.675331 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m00:13:19.677575 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m00:13:19.681215 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m00:13:19.681717 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:13:19.682064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:20.016237 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a6d-0004-3869-0002-59430003a6be
[0m00:13:20.016718 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:13:20.017068 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m00:13:20.146143 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:13:20.146798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11f9aab4-582d-400a-ab23-59cd57ea95c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084d37d0>]}
[0m00:13:20.147802 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshot.weather_conditions_frequency ................ [[31mERROR[0m in 0.47s]
[0m00:13:20.148400 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:13:20.149915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:13:20.150255 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m00:13:20.150582 [info ] [MainThread]: 
[0m00:13:20.150880 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m00:13:20.151900 [debug] [MainThread]: Command end result
[0m00:13:20.178728 [info ] [MainThread]: 
[0m00:13:20.179059 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:13:20.179242 [info ] [MainThread]: 
[0m00:13:20.179475 [error] [MainThread]:   Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:13:20.179639 [info ] [MainThread]: 
[0m00:13:20.179847 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:13:20.180174 [info ] [MainThread]: 
[0m00:13:20.180429 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:13:20.180606 [info ] [MainThread]: 
[0m00:13:20.180805 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:13:20.180967 [info ] [MainThread]: 
[0m00:13:20.181136 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:13:20.182654 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.1743827, "process_in_blocks": "0", "process_kernel_time": 0.291317, "process_mem_max_rss": "141950976", "process_out_blocks": "0", "process_user_time": 1.579343}
[0m00:13:20.183009 [debug] [MainThread]: Command `dbt snapshot` failed at 00:13:20.182951 after 5.17 seconds
[0m00:13:20.183246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084caba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10481dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f53d10>]}
[0m00:13:20.183461 [debug] [MainThread]: Flushing usage events
[0m00:14:39.564764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107513d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107513b10>]}


============================== 00:14:39.568393 | 719e2d25-ee3b-42b2-b000-a65ab740e552 ==============================
[0m00:14:39.568393 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:14:39.568783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:14:39.810964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '719e2d25-ee3b-42b2-b000-a65ab740e552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11158a520>]}
[0m00:14:39.835993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '719e2d25-ee3b-42b2-b000-a65ab740e552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114fc050>]}
[0m00:14:39.836718 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:14:39.903485 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:14:39.976774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:14:39.977017 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:14:39.997991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '719e2d25-ee3b-42b2-b000-a65ab740e552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111473850>]}
[0m00:14:40.052566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '719e2d25-ee3b-42b2-b000-a65ab740e552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111443e30>]}
[0m00:14:40.052863 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m00:14:40.053037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '719e2d25-ee3b-42b2-b000-a65ab740e552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119949f0>]}
[0m00:14:40.054085 [info ] [MainThread]: 
[0m00:14:40.054389 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:14:40.056502 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m00:14:40.064140 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m00:14:40.064351 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m00:14:40.064487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:40.592791 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.528 seconds
[0m00:14:40.597880 [debug] [ThreadPool]: On list_openweather: Close
[0m00:14:40.717658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m00:14:40.732877 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m00:14:40.733298 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m00:14:40.733547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:41.166125 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.432 seconds
[0m00:14:41.169421 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m00:14:41.287253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m00:14:41.291025 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m00:14:41.291388 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m00:14:41.291758 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:41.786280 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.494 seconds
[0m00:14:41.789752 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m00:14:41.941863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '719e2d25-ee3b-42b2-b000-a65ab740e552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111967860>]}
[0m00:14:41.942844 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:14:41.943143 [info ] [MainThread]: 
[0m00:14:41.948011 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m00:14:41.948631 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m00:14:41.949107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now model.weather_dbt.daily_avg_weather_trend)
[0m00:14:41.949798 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m00:14:41.958991 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m00:14:41.960879 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m00:14:41.984514 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m00:14:41.985779 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m00:14:41.986041 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m00:14:41.986263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:43.598327 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.612 seconds
[0m00:14:43.612248 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m00:14:43.763500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '719e2d25-ee3b-42b2-b000-a65ab740e552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c07950>]}
[0m00:14:43.764388 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.81s]
[0m00:14:43.764948 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m00:14:43.765355 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m00:14:43.765843 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m00:14:43.766302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m00:14:43.766629 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m00:14:43.769534 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m00:14:43.770538 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m00:14:43.773353 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m00:14:43.774898 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m00:14:43.775242 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m00:14:43.775534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:45.160100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.384 seconds
[0m00:14:45.163693 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m00:14:45.291886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '719e2d25-ee3b-42b2-b000-a65ab740e552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e1ff0>]}
[0m00:14:45.293024 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.53s]
[0m00:14:45.293733 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m00:14:45.294221 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m00:14:45.294997 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m00:14:45.295732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m00:14:45.296133 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m00:14:45.299456 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m00:14:45.300780 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m00:14:45.302871 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m00:14:45.304316 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m00:14:45.304663 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    *
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY
        );
[0m00:14:45.305403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:46.583249 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.278 seconds
[0m00:14:46.586841 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m00:14:46.707433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '719e2d25-ee3b-42b2-b000-a65ab740e552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107440230>]}
[0m00:14:46.708373 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.hourly_weather_patterns ............ [[32mSUCCESS 1[0m in 1.41s]
[0m00:14:46.708871 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m00:14:46.709216 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m00:14:46.709539 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m00:14:46.709864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m00:14:46.710127 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m00:14:46.712830 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m00:14:46.713917 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m00:14:46.733325 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m00:14:46.734641 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m00:14:46.734952 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m00:14:46.735230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:47.308615 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.573 seconds
[0m00:14:47.311082 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m00:14:47.419576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '719e2d25-ee3b-42b2-b000-a65ab740e552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111661c50>]}
[0m00:14:47.420632 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.71s]
[0m00:14:47.421444 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m00:14:47.422003 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m00:14:47.422744 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m00:14:47.423450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m00:14:47.423874 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m00:14:47.427946 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m00:14:47.429326 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m00:14:47.431850 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m00:14:47.433442 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m00:14:47.433945 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    *
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME
        );
[0m00:14:47.434291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:48.885267 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.450 seconds
[0m00:14:48.889591 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m00:14:49.013976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '719e2d25-ee3b-42b2-b000-a65ab740e552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bfc8a0>]}
[0m00:14:49.014766 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.59s]
[0m00:14:49.015180 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m00:14:49.016341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:49.016556 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m00:14:49.016787 [info ] [MainThread]: 
[0m00:14:49.016978 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 8.96 seconds (8.96s).
[0m00:14:49.017767 [debug] [MainThread]: Command end result
[0m00:14:49.043445 [info ] [MainThread]: 
[0m00:14:49.043831 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:14:49.044059 [info ] [MainThread]: 
[0m00:14:49.044268 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m00:14:49.046280 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.520364, "process_in_blocks": "0", "process_kernel_time": 0.290166, "process_mem_max_rss": "138887168", "process_out_blocks": "0", "process_user_time": 1.578893}
[0m00:14:49.046692 [debug] [MainThread]: Command `dbt run` succeeded at 00:14:49.046629 after 9.52 seconds
[0m00:14:49.046959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ce7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d3d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10753cd10>]}
[0m00:14:49.047202 [debug] [MainThread]: Flushing usage events
[0m00:18:31.734234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106858d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108187d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108187b10>]}


============================== 00:18:31.737316 | f8ffcf9e-6771-4ecd-8d64-18f10f63c155 ==============================
[0m00:18:31.737316 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:18:31.737648 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:18:31.792563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8ffcf9e-6771-4ecd-8d64-18f10f63c155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fef360>]}
[0m00:18:31.804087 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.10985263, "process_in_blocks": "0", "process_kernel_time": 0.132219, "process_mem_max_rss": "98959360", "process_out_blocks": "0", "process_user_time": 0.63936}
[0m00:18:31.804377 [debug] [MainThread]: Command `dbt clean` succeeded at 00:18:31.804326 after 0.11 seconds
[0m00:18:31.804553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ae580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ae690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f16950>]}
[0m00:18:31.804720 [debug] [MainThread]: Flushing usage events
[0m00:20:08.114539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f98d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105813d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105813b10>]}


============================== 00:20:08.117498 | 2b844597-c779-4e2d-a36a-4f96c4180516 ==============================
[0m00:20:08.117498 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:20:08.117822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:20:08.170672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b844597-c779-4e2d-a36a-4f96c4180516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a7f360>]}
[0m00:20:08.179984 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.10194683, "process_in_blocks": "0", "process_kernel_time": 0.121471, "process_mem_max_rss": "98598912", "process_out_blocks": "0", "process_user_time": 0.618503}
[0m00:20:08.180306 [debug] [MainThread]: Command `dbt clean` succeeded at 00:20:08.180253 after 0.10 seconds
[0m00:20:08.180482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b02580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b02690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056de950>]}
[0m00:20:08.180638 [debug] [MainThread]: Flushing usage events
[0m00:20:15.314139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107617d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107617b10>]}


============================== 00:20:15.317584 | 9f409379-ce54-4985-afda-b406263d96ee ==============================
[0m00:20:15.317584 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:20:15.317990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m00:20:15.557499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f409379-ce54-4985-afda-b406263d96ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104fa520>]}
[0m00:20:15.584261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f409379-ce54-4985-afda-b406263d96ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103fc050>]}
[0m00:20:15.585242 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:20:15.645230 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:20:15.645802 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:20:15.645988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9f409379-ce54-4985-afda-b406263d96ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11036ca50>]}
[0m00:20:16.259982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f409379-ce54-4985-afda-b406263d96ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110885040>]}
[0m00:20:16.311011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f409379-ce54-4985-afda-b406263d96ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e498d0>]}
[0m00:20:16.311276 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m00:20:16.311444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f409379-ce54-4985-afda-b406263d96ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e83790>]}
[0m00:20:16.312366 [info ] [MainThread]: 
[0m00:20:16.312635 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:20:16.314698 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m00:20:16.321211 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m00:20:16.321413 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m00:20:16.321538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:16.884304 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.563 seconds
[0m00:20:16.885742 [debug] [ThreadPool]: On list_openweather: Close
[0m00:20:17.021852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m00:20:17.031245 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m00:20:17.031615 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m00:20:17.031843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:20:17.527468 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.496 seconds
[0m00:20:17.529909 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m00:20:17.667030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m00:20:17.670935 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m00:20:17.671381 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m00:20:17.671677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:20:18.205267 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.533 seconds
[0m00:20:18.207770 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m00:20:18.337818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f409379-ce54-4985-afda-b406263d96ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111177d0>]}
[0m00:20:18.338595 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:20:18.338900 [info ] [MainThread]: 
[0m00:20:18.343089 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:20:18.343659 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.daily_average_weather_trend ..................... [RUN]
[0m00:20:18.344072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now snapshot.weather_dbt.daily_average_weather_trend)
[0m00:20:18.344886 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_trend
[0m00:20:18.354299 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_trend
[0m00:20:18.403297 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_trend"
[0m00:20:18.403637 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_DATE as varchar ), '')
         || '|' || coalesce(cast(WEATHER_DATE as varchar ), '')
        ) as dbt_scd_id,
        WEATHER_DATE as dbt_updated_at,
        WEATHER_DATE as dbt_valid_from,
        
  
  coalesce(nullif(WEATHER_DATE, WEATHER_DATE), null)
  as dbt_valid_to
from (
        



WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:20:18.403850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:18.854621 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a74-0004-3987-0002-59430003d19e
[0m00:20:18.855320 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:20:18.855886 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: Close
[0m00:20:18.973245 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:20:18.974998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f409379-ce54-4985-afda-b406263d96ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d68520>]}
[0m00:20:18.975785 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshot.daily_average_weather_trend ................. [[31mERROR[0m in 0.63s]
[0m00:20:18.976357 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:20:18.976793 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m00:20:18.978020 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.extreme_weather_events .......................... [RUN]
[0m00:20:18.978534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_trend, now snapshot.weather_dbt.extreme_weather_events)
[0m00:20:18.978900 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m00:20:18.982954 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m00:20:18.986979 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m00:20:18.987373 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:20:18.987708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:19.412479 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a74-0004-3865-0002-594300039766
[0m00:20:19.413255 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m00:20:19.413702 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m00:20:19.560424 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:20:19.561000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f409379-ce54-4985-afda-b406263d96ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d5df90>]}
[0m00:20:19.561785 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshot.extreme_weather_events ...................... [[31mERROR[0m in 0.58s]
[0m00:20:19.562450 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m00:20:19.562894 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:20:19.563526 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.hourly_weather_patterns ......................... [RUN]
[0m00:20:19.564095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m00:20:19.564498 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m00:20:19.568341 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m00:20:19.572599 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m00:20:19.573104 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:20:19.573692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:20.028475 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a74-0004-3864-0002-59430003e01e
[0m00:20:20.029321 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m00:20:20.029995 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m00:20:20.150629 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:20:20.151673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f409379-ce54-4985-afda-b406263d96ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c4d050>]}
[0m00:20:20.152665 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshot.hourly_weather_patterns ..................... [[31mERROR[0m in 0.59s]
[0m00:20:20.153283 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:20:20.153660 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:20:20.154173 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.weather_conditions_frequency .................... [RUN]
[0m00:20:20.154635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m00:20:20.154951 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m00:20:20.158687 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m00:20:20.162095 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m00:20:20.162480 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:20:20.162808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:20:20.604153 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a74-0004-3864-0002-59430003e022
[0m00:20:20.604973 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:20:20.606112 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m00:20:20.746431 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:20:20.747133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f409379-ce54-4985-afda-b406263d96ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c6eeb0>]}
[0m00:20:20.748053 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshot.weather_conditions_frequency ................ [[31mERROR[0m in 0.59s]
[0m00:20:20.748759 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:20:20.750109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:20:20.750385 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m00:20:20.750619 [info ] [MainThread]: 
[0m00:20:20.750835 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 4.44 seconds (4.44s).
[0m00:20:20.751527 [debug] [MainThread]: Command end result
[0m00:20:20.770024 [info ] [MainThread]: 
[0m00:20:20.770351 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:20:20.770517 [info ] [MainThread]: 
[0m00:20:20.770741 [error] [MainThread]:   Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:20:20.770977 [info ] [MainThread]: 
[0m00:20:20.771392 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:20:20.771625 [info ] [MainThread]: 
[0m00:20:20.771823 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:20:20.771973 [info ] [MainThread]: 
[0m00:20:20.772147 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:20:20.772287 [info ] [MainThread]: 
[0m00:20:20.772439 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:20:20.773966 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.4988823, "process_in_blocks": "0", "process_kernel_time": 0.253541, "process_mem_max_rss": "145735680", "process_out_blocks": "0", "process_user_time": 1.944916}
[0m00:20:20.774369 [debug] [MainThread]: Command `dbt snapshot` failed at 00:20:20.774310 after 5.50 seconds
[0m00:20:20.774601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a7f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f17ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f17e90>]}
[0m00:20:20.774790 [debug] [MainThread]: Flushing usage events
[0m00:21:50.914481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033bcd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cbfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cbfb10>]}


============================== 00:21:50.917474 | 4884ad75-3cf8-4fee-830c-dca46cf6db3c ==============================
[0m00:21:50.917474 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:21:50.917786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:21:50.970915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4884ad75-3cf8-4fee-830c-dca46cf6db3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b2b360>]}
[0m00:21:50.980450 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.104379624, "process_in_blocks": "0", "process_kernel_time": 0.12207, "process_mem_max_rss": "99188736", "process_out_blocks": "0", "process_user_time": 0.615749}
[0m00:21:50.980735 [debug] [MainThread]: Command `dbt clean` succeeded at 00:21:50.980684 after 0.10 seconds
[0m00:21:50.980918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dea580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dea690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a52950>]}
[0m00:21:50.981075 [debug] [MainThread]: Flushing usage events
[0m00:21:55.279050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102580d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e87d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e87b10>]}


============================== 00:21:55.281543 | f4d0e76d-fe09-4909-bfb4-8d56fc8fca65 ==============================
[0m00:21:55.281543 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:21:55.281868 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:21:55.501195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4d0e76d-fe09-4909-bfb4-8d56fc8fca65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ade520>]}
[0m00:21:55.524110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4d0e76d-fe09-4909-bfb4-8d56fc8fca65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e0050>]}
[0m00:21:55.525474 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:21:55.588411 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:21:55.589207 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:21:55.589607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f4d0e76d-fe09-4909-bfb4-8d56fc8fca65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104954a50>]}
[0m00:21:56.177325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4d0e76d-fe09-4909-bfb4-8d56fc8fca65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d4d040>]}
[0m00:21:56.225840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4d0e76d-fe09-4909-bfb4-8d56fc8fca65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510dc50>]}
[0m00:21:56.226130 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m00:21:56.226295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4d0e76d-fe09-4909-bfb4-8d56fc8fca65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105147c70>]}
[0m00:21:56.227272 [info ] [MainThread]: 
[0m00:21:56.227552 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:21:56.229779 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m00:21:56.236806 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m00:21:56.237013 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m00:21:56.237139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:56.797582 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.560 seconds
[0m00:21:56.799585 [debug] [ThreadPool]: On list_openweather: Close
[0m00:21:56.949635 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m00:21:56.962051 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m00:21:56.962518 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m00:21:56.962806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:57.475112 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.512 seconds
[0m00:21:57.477759 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m00:21:57.620701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m00:21:57.625037 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m00:21:57.625424 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m00:21:57.625730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:58.026479 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.401 seconds
[0m00:21:58.028170 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m00:21:58.146418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4d0e76d-fe09-4909-bfb4-8d56fc8fca65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051df590>]}
[0m00:21:58.147523 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:21:58.147969 [info ] [MainThread]: 
[0m00:21:58.151595 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m00:21:58.152402 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m00:21:58.152970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now model.weather_dbt.daily_avg_weather_trend)
[0m00:21:58.153715 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m00:21:58.162818 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m00:21:58.164084 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m00:21:58.187167 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m00:21:58.188448 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m00:21:58.188708 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m00:21:58.188928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:59.566028 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.377 seconds
[0m00:21:59.582243 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m00:21:59.703511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d0e76d-fe09-4909-bfb4-8d56fc8fca65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e55f40>]}
[0m00:21:59.704553 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.55s]
[0m00:21:59.705309 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m00:21:59.705780 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m00:21:59.706397 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m00:21:59.706932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m00:21:59.707269 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m00:21:59.710125 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m00:21:59.711037 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m00:21:59.714398 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m00:21:59.716312 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m00:21:59.716776 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m00:21:59.717189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:00.767792 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.050 seconds
[0m00:22:00.771923 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m00:22:00.893973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d0e76d-fe09-4909-bfb4-8d56fc8fca65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105334c30>]}
[0m00:22:00.894894 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.19s]
[0m00:22:00.895438 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m00:22:00.895818 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m00:22:00.896315 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m00:22:00.896775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m00:22:00.897089 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m00:22:00.900216 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m00:22:00.901235 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m00:22:00.910222 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m00:22:00.911892 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m00:22:00.912255 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    *
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY
        );
[0m00:22:00.912573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:02.182888 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.270 seconds
[0m00:22:02.188889 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m00:22:02.332855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d0e76d-fe09-4909-bfb4-8d56fc8fca65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102902750>]}
[0m00:22:02.333986 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.hourly_weather_patterns ............ [[32mSUCCESS 1[0m in 1.44s]
[0m00:22:02.334825 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m00:22:02.335399 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m00:22:02.336138 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m00:22:02.336855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m00:22:02.337281 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m00:22:02.341379 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m00:22:02.342846 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m00:22:02.364908 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m00:22:02.366651 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m00:22:02.366932 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m00:22:02.367179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:02.954511 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.587 seconds
[0m00:22:02.959286 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m00:22:03.087060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d0e76d-fe09-4909-bfb4-8d56fc8fca65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024bc8a0>]}
[0m00:22:03.088093 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.75s]
[0m00:22:03.088726 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m00:22:03.089196 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m00:22:03.089621 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m00:22:03.090177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m00:22:03.090598 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m00:22:03.094342 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m00:22:03.095617 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m00:22:03.099135 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m00:22:03.100673 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m00:22:03.101130 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    *
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME
        );
[0m00:22:03.101508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:04.259375 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.157 seconds
[0m00:22:04.262795 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m00:22:04.398671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d0e76d-fe09-4909-bfb4-8d56fc8fca65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10155ec90>]}
[0m00:22:04.399914 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.31s]
[0m00:22:04.400713 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m00:22:04.402332 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:22:04.402709 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m00:22:04.403097 [info ] [MainThread]: 
[0m00:22:04.403409 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 8.18 seconds (8.18s).
[0m00:22:04.404527 [debug] [MainThread]: Command end result
[0m00:22:04.430837 [info ] [MainThread]: 
[0m00:22:04.431184 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:22:04.431385 [info ] [MainThread]: 
[0m00:22:04.431602 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m00:22:04.433144 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.193825, "process_in_blocks": "0", "process_kernel_time": 0.253893, "process_mem_max_rss": "145817600", "process_out_blocks": "0", "process_user_time": 2.028863}
[0m00:22:04.433533 [debug] [MainThread]: Command `dbt run` succeeded at 00:22:04.433468 after 9.19 seconds
[0m00:22:04.433782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028a18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105367170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105364cb0>]}
[0m00:22:04.434007 [debug] [MainThread]: Flushing usage events
[0m00:22:54.149609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105120d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a23d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a23b10>]}


============================== 00:22:54.152618 | f9633ac9-278d-46ec-bab9-c96b469b2bd9 ==============================
[0m00:22:54.152618 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:22:54.152950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:22:54.382849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9633ac9-278d-46ec-bab9-c96b469b2bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10767e520>]}
[0m00:22:54.406480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9633ac9-278d-46ec-bab9-c96b469b2bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107580050>]}
[0m00:22:54.407154 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:22:54.468981 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:22:54.537259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:22:54.537483 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:22:54.556748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9633ac9-278d-46ec-bab9-c96b469b2bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f3850>]}
[0m00:22:54.607580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9633ac9-278d-46ec-bab9-c96b469b2bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c5310>]}
[0m00:22:54.607847 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m00:22:54.608013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9633ac9-278d-46ec-bab9-c96b469b2bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a88c90>]}
[0m00:22:54.609046 [info ] [MainThread]: 
[0m00:22:54.609332 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:22:54.611371 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m00:22:54.618804 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m00:22:54.619027 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m00:22:54.619168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:55.136400 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.517 seconds
[0m00:22:55.139840 [debug] [ThreadPool]: On list_openweather: Close
[0m00:22:55.268788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m00:22:55.282799 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m00:22:55.283179 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m00:22:55.283404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:22:55.852807 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.569 seconds
[0m00:22:55.856279 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m00:22:55.974018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m00:22:55.978280 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m00:22:55.978658 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m00:22:55.978959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:22:56.496821 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.517 seconds
[0m00:22:56.501634 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m00:22:56.615800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9633ac9-278d-46ec-bab9-c96b469b2bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a57ad0>]}
[0m00:22:56.616539 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:22:56.616836 [info ] [MainThread]: 
[0m00:22:56.620891 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:22:56.621427 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.daily_average_weather_trend ..................... [RUN]
[0m00:22:56.621834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now snapshot.weather_dbt.daily_average_weather_trend)
[0m00:22:56.622439 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_trend
[0m00:22:56.630334 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_trend
[0m00:22:56.684314 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_trend"
[0m00:22:56.684676 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_trend"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_DATE as varchar ), '')
         || '|' || coalesce(cast(WEATHER_DATE as varchar ), '')
        ) as dbt_scd_id,
        WEATHER_DATE as dbt_updated_at,
        WEATHER_DATE as dbt_valid_from,
        
  
  coalesce(nullif(WEATHER_DATE, WEATHER_DATE), null)
  as dbt_valid_to
from (
        



WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:22:56.684885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:57.112075 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a76-0004-386a-0002-59430003473e
[0m00:22:57.112736 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:22:57.113296 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_trend: Close
[0m00:22:57.252677 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:22:57.253920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9633ac9-278d-46ec-bab9-c96b469b2bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd8c50>]}
[0m00:22:57.254540 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshot.daily_average_weather_trend ................. [[31mERROR[0m in 0.63s]
[0m00:22:57.255016 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_trend
[0m00:22:57.255305 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m00:22:57.256542 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.extreme_weather_events .......................... [RUN]
[0m00:22:57.257434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_trend, now snapshot.weather_dbt.extreme_weather_events)
[0m00:22:57.257711 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m00:22:57.260154 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m00:22:57.264319 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m00:22:57.264708 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:22:57.265087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:57.710999 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a76-0004-3987-0002-59430003d1fa
[0m00:22:57.711765 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m00:22:57.712279 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m00:22:57.863980 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:22:57.864741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9633ac9-278d-46ec-bab9-c96b469b2bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d61860>]}
[0m00:22:57.865762 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshot.extreme_weather_events ...................... [[31mERROR[0m in 0.61s]
[0m00:22:57.866382 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m00:22:57.866803 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:22:57.867384 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.hourly_weather_patterns ......................... [RUN]
[0m00:22:57.867879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m00:22:57.868226 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m00:22:57.871979 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m00:22:57.877183 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m00:22:57.877891 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:22:57.878285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:58.425298 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a76-0004-3987-0002-59430003d1fe
[0m00:22:58.426558 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m00:22:58.427321 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m00:22:58.578993 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:22:58.579699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9633ac9-278d-46ec-bab9-c96b469b2bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795c690>]}
[0m00:22:58.580635 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshot.hourly_weather_patterns ..................... [[31mERROR[0m in 0.71s]
[0m00:22:58.581243 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:22:58.581622 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:22:58.582140 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.weather_conditions_frequency .................... [RUN]
[0m00:22:58.582651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m00:22:58.582968 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m00:22:58.586424 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m00:22:58.590947 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m00:22:58.591339 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:22:58.591629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:59.081110 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a76-0004-386c-0002-59430003778e
[0m00:22:59.082669 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:22:59.083324 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m00:22:59.212758 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:22:59.213276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9633ac9-278d-46ec-bab9-c96b469b2bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078839d0>]}
[0m00:22:59.213964 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshot.weather_conditions_frequency ................ [[31mERROR[0m in 0.63s]
[0m00:22:59.214454 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:22:59.215543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:22:59.215851 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m00:22:59.216123 [info ] [MainThread]: 
[0m00:22:59.216384 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 4.61 seconds (4.61s).
[0m00:22:59.217223 [debug] [MainThread]: Command end result
[0m00:22:59.240728 [info ] [MainThread]: 
[0m00:22:59.241079 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:22:59.241272 [info ] [MainThread]: 
[0m00:22:59.241523 [error] [MainThread]:   Database Error in snapshot daily_average_weather_trend (snapshots/daily_avg_weather_trend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:22:59.241697 [info ] [MainThread]: 
[0m00:22:59.241911 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:22:59.242073 [info ] [MainThread]: 
[0m00:22:59.242284 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:22:59.242443 [info ] [MainThread]: 
[0m00:22:59.242641 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:22:59.242808 [info ] [MainThread]: 
[0m00:22:59.242989 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:22:59.244765 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 5.1322002, "process_in_blocks": "0", "process_kernel_time": 0.269164, "process_mem_max_rss": "141377536", "process_out_blocks": "0", "process_user_time": 1.523748}
[0m00:22:59.245128 [debug] [MainThread]: Command `dbt snapshot` failed at 00:22:59.245071 after 5.13 seconds
[0m00:22:59.245366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a36ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d8dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10582d4f0>]}
[0m00:22:59.245580 [debug] [MainThread]: Flushing usage events
[0m00:23:44.634262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d98d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112617d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112617b10>]}


============================== 00:23:44.637466 | 16b0a7c6-6c7d-4771-a6b8-afd9231332b9 ==============================
[0m00:23:44.637466 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:23:44.637790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:23:44.894861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16b0a7c6-6c7d-4771-a6b8-afd9231332b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11468a520>]}
[0m00:23:44.921433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16b0a7c6-6c7d-4771-a6b8-afd9231332b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11467c050>]}
[0m00:23:44.922215 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:23:44.985159 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:23:45.061182 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:23:45.061631 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:23:45.066710 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected string, got "day', w.DATE_TIME)
  )
  SELECT
      CITY_ID,
      CITY_NAME,
      WEATHER_DATE,
      AVG_TEMP_FAHRENHEIT,
      AVG_HUMIDITY,
      unique_key_column
  FROM
      Daily_Average_Weather_Trend
  ORDER BY
      WEATHER_DATE, CITY_NAME
  
  {% endsnapshot %}"
[0m00:23:45.068511 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.47720367, "process_in_blocks": "0", "process_kernel_time": 0.227614, "process_mem_max_rss": "122814464", "process_out_blocks": "0", "process_user_time": 0.863333}
[0m00:23:45.068878 [debug] [MainThread]: Command `dbt snapshot` failed at 00:23:45.068815 after 0.48 seconds
[0m00:23:45.069096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114924450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114924750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11490c320>]}
[0m00:23:45.069286 [debug] [MainThread]: Flushing usage events
[0m00:24:39.060741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ecd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108117d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108117b10>]}


============================== 00:24:39.064668 | de41bdff-038e-42ff-af04-ddb8085c405d ==============================
[0m00:24:39.064668 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:24:39.065011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:24:39.291235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de41bdff-038e-42ff-af04-ddb8085c405d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d72520>]}
[0m00:24:39.315078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de41bdff-038e-42ff-af04-ddb8085c405d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c74050>]}
[0m00:24:39.315879 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:24:39.377725 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:24:39.447995 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:24:39.448374 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:24:39.489078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de41bdff-038e-42ff-af04-ddb8085c405d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109024750>]}
[0m00:24:39.537898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de41bdff-038e-42ff-af04-ddb8085c405d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb9310>]}
[0m00:24:39.538159 [info ] [MainThread]: Found 5 models, 3 snapshots, 2 sources, 459 macros
[0m00:24:39.538332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de41bdff-038e-42ff-af04-ddb8085c405d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091c11d0>]}
[0m00:24:39.539261 [info ] [MainThread]: 
[0m00:24:39.539545 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:24:39.541527 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m00:24:39.547977 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m00:24:39.548188 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m00:24:39.548322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:40.225388 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.677 seconds
[0m00:24:40.232274 [debug] [ThreadPool]: On list_openweather: Close
[0m00:24:40.388861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m00:24:40.400427 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m00:24:40.400879 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m00:24:40.401123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:24:40.923851 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.522 seconds
[0m00:24:40.928039 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m00:24:41.061209 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m00:24:41.064824 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m00:24:41.065223 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m00:24:41.065532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:24:41.552770 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.487 seconds
[0m00:24:41.554573 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m00:24:41.679902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de41bdff-038e-42ff-af04-ddb8085c405d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e7040>]}
[0m00:24:41.680447 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:24:41.680717 [info ] [MainThread]: 
[0m00:24:41.684069 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events
[0m00:24:41.684479 [info ] [Thread-1 (]: 1 of 3 START snapshot snapshot.extreme_weather_events .......................... [RUN]
[0m00:24:41.684785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now snapshot.weather_dbt.extreme_weather_events)
[0m00:24:41.685032 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events
[0m00:24:41.691423 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events
[0m00:24:41.736639 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events"
[0m00:24:41.736959 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, DATE_TIME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    w.WIND_SPEED,
    CASE
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
        WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
        WHEN w.WIND_SPEED > 20 THEN 'High Winds'
        ELSE 'Normal'
    END AS WEATHER_ALERT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
WHERE
    ((w.TEMP - 273.15) * 9/5 + 32) > 100
    OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
    OR w.WIND_SPEED > 20

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:24:41.737164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:42.196446 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a78-0004-3869-0002-59430003a72a
[0m00:24:42.197173 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 45 unexpected 'as'.
syntax error line 6 at position 61 unexpected ')'.
[0m00:24:42.197738 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events: Close
[0m00:24:42.542834 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:24:42.544746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de41bdff-038e-42ff-af04-ddb8085c405d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10939dc10>]}
[0m00:24:42.545531 [error] [Thread-1 (]: 1 of 3 ERROR snapshotting snapshot.extreme_weather_events ...................... [[31mERROR[0m in 0.86s]
[0m00:24:42.546061 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events
[0m00:24:42.546419 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:24:42.547449 [info ] [Thread-1 (]: 2 of 3 START snapshot snapshot.hourly_weather_patterns ......................... [RUN]
[0m00:24:42.547870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events, now snapshot.weather_dbt.hourly_weather_patterns)
[0m00:24:42.548158 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns
[0m00:24:42.551251 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns
[0m00:24:42.555419 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns"
[0m00:24:42.555850 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, HOUR_OF_DAY as varchar ), '')
         || '|' || coalesce(cast(HOUR_OF_DAY as varchar ), '')
        ) as dbt_scd_id,
        HOUR_OF_DAY as dbt_updated_at,
        HOUR_OF_DAY as dbt_valid_from,
        
  
  coalesce(nullif(HOUR_OF_DAY, HOUR_OF_DAY), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
    AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
    AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
    AVG(w.HUMIDITY) AS AVG_HUMIDITY
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:24:42.556140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:43.001503 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a78-0004-3869-0002-59430003a72e
[0m00:24:43.002117 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 47 unexpected 'as'.
syntax error line 6 at position 63 unexpected ')'.
[0m00:24:43.002590 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns: Close
[0m00:24:43.134875 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:24:43.135674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de41bdff-038e-42ff-af04-ddb8085c405d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10945e0a0>]}
[0m00:24:43.136646 [error] [Thread-1 (]: 2 of 3 ERROR snapshotting snapshot.hourly_weather_patterns ..................... [[31mERROR[0m in 0.59s]
[0m00:24:43.137265 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns
[0m00:24:43.137674 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:24:43.138292 [info ] [Thread-1 (]: 3 of 3 START snapshot snapshot.weather_conditions_frequency .................... [RUN]
[0m00:24:43.138822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns, now snapshot.weather_dbt.weather_conditions_frequency)
[0m00:24:43.139179 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency
[0m00:24:43.143094 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency
[0m00:24:43.146875 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency"
[0m00:24:43.147264 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID, WEATHER_MAIN as varchar ), '')
         || '|' || coalesce(cast(CITY_ID as varchar ), '')
        ) as dbt_scd_id,
        CITY_ID as dbt_updated_at,
        CITY_ID as dbt_valid_from,
        
  
  coalesce(nullif(CITY_ID, CITY_ID), null)
  as dbt_valid_to
from (
        



SELECT
    w.CITY_ID,
    c."Name",
    w.WEATHER_MAIN,
    COUNT(*) AS CONDITION_COUNT
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
GROUP BY
    w.CITY_ID, c."Name", w.WEATHER_MAIN

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:24:43.147586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:43.665776 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89a78-0004-3868-0002-59430003875a
[0m00:24:43.667023 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 33 unexpected ','.
syntax error line 6 at position 48 unexpected 'as'.
syntax error line 6 at position 64 unexpected ')'.
[0m00:24:43.667771 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency: Close
[0m00:24:43.792535 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:24:43.793280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de41bdff-038e-42ff-af04-ddb8085c405d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c6c410>]}
[0m00:24:43.794238 [error] [Thread-1 (]: 3 of 3 ERROR snapshotting snapshot.weather_conditions_frequency ................ [[31mERROR[0m in 0.65s]
[0m00:24:43.794852 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency
[0m00:24:43.796384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:24:43.796732 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency' was properly closed.
[0m00:24:43.797068 [info ] [MainThread]: 
[0m00:24:43.797373 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m00:24:43.798182 [debug] [MainThread]: Command end result
[0m00:24:43.822593 [info ] [MainThread]: 
[0m00:24:43.822948 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m00:24:43.823124 [info ] [MainThread]: 
[0m00:24:43.823356 [error] [MainThread]:   Database Error in snapshot extreme_weather_events (snapshots/extreme_weather_events.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 45 unexpected 'as'.
  syntax error line 6 at position 61 unexpected ')'.
[0m00:24:43.823532 [info ] [MainThread]: 
[0m00:24:43.823747 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns (snapshots/hourly_weather_patterns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 47 unexpected 'as'.
  syntax error line 6 at position 63 unexpected ')'.
[0m00:24:43.823915 [info ] [MainThread]: 
[0m00:24:43.824102 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency (snapshots/weather_conditions_frequency.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 33 unexpected ','.
  syntax error line 6 at position 48 unexpected 'as'.
  syntax error line 6 at position 64 unexpected ')'.
[0m00:24:43.824260 [info ] [MainThread]: 
[0m00:24:43.824417 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m00:24:43.825846 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 4.801056, "process_in_blocks": "0", "process_kernel_time": 0.256181, "process_mem_max_rss": "139182080", "process_out_blocks": "0", "process_user_time": 1.43653}
[0m00:24:43.826179 [debug] [MainThread]: Command `dbt snapshot` failed at 00:24:43.826123 after 4.80 seconds
[0m00:24:43.826402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a744d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c3e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812aba0>]}
[0m00:24:43.826601 [debug] [MainThread]: Flushing usage events
[0m00:25:12.504794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c88d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104813d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104813b10>]}


============================== 00:25:12.507891 | 07e61b3b-16e7-4a68-a770-74b5fa7140f3 ==============================
[0m00:25:12.507891 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:25:12.508210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:25:12.738676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07e61b3b-16e7-4a68-a770-74b5fa7140f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1a520>]}
[0m00:25:12.763481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07e61b3b-16e7-4a68-a770-74b5fa7140f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cfc050>]}
[0m00:25:12.764230 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:25:12.826444 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:25:12.898339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:25:12.898717 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:25:12.904961 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected string, got "day', w.DATE_TIME)
  )
  SELECT
      CITY_ID,
      CITY_NAME,
      WEATHER_DATE,
      AVG_TEMP_FAHRENHEIT,
      AVG_HUMIDITY,
      unique_key_column
  FROM
      Daily_Average_Weather_Trend
  ORDER BY
      WEATHER_DATE, CITY_NAME
  
  {% endsnapshot %}"
[0m00:25:12.906859 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.44016853, "process_in_blocks": "0", "process_kernel_time": 0.21745, "process_mem_max_rss": "124518400", "process_out_blocks": "0", "process_user_time": 0.848359}
[0m00:25:12.907256 [debug] [MainThread]: Command `dbt snapshot` failed at 00:25:12.907192 after 0.44 seconds
[0m00:25:12.907480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106274150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106274450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cc320>]}
[0m00:25:12.907659 [debug] [MainThread]: Flushing usage events
[0m00:25:41.380597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ce8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ebb10>]}


============================== 00:25:41.383830 | f3ad6d98-95fd-46c3-8332-382511cb94df ==============================
[0m00:25:41.383830 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:25:41.384178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:25:41.621119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3ad6d98-95fd-46c3-8332-382511cb94df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105246520>]}
[0m00:25:41.646449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3ad6d98-95fd-46c3-8332-382511cb94df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105148050>]}
[0m00:25:41.647216 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:25:41.705995 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:25:41.772988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:25:41.773325 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:25:41.777922 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected string, got "day', w.DATE_TIME)
  )
  SELECT
      CITY_ID,
      CITY_NAME,
      WEATHER_DATE,
      AVG_TEMP_FAHRENHEIT,
      AVG_HUMIDITY,
      unique_key_column
  FROM
      Daily_Average_Weather_Trend
  ORDER BY
      WEATHER_DATE, CITY_NAME
  
  {% endsnapshot %}"
[0m00:25:41.779473 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.43931308, "process_in_blocks": "0", "process_kernel_time": 0.212389, "process_mem_max_rss": "122503168", "process_out_blocks": "0", "process_user_time": 0.844457}
[0m00:25:41.779765 [debug] [MainThread]: Command `dbt snapshot` failed at 00:25:41.779712 after 0.44 seconds
[0m00:25:41.779955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10548c150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10548c450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054dc320>]}
[0m00:25:41.780116 [debug] [MainThread]: Flushing usage events
[0m00:26:36.959103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104734d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106037d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106037b10>]}


============================== 00:26:36.962503 | f5d32579-fb83-43b4-bd91-1bc83b1c45e2 ==============================
[0m00:26:36.962503 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:26:36.962838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:26:37.202768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5d32579-fb83-43b4-bd91-1bc83b1c45e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c92520>]}
[0m00:26:37.227808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5d32579-fb83-43b4-bd91-1bc83b1c45e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b94050>]}
[0m00:26:37.228552 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:26:37.289578 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:26:37.365843 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:26:37.366263 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/daily_avg_weather_trend.sql
[0m00:26:37.366452 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:26:37.451072 [error] [MainThread]: Encountered an error:
Compilation Error in model daily_avg_weather_trend (models/output/daily_avg_weather_trend.sql)
  Encountered unknown tag 'snapshot'.
    line 1
      {% snapshot daily_average_weather_trend %}
[0m00:26:37.452806 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.536031, "process_in_blocks": "0", "process_kernel_time": 0.224081, "process_mem_max_rss": "127320064", "process_out_blocks": "0", "process_user_time": 0.953524}
[0m00:26:37.453122 [debug] [MainThread]: Command `dbt snapshot` failed at 00:26:37.453069 after 0.54 seconds
[0m00:26:37.453353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b07750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b07650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f4a8a0>]}
[0m00:26:37.453533 [debug] [MainThread]: Flushing usage events
[0m00:27:06.040658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ac7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ac7b10>]}


============================== 00:27:06.043780 | 4ce36162-0262-415a-a0d5-882c088f577c ==============================
[0m00:27:06.043780 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:27:06.044111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:27:06.276368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ce36162-0262-415a-a0d5-882c088f577c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109722520>]}
[0m00:27:06.301756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ce36162-0262-415a-a0d5-882c088f577c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109624050>]}
[0m00:27:06.302956 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:27:06.364681 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:27:06.438886 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:27:06.439389 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:27:06.439595 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/daily_avg_weather_trend.sql
[0m00:27:06.517302 [error] [MainThread]: Encountered an error:
Compilation Error in model daily_avg_weather_trend (models/output/daily_avg_weather_trend.sql)
  Encountered unknown tag 'snapshot'.
    line 1
      {% snapshot daily_avg_weather_trend %}
[0m00:27:06.519108 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.5156612, "process_in_blocks": "0", "process_kernel_time": 0.216893, "process_mem_max_rss": "126894080", "process_out_blocks": "0", "process_user_time": 0.942417}
[0m00:27:06.519480 [debug] [MainThread]: Command `dbt snapshot` failed at 00:27:06.519421 after 0.52 seconds
[0m00:27:06.519704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109597750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109597650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099d68a0>]}
[0m00:27:06.519874 [debug] [MainThread]: Flushing usage events
[0m00:27:30.609520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031e4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ae7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ae7b10>]}


============================== 00:27:30.612689 | 08cf5b2e-695e-4a7e-ac27-3694b882efb8 ==============================
[0m00:27:30.612689 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:27:30.613038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:27:30.846553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08cf5b2e-695e-4a7e-ac27-3694b882efb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105742520>]}
[0m00:27:30.871993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08cf5b2e-695e-4a7e-ac27-3694b882efb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105644050>]}
[0m00:27:30.873456 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:27:30.933849 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:27:31.009480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:27:31.009867 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/daily_avg_weather_trend.sql
[0m00:27:31.010049 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:27:31.086783 [error] [MainThread]: Encountered an error:
Compilation Error in model daily_avg_weather_trend (models/output/daily_avg_weather_trend.sql)
  Encountered unknown tag 'snapshot'.
    line 1
      {% snapshot snapshot_daily_avg_weather_trend %}
[0m00:27:31.088257 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.51787555, "process_in_blocks": "0", "process_kernel_time": 0.222347, "process_mem_max_rss": "127909888", "process_out_blocks": "0", "process_user_time": 0.946858}
[0m00:27:31.088692 [debug] [MainThread]: Command `dbt snapshot` failed at 00:27:31.088583 after 0.52 seconds
[0m00:27:31.088959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b7750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059f68a0>]}
[0m00:27:31.089146 [debug] [MainThread]: Flushing usage events
[0m00:28:21.837729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d7b10>]}


============================== 00:28:21.840870 | c05ca363-93bf-4035-81fa-e0ae08848c67 ==============================
[0m00:28:21.840870 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:28:21.841188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:28:22.076770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c05ca363-93bf-4035-81fa-e0ae08848c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064fa520>]}
[0m00:28:22.101799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c05ca363-93bf-4035-81fa-e0ae08848c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063fc050>]}
[0m00:28:22.102516 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:28:22.165785 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:28:22.239725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:28:22.240199 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:28:22.301917 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_daily_avg_weather_trend (snapshots/daily_avg_weather_trend.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m00:28:22.303483 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.5060365, "process_in_blocks": "0", "process_kernel_time": 0.213257, "process_mem_max_rss": "125566976", "process_out_blocks": "0", "process_user_time": 0.919776}
[0m00:28:22.303853 [debug] [MainThread]: Command `dbt snapshot` failed at 00:28:22.303792 after 0.51 seconds
[0m00:28:22.304078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10636f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10636f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b0320>]}
[0m00:28:22.304262 [debug] [MainThread]: Flushing usage events
[0m00:29:15.618321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106298d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c17d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c17b10>]}


============================== 00:29:15.621244 | 96330a38-6f80-4c8f-b6d0-24ac91fe1eaf ==============================
[0m00:29:15.621244 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:29:15.621556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:29:15.845200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96330a38-6f80-4c8f-b6d0-24ac91fe1eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a38a520>]}
[0m00:29:15.868496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96330a38-6f80-4c8f-b6d0-24ac91fe1eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2fc050>]}
[0m00:29:15.869157 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:29:15.930969 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:29:16.001601 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:29:16.002061 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m00:29:16.077372 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: Snapshots must be configured with a 'strategy', 'unique_key', and 'target_schema'.
[0m00:29:16.079058 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.49682474, "process_in_blocks": "0", "process_kernel_time": 0.199622, "process_mem_max_rss": "128598016", "process_out_blocks": "0", "process_user_time": 0.889588}
[0m00:29:16.079399 [debug] [MainThread]: Command `dbt snapshot` failed at 00:29:16.079340 after 0.50 seconds
[0m00:29:16.079632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a26f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a26f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a620320>]}
[0m00:29:16.079811 [debug] [MainThread]: Flushing usage events
[0m08:55:23.367954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e68d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10676fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10676fb10>]}


============================== 08:55:23.371018 | 6b550a69-f113-4374-a6de-d201cccb8957 ==============================
[0m08:55:23.371018 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:55:23.371342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m08:55:23.577507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b550a69-f113-4374-a6de-d201cccb8957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dfa520>]}
[0m08:55:23.601415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b550a69-f113-4374-a6de-d201cccb8957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cfc050>]}
[0m08:55:23.602881 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:55:23.681928 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:55:23.747277 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:55:23.747611 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m08:55:23.818665 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: Snapshots must be configured with a 'strategy', 'unique_key', and 'target_schema'.
[0m08:55:23.820112 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.48643988, "process_in_blocks": "0", "process_kernel_time": 0.185205, "process_mem_max_rss": "126173184", "process_out_blocks": "0", "process_user_time": 0.874637}
[0m08:55:23.820410 [debug] [MainThread]: Command `dbt snapshot` failed at 08:55:23.820362 after 0.49 seconds
[0m08:55:23.820611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084d0320>]}
[0m08:55:23.820771 [debug] [MainThread]: Flushing usage events
[0m08:56:03.308756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d78d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667bb10>]}


============================== 08:56:03.311147 | f847912b-cb4e-4eb3-b1ff-ec963794417d ==============================
[0m08:56:03.311147 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:56:03.311549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:56:03.475073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f847912b-cb4e-4eb3-b1ff-ec963794417d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fa520>]}
[0m08:56:03.498041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f847912b-cb4e-4eb3-b1ff-ec963794417d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073fc050>]}
[0m08:56:03.498469 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:56:03.554038 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:56:03.618046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:56:03.618392 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m08:56:03.697714 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: Snapshots must be configured with a 'strategy', 'unique_key', and 'target_schema'.
[0m08:56:03.698788 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.42254022, "process_in_blocks": "0", "process_kernel_time": 0.158646, "process_mem_max_rss": "125124608", "process_out_blocks": "0", "process_user_time": 0.877503}
[0m08:56:03.699085 [debug] [MainThread]: Command `dbt snapshot` failed at 08:56:03.699036 after 0.42 seconds
[0m08:56:03.699283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10736f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10736f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079b0320>]}
[0m08:56:03.699445 [debug] [MainThread]: Flushing usage events
[0m08:57:18.549610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f74d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10889fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10889fb10>]}


============================== 08:57:18.552237 | 62eb1933-2d4a-4563-bcd6-51db5871d7b2 ==============================
[0m08:57:18.552237 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:57:18.552578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:57:18.718086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62eb1933-2d4a-4563-bcd6-51db5871d7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096fa520>]}
[0m08:57:18.740959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62eb1933-2d4a-4563-bcd6-51db5871d7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096ec050>]}
[0m08:57:18.741366 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:57:18.797184 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:57:18.855365 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:57:18.855680 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m08:57:18.930756 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: Snapshots must be configured with a 'strategy', 'unique_key', and 'target_schema'.
[0m08:57:18.931749 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.4152856, "process_in_blocks": "0", "process_kernel_time": 0.157385, "process_mem_max_rss": "123518976", "process_out_blocks": "0", "process_user_time": 0.870538}
[0m08:57:18.932040 [debug] [MainThread]: Command `dbt snapshot` failed at 08:57:18.931988 after 0.42 seconds
[0m08:57:18.932251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10956f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10956f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099b0320>]}
[0m08:57:18.932421 [debug] [MainThread]: Flushing usage events
[0m08:57:36.596952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b7b10>]}


============================== 08:57:36.599221 | d06ce2a6-54ff-4e6a-973d-2be0c1f36c3b ==============================
[0m08:57:36.599221 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:57:36.599537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:57:36.756911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd06ce2a6-54ff-4e6a-973d-2be0c1f36c3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10941a520>]}
[0m08:57:36.779522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd06ce2a6-54ff-4e6a-973d-2be0c1f36c3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10940c050>]}
[0m08:57:36.779944 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:57:36.835587 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:57:36.893383 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:57:36.893728 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m08:57:36.964670 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: Snapshots must be configured with a 'strategy', 'unique_key', and 'target_schema'.
[0m08:57:36.965650 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.40101224, "process_in_blocks": "0", "process_kernel_time": 0.131998, "process_mem_max_rss": "124239872", "process_out_blocks": "0", "process_user_time": 0.863378}
[0m08:57:36.965955 [debug] [MainThread]: Command `dbt snapshot` failed at 08:57:36.965902 after 0.40 seconds
[0m08:57:36.966164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10936f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10936f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096cc320>]}
[0m08:57:36.966333 [debug] [MainThread]: Flushing usage events
[0m08:58:18.839960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fcd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108003d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108003b10>]}


============================== 08:58:18.842299 | cbb10c22-7268-4975-87ae-2c7ea8d8e684 ==============================
[0m08:58:18.842299 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:58:18.842610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:58:18.892622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbb10c22-7268-4975-87ae-2c7ea8d8e684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e6b360>]}
[0m08:58:18.904342 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.09748008, "process_in_blocks": "0", "process_kernel_time": 0.093698, "process_mem_max_rss": "100237312", "process_out_blocks": "0", "process_user_time": 0.60384}
[0m08:58:18.904692 [debug] [MainThread]: Command `dbt clean` succeeded at 08:58:18.904628 after 0.10 seconds
[0m08:58:18.904875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812a580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d92950>]}
[0m08:58:18.905037 [debug] [MainThread]: Flushing usage events
[0m08:58:23.169726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033ecd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c17d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c17b10>]}


============================== 08:58:23.171978 | 52ea9380-ece3-4008-9224-01a919ebf151 ==============================
[0m08:58:23.171978 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:58:23.172282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:58:23.340197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52ea9380-ece3-4008-9224-01a919ebf151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b8a520>]}
[0m08:58:23.363518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52ea9380-ece3-4008-9224-01a919ebf151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106afc050>]}
[0m08:58:23.363928 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:58:23.420209 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:58:23.420722 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:58:23.420920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '52ea9380-ece3-4008-9224-01a919ebf151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a70a50>]}
[0m08:58:23.905718 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: Snapshots must be configured with a 'strategy', 'unique_key', and 'target_schema'.
[0m08:58:23.906854 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7691011, "process_in_blocks": "0", "process_kernel_time": 0.161672, "process_mem_max_rss": "125599744", "process_out_blocks": "0", "process_user_time": 1.21241}
[0m08:58:23.907126 [debug] [MainThread]: Command `dbt run` failed at 08:58:23.907080 after 0.77 seconds
[0m08:58:23.907300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107022a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107089b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c1fe70>]}
[0m08:58:23.907462 [debug] [MainThread]: Flushing usage events
[0m08:59:15.516370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085dfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085dfb10>]}


============================== 08:59:15.518631 | d566c550-5bc4-47d2-8109-f9b59765cf15 ==============================
[0m08:59:15.518631 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:59:15.518941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:59:15.685149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd566c550-5bc4-47d2-8109-f9b59765cf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109236520>]}
[0m08:59:15.707876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd566c550-5bc4-47d2-8109-f9b59765cf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109138050>]}
[0m08:59:15.708271 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m08:59:15.763931 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:59:15.764427 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:59:15.764614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd566c550-5bc4-47d2-8109-f9b59765cf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090aca50>]}
[0m08:59:16.258094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd566c550-5bc4-47d2-8109-f9b59765cf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107305220>]}
[0m08:59:16.297413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd566c550-5bc4-47d2-8109-f9b59765cf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10943d9b0>]}
[0m08:59:16.297666 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m08:59:16.297825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd566c550-5bc4-47d2-8109-f9b59765cf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094c3380>]}
[0m08:59:16.299048 [info ] [MainThread]: 
[0m08:59:16.299313 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:59:16.301402 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m08:59:16.308398 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m08:59:16.308663 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m08:59:16.308809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:59:17.066613 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.758 seconds
[0m08:59:17.069680 [debug] [ThreadPool]: On list_openweather: Close
[0m08:59:17.254097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m08:59:17.262625 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m08:59:17.262873 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m08:59:17.263058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:17.923350 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.660 seconds
[0m08:59:17.926923 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m08:59:18.109606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd566c550-5bc4-47d2-8109-f9b59765cf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109806750>]}
[0m08:59:18.110531 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:59:18.110997 [info ] [MainThread]: 
[0m08:59:18.115542 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m08:59:18.116247 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m08:59:18.116781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m08:59:18.117450 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m08:59:18.125332 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m08:59:18.126971 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m08:59:18.149972 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m08:59:18.151321 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m08:59:18.151582 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m08:59:18.151804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:21.873930 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.721 seconds
[0m08:59:21.903110 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m08:59:22.059362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd566c550-5bc4-47d2-8109-f9b59765cf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085adf40>]}
[0m08:59:22.060460 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 3.94s]
[0m08:59:22.061217 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m08:59:22.061739 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m08:59:22.062406 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m08:59:22.063008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m08:59:22.063430 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m08:59:22.068228 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m08:59:22.069539 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m08:59:22.072019 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m08:59:22.074013 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m08:59:22.074413 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m08:59:22.074890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:23.514845 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.439 seconds
[0m08:59:23.523702 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m08:59:23.639835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd566c550-5bc4-47d2-8109-f9b59765cf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10992bb10>]}
[0m08:59:23.640367 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.58s]
[0m08:59:23.640744 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m08:59:23.640992 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m08:59:23.641324 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m08:59:23.641631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m08:59:23.641856 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m08:59:23.643767 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m08:59:23.644295 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m08:59:23.645633 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m08:59:23.646486 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m08:59:23.646734 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    *
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY
        );
[0m08:59:23.647099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:25.140665 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.493 seconds
[0m08:59:25.143011 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m08:59:25.295517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd566c550-5bc4-47d2-8109-f9b59765cf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109101fd0>]}
[0m08:59:25.297649 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.hourly_weather_patterns ............ [[32mSUCCESS 1[0m in 1.65s]
[0m08:59:25.298141 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m08:59:25.298418 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m08:59:25.298784 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m08:59:25.299100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m08:59:25.299300 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m08:59:25.301570 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m08:59:25.302161 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m08:59:25.314249 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m08:59:25.315107 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m08:59:25.315308 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m08:59:25.315473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:26.196151 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.880 seconds
[0m08:59:26.200247 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m08:59:26.346389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd566c550-5bc4-47d2-8109-f9b59765cf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c14910>]}
[0m08:59:26.347374 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 1.05s]
[0m08:59:26.347992 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m08:59:26.348471 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m08:59:26.348987 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m08:59:26.349494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m08:59:26.349849 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m08:59:26.353007 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m08:59:26.353955 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m08:59:26.356228 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m08:59:26.357393 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m08:59:26.357713 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    *
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME
        );
[0m08:59:26.358004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:27.504951 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.146 seconds
[0m08:59:27.509515 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m08:59:27.634210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd566c550-5bc4-47d2-8109-f9b59765cf15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a805f0>]}
[0m08:59:27.635290 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.28s]
[0m08:59:27.636114 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m08:59:27.637995 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:59:27.638503 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m08:59:27.638943 [info ] [MainThread]: 
[0m08:59:27.639302 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 11.34 seconds (11.34s).
[0m08:59:27.640575 [debug] [MainThread]: Command end result
[0m08:59:27.665589 [info ] [MainThread]: 
[0m08:59:27.665948 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:59:27.666328 [info ] [MainThread]: 
[0m08:59:27.666544 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:59:27.667746 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.184326, "process_in_blocks": "0", "process_kernel_time": 0.21693, "process_mem_max_rss": "140836864", "process_out_blocks": "0", "process_user_time": 1.820842}
[0m08:59:27.668135 [debug] [MainThread]: Command `dbt run` succeeded at 08:59:27.668025 after 12.18 seconds
[0m08:59:27.668399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b31df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a83dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a83d70>]}
[0m08:59:27.668641 [debug] [MainThread]: Flushing usage events
[0m09:02:51.982764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f17d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f17b10>]}


============================== 09:02:51.985170 | a95ebb14-2adb-4274-ad9c-205ce32c112b ==============================
[0m09:02:51.985170 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:02:51.985523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m09:02:52.147597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a95ebb14-2adb-4274-ad9c-205ce32c112b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d8a520>]}
[0m09:02:52.170197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a95ebb14-2adb-4274-ad9c-205ce32c112b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cfc050>]}
[0m09:02:52.170584 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:02:52.225014 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:02:52.275507 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:02:52.275783 [debug] [MainThread]: Partial parsing: added file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m09:02:52.280223 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected string, got "day', w.DATE_TIME)
  )
  SELECT
      CITY_ID,
      CITY_NAME,
      WEATHER_DATE,
      AVG_TEMP_FAHRENHEIT,
      AVG_HUMIDITY,
      CURRENT_TIMESTAMP AS LAST_UPDATED  -- Add a field to track when the snapshot was taken
  FROM
      Daily_Average_Weather_Trend
  ORDER BY
      WEATHER_DATE, CITY_NAME
  
  {% endsnapshot %}"
[0m09:02:52.281223 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.33151895, "process_in_blocks": "0", "process_kernel_time": 0.152899, "process_mem_max_rss": "122306560", "process_out_blocks": "0", "process_user_time": 0.779661}
[0m09:02:52.281507 [debug] [MainThread]: Command `dbt snapshot` failed at 09:02:52.281461 after 0.33 seconds
[0m09:02:52.281705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107180320>]}
[0m09:02:52.281872 [debug] [MainThread]: Flushing usage events
[0m09:04:36.241715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106013d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106013b10>]}


============================== 09:04:36.244182 | b90438a9-4d71-4388-8ce3-9398e4986530 ==============================
[0m09:04:36.244182 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:04:36.244524 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:04:36.417057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b90438a9-4d71-4388-8ce3-9398e4986530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f8a520>]}
[0m09:04:36.443435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b90438a9-4d71-4388-8ce3-9398e4986530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f7c050>]}
[0m09:04:36.444027 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:04:36.501742 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:04:36.555963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:04:36.556309 [debug] [MainThread]: Partial parsing: added file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m09:04:36.561257 [error] [MainThread]: Encountered an error:
Compilation Error
  Reached EOF without finding a close tag for snapshot (searched from line 1)
[0m09:04:36.562373 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.3545403, "process_in_blocks": "0", "process_kernel_time": 0.162597, "process_mem_max_rss": "125599744", "process_out_blocks": "0", "process_user_time": 0.808}
[0m09:04:36.562793 [debug] [MainThread]: Command `dbt snapshot` failed at 09:04:36.562735 after 0.36 seconds
[0m09:04:36.563003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e6d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e6d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10720c320>]}
[0m09:04:36.563178 [debug] [MainThread]: Flushing usage events
[0m09:04:57.769092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103034d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104937d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104937b10>]}


============================== 09:04:57.771376 | f4791e8d-9b24-4e48-88a9-aa2823e96b9f ==============================
[0m09:04:57.771376 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:04:57.771690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:04:57.946167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4791e8d-9b24-4e48-88a9-aa2823e96b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105592520>]}
[0m09:04:57.971611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4791e8d-9b24-4e48-88a9-aa2823e96b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105494050>]}
[0m09:04:57.972086 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:04:58.029055 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:04:58.083996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:04:58.084351 [debug] [MainThread]: Partial parsing: added file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m09:04:58.147389 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot daily_average_weather_snapshot (snapshots/daily_avg_weather_trend.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m09:04:58.148523 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.41162583, "process_in_blocks": "0", "process_kernel_time": 0.165449, "process_mem_max_rss": "126337024", "process_out_blocks": "0", "process_user_time": 0.859518}
[0m09:04:58.148925 [debug] [MainThread]: Command `dbt snapshot` failed at 09:04:58.148863 after 0.41 seconds
[0m09:04:58.149142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105405550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105407950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105814320>]}
[0m09:04:58.149317 [debug] [MainThread]: Flushing usage events
[0m09:05:24.772599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032bcd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d7b10>]}


============================== 09:05:24.774905 | 1fc4b6ad-c6ff-42ad-9234-66ba3472bc1a ==============================
[0m09:05:24.774905 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:05:24.775228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:05:24.929816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fc4b6ad-c6ff-42ad-9234-66ba3472bc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678a520>]}
[0m09:05:24.952450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fc4b6ad-c6ff-42ad-9234-66ba3472bc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fc050>]}
[0m09:05:24.952841 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:05:25.008962 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:05:25.060824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:05:25.061133 [debug] [MainThread]: Partial parsing: added file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m09:05:25.116848 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot daily_average_weather_snapshot (snapshots/daily_avg_weather_trend.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m09:05:25.117817 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.37766755, "process_in_blocks": "0", "process_kernel_time": 0.135417, "process_mem_max_rss": "124698624", "process_out_blocks": "0", "process_user_time": 0.839969}
[0m09:05:25.118100 [debug] [MainThread]: Command `dbt snapshot` failed at 09:05:25.118050 after 0.38 seconds
[0m09:05:25.118288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10666d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10666f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b9c320>]}
[0m09:05:25.118453 [debug] [MainThread]: Flushing usage events
[0m09:06:09.857763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d38d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad7b10>]}


============================== 09:06:09.860309 | 1e4a1fd7-ad28-46fa-a19a-277f0d4c2076 ==============================
[0m09:06:09.860309 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:06:09.860617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:06:10.037143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e4a1fd7-ad28-46fa-a19a-277f0d4c2076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11021a520>]}
[0m09:06:10.062183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e4a1fd7-ad28-46fa-a19a-277f0d4c2076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100fc050>]}
[0m09:06:10.062611 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:06:10.120298 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:06:10.175011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:06:10.175317 [debug] [MainThread]: Partial parsing: added file: weather_dbt://snapshots/daily_avg_weather_trend.sql
[0m09:06:10.237953 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot daily_average_weather_snapshot (snapshots/daily_avg_weather_trend.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m09:06:10.238921 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.41356963, "process_in_blocks": "0", "process_kernel_time": 0.166296, "process_mem_max_rss": "126631936", "process_out_blocks": "0", "process_user_time": 0.865811}
[0m09:06:10.239213 [debug] [MainThread]: Command `dbt snapshot` failed at 09:06:10.239164 after 0.41 seconds
[0m09:06:10.239412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11006d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11006f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11049c320>]}
[0m09:06:10.239577 [debug] [MainThread]: Flushing usage events
[0m09:08:37.513666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d0cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106513d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106513b10>]}


============================== 09:08:37.516036 | 56f09159-1504-4158-978a-de3511de8244 ==============================
[0m09:08:37.516036 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:08:37.516510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:08:37.565777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56f09159-1504-4158-978a-de3511de8244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10347b360>]}
[0m09:08:37.573118 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.092629835, "process_in_blocks": "0", "process_kernel_time": 0.095113, "process_mem_max_rss": "100614144", "process_out_blocks": "0", "process_user_time": 0.615357}
[0m09:08:37.573410 [debug] [MainThread]: Command `dbt clean` succeeded at 09:08:37.573361 after 0.09 seconds
[0m09:08:37.573589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106802580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106802690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e2950>]}
[0m09:08:37.573740 [debug] [MainThread]: Flushing usage events
[0m09:08:41.723536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108edbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108edbb10>]}


============================== 09:08:41.725839 | e9483b2e-635c-4cd5-a269-f0c7da656244 ==============================
[0m09:08:41.725839 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:08:41.726138 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:08:41.900343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9483b2e-635c-4cd5-a269-f0c7da656244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c8a520>]}
[0m09:08:41.925650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9483b2e-635c-4cd5-a269-f0c7da656244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bf4050>]}
[0m09:08:41.926208 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:08:41.985225 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:08:41.985726 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:08:41.985921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e9483b2e-635c-4cd5-a269-f0c7da656244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b6ca50>]}
[0m09:08:42.475307 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot daily_average_weather_snapshot (snapshots/daily_avg_weather_trend.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m09:08:42.476266 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7850301, "process_in_blocks": "0", "process_kernel_time": 0.174903, "process_mem_max_rss": "126615552", "process_out_blocks": "0", "process_user_time": 1.225282}
[0m09:08:42.476532 [debug] [MainThread]: Command `dbt run` failed at 09:08:42.476485 after 0.79 seconds
[0m09:08:42.476705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a122a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1896d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee3e70>]}
[0m09:08:42.476860 [debug] [MainThread]: Flushing usage events
[0m09:09:00.805971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10243cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d3fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d3fb10>]}


============================== 09:09:00.808380 | cab761a5-dad6-4f08-849e-329b1ffe050b ==============================
[0m09:09:00.808380 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:09:00.808698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:09:00.857628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cab761a5-dad6-4f08-849e-329b1ffe050b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bab360>]}
[0m09:09:00.863575 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.08999866, "process_in_blocks": "0", "process_kernel_time": 0.092318, "process_mem_max_rss": "97746944", "process_out_blocks": "0", "process_user_time": 0.605197}
[0m09:09:00.863881 [debug] [MainThread]: Command `dbt clean` succeeded at 09:09:00.863826 after 0.09 seconds
[0m09:09:00.864058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e6a580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e6a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ad2950>]}
[0m09:09:00.864313 [debug] [MainThread]: Flushing usage events
[0m09:09:04.099950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cfcd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ffd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ffb10>]}


============================== 09:09:04.102236 | 8bcab9a5-3eb9-47aa-9772-eb115c801b71 ==============================
[0m09:09:04.102236 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:09:04.102563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:09:04.150666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bcab9a5-3eb9-47aa-9772-eb115c801b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10546b360>]}
[0m09:09:04.156149 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.08854225, "process_in_blocks": "0", "process_kernel_time": 0.08033, "process_mem_max_rss": "99303424", "process_out_blocks": "0", "process_user_time": 0.608905}
[0m09:09:04.156462 [debug] [MainThread]: Command `dbt clean` succeeded at 09:09:04.156413 after 0.09 seconds
[0m09:09:04.156640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10672a580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10672a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106392950>]}
[0m09:09:04.156803 [debug] [MainThread]: Flushing usage events
[0m09:09:08.703203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109513d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109513b10>]}


============================== 09:09:08.705826 | 75a701fd-a211-4507-99aa-0d538d123737 ==============================
[0m09:09:08.705826 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:09:08.706152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:09:08.870138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75a701fd-a211-4507-99aa-0d538d123737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adfa520>]}
[0m09:09:08.892722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75a701fd-a211-4507-99aa-0d538d123737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acfc050>]}
[0m09:09:08.893130 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:09:08.948071 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:09:08.948603 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:09:08.948793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '75a701fd-a211-4507-99aa-0d538d123737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac70a50>]}
[0m09:09:09.443942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75a701fd-a211-4507-99aa-0d538d123737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3d220>]}
[0m09:09:09.481561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75a701fd-a211-4507-99aa-0d538d123737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0019b0>]}
[0m09:09:09.481803 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m09:09:09.481954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75a701fd-a211-4507-99aa-0d538d123737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b087380>]}
[0m09:09:09.483129 [info ] [MainThread]: 
[0m09:09:09.483395 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:09:09.485462 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m09:09:09.491824 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m09:09:09.492061 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m09:09:09.492191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:09:10.182369 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.690 seconds
[0m09:09:10.184159 [debug] [ThreadPool]: On list_openweather: Close
[0m09:09:10.338693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m09:09:10.350217 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m09:09:10.350584 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m09:09:10.350858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:09:11.051881 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.701 seconds
[0m09:09:11.056795 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m09:09:11.225913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75a701fd-a211-4507-99aa-0d538d123737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5e6750>]}
[0m09:09:11.226688 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:09:11.227076 [info ] [MainThread]: 
[0m09:09:11.230001 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m09:09:11.230634 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m09:09:11.231122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m09:09:11.231491 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m09:09:11.240163 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m09:09:11.241803 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m09:09:11.264980 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m09:09:11.267444 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m09:09:11.267716 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m09:09:11.267938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:09:12.815322 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.547 seconds
[0m09:09:12.840776 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m09:09:13.066399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a701fd-a211-4507-99aa-0d538d123737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094e1f40>]}
[0m09:09:13.067516 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.83s]
[0m09:09:13.068414 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m09:09:13.068926 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m09:09:13.069558 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m09:09:13.070141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m09:09:13.070552 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m09:09:13.075164 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m09:09:13.076375 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m09:09:13.079005 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m09:09:13.081270 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m09:09:13.081652 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m09:09:13.081976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:09:14.584468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.502 seconds
[0m09:09:14.588112 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m09:09:14.725542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a701fd-a211-4507-99aa-0d538d123737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c10fb10>]}
[0m09:09:14.726598 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.66s]
[0m09:09:14.727426 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m09:09:14.728002 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m09:09:14.728789 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m09:09:14.729429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m09:09:14.729852 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m09:09:14.733843 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m09:09:14.735304 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m09:09:14.737829 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m09:09:14.739273 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m09:09:14.739661 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    *
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY
        );
[0m09:09:14.740015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:09:16.338597 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.598 seconds
[0m09:09:16.345665 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m09:09:16.864327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a701fd-a211-4507-99aa-0d538d123737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acc5850>]}
[0m09:09:16.865506 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.hourly_weather_patterns ............ [[32mSUCCESS 1[0m in 2.13s]
[0m09:09:16.866209 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m09:09:16.866688 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m09:09:16.867315 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m09:09:16.867888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m09:09:16.868296 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m09:09:16.872195 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m09:09:16.873474 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m09:09:16.893080 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m09:09:16.894217 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m09:09:16.894493 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m09:09:16.894723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:09:18.271108 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.376 seconds
[0m09:09:18.275745 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m09:09:18.408718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a701fd-a211-4507-99aa-0d538d123737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107424910>]}
[0m09:09:18.409654 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 1.54s]
[0m09:09:18.410355 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m09:09:18.410834 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m09:09:18.411426 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m09:09:18.411985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m09:09:18.412382 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m09:09:18.416456 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m09:09:18.417642 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m09:09:18.420055 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m09:09:18.421460 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m09:09:18.421879 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    *
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME
        );
[0m09:09:18.422228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:09:19.999390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.575 seconds
[0m09:09:20.003636 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m09:09:20.129131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a701fd-a211-4507-99aa-0d538d123737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c464230>]}
[0m09:09:20.130206 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.72s]
[0m09:09:20.130979 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m09:09:20.132621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:09:20.133015 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m09:09:20.133454 [info ] [MainThread]: 
[0m09:09:20.133818 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 10.65 seconds (10.65s).
[0m09:09:20.135105 [debug] [MainThread]: Command end result
[0m09:09:20.161421 [info ] [MainThread]: 
[0m09:09:20.161852 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:09:20.162056 [info ] [MainThread]: 
[0m09:09:20.162276 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m09:09:20.164439 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.493248, "process_in_blocks": "0", "process_kernel_time": 0.20673, "process_mem_max_rss": "141164544", "process_out_blocks": "0", "process_user_time": 1.895124}
[0m09:09:20.165009 [debug] [MainThread]: Command `dbt run` succeeded at 09:09:20.164923 after 11.49 seconds
[0m09:09:20.165286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ebc7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c467ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c467dd0>]}
[0m09:09:20.165533 [debug] [MainThread]: Flushing usage events
[0m09:13:14.517460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072a4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba7b10>]}


============================== 09:13:14.519977 | 41ebb632-285f-4b95-8a55-7ce2894bb991 ==============================
[0m09:13:14.519977 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:13:14.520292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m09:13:14.706678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41ebb632-285f-4b95-8a55-7ce2894bb991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab1a520>]}
[0m09:13:14.731316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41ebb632-285f-4b95-8a55-7ce2894bb991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aafc050>]}
[0m09:13:14.731818 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:13:14.789107 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:13:14.845971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:13:14.846306 [debug] [MainThread]: Partial parsing: added file: weather_dbt://snapshots/daily_average_weather_trend.sql
[0m09:13:14.973044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41ebb632-285f-4b95-8a55-7ce2894bb991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae48a50>]}
[0m09:13:15.022260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41ebb632-285f-4b95-8a55-7ce2894bb991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad9e4e0>]}
[0m09:13:15.022565 [info ] [MainThread]: Found 5 models, 1 snapshot, 2 sources, 459 macros
[0m09:13:15.022735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41ebb632-285f-4b95-8a55-7ce2894bb991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aedc910>]}
[0m09:13:15.023640 [info ] [MainThread]: 
[0m09:13:15.023929 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:13:15.024345 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m09:13:15.030923 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m09:13:15.031166 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m09:13:15.031307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:13:15.813271 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.781 seconds
[0m09:13:15.816763 [debug] [ThreadPool]: On list_openweather: Close
[0m09:13:15.944315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now create_openweather_snapshots)
[0m09:13:15.945126 [debug] [ThreadPool]: Creating schema "database: "openweather"
schema: "snapshots"
"
[0m09:13:15.951131 [debug] [ThreadPool]: Using snowflake connection "create_openweather_snapshots"
[0m09:13:15.951518 [debug] [ThreadPool]: On create_openweather_snapshots: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "create_openweather_snapshots"} */
create schema if not exists openweather.snapshots
[0m09:13:15.951832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:13:16.543917 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.592 seconds
[0m09:13:16.546877 [debug] [ThreadPool]: On create_openweather_snapshots: Close
[0m09:13:16.695502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_openweather_snapshots, now list_openweather_analytics)
[0m09:13:16.703279 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m09:13:16.703632 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m09:13:16.703895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:13:17.259278 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.555 seconds
[0m09:13:17.262810 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m09:13:17.405168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshots)
[0m09:13:17.410530 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshots"
[0m09:13:17.410927 [debug] [ThreadPool]: On list_openweather_snapshots: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshots"} */
show objects in openweather.snapshots limit 10000
[0m09:13:17.411238 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:13:18.007599 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.596 seconds
[0m09:13:18.010757 [debug] [ThreadPool]: On list_openweather_snapshots: Close
[0m09:13:18.148504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41ebb632-285f-4b95-8a55-7ce2894bb991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af9a9c0>]}
[0m09:13:18.149357 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:13:18.149826 [info ] [MainThread]: 
[0m09:13:18.152801 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_snapshot
[0m09:13:18.153474 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.daily_average_weather_snapshot ................. [RUN]
[0m09:13:18.153947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshots, now snapshot.weather_dbt.daily_average_weather_snapshot)
[0m09:13:18.154323 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_snapshot
[0m09:13:18.163929 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_snapshot
[0m09:13:18.214754 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m09:13:18.215100 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
from (
        



WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    CITY_ID,
    CITY_NAME,
    WEATHER_DATE,
    AVG_TEMP_FAHRENHEIT,
    AVG_HUMIDITY,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m09:13:18.215317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:13:18.790387 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.574 seconds
[0m09:13:18.799291 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m09:13:18.799841 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m09:13:18.940160 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.140 seconds
[0m09:13:18.941883 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m09:13:18.945185 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m09:13:18.945819 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
create or replace transient table openweather.snapshots.daily_average_weather_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
from (
        



WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    CITY_ID,
    CITY_NAME,
    WEATHER_DATE,
    AVG_TEMP_FAHRENHEIT,
    AVG_HUMIDITY,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME

    ) sbq



        );
[0m09:13:20.017458 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.071 seconds
[0m09:13:20.045731 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: Close
[0m09:13:20.179129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41ebb632-285f-4b95-8a55-7ce2894bb991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b40aed0>]}
[0m09:13:20.180416 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.daily_average_weather_snapshot ................. [[32mSUCCESS 1[0m in 2.02s]
[0m09:13:20.181311 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_snapshot
[0m09:13:20.183120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:13:20.183629 [debug] [MainThread]: Connection 'snapshot.weather_dbt.daily_average_weather_snapshot' was properly closed.
[0m09:13:20.183987 [info ] [MainThread]: 
[0m09:13:20.184358 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.16 seconds (5.16s).
[0m09:13:20.185112 [debug] [MainThread]: Command end result
[0m09:13:20.214405 [info ] [MainThread]: 
[0m09:13:20.214776 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:13:20.214976 [info ] [MainThread]: 
[0m09:13:20.215164 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:13:20.216348 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 5.7365937, "process_in_blocks": "0", "process_kernel_time": 0.222789, "process_mem_max_rss": "139657216", "process_out_blocks": "0", "process_user_time": 1.515088}
[0m09:13:20.216708 [debug] [MainThread]: Command `dbt snapshot` succeeded at 09:13:20.216644 after 5.74 seconds
[0m09:13:20.216944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0b2620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b563390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b562350>]}
[0m09:13:20.217293 [debug] [MainThread]: Flushing usage events
[0m09:16:11.574700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de3b10>]}


============================== 09:16:11.577012 | 82dd2ad5-b720-43b6-92a4-db27c3a9228c ==============================
[0m09:16:11.577012 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:16:11.577314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:16:11.626521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82dd2ad5-b720-43b6-92a4-db27c3a9228c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c4f360>]}
[0m09:16:11.634350 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.092043, "process_in_blocks": "0", "process_kernel_time": 0.095041, "process_mem_max_rss": "100696064", "process_out_blocks": "0", "process_user_time": 0.606275}
[0m09:16:11.634630 [debug] [MainThread]: Command `dbt clean` succeeded at 09:16:11.634581 after 0.09 seconds
[0m09:16:11.634791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f0e580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f0e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b76950>]}
[0m09:16:11.634940 [debug] [MainThread]: Flushing usage events
[0m09:16:16.716682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033d8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d07d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d07b10>]}


============================== 09:16:16.719448 | c582f82a-5ba1-49fe-b50b-27cf9e580f14 ==============================
[0m09:16:16.719448 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:16:16.719916 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:16:16.895653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c582f82a-5ba1-49fe-b50b-27cf9e580f14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b8a520>]}
[0m09:16:16.920396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c582f82a-5ba1-49fe-b50b-27cf9e580f14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105afc050>]}
[0m09:16:16.920862 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:16:16.978708 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:16:16.979266 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:16:16.979568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c582f82a-5ba1-49fe-b50b-27cf9e580f14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a70a50>]}
[0m09:16:17.469317 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot hourly_weather_patterns_snapshot (snapshots/hourly_weather_patterns_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m09:16:17.470473 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7917517, "process_in_blocks": "0", "process_kernel_time": 0.171686, "process_mem_max_rss": "126697472", "process_out_blocks": "0", "process_user_time": 1.228426}
[0m09:16:17.470830 [debug] [MainThread]: Command `dbt run` failed at 09:16:17.470780 after 0.79 seconds
[0m09:16:17.471019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f26a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f896d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0fe70>]}
[0m09:16:17.471194 [debug] [MainThread]: Flushing usage events
[0m09:17:47.466894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052a0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bcbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bcbb10>]}


============================== 09:17:47.469154 | 42401824-403b-420c-a0ac-50b0e151fe4e ==============================
[0m09:17:47.469154 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:17:47.469462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:17:47.636423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42401824-403b-420c-a0ac-50b0e151fe4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107826520>]}
[0m09:17:47.658975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42401824-403b-420c-a0ac-50b0e151fe4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107728050>]}
[0m09:17:47.659382 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:17:47.715876 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:17:47.716393 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:17:47.716574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '42401824-403b-420c-a0ac-50b0e151fe4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10769ca50>]}
[0m09:17:48.179011 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot hourly_weather_patterns_snapshot (snapshots/hourly_weather_patterns_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m09:17:48.180037 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7448215, "process_in_blocks": "0", "process_kernel_time": 0.164626, "process_mem_max_rss": "126287872", "process_out_blocks": "0", "process_user_time": 1.193506}
[0m09:17:48.180294 [debug] [MainThread]: Command `dbt run` failed at 09:17:48.180245 after 0.75 seconds
[0m09:17:48.180467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a2ea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a956d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd3e70>]}
[0m09:17:48.180634 [debug] [MainThread]: Flushing usage events
[0m09:18:50.222150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c38d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653bb10>]}


============================== 09:18:50.224512 | 4519ec98-7629-4e4b-907d-cf34a36656a3 ==============================
[0m09:18:50.224512 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:18:50.224835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:18:50.395313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4519ec98-7629-4e4b-907d-cf34a36656a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107196520>]}
[0m09:18:50.420425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4519ec98-7629-4e4b-907d-cf34a36656a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107098050>]}
[0m09:18:50.420952 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:18:50.478751 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:18:50.479450 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:18:50.479675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4519ec98-7629-4e4b-907d-cf34a36656a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700ca50>]}
[0m09:18:50.970020 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot hourly_weather_patterns_snapshot (snapshots/hourly_weather_patterns_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m09:18:50.971004 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.78152186, "process_in_blocks": "0", "process_kernel_time": 0.174336, "process_mem_max_rss": "128401408", "process_out_blocks": "0", "process_user_time": 1.225647}
[0m09:18:50.971294 [debug] [MainThread]: Command `dbt run` failed at 09:18:50.971227 after 0.78 seconds
[0m09:18:50.971471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10739ea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074056d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106543e70>]}
[0m09:18:50.971638 [debug] [MainThread]: Flushing usage events
[0m09:19:03.540290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098dbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098dbb10>]}


============================== 09:19:03.542559 | 60d60207-d8e8-4443-b3c4-4e7d9157f1c5 ==============================
[0m09:19:03.542559 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:19:03.542862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:19:03.707496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60d60207-d8e8-4443-b3c4-4e7d9157f1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a58a520>]}
[0m09:19:03.730167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60d60207-d8e8-4443-b3c4-4e7d9157f1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4fc050>]}
[0m09:19:03.730577 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:19:03.787125 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:19:03.787655 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:19:03.787835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '60d60207-d8e8-4443-b3c4-4e7d9157f1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a470a50>]}
[0m09:19:04.243837 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot extreme_weather_events_snapshot (snapshots/extreme_weather_events_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m09:19:04.244847 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.73681813, "process_in_blocks": "0", "process_kernel_time": 0.160166, "process_mem_max_rss": "127303680", "process_out_blocks": "0", "process_user_time": 1.177182}
[0m09:19:04.245114 [debug] [MainThread]: Command `dbt run` failed at 09:19:04.245067 after 0.74 seconds
[0m09:19:04.245287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb26a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb896d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098e3e70>]}
[0m09:19:04.245449 [debug] [MainThread]: Flushing usage events
[0m09:19:34.884316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089ebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089ebb10>]}


============================== 09:19:34.886584 | 7ed1ad11-1ee8-4437-ac58-7f0b4d4c1136 ==============================
[0m09:19:34.886584 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:19:34.886889 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:19:35.054179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ed1ad11-1ee8-4437-ac58-7f0b4d4c1136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109646520>]}
[0m09:19:35.079652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ed1ad11-1ee8-4437-ac58-7f0b4d4c1136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109548050>]}
[0m09:19:35.080153 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:19:35.135569 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:19:35.136225 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:19:35.136413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7ed1ad11-1ee8-4437-ac58-7f0b4d4c1136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094bca50>]}
[0m09:19:35.654226 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot weather_conditions_frequency_snapshot (snapshots/weather_condition_freq_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m09:19:35.655212 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.80281705, "process_in_blocks": "0", "process_kernel_time": 0.149245, "process_mem_max_rss": "129548288", "process_out_blocks": "0", "process_user_time": 1.251333}
[0m09:19:35.655481 [debug] [MainThread]: Command `dbt run` failed at 09:19:35.655432 after 0.80 seconds
[0m09:19:35.655651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10984aa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098b49b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f3e70>]}
[0m09:19:35.655814 [debug] [MainThread]: Flushing usage events
[0m09:19:57.734748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106810d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086dbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086dbb10>]}


============================== 09:19:57.737369 | eab96a69-eb5d-452c-bdb0-9316bb55479a ==============================
[0m09:19:57.737369 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:19:57.737754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:19:57.915948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eab96a69-eb5d-452c-bdb0-9316bb55479a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094fa520>]}
[0m09:19:57.940860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eab96a69-eb5d-452c-bdb0-9316bb55479a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093fc050>]}
[0m09:19:57.941481 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:19:57.999248 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:19:57.999759 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:19:57.999936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eab96a69-eb5d-452c-bdb0-9316bb55479a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109370a50>]}
[0m09:19:58.608015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eab96a69-eb5d-452c-bdb0-9316bb55479a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098234d0>]}
[0m09:19:58.656923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eab96a69-eb5d-452c-bdb0-9316bb55479a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ab9710>]}
[0m09:19:58.657197 [info ] [MainThread]: Found 5 models, 3 snapshots, 2 sources, 459 macros
[0m09:19:58.657360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eab96a69-eb5d-452c-bdb0-9316bb55479a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a4bb0>]}
[0m09:19:58.658324 [info ] [MainThread]: 
[0m09:19:58.658597 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:19:58.660920 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m09:19:58.667405 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m09:19:58.667626 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m09:19:58.667760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:19:59.302759 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.635 seconds
[0m09:19:59.304900 [debug] [ThreadPool]: On list_openweather: Close
[0m09:19:59.410222 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m09:19:59.421748 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m09:19:59.422253 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m09:19:59.422546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:19:59.988269 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.566 seconds
[0m09:19:59.991548 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m09:20:00.114502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m09:20:00.119202 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m09:20:00.119749 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m09:20:00.120085 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:20:00.643082 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.523 seconds
[0m09:20:00.645725 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m09:20:00.778868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eab96a69-eb5d-452c-bdb0-9316bb55479a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0d3410>]}
[0m09:20:00.779786 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:20:00.780182 [info ] [MainThread]: 
[0m09:20:00.783022 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m09:20:00.783684 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m09:20:00.784521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now model.weather_dbt.daily_avg_weather_trend)
[0m09:20:00.785040 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m09:20:00.792720 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m09:20:00.794051 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m09:20:00.816692 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m09:20:00.818243 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m09:20:00.818523 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m09:20:00.818746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:20:02.328911 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.510 seconds
[0m09:20:02.355788 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m09:20:02.491620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eab96a69-eb5d-452c-bdb0-9316bb55479a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086adf40>]}
[0m09:20:02.492980 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.71s]
[0m09:20:02.493881 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m09:20:02.494402 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m09:20:02.495160 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m09:20:02.495850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m09:20:02.496279 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m09:20:02.499973 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m09:20:02.501308 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m09:20:02.504722 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m09:20:02.506189 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m09:20:02.506549 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m09:20:02.506954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:20:03.685143 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.178 seconds
[0m09:20:03.688826 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m09:20:03.808217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eab96a69-eb5d-452c-bdb0-9316bb55479a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b625c70>]}
[0m09:20:03.809539 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.31s]
[0m09:20:03.810471 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m09:20:03.811045 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m09:20:03.811864 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m09:20:03.812485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m09:20:03.812900 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m09:20:03.816881 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m09:20:03.817953 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m09:20:03.827375 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m09:20:03.829262 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m09:20:03.829620 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    *
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY
        );
[0m09:20:03.829929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:20:05.053376 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.223 seconds
[0m09:20:05.056915 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m09:20:05.188719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eab96a69-eb5d-452c-bdb0-9316bb55479a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cd0d50>]}
[0m09:20:05.189804 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.hourly_weather_patterns ............ [[32mSUCCESS 1[0m in 1.38s]
[0m09:20:05.190522 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m09:20:05.190996 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m09:20:05.191632 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m09:20:05.192508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m09:20:05.192956 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m09:20:05.196900 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m09:20:05.198075 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m09:20:05.219028 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m09:20:05.220213 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m09:20:05.220489 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m09:20:05.220737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:20:06.236816 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.016 seconds
[0m09:20:06.240596 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m09:20:06.367743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eab96a69-eb5d-452c-bdb0-9316bb55479a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6197f0>]}
[0m09:20:06.368838 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 1.18s]
[0m09:20:06.369548 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m09:20:06.370135 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m09:20:06.371123 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m09:20:06.372018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m09:20:06.372532 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m09:20:06.376937 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m09:20:06.378127 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m09:20:06.381899 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m09:20:06.383667 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m09:20:06.384189 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    *
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME
        );
[0m09:20:06.384524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:20:07.873189 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.488 seconds
[0m09:20:07.878172 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m09:20:08.005044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eab96a69-eb5d-452c-bdb0-9316bb55479a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042fac30>]}
[0m09:20:08.006139 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.63s]
[0m09:20:08.006857 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m09:20:08.008413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:20:08.008887 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m09:20:08.009586 [info ] [MainThread]: 
[0m09:20:08.009986 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 9.35 seconds (9.35s).
[0m09:20:08.011305 [debug] [MainThread]: Command end result
[0m09:20:08.037263 [info ] [MainThread]: 
[0m09:20:08.037666 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:20:08.037869 [info ] [MainThread]: 
[0m09:20:08.038182 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m09:20:08.039738 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.341154, "process_in_blocks": "0", "process_kernel_time": 0.256282, "process_mem_max_rss": "145899520", "process_out_blocks": "0", "process_user_time": 2.08483}
[0m09:20:08.040166 [debug] [MainThread]: Command `dbt run` succeeded at 09:20:08.040095 after 10.34 seconds
[0m09:20:08.040445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c858b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b39f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b39e930>]}
[0m09:20:08.040723 [debug] [MainThread]: Flushing usage events
[0m09:21:08.117687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104898d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107013d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107013b10>]}


============================== 09:21:08.120095 | f8c00544-529b-4fc1-8245-aea7407ce3dd ==============================
[0m09:21:08.120095 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:21:08.120411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:21:08.286112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8c00544-529b-4fc1-8245-aea7407ce3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888a520>]}
[0m09:21:08.308791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8c00544-529b-4fc1-8245-aea7407ce3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10887c050>]}
[0m09:21:08.309168 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:21:08.365469 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:21:08.424145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:21:08.424440 [debug] [MainThread]: Partial parsing: added file: weather_dbt://snapshots/hourly_weather_patterns_snapshot.sql
[0m09:21:08.536103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8c00544-529b-4fc1-8245-aea7407ce3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad0d50>]}
[0m09:21:08.582273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8c00544-529b-4fc1-8245-aea7407ce3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b224e0>]}
[0m09:21:08.582552 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m09:21:08.582727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8c00544-529b-4fc1-8245-aea7407ce3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108df4c90>]}
[0m09:21:08.583704 [info ] [MainThread]: 
[0m09:21:08.583988 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:21:08.586055 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m09:21:08.592483 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m09:21:08.592693 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m09:21:08.592828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:21:09.168093 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.575 seconds
[0m09:21:09.171484 [debug] [ThreadPool]: On list_openweather: Close
[0m09:21:09.324904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m09:21:09.335372 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m09:21:09.335756 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m09:21:09.336044 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:09.911466 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.575 seconds
[0m09:21:09.917301 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m09:21:10.034339 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m09:21:10.038456 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m09:21:10.038735 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m09:21:10.038966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:10.542863 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.503 seconds
[0m09:21:10.546232 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m09:21:10.666744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8c00544-529b-4fc1-8245-aea7407ce3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f393d0>]}
[0m09:21:10.667135 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:21:10.667313 [info ] [MainThread]: 
[0m09:21:10.668538 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_snapshot
[0m09:21:10.668840 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.daily_average_weather_snapshot .................. [RUN]
[0m09:21:10.669079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now snapshot.weather_dbt.daily_average_weather_snapshot)
[0m09:21:10.669259 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_snapshot
[0m09:21:10.674149 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_snapshot
[0m09:21:10.711840 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m09:21:10.712160 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
from (
        



WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    CITY_ID,
    CITY_NAME,
    WEATHER_DATE,
    AVG_TEMP_FAHRENHEIT,
    AVG_HUMIDITY,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m09:21:10.712368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:11.686371 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.972 seconds
[0m09:21:11.698461 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m09:21:11.699105 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m09:21:12.135923 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.436 seconds
[0m09:21:12.137589 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m09:21:12.141186 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m09:21:12.141956 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
create or replace transient table openweather.snapshot.daily_average_weather_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
from (
        



WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    CITY_ID,
    CITY_NAME,
    WEATHER_DATE,
    AVG_TEMP_FAHRENHEIT,
    AVG_HUMIDITY,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME

    ) sbq



        );
[0m09:21:13.411613 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.268 seconds
[0m09:21:13.437652 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: Close
[0m09:21:13.565071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c00544-529b-4fc1-8245-aea7407ce3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109114dd0>]}
[0m09:21:13.566222 [info ] [Thread-1 (]: 1 of 4 OK snapshotted snapshot.daily_average_weather_snapshot .................. [[32mSUCCESS 1[0m in 2.89s]
[0m09:21:13.566988 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_snapshot
[0m09:21:13.567508 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events_snapshot
[0m09:21:13.568189 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.extreme_weather_events_snapshot ................. [RUN]
[0m09:21:13.568775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_snapshot, now snapshot.weather_dbt.extreme_weather_events_snapshot)
[0m09:21:13.569193 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events_snapshot
[0m09:21:13.573212 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events_snapshot
[0m09:21:13.577655 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m09:21:13.578278 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
from (
        



WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    CITY_ID,
    CITY_NAME,
    DATE_TIME,
    TEMP_FAHRENHEIT,
    WIND_SPEED,
    WEATHER_ALERT,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m09:21:13.578659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:14.332424 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.753 seconds
[0m09:21:14.335104 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m09:21:14.335773 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m09:21:14.465652 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.129 seconds
[0m09:21:14.467581 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m09:21:14.470592 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m09:21:14.471154 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
create or replace transient table openweather.snapshot.extreme_weather_events_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
from (
        



WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    CITY_ID,
    CITY_NAME,
    DATE_TIME,
    TEMP_FAHRENHEIT,
    WIND_SPEED,
    WEATHER_ALERT,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME

    ) sbq



        );
[0m09:21:15.254544 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.782 seconds
[0m09:21:15.259711 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: Close
[0m09:21:15.369021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c00544-529b-4fc1-8245-aea7407ce3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109afedb0>]}
[0m09:21:15.370063 [info ] [Thread-1 (]: 2 of 4 OK snapshotted snapshot.extreme_weather_events_snapshot ................. [[32mSUCCESS 1[0m in 1.80s]
[0m09:21:15.370584 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events_snapshot
[0m09:21:15.370935 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns_snapshot
[0m09:21:15.371376 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.hourly_weather_patterns_snapshot ................ [RUN]
[0m09:21:15.371775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events_snapshot, now snapshot.weather_dbt.hourly_weather_patterns_snapshot)
[0m09:21:15.372062 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns_snapshot
[0m09:21:15.375260 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns_snapshot
[0m09:21:15.379424 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m09:21:15.379871 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
from (
        



WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    CITY_ID,
    CITY_NAME,
    HOUR_OF_DAY,
    AVG_TEMP_FAHRENHEIT,
    AVG_WIND_SPEED,
    AVG_HUMIDITY,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m09:21:15.380167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:16.072590 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.692 seconds
[0m09:21:16.075645 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m09:21:16.076216 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m09:21:16.185467 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.108 seconds
[0m09:21:16.189842 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m09:21:16.192980 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m09:21:16.193596 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
create or replace transient table openweather.snapshot.hourly_weather_patterns_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
from (
        



WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    CITY_ID,
    CITY_NAME,
    HOUR_OF_DAY,
    AVG_TEMP_FAHRENHEIT,
    AVG_WIND_SPEED,
    AVG_HUMIDITY,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY

    ) sbq



        );
[0m09:21:17.305277 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.111 seconds
[0m09:21:17.309799 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: Close
[0m09:21:17.441408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c00544-529b-4fc1-8245-aea7407ce3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089a62b0>]}
[0m09:21:17.442326 [info ] [Thread-1 (]: 3 of 4 OK snapshotted snapshot.hourly_weather_patterns_snapshot ................ [[32mSUCCESS 1[0m in 2.07s]
[0m09:21:17.442960 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns_snapshot
[0m09:21:17.443387 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency_snapshot
[0m09:21:17.443911 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.weather_conditions_frequency_snapshot ........... [RUN]
[0m09:21:17.444401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns_snapshot, now snapshot.weather_dbt.weather_conditions_frequency_snapshot)
[0m09:21:17.444755 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency_snapshot
[0m09:21:17.448511 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency_snapshot
[0m09:21:17.458323 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m09:21:17.458856 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
from (
        



WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    CITY_ID,
    CITY_NAME,
    WEATHER_MAIN,
    CONDITION_COUNT,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m09:21:17.459179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:17.905669 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.446 seconds
[0m09:21:17.910109 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m09:21:17.910621 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m09:21:17.980565 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.069 seconds
[0m09:21:17.981391 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m09:21:17.983888 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m09:21:17.984372 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
create or replace transient table openweather.snapshot.weather_conditions_frequency_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
from (
        



WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    CITY_ID,
    CITY_NAME,
    WEATHER_MAIN,
    CONDITION_COUNT,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME

    ) sbq



        );
[0m09:21:18.663762 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.678 seconds
[0m09:21:18.667790 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: Close
[0m09:21:18.780915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c00544-529b-4fc1-8245-aea7407ce3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d8fd0>]}
[0m09:21:18.781828 [info ] [Thread-1 (]: 4 of 4 OK snapshotted snapshot.weather_conditions_frequency_snapshot ........... [[32mSUCCESS 1[0m in 1.34s]
[0m09:21:18.782441 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency_snapshot
[0m09:21:18.783886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:21:18.784224 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency_snapshot' was properly closed.
[0m09:21:18.784546 [info ] [MainThread]: 
[0m09:21:18.784844 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 10.20 seconds (10.20s).
[0m09:21:18.785823 [debug] [MainThread]: Command end result
[0m09:21:18.809288 [info ] [MainThread]: 
[0m09:21:18.809637 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:21:18.809846 [info ] [MainThread]: 
[0m09:21:18.810047 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:21:18.811221 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 10.726472, "process_in_blocks": "0", "process_kernel_time": 0.224204, "process_mem_max_rss": "140017664", "process_out_blocks": "0", "process_user_time": 1.640337}
[0m09:21:18.811548 [debug] [MainThread]: Command `dbt snapshot` succeeded at 09:21:18.811490 after 10.73 seconds
[0m09:21:18.811760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107026c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100df9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e7d550>]}
[0m09:21:18.811976 [debug] [MainThread]: Flushing usage events
[0m09:48:04.990356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106613d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106613b10>]}


============================== 09:48:04.992634 | e9ebebc5-4603-4805-a22f-1aee12006dae ==============================
[0m09:48:04.992634 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:48:04.992949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:48:05.160916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9ebebc5-4603-4805-a22f-1aee12006dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10758a520>]}
[0m09:48:05.183470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9ebebc5-4603-4805-a22f-1aee12006dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fc050>]}
[0m09:48:05.183871 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:48:05.239870 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:48:05.298161 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:48:05.298478 [debug] [MainThread]: Partial parsing: added file: weather_dbt://models/schema.yml
[0m09:48:05.322521 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m09:48:05.322780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e9ebebc5-4603-4805-a22f-1aee12006dae', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107470d50>]}
[0m09:48:05.327951 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'daily_average_weather_trend' in the 'models' section of file 'models/schema.yml'
[0m09:48:05.396368 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_daily_average_weather_trend_city_id.28e0ed22c6' (models/schema.yml) depends on a node named 'daily_average_weather_trend' in package '' which was not found
[0m09:48:05.396694 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.unique_daily_average_weather_trend_city_id.c81911e991' (models/schema.yml) depends on a node named 'daily_average_weather_trend' in package '' which was not found
[0m09:48:05.396897 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_daily_average_weather_trend_weather_date.f3f17cdb15' (models/schema.yml) depends on a node named 'daily_average_weather_trend' in package '' which was not found
[0m09:48:05.397137 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.unique_combination_of_daily_average_weather_trend_weather_date__city_id__weather_date.1fb397e231' (models/schema.yml) depends on a node named 'daily_average_weather_trend' in package '' which was not found
[0m09:48:05.397310 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_daily_average_weather_trend_avg_temp_fahrenheit.c064852024' (models/schema.yml) depends on a node named 'daily_average_weather_trend' in package '' which was not found
[0m09:48:05.397472 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.accepted_range_daily_average_weather_trend_avg_temp_fahrenheit__130___50.242bec3406' (models/schema.yml) depends on a node named 'daily_average_weather_trend' in package '' which was not found
[0m09:48:05.397610 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_daily_average_weather_trend_avg_humidity.a1b0ff7cea' (models/schema.yml) depends on a node named 'daily_average_weather_trend' in package '' which was not found
[0m09:48:05.397747 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.accepted_range_daily_average_weather_trend_avg_humidity__100__0.491f26385c' (models/schema.yml) depends on a node named 'daily_average_weather_trend' in package '' which was not found
[0m09:48:05.435156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9ebebc5-4603-4805-a22f-1aee12006dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b9fa70>]}
[0m09:48:05.531496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9ebebc5-4603-4805-a22f-1aee12006dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b7850>]}
[0m09:48:05.531744 [info ] [MainThread]: Found 5 models, 4 snapshots, 2 sources, 459 macros
[0m09:48:05.531898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9ebebc5-4603-4805-a22f-1aee12006dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109950d50>]}
[0m09:48:05.532677 [info ] [MainThread]: 
[0m09:48:05.532834 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:48:05.533041 [debug] [MainThread]: Command end result
[0m09:48:05.546693 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5883394, "process_in_blocks": "0", "process_kernel_time": 0.166083, "process_mem_max_rss": "129269760", "process_out_blocks": "0", "process_user_time": 1.026531}
[0m09:48:05.547086 [debug] [MainThread]: Command `dbt test` succeeded at 09:48:05.546964 after 0.59 seconds
[0m09:48:05.547376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098bf750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098bf6a0>]}
[0m09:48:05.547575 [debug] [MainThread]: Flushing usage events
[0m09:51:18.770306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d98d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af13d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af13b10>]}


============================== 09:51:18.772672 | 9dfa6fbb-488f-434e-b92b-65b9d9ddd322 ==============================
[0m09:51:18.772672 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:51:18.772987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:51:18.947853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9dfa6fbb-488f-434e-b92b-65b9d9ddd322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be8a520>]}
[0m09:51:18.972937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9dfa6fbb-488f-434e-b92b-65b9d9ddd322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdfc050>]}
[0m09:51:18.973350 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:51:19.030389 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:51:19.102669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:51:19.103107 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/schema.yml
[0m09:51:19.129696 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m09:51:19.130050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9dfa6fbb-488f-434e-b92b-65b9d9ddd322', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd73750>]}
[0m09:51:19.235577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dfa6fbb-488f-434e-b92b-65b9d9ddd322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3be990>]}
[0m09:51:19.337050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9dfa6fbb-488f-434e-b92b-65b9d9ddd322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdb7850>]}
[0m09:51:19.337311 [info ] [MainThread]: Found 5 models, 4 snapshots, 8 data tests, 2 sources, 459 macros
[0m09:51:19.337463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dfa6fbb-488f-434e-b92b-65b9d9ddd322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d069230>]}
[0m09:51:19.338470 [info ] [MainThread]: 
[0m09:51:19.338755 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:51:19.341264 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_analytics'
[0m09:51:19.349057 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m09:51:19.349234 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m09:51:19.349361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:51:19.983760 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.634 seconds
[0m09:51:19.987911 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m09:51:20.105102 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m09:51:20.109395 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m09:51:20.109813 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m09:51:20.110139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:51:21.348724 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.239 seconds
[0m09:51:21.350061 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m09:51:21.486569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dfa6fbb-488f-434e-b92b-65b9d9ddd322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3f0b90>]}
[0m09:51:21.487246 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:51:21.487604 [info ] [MainThread]: 
[0m09:51:21.490296 [debug] [Thread-1 (]: Began running node test.weather_dbt.accepted_range_daily_avg_weather_trend_avg_humidity__100__0.f4f648b7a9
[0m09:51:21.490767 [info ] [Thread-1 (]: 1 of 8 START test accepted_range_daily_avg_weather_trend_avg_humidity__100__0 .. [RUN]
[0m09:51:21.491213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now test.weather_dbt.accepted_range_daily_avg_weather_trend_avg_humidity__100__0.f4f648b7a9)
[0m09:51:21.491547 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.accepted_range_daily_avg_weather_trend_avg_humidity__100__0.f4f648b7a9
[0m09:51:21.508762 [debug] [Thread-1 (]: Compilation Error in test accepted_range_daily_avg_weather_trend_avg_humidity__100__0 (models/schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:51:21.509329 [error] [Thread-1 (]: 1 of 8 ERROR accepted_range_daily_avg_weather_trend_avg_humidity__100__0 ....... [[31mERROR[0m in 0.02s]
[0m09:51:21.509755 [debug] [Thread-1 (]: Finished running node test.weather_dbt.accepted_range_daily_avg_weather_trend_avg_humidity__100__0.f4f648b7a9
[0m09:51:21.510081 [debug] [Thread-1 (]: Began running node test.weather_dbt.accepted_range_daily_avg_weather_trend_avg_temp_fahrenheit__130___50.13a4c71e5b
[0m09:51:21.511097 [info ] [Thread-1 (]: 2 of 8 START test accepted_range_daily_avg_weather_trend_avg_temp_fahrenheit__130___50  [RUN]
[0m09:51:21.511665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.accepted_range_daily_avg_weather_trend_avg_humidity__100__0.f4f648b7a9, now test.weather_dbt.accepted_range_daily_avg_weather_trend_avg_temp_fahrenheit__130___50.13a4c71e5b)
[0m09:51:21.512028 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.accepted_range_daily_avg_weather_trend_avg_temp_fahrenheit__130___50.13a4c71e5b
[0m09:51:21.521465 [debug] [Thread-1 (]: Compilation Error in test accepted_range_daily_avg_weather_trend_avg_temp_fahrenheit__130___50 (models/schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:51:21.521902 [error] [Thread-1 (]: 2 of 8 ERROR accepted_range_daily_avg_weather_trend_avg_temp_fahrenheit__130___50  [[31mERROR[0m in 0.01s]
[0m09:51:21.522262 [debug] [Thread-1 (]: Finished running node test.weather_dbt.accepted_range_daily_avg_weather_trend_avg_temp_fahrenheit__130___50.13a4c71e5b
[0m09:51:21.522510 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:51:21.522854 [info ] [Thread-1 (]: 3 of 8 START test not_null_daily_avg_weather_trend_avg_humidity ................ [RUN]
[0m09:51:21.523228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.accepted_range_daily_avg_weather_trend_avg_temp_fahrenheit__130___50.13a4c71e5b, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07)
[0m09:51:21.523435 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:51:21.529045 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:51:21.529748 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:51:21.541396 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:51:21.542127 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:51:21.542327 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_humidity
from openweather.analytics.daily_avg_weather_trend
where avg_humidity is null



      
    ) dbt_internal_test
[0m09:51:21.542498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:22.627089 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.084 seconds
[0m09:51:22.641224 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: Close
[0m09:51:22.920972 [info ] [Thread-1 (]: 3 of 8 PASS not_null_daily_avg_weather_trend_avg_humidity ...................... [[32mPASS[0m in 1.40s]
[0m09:51:22.921879 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:51:22.922378 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:51:22.922885 [info ] [Thread-1 (]: 4 of 8 START test not_null_daily_avg_weather_trend_avg_temp_fahrenheit ......... [RUN]
[0m09:51:22.923461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372)
[0m09:51:22.923879 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:51:22.928789 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:51:22.929832 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:51:22.932592 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:51:22.934259 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:51:22.934801 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp_fahrenheit
from openweather.analytics.daily_avg_weather_trend
where avg_temp_fahrenheit is null



      
    ) dbt_internal_test
[0m09:51:22.935134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:23.653320 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.718 seconds
[0m09:51:23.657034 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: Close
[0m09:51:23.780946 [info ] [Thread-1 (]: 4 of 8 PASS not_null_daily_avg_weather_trend_avg_temp_fahrenheit ............... [[32mPASS[0m in 0.86s]
[0m09:51:23.782217 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:51:23.782642 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:51:23.783054 [info ] [Thread-1 (]: 5 of 8 START test not_null_daily_avg_weather_trend_city_id ..................... [RUN]
[0m09:51:23.783490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372, now test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790)
[0m09:51:23.783803 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:51:23.787837 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:51:23.788804 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:51:23.790864 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:51:23.792035 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:51:23.792338 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_id
from openweather.analytics.daily_avg_weather_trend
where city_id is null



      
    ) dbt_internal_test
[0m09:51:23.792592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:24.514523 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.721 seconds
[0m09:51:24.524382 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: Close
[0m09:51:24.652406 [info ] [Thread-1 (]: 5 of 8 PASS not_null_daily_avg_weather_trend_city_id ........................... [[32mPASS[0m in 0.87s]
[0m09:51:24.653427 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:51:24.654014 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:51:24.654848 [info ] [Thread-1 (]: 6 of 8 START test not_null_daily_avg_weather_trend_weather_date ................ [RUN]
[0m09:51:24.655335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790, now test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b)
[0m09:51:24.655717 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:51:24.660685 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:51:24.662429 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:51:24.665765 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:51:24.667249 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:51:24.667812 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_date
from openweather.analytics.daily_avg_weather_trend
where weather_date is null



      
    ) dbt_internal_test
[0m09:51:24.668129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:25.097456 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.429 seconds
[0m09:51:25.098857 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: Close
[0m09:51:25.236155 [info ] [Thread-1 (]: 6 of 8 PASS not_null_daily_avg_weather_trend_weather_date ...................... [[32mPASS[0m in 0.58s]
[0m09:51:25.236843 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:51:25.237258 [debug] [Thread-1 (]: Began running node test.weather_dbt.unique_combination_of_daily_avg_weather_trend_weather_date__city_id__weather_date.46c8898a72
[0m09:51:25.237577 [info ] [Thread-1 (]: 7 of 8 START test unique_combination_of_daily_avg_weather_trend_weather_date__city_id__weather_date  [RUN]
[0m09:51:25.237931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b, now test.weather_dbt.unique_combination_of_daily_avg_weather_trend_weather_date__city_id__weather_date.46c8898a72)
[0m09:51:25.238179 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.unique_combination_of_daily_avg_weather_trend_weather_date__city_id__weather_date.46c8898a72
[0m09:51:25.242408 [debug] [Thread-1 (]: Compilation Error in test unique_combination_of_daily_avg_weather_trend_weather_date__city_id__weather_date (models/schema.yml)
  'test_unique_combination_of' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:51:25.242728 [error] [Thread-1 (]: 7 of 8 ERROR unique_combination_of_daily_avg_weather_trend_weather_date__city_id__weather_date  [[31mERROR[0m in 0.00s]
[0m09:51:25.243038 [debug] [Thread-1 (]: Finished running node test.weather_dbt.unique_combination_of_daily_avg_weather_trend_weather_date__city_id__weather_date.46c8898a72
[0m09:51:25.243258 [debug] [Thread-1 (]: Began running node test.weather_dbt.unique_daily_avg_weather_trend_city_id.95007610c0
[0m09:51:25.243450 [info ] [Thread-1 (]: 8 of 8 START test unique_daily_avg_weather_trend_city_id ....................... [RUN]
[0m09:51:25.243813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.unique_combination_of_daily_avg_weather_trend_weather_date__city_id__weather_date.46c8898a72, now test.weather_dbt.unique_daily_avg_weather_trend_city_id.95007610c0)
[0m09:51:25.244174 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.unique_daily_avg_weather_trend_city_id.95007610c0
[0m09:51:25.248035 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.unique_daily_avg_weather_trend_city_id.95007610c0"
[0m09:51:25.248746 [debug] [Thread-1 (]: Began executing node test.weather_dbt.unique_daily_avg_weather_trend_city_id.95007610c0
[0m09:51:25.250486 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.unique_daily_avg_weather_trend_city_id.95007610c0"
[0m09:51:25.251169 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.unique_daily_avg_weather_trend_city_id.95007610c0"
[0m09:51:25.251392 [debug] [Thread-1 (]: On test.weather_dbt.unique_daily_avg_weather_trend_city_id.95007610c0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.unique_daily_avg_weather_trend_city_id.95007610c0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    city_id as unique_field,
    count(*) as n_records

from openweather.analytics.daily_avg_weather_trend
where city_id is not null
group by city_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:51:25.251577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:26.002867 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.751 seconds
[0m09:51:26.004536 [debug] [Thread-1 (]: On test.weather_dbt.unique_daily_avg_weather_trend_city_id.95007610c0: Close
[0m09:51:26.130997 [error] [Thread-1 (]: 8 of 8 FAIL 459 unique_daily_avg_weather_trend_city_id ......................... [[31mFAIL 459[0m in 0.89s]
[0m09:51:26.131441 [debug] [Thread-1 (]: Finished running node test.weather_dbt.unique_daily_avg_weather_trend_city_id.95007610c0
[0m09:51:26.132163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:51:26.132354 [debug] [MainThread]: Connection 'test.weather_dbt.unique_daily_avg_weather_trend_city_id.95007610c0' was properly closed.
[0m09:51:26.132530 [info ] [MainThread]: 
[0m09:51:26.132698 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 6.79 seconds (6.79s).
[0m09:51:26.133431 [debug] [MainThread]: Command end result
[0m09:51:26.150728 [info ] [MainThread]: 
[0m09:51:26.151001 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m09:51:26.151150 [info ] [MainThread]: 
[0m09:51:26.151337 [error] [MainThread]:   Compilation Error in test accepted_range_daily_avg_weather_trend_avg_humidity__100__0 (models/schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:51:26.151466 [info ] [MainThread]: 
[0m09:51:26.151628 [error] [MainThread]:   Compilation Error in test accepted_range_daily_avg_weather_trend_avg_temp_fahrenheit__130___50 (models/schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:51:26.151747 [info ] [MainThread]: 
[0m09:51:26.151897 [error] [MainThread]:   Compilation Error in test unique_combination_of_daily_avg_weather_trend_weather_date__city_id__weather_date (models/schema.yml)
  'test_unique_combination_of' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:51:26.152129 [info ] [MainThread]: 
[0m09:51:26.152402 [error] [MainThread]: [31mFailure in test unique_daily_avg_weather_trend_city_id (models/schema.yml)[0m
[0m09:51:26.152552 [error] [MainThread]:   Got 459 results, configured to fail if != 0
[0m09:51:26.152668 [info ] [MainThread]: 
[0m09:51:26.152808 [info ] [MainThread]:   compiled code at target/compiled/weather_dbt/models/schema.yml/unique_daily_avg_weather_trend_city_id.sql
[0m09:51:26.152928 [info ] [MainThread]: 
[0m09:51:26.153068 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=0 TOTAL=8
[0m09:51:26.153957 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 7.41605, "process_in_blocks": "0", "process_kernel_time": 0.230118, "process_mem_max_rss": "143982592", "process_out_blocks": "0", "process_user_time": 1.551356}
[0m09:51:26.154210 [debug] [MainThread]: Command `dbt test` failed at 09:51:26.154166 after 7.42 seconds
[0m09:51:26.154395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d54d5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4a8ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4a9090>]}
[0m09:51:26.154557 [debug] [MainThread]: Flushing usage events
[0m09:52:12.229128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105317d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105317b10>]}


============================== 09:52:12.231468 | 6dd3fb51-35e3-4a87-a723-bd5a87b4aaad ==============================
[0m09:52:12.231468 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:52:12.231788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m09:52:12.389436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dd3fb51-35e3-4a87-a723-bd5a87b4aaad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fa520>]}
[0m09:52:12.412102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dd3fb51-35e3-4a87-a723-bd5a87b4aaad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060fc050>]}
[0m09:52:12.412504 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:52:12.466941 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:52:12.534072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:52:12.534500 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/schema.yml
[0m09:52:12.628970 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m09:52:12.629282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6dd3fb51-35e3-4a87-a723-bd5a87b4aaad', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067dcd50>]}
[0m09:52:12.748105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dd3fb51-35e3-4a87-a723-bd5a87b4aaad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106042120>]}
[0m09:52:12.804358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dd3fb51-35e3-4a87-a723-bd5a87b4aaad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10684e890>]}
[0m09:52:12.804600 [info ] [MainThread]: Found 5 models, 4 snapshots, 4 data tests, 2 sources, 459 macros
[0m09:52:12.804763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dd3fb51-35e3-4a87-a723-bd5a87b4aaad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b6340>]}
[0m09:52:12.805691 [info ] [MainThread]: 
[0m09:52:12.805947 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:52:12.808075 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_snapshot'
[0m09:52:12.815757 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m09:52:12.815970 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m09:52:12.816110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:13.430666 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.614 seconds
[0m09:52:13.438501 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m09:52:13.580803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m09:52:13.584449 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m09:52:13.584834 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m09:52:13.585141 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:14.043920 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.458 seconds
[0m09:52:14.049365 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m09:52:14.170156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dd3fb51-35e3-4a87-a723-bd5a87b4aaad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110094890>]}
[0m09:52:14.170888 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:52:14.171269 [info ] [MainThread]: 
[0m09:52:14.174138 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:52:14.174667 [info ] [Thread-1 (]: 1 of 4 START test not_null_daily_avg_weather_trend_avg_humidity ................ [RUN]
[0m09:52:14.175188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07)
[0m09:52:14.175593 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:52:14.191569 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:52:14.192840 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:52:14.207932 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:52:14.208717 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:52:14.208963 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_humidity
from openweather.analytics.daily_avg_weather_trend
where avg_humidity is null



      
    ) dbt_internal_test
[0m09:52:14.209176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:14.674840 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.465 seconds
[0m09:52:14.691494 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: Close
[0m09:52:14.852881 [info ] [Thread-1 (]: 1 of 4 PASS not_null_daily_avg_weather_trend_avg_humidity ...................... [[32mPASS[0m in 0.68s]
[0m09:52:14.855417 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:52:14.856689 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:52:14.857465 [info ] [Thread-1 (]: 2 of 4 START test not_null_daily_avg_weather_trend_avg_temp_fahrenheit ......... [RUN]
[0m09:52:14.858196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372)
[0m09:52:14.858711 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:52:14.863867 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:52:14.864892 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:52:14.868714 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:52:14.870300 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:52:14.870715 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp_fahrenheit
from openweather.analytics.daily_avg_weather_trend
where avg_temp_fahrenheit is null



      
    ) dbt_internal_test
[0m09:52:14.871083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:15.385927 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.515 seconds
[0m09:52:15.388578 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: Close
[0m09:52:15.516465 [info ] [Thread-1 (]: 2 of 4 PASS not_null_daily_avg_weather_trend_avg_temp_fahrenheit ............... [[32mPASS[0m in 0.66s]
[0m09:52:15.517342 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:52:15.517820 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:52:15.518347 [info ] [Thread-1 (]: 3 of 4 START test not_null_daily_avg_weather_trend_city_id ..................... [RUN]
[0m09:52:15.518922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372, now test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790)
[0m09:52:15.519343 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:52:15.524615 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:52:15.525548 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:52:15.528490 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:52:15.529581 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:52:15.529910 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_id
from openweather.analytics.daily_avg_weather_trend
where city_id is null



      
    ) dbt_internal_test
[0m09:52:15.530206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:15.963509 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.433 seconds
[0m09:52:15.969575 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: Close
[0m09:52:16.090111 [info ] [Thread-1 (]: 3 of 4 PASS not_null_daily_avg_weather_trend_city_id ........................... [[32mPASS[0m in 0.57s]
[0m09:52:16.090875 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:52:16.091305 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:52:16.091702 [info ] [Thread-1 (]: 4 of 4 START test not_null_daily_avg_weather_trend_weather_date ................ [RUN]
[0m09:52:16.092145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790, now test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b)
[0m09:52:16.092456 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:52:16.096408 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:52:16.097428 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:52:16.099910 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:52:16.100777 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:52:16.101058 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_date
from openweather.analytics.daily_avg_weather_trend
where weather_date is null



      
    ) dbt_internal_test
[0m09:52:16.101306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:16.633616 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.532 seconds
[0m09:52:16.639187 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: Close
[0m09:52:16.747092 [info ] [Thread-1 (]: 4 of 4 PASS not_null_daily_avg_weather_trend_weather_date ...................... [[32mPASS[0m in 0.65s]
[0m09:52:16.747994 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:52:16.749855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:16.750318 [debug] [MainThread]: Connection 'test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b' was properly closed.
[0m09:52:16.750695 [info ] [MainThread]: 
[0m09:52:16.751055 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 3.94 seconds (3.94s).
[0m09:52:16.752194 [debug] [MainThread]: Command end result
[0m09:52:16.779194 [info ] [MainThread]: 
[0m09:52:16.779476 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:52:16.779625 [info ] [MainThread]: 
[0m09:52:16.779780 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:52:16.780860 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.5837994, "process_in_blocks": "0", "process_kernel_time": 0.192712, "process_mem_max_rss": "145031168", "process_out_blocks": "0", "process_user_time": 1.580402}
[0m09:52:16.781208 [debug] [MainThread]: Command `dbt test` succeeded at 09:52:16.781145 after 4.58 seconds
[0m09:52:16.781437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101ed910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110139db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110138690>]}
[0m09:52:16.781666 [debug] [MainThread]: Flushing usage events
[0m09:53:39.738615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a78d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043a3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043a3b10>]}


============================== 09:53:39.741354 | 0706d016-38b4-4c5a-8371-6fb29144c7e5 ==============================
[0m09:53:39.741354 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:53:39.741694 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:53:39.919697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0706d016-38b4-4c5a-8371-6fb29144c7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10511a520>]}
[0m09:53:39.945095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0706d016-38b4-4c5a-8371-6fb29144c7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510c050>]}
[0m09:53:39.945663 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:53:40.002730 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:53:40.073698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:53:40.074016 [debug] [MainThread]: Partial parsing: added file: weather_dbt://tests/daily_avg_weather_test.sql
[0m09:53:40.133043 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.daily_avg_weather_test' (tests/daily_avg_weather_test.sql) depends on a node named 'daily_average_weather_trend' in package '' which was not found
[0m09:53:40.173226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0706d016-38b4-4c5a-8371-6fb29144c7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055dca50>]}
[0m09:53:40.277677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0706d016-38b4-4c5a-8371-6fb29144c7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059746e0>]}
[0m09:53:40.278024 [info ] [MainThread]: Found 5 models, 4 snapshots, 4 data tests, 2 sources, 459 macros
[0m09:53:40.278280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0706d016-38b4-4c5a-8371-6fb29144c7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105032b30>]}
[0m09:53:40.279279 [info ] [MainThread]: 
[0m09:53:40.279547 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:53:40.281818 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_snapshot'
[0m09:53:40.289692 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m09:53:40.289884 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m09:53:40.290011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:40.921070 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.631 seconds
[0m09:53:40.924718 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m09:53:41.039198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m09:53:41.042346 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m09:53:41.042791 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m09:53:41.043063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:53:41.564761 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.521 seconds
[0m09:53:41.568282 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m09:53:41.707037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0706d016-38b4-4c5a-8371-6fb29144c7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10596a8f0>]}
[0m09:53:41.708124 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:53:41.708555 [info ] [MainThread]: 
[0m09:53:41.711900 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:53:41.712461 [info ] [Thread-1 (]: 1 of 4 START test not_null_daily_avg_weather_trend_avg_humidity ................ [RUN]
[0m09:53:41.713000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07)
[0m09:53:41.713329 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:53:41.729138 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:53:41.730148 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:53:41.743791 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:53:41.744506 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:53:41.744745 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_humidity
from openweather.analytics.daily_avg_weather_trend
where avg_humidity is null



      
    ) dbt_internal_test
[0m09:53:41.744951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:42.195869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.450 seconds
[0m09:53:42.208875 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: Close
[0m09:53:42.327743 [info ] [Thread-1 (]: 1 of 4 PASS not_null_daily_avg_weather_trend_avg_humidity ...................... [[32mPASS[0m in 0.61s]
[0m09:53:42.328591 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:53:42.329077 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:53:42.329561 [info ] [Thread-1 (]: 2 of 4 START test not_null_daily_avg_weather_trend_avg_temp_fahrenheit ......... [RUN]
[0m09:53:42.330063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372)
[0m09:53:42.330421 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:53:42.334729 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:53:42.335758 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:53:42.338932 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:53:42.340114 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:53:42.340450 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp_fahrenheit
from openweather.analytics.daily_avg_weather_trend
where avg_temp_fahrenheit is null



      
    ) dbt_internal_test
[0m09:53:42.340745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:42.827718 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.486 seconds
[0m09:53:42.834948 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: Close
[0m09:53:42.973895 [info ] [Thread-1 (]: 2 of 4 PASS not_null_daily_avg_weather_trend_avg_temp_fahrenheit ............... [[32mPASS[0m in 0.64s]
[0m09:53:42.974673 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:53:42.975168 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:53:42.975716 [info ] [Thread-1 (]: 3 of 4 START test not_null_daily_avg_weather_trend_city_id ..................... [RUN]
[0m09:53:42.976335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372, now test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790)
[0m09:53:42.976754 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:53:42.981517 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:53:42.982550 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:53:42.985462 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:53:42.986912 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:53:42.987313 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_id
from openweather.analytics.daily_avg_weather_trend
where city_id is null



      
    ) dbt_internal_test
[0m09:53:42.987622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:43.607179 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.619 seconds
[0m09:53:43.611663 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: Close
[0m09:53:43.725792 [info ] [Thread-1 (]: 3 of 4 PASS not_null_daily_avg_weather_trend_city_id ........................... [[32mPASS[0m in 0.75s]
[0m09:53:43.726745 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:53:43.727333 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:53:43.727951 [info ] [Thread-1 (]: 4 of 4 START test not_null_daily_avg_weather_trend_weather_date ................ [RUN]
[0m09:53:43.728663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790, now test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b)
[0m09:53:43.729119 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:53:43.734773 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:53:43.735821 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:53:43.738168 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:53:43.739817 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:53:43.740490 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_date
from openweather.analytics.daily_avg_weather_trend
where weather_date is null



      
    ) dbt_internal_test
[0m09:53:43.741091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:44.198673 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.457 seconds
[0m09:53:44.205192 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: Close
[0m09:53:44.351783 [info ] [Thread-1 (]: 4 of 4 PASS not_null_daily_avg_weather_trend_weather_date ...................... [[32mPASS[0m in 0.62s]
[0m09:53:44.352733 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:53:44.354503 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:44.354911 [debug] [MainThread]: Connection 'test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b' was properly closed.
[0m09:53:44.355326 [info ] [MainThread]: 
[0m09:53:44.355694 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 4.08 seconds (4.08s).
[0m09:53:44.356827 [debug] [MainThread]: Command end result
[0m09:53:44.385092 [info ] [MainThread]: 
[0m09:53:44.385447 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:53:44.385650 [info ] [MainThread]: 
[0m09:53:44.385862 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:53:44.387029 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.6858783, "process_in_blocks": "0", "process_kernel_time": 0.233892, "process_mem_max_rss": "143605760", "process_out_blocks": "0", "process_user_time": 1.515474}
[0m09:53:44.387376 [debug] [MainThread]: Command `dbt test` succeeded at 09:53:44.387315 after 4.69 seconds
[0m09:53:44.387617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10415d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104375ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106714940>]}
[0m09:53:44.387837 [debug] [MainThread]: Flushing usage events
[0m09:54:06.287303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107158d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a5fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a5fb10>]}


============================== 09:54:06.289826 | 452c8212-01cd-4e3c-a7e8-7be1e6a98931 ==============================
[0m09:54:06.289826 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:54:06.290136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:54:06.464535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '452c8212-01cd-4e3c-a7e8-7be1e6a98931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c01a520>]}
[0m09:54:06.488869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '452c8212-01cd-4e3c-a7e8-7be1e6a98931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aefc050>]}
[0m09:54:06.489313 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:54:06.546207 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:54:06.621435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:54:06.621838 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://tests/daily_avg_weather_test.sql
[0m09:54:06.716814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '452c8212-01cd-4e3c-a7e8-7be1e6a98931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3d8a50>]}
[0m09:54:06.823259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '452c8212-01cd-4e3c-a7e8-7be1e6a98931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6706e0>]}
[0m09:54:06.823573 [info ] [MainThread]: Found 5 models, 4 snapshots, 5 data tests, 2 sources, 459 macros
[0m09:54:06.823740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '452c8212-01cd-4e3c-a7e8-7be1e6a98931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0a98d0>]}
[0m09:54:06.824874 [info ] [MainThread]: 
[0m09:54:06.825187 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:54:06.827731 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_analytics'
[0m09:54:06.835520 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m09:54:06.835713 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m09:54:06.835841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:07.362992 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.527 seconds
[0m09:54:07.367264 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m09:54:07.497679 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m09:54:07.502013 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m09:54:07.502454 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m09:54:07.502766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:54:07.954708 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.452 seconds
[0m09:54:07.958100 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m09:54:08.095815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '452c8212-01cd-4e3c-a7e8-7be1e6a98931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c666a90>]}
[0m09:54:08.097005 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:54:08.097444 [info ] [MainThread]: 
[0m09:54:08.100830 [debug] [Thread-1 (]: Began running node test.weather_dbt.daily_avg_weather_test
[0m09:54:08.101404 [info ] [Thread-1 (]: 1 of 5 START test daily_avg_weather_test ....................................... [RUN]
[0m09:54:08.101944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now test.weather_dbt.daily_avg_weather_test)
[0m09:54:08.102342 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.daily_avg_weather_test
[0m09:54:08.110016 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.daily_avg_weather_test"
[0m09:54:08.111461 [debug] [Thread-1 (]: Began executing node test.weather_dbt.daily_avg_weather_test
[0m09:54:08.129615 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.daily_avg_weather_test"
[0m09:54:08.130671 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.daily_avg_weather_test"
[0m09:54:08.131088 [debug] [Thread-1 (]: On test.weather_dbt.daily_avg_weather_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.daily_avg_weather_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT CITY_ID, WEATHER_DATE, COUNT(*)
FROM openweather.analytics.daily_avg_weather_trend
GROUP BY CITY_ID, WEATHER_DATE
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m09:54:08.131460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:08.821847 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m09:54:08.832404 [debug] [Thread-1 (]: On test.weather_dbt.daily_avg_weather_test: Close
[0m09:54:08.953193 [info ] [Thread-1 (]: 1 of 5 PASS daily_avg_weather_test ............................................. [[32mPASS[0m in 0.85s]
[0m09:54:08.954243 [debug] [Thread-1 (]: Finished running node test.weather_dbt.daily_avg_weather_test
[0m09:54:08.954866 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:54:08.955632 [info ] [Thread-1 (]: 2 of 5 START test not_null_daily_avg_weather_trend_avg_humidity ................ [RUN]
[0m09:54:08.956476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.daily_avg_weather_test, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07)
[0m09:54:08.956923 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:54:08.967879 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:54:08.968862 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:54:08.971417 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:54:08.972305 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:54:08.972667 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_humidity
from openweather.analytics.daily_avg_weather_trend
where avg_humidity is null



      
    ) dbt_internal_test
[0m09:54:08.972967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:09.411885 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.439 seconds
[0m09:54:09.414566 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: Close
[0m09:54:09.561837 [info ] [Thread-1 (]: 2 of 5 PASS not_null_daily_avg_weather_trend_avg_humidity ...................... [[32mPASS[0m in 0.61s]
[0m09:54:09.562446 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:54:09.562761 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:54:09.563074 [info ] [Thread-1 (]: 3 of 5 START test not_null_daily_avg_weather_trend_avg_temp_fahrenheit ......... [RUN]
[0m09:54:09.563445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372)
[0m09:54:09.563753 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:54:09.566686 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:54:09.567359 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:54:09.569630 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:54:09.570211 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:54:09.570437 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp_fahrenheit
from openweather.analytics.daily_avg_weather_trend
where avg_temp_fahrenheit is null



      
    ) dbt_internal_test
[0m09:54:09.570641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:10.009470 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.439 seconds
[0m09:54:10.013097 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: Close
[0m09:54:10.143489 [info ] [Thread-1 (]: 3 of 5 PASS not_null_daily_avg_weather_trend_avg_temp_fahrenheit ............... [[32mPASS[0m in 0.58s]
[0m09:54:10.144582 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:54:10.145175 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:54:10.145800 [info ] [Thread-1 (]: 4 of 5 START test not_null_daily_avg_weather_trend_city_id ..................... [RUN]
[0m09:54:10.146782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372, now test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790)
[0m09:54:10.147250 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:54:10.152271 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:54:10.153304 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:54:10.155346 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:54:10.156814 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:54:10.157351 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_id
from openweather.analytics.daily_avg_weather_trend
where city_id is null



      
    ) dbt_internal_test
[0m09:54:10.157783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:10.625461 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.464 seconds
[0m09:54:10.630862 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: Close
[0m09:54:10.749988 [info ] [Thread-1 (]: 4 of 5 PASS not_null_daily_avg_weather_trend_city_id ........................... [[32mPASS[0m in 0.60s]
[0m09:54:10.750808 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:54:10.751295 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:54:10.751801 [info ] [Thread-1 (]: 5 of 5 START test not_null_daily_avg_weather_trend_weather_date ................ [RUN]
[0m09:54:10.752375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790, now test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b)
[0m09:54:10.752796 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:54:10.758336 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:54:10.759416 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:54:10.761578 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:54:10.762976 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:54:10.763373 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_date
from openweather.analytics.daily_avg_weather_trend
where weather_date is null



      
    ) dbt_internal_test
[0m09:54:10.763676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:11.129171 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.365 seconds
[0m09:54:11.134336 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: Close
[0m09:54:11.260847 [info ] [Thread-1 (]: 5 of 5 PASS not_null_daily_avg_weather_trend_weather_date ...................... [[32mPASS[0m in 0.51s]
[0m09:54:11.261484 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:54:11.262776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:54:11.263068 [debug] [MainThread]: Connection 'test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b' was properly closed.
[0m09:54:11.263349 [info ] [MainThread]: 
[0m09:54:11.263602 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 4.44 seconds (4.44s).
[0m09:54:11.264569 [debug] [MainThread]: Command end result
[0m09:54:11.287469 [info ] [MainThread]: 
[0m09:54:11.287795 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:54:11.287987 [info ] [MainThread]: 
[0m09:54:11.288171 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m09:54:11.289254 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.0384827, "process_in_blocks": "0", "process_kernel_time": 0.23251, "process_mem_max_rss": "142622720", "process_out_blocks": "0", "process_user_time": 1.553336}
[0m09:54:11.289570 [debug] [MainThread]: Command `dbt test` succeeded at 09:54:11.289513 after 5.04 seconds
[0m09:54:11.289786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108815910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb14680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb15650>]}
[0m09:54:11.289990 [debug] [MainThread]: Flushing usage events
[0m09:55:19.097488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107140d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a43d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a43b10>]}


============================== 09:55:19.099875 | 86b99e56-8eeb-4f6a-b1e4-219d1f233193 ==============================
[0m09:55:19.099875 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:55:19.100208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:55:19.275441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86b99e56-8eeb-4f6a-b1e4-219d1f233193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097fa520>]}
[0m09:55:19.301040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86b99e56-8eeb-4f6a-b1e4-219d1f233193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096fc050>]}
[0m09:55:19.301544 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:55:19.359245 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:55:19.437617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:55:19.438053 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://tests/daily_avg_weather_test.sql
[0m09:55:19.532986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86b99e56-8eeb-4f6a-b1e4-219d1f233193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cd8a50>]}
[0m09:55:19.637762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86b99e56-8eeb-4f6a-b1e4-219d1f233193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f706e0>]}
[0m09:55:19.638076 [info ] [MainThread]: Found 5 models, 4 snapshots, 5 data tests, 2 sources, 459 macros
[0m09:55:19.638252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86b99e56-8eeb-4f6a-b1e4-219d1f233193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109636b30>]}
[0m09:55:19.639307 [info ] [MainThread]: 
[0m09:55:19.639596 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:55:19.641861 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_snapshot'
[0m09:55:19.649785 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m09:55:19.650010 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m09:55:19.650144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:20.300808 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.650 seconds
[0m09:55:20.305497 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m09:55:20.433026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m09:55:20.436206 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m09:55:20.436539 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m09:55:20.436804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:55:20.938757 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.501 seconds
[0m09:55:20.945801 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m09:55:21.089917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86b99e56-8eeb-4f6a-b1e4-219d1f233193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e03ba0>]}
[0m09:55:21.090609 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:55:21.090868 [info ] [MainThread]: 
[0m09:55:21.093301 [debug] [Thread-1 (]: Began running node test.weather_dbt.daily_avg_weather_test
[0m09:55:21.093810 [info ] [Thread-1 (]: 1 of 5 START test daily_avg_weather_test ....................................... [RUN]
[0m09:55:21.094336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now test.weather_dbt.daily_avg_weather_test)
[0m09:55:21.094723 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.daily_avg_weather_test
[0m09:55:21.104546 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.daily_avg_weather_test"
[0m09:55:21.105511 [debug] [Thread-1 (]: Began executing node test.weather_dbt.daily_avg_weather_test
[0m09:55:21.123536 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.daily_avg_weather_test"
[0m09:55:21.124860 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.daily_avg_weather_test"
[0m09:55:21.125155 [debug] [Thread-1 (]: On test.weather_dbt.daily_avg_weather_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.daily_avg_weather_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- duplicate record test
SELECT CITY_ID, WEATHER_DATE, COUNT(*)
FROM openweather.analytics.daily_avg_weather_trend
GROUP BY CITY_ID, WEATHER_DATE
HAVING COUNT(*) > 1

-- temperature range
SELECT *
FROM openweather.analytics.daily_avg_weather_trend
WHERE AVG_TEMP_FAHRENHEIT < -50 OR AVG_TEMP_FAHRENHEIT > 130

-- humidity range
SELECT *
FROM openweather.analytics.daily_avg_weather_trend
WHERE AVG_HUMIDITY < 0 OR AVG_HUMIDITY > 100
      
    ) dbt_internal_test
[0m09:55:21.125407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:21.653905 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89cb3-0004-3867-0002-594300035fae
[0m09:55:21.654662 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected 'SELECT'.
syntax error line 18 at position 0 unexpected 'SELECT'.
syntax error line 22 at position 4 unexpected ')'.
[0m09:55:21.655267 [debug] [Thread-1 (]: On test.weather_dbt.daily_avg_weather_test: Close
[0m09:55:21.771845 [debug] [Thread-1 (]: Database Error in test daily_avg_weather_test (tests/daily_avg_weather_test.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected 'SELECT'.
  syntax error line 18 at position 0 unexpected 'SELECT'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target/run/weather_dbt/tests/daily_avg_weather_test.sql
[0m09:55:21.772382 [error] [Thread-1 (]: 1 of 5 ERROR daily_avg_weather_test ............................................ [[31mERROR[0m in 0.68s]
[0m09:55:21.772855 [debug] [Thread-1 (]: Finished running node test.weather_dbt.daily_avg_weather_test
[0m09:55:21.773193 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:55:21.774073 [info ] [Thread-1 (]: 2 of 5 START test not_null_daily_avg_weather_trend_avg_humidity ................ [RUN]
[0m09:55:21.774435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.daily_avg_weather_test, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07)
[0m09:55:21.774679 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:55:21.781819 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:55:21.782499 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:55:21.784361 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:55:21.784966 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:55:21.785197 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_humidity
from openweather.analytics.daily_avg_weather_trend
where avg_humidity is null



      
    ) dbt_internal_test
[0m09:55:21.785403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:22.302209 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.516 seconds
[0m09:55:22.317834 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: Close
[0m09:55:22.486076 [info ] [Thread-1 (]: 2 of 5 PASS not_null_daily_avg_weather_trend_avg_humidity ...................... [[32mPASS[0m in 0.71s]
[0m09:55:22.487836 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:55:22.488515 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:55:22.489345 [info ] [Thread-1 (]: 3 of 5 START test not_null_daily_avg_weather_trend_avg_temp_fahrenheit ......... [RUN]
[0m09:55:22.490165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372)
[0m09:55:22.490707 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:55:22.496138 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:55:22.497260 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:55:22.501458 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:55:22.502708 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:55:22.503143 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp_fahrenheit
from openweather.analytics.daily_avg_weather_trend
where avg_temp_fahrenheit is null



      
    ) dbt_internal_test
[0m09:55:22.503491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:22.978710 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.474 seconds
[0m09:55:22.984032 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: Close
[0m09:55:23.124184 [info ] [Thread-1 (]: 3 of 5 PASS not_null_daily_avg_weather_trend_avg_temp_fahrenheit ............... [[32mPASS[0m in 0.63s]
[0m09:55:23.125601 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:55:23.126000 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:55:23.126388 [info ] [Thread-1 (]: 4 of 5 START test not_null_daily_avg_weather_trend_city_id ..................... [RUN]
[0m09:55:23.126830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372, now test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790)
[0m09:55:23.127113 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:55:23.130973 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:55:23.131916 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:55:23.133998 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:55:23.140284 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:55:23.140672 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_id
from openweather.analytics.daily_avg_weather_trend
where city_id is null



      
    ) dbt_internal_test
[0m09:55:23.140938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:23.618757 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.478 seconds
[0m09:55:23.620998 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: Close
[0m09:55:23.791181 [info ] [Thread-1 (]: 4 of 5 PASS not_null_daily_avg_weather_trend_city_id ........................... [[32mPASS[0m in 0.66s]
[0m09:55:23.792579 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:55:23.793016 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:55:23.793433 [info ] [Thread-1 (]: 5 of 5 START test not_null_daily_avg_weather_trend_weather_date ................ [RUN]
[0m09:55:23.793923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790, now test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b)
[0m09:55:23.794213 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:55:23.798391 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:55:23.799288 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:55:23.801091 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:55:23.801888 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:55:23.802138 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_date
from openweather.analytics.daily_avg_weather_trend
where weather_date is null



      
    ) dbt_internal_test
[0m09:55:23.802360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:24.229871 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.427 seconds
[0m09:55:24.237147 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: Close
[0m09:55:24.368624 [info ] [Thread-1 (]: 5 of 5 PASS not_null_daily_avg_weather_trend_weather_date ...................... [[32mPASS[0m in 0.57s]
[0m09:55:24.369988 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:55:24.371185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:55:24.371391 [debug] [MainThread]: Connection 'test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b' was properly closed.
[0m09:55:24.371614 [info ] [MainThread]: 
[0m09:55:24.371833 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 4.73 seconds (4.73s).
[0m09:55:24.372578 [debug] [MainThread]: Command end result
[0m09:55:24.391013 [info ] [MainThread]: 
[0m09:55:24.391290 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:55:24.391446 [info ] [MainThread]: 
[0m09:55:24.391655 [error] [MainThread]:   Database Error in test daily_avg_weather_test (tests/daily_avg_weather_test.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected 'SELECT'.
  syntax error line 18 at position 0 unexpected 'SELECT'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target/run/weather_dbt/tests/daily_avg_weather_test.sql
[0m09:55:24.391917 [info ] [MainThread]: 
[0m09:55:24.392120 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m09:55:24.393062 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 5.330937, "process_in_blocks": "0", "process_kernel_time": 0.233696, "process_mem_max_rss": "143130624", "process_out_blocks": "0", "process_user_time": 1.603361}
[0m09:55:24.393343 [debug] [MainThread]: Command `dbt test` failed at 09:55:24.393297 after 5.33 seconds
[0m09:55:24.393534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087fd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac59c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac59440>]}
[0m09:55:24.393708 [debug] [MainThread]: Flushing usage events
[0m09:56:58.056153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7dbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7dbb10>]}


============================== 09:56:58.058507 | 38c63dae-d05b-409d-a195-7256160dc443 ==============================
[0m09:56:58.058507 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:56:58.058825 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:56:58.222873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38c63dae-d05b-409d-a195-7256160dc443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b58a520>]}
[0m09:56:58.245421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38c63dae-d05b-409d-a195-7256160dc443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4fc050>]}
[0m09:56:58.245840 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m09:56:58.301122 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:56:58.374687 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 0 files changed.
[0m09:56:58.375026 [debug] [MainThread]: Partial parsing: added file: weather_dbt://tests/humidity_range_daily_avg.sql
[0m09:56:58.375177 [debug] [MainThread]: Partial parsing: added file: weather_dbt://tests/duplication_record_test_daily_avg.sql
[0m09:56:58.375310 [debug] [MainThread]: Partial parsing: added file: weather_dbt://tests/temp_range_daily_avg.sql
[0m09:56:58.375425 [debug] [MainThread]: Partial parsing: deleted file: weather_dbt://tests/daily_avg_weather_test.sql
[0m09:56:58.465323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38c63dae-d05b-409d-a195-7256160dc443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bad9150>]}
[0m09:56:58.561281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38c63dae-d05b-409d-a195-7256160dc443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd246e0>]}
[0m09:56:58.561545 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m09:56:58.561705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38c63dae-d05b-409d-a195-7256160dc443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b573af0>]}
[0m09:56:58.562685 [info ] [MainThread]: 
[0m09:56:58.562950 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:56:58.565095 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_analytics'
[0m09:56:58.572675 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m09:56:58.572907 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m09:56:58.573040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:59.227989 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.655 seconds
[0m09:56:59.232333 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m09:56:59.360044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m09:56:59.364146 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m09:56:59.364549 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m09:56:59.364865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:56:59.898040 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.533 seconds
[0m09:56:59.899321 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m09:57:00.196717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38c63dae-d05b-409d-a195-7256160dc443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd02dd0>]}
[0m09:57:00.197856 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:57:00.198317 [info ] [MainThread]: 
[0m09:57:00.201376 [debug] [Thread-1 (]: Began running node test.weather_dbt.duplication_record_test_daily_avg
[0m09:57:00.201847 [info ] [Thread-1 (]: 1 of 7 START test duplication_record_test_daily_avg ............................ [RUN]
[0m09:57:00.202333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now test.weather_dbt.duplication_record_test_daily_avg)
[0m09:57:00.202702 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.duplication_record_test_daily_avg
[0m09:57:00.210963 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.duplication_record_test_daily_avg"
[0m09:57:00.212710 [debug] [Thread-1 (]: Began executing node test.weather_dbt.duplication_record_test_daily_avg
[0m09:57:00.231365 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.duplication_record_test_daily_avg"
[0m09:57:00.232271 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.duplication_record_test_daily_avg"
[0m09:57:00.232541 [debug] [Thread-1 (]: On test.weather_dbt.duplication_record_test_daily_avg: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.duplication_record_test_daily_avg"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- duplicate record test
SELECT CITY_ID, WEATHER_DATE, COUNT(*)
FROM openweather.analytics.daily_avg_weather_trend
GROUP BY CITY_ID, WEATHER_DATE
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m09:57:00.232773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:00.739597 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.506 seconds
[0m09:57:00.758936 [debug] [Thread-1 (]: On test.weather_dbt.duplication_record_test_daily_avg: Close
[0m09:57:00.880897 [info ] [Thread-1 (]: 1 of 7 PASS duplication_record_test_daily_avg .................................. [[32mPASS[0m in 0.68s]
[0m09:57:00.881853 [debug] [Thread-1 (]: Finished running node test.weather_dbt.duplication_record_test_daily_avg
[0m09:57:00.882443 [debug] [Thread-1 (]: Began running node test.weather_dbt.humidity_range_daily_avg
[0m09:57:00.883076 [info ] [Thread-1 (]: 2 of 7 START test humidity_range_daily_avg ..................................... [RUN]
[0m09:57:00.883756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.duplication_record_test_daily_avg, now test.weather_dbt.humidity_range_daily_avg)
[0m09:57:00.884220 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.humidity_range_daily_avg
[0m09:57:00.887390 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.humidity_range_daily_avg"
[0m09:57:00.888345 [debug] [Thread-1 (]: Began executing node test.weather_dbt.humidity_range_daily_avg
[0m09:57:00.891686 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.humidity_range_daily_avg"
[0m09:57:00.892708 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.humidity_range_daily_avg"
[0m09:57:00.893382 [debug] [Thread-1 (]: On test.weather_dbt.humidity_range_daily_avg: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.humidity_range_daily_avg"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- humidity range
SELECT *
FROM openweather.analytics.daily_avg_weather_trend
WHERE AVG_HUMIDITY < 0 OR AVG_HUMIDITY > 100
      
    ) dbt_internal_test
[0m09:57:00.893994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:02.257594 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.362 seconds
[0m09:57:02.265042 [debug] [Thread-1 (]: On test.weather_dbt.humidity_range_daily_avg: Close
[0m09:57:02.377511 [info ] [Thread-1 (]: 2 of 7 PASS humidity_range_daily_avg ........................................... [[32mPASS[0m in 1.49s]
[0m09:57:02.378609 [debug] [Thread-1 (]: Finished running node test.weather_dbt.humidity_range_daily_avg
[0m09:57:02.379234 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:57:02.379830 [info ] [Thread-1 (]: 3 of 7 START test not_null_daily_avg_weather_trend_avg_humidity ................ [RUN]
[0m09:57:02.380428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.humidity_range_daily_avg, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07)
[0m09:57:02.380838 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:57:02.393061 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:57:02.394065 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:57:02.402486 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:57:02.403614 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m09:57:02.403929 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_humidity
from openweather.analytics.daily_avg_weather_trend
where avg_humidity is null



      
    ) dbt_internal_test
[0m09:57:02.404197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:02.834423 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.430 seconds
[0m09:57:02.840810 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: Close
[0m09:57:02.979477 [info ] [Thread-1 (]: 3 of 7 PASS not_null_daily_avg_weather_trend_avg_humidity ...................... [[32mPASS[0m in 0.60s]
[0m09:57:02.981903 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m09:57:02.982998 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:57:02.983624 [info ] [Thread-1 (]: 4 of 7 START test not_null_daily_avg_weather_trend_avg_temp_fahrenheit ......... [RUN]
[0m09:57:02.984193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372)
[0m09:57:02.984674 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:57:02.990516 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:57:02.991564 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:57:02.994494 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:57:02.995571 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m09:57:02.995932 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp_fahrenheit
from openweather.analytics.daily_avg_weather_trend
where avg_temp_fahrenheit is null



      
    ) dbt_internal_test
[0m09:57:02.996246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:03.426377 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.430 seconds
[0m09:57:03.431214 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: Close
[0m09:57:03.585749 [info ] [Thread-1 (]: 4 of 7 PASS not_null_daily_avg_weather_trend_avg_temp_fahrenheit ............... [[32mPASS[0m in 0.60s]
[0m09:57:03.587472 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m09:57:03.588060 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:57:03.588602 [info ] [Thread-1 (]: 5 of 7 START test not_null_daily_avg_weather_trend_city_id ..................... [RUN]
[0m09:57:03.589173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372, now test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790)
[0m09:57:03.589563 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:57:03.594108 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:57:03.594924 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:57:03.596700 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:57:03.597503 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m09:57:03.597809 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_id
from openweather.analytics.daily_avg_weather_trend
where city_id is null



      
    ) dbt_internal_test
[0m09:57:03.598078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:04.031091 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.432 seconds
[0m09:57:04.035647 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: Close
[0m09:57:04.154380 [info ] [Thread-1 (]: 5 of 7 PASS not_null_daily_avg_weather_trend_city_id ........................... [[32mPASS[0m in 0.57s]
[0m09:57:04.155101 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m09:57:04.155442 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:57:04.155815 [info ] [Thread-1 (]: 6 of 7 START test not_null_daily_avg_weather_trend_weather_date ................ [RUN]
[0m09:57:04.156213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790, now test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b)
[0m09:57:04.156501 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:57:04.160082 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:57:04.160935 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:57:04.162642 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:57:04.163435 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m09:57:04.163671 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_date
from openweather.analytics.daily_avg_weather_trend
where weather_date is null



      
    ) dbt_internal_test
[0m09:57:04.163884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:04.641858 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.477 seconds
[0m09:57:04.646319 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: Close
[0m09:57:04.789923 [info ] [Thread-1 (]: 6 of 7 PASS not_null_daily_avg_weather_trend_weather_date ...................... [[32mPASS[0m in 0.63s]
[0m09:57:04.790666 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m09:57:04.791089 [debug] [Thread-1 (]: Began running node test.weather_dbt.temp_range_daily_avg
[0m09:57:04.791418 [info ] [Thread-1 (]: 7 of 7 START test temp_range_daily_avg ......................................... [RUN]
[0m09:57:04.791904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b, now test.weather_dbt.temp_range_daily_avg)
[0m09:57:04.792321 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.temp_range_daily_avg
[0m09:57:04.794924 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.temp_range_daily_avg"
[0m09:57:04.795641 [debug] [Thread-1 (]: Began executing node test.weather_dbt.temp_range_daily_avg
[0m09:57:04.797507 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.temp_range_daily_avg"
[0m09:57:04.798361 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.temp_range_daily_avg"
[0m09:57:04.798651 [debug] [Thread-1 (]: On test.weather_dbt.temp_range_daily_avg: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "test.weather_dbt.temp_range_daily_avg"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- temperature range
SELECT *
FROM openweather.analytics.daily_avg_weather_trend
WHERE AVG_TEMP_FAHRENHEIT < -50 OR AVG_TEMP_FAHRENHEIT > 130
      
    ) dbt_internal_test
[0m09:57:04.798911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:05.434577 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.635 seconds
[0m09:57:05.438719 [debug] [Thread-1 (]: On test.weather_dbt.temp_range_daily_avg: Close
[0m09:57:05.571608 [info ] [Thread-1 (]: 7 of 7 PASS temp_range_daily_avg ............................................... [[32mPASS[0m in 0.78s]
[0m09:57:05.573049 [debug] [Thread-1 (]: Finished running node test.weather_dbt.temp_range_daily_avg
[0m09:57:05.574225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:05.574449 [debug] [MainThread]: Connection 'test.weather_dbt.temp_range_daily_avg' was properly closed.
[0m09:57:05.574682 [info ] [MainThread]: 
[0m09:57:05.574899 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 7.01 seconds (7.01s).
[0m09:57:05.575855 [debug] [MainThread]: Command end result
[0m09:57:05.595305 [info ] [MainThread]: 
[0m09:57:05.595610 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:57:05.595786 [info ] [MainThread]: 
[0m09:57:05.595960 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m09:57:05.596923 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.5727005, "process_in_blocks": "0", "process_kernel_time": 0.232196, "process_mem_max_rss": "141000704", "process_out_blocks": "0", "process_user_time": 1.713725}
[0m09:57:05.597202 [debug] [MainThread]: Command `dbt test` succeeded at 09:57:05.597151 after 7.57 seconds
[0m09:57:05.597389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3cd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb15c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb15390>]}
[0m09:57:05.597565 [debug] [MainThread]: Flushing usage events
[0m09:58:22.103339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d9cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10469fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10469fb10>]}


============================== 09:58:22.105659 | cc4eca8c-99bc-4812-b7d8-afb4713804fa ==============================
[0m09:58:22.105659 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:58:22.105973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:58:22.154107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc4eca8c-99bc-4812-b7d8-afb4713804fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10350b360>]}
[0m09:58:22.162787 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.091598295, "process_in_blocks": "0", "process_kernel_time": 0.093859, "process_mem_max_rss": "97206272", "process_out_blocks": "0", "process_user_time": 0.607778}
[0m09:58:22.163088 [debug] [MainThread]: Command `dbt clean` succeeded at 09:58:22.163035 after 0.09 seconds
[0m09:58:22.163257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ca580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ca690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104432950>]}
[0m09:58:22.163407 [debug] [MainThread]: Flushing usage events
[0m15:04:05.850199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107344d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c4bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c4bb10>]}


============================== 15:04:05.853152 | 1e67fb9c-844f-45cf-90e0-3bae3d161fe0 ==============================
[0m15:04:05.853152 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:04:05.853464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m15:04:05.905712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e67fb9c-844f-45cf-90e0-3bae3d161fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ab3360>]}
[0m15:04:05.915900 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.11942987, "process_in_blocks": "0", "process_kernel_time": 0.140813, "process_mem_max_rss": "98189312", "process_out_blocks": "0", "process_user_time": 0.614283}
[0m15:04:05.916184 [debug] [MainThread]: Command `dbt clean` succeeded at 15:04:05.916137 after 0.12 seconds
[0m15:04:05.916352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a02580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a02690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089da950>]}
[0m15:04:05.916515 [debug] [MainThread]: Flushing usage events
[0m12:01:03.225171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044d4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dd7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dd7b10>]}


============================== 12:01:03.228791 | 1bea2a46-026e-493f-a553-e5dc9ecdd72e ==============================
[0m12:01:03.228791 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:01:03.229117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:01:03.277242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bea2a46-026e-493f-a553-e5dc9ecdd72e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c43360>]}
[0m12:01:03.287335 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.09837762, "process_in_blocks": "0", "process_kernel_time": 0.147585, "process_mem_max_rss": "101679104", "process_out_blocks": "0", "process_user_time": 0.657096}
[0m12:01:03.287718 [debug] [MainThread]: Command `dbt clean` succeeded at 12:01:03.287643 after 0.10 seconds
[0m12:01:03.287926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f02580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f02690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b6a950>]}
[0m12:01:03.288094 [debug] [MainThread]: Flushing usage events
[0m20:02:05.744542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf92ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c0bc680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf92ff0>]}


============================== 20:02:05.748681 | 9501202e-0a7e-4be4-9e8a-74b8ce184f1a ==============================
[0m20:02:05.748681 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:02:05.749498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/weather_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/weather_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/weather_dbt --project-dir /opt/airflow/weather_dbt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:02:05.777864 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'weather_dbt' does not have a target named 'openweather'. The valid target names for this profile are:
   - dev
[0m20:02:05.778585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.06460067, "process_user_time": 1.074453, "process_kernel_time": 0.067776, "process_mem_max_rss": "188088", "process_out_blocks": "2187", "command_success": false, "process_in_blocks": "0"}
[0m20:02:05.779281 [debug] [MainThread]: Command `dbt run` failed at 20:02:05.779203 after 0.07 seconds
[0m20:02:05.779577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d81ee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c79a5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bfd7620>]}
[0m20:02:05.779820 [debug] [MainThread]: Flushing usage events
[0m20:03:05.505556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a4e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba0fdee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb90d7020>]}


============================== 20:03:05.509280 | 15c714f3-75e4-4992-8b52-6385dc3e290c ==============================
[0m20:03:05.509280 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:03:05.510010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/weather_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/weather_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/weather_dbt --project-dir /opt/airflow/weather_dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:03:05.954002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15c714f3-75e4-4992-8b52-6385dc3e290c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb906e450>]}
[0m20:03:05.978200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15c714f3-75e4-4992-8b52-6385dc3e290c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e249490>]}
[0m20:03:05.978707 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:03:06.031835 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:03:06.032721 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:03:06.033340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '15c714f3-75e4-4992-8b52-6385dc3e290c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c59f800>]}
[0m20:03:06.590907 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:03:06.592389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '15c714f3-75e4-4992-8b52-6385dc3e290c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff973c4110>]}
[0m20:03:06.763948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15c714f3-75e4-4992-8b52-6385dc3e290c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f0b440>]}
[0m20:03:06.832681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15c714f3-75e4-4992-8b52-6385dc3e290c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97b87080>]}
[0m20:03:06.833094 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m20:03:06.833624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15c714f3-75e4-4992-8b52-6385dc3e290c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7be4290>]}
[0m20:03:06.834838 [info ] [MainThread]: 
[0m20:03:06.835305 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:03:06.837694 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m20:03:06.844653 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m20:03:06.844962 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m20:03:06.845170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:08.432359 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.587 seconds
[0m20:03:08.434201 [debug] [ThreadPool]: On list_weather: Close
[0m20:03:08.654047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now create_weather_analytics)
[0m20:03:08.655585 [debug] [ThreadPool]: Creating schema "database: "weather"
schema: "analytics"
"
[0m20:03:08.663009 [debug] [ThreadPool]: Using snowflake connection "create_weather_analytics"
[0m20:03:08.663553 [debug] [ThreadPool]: On create_weather_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "create_weather_analytics"} */
create schema if not exists weather.analytics
[0m20:03:08.664023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:03:09.416040 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.751 seconds
[0m20:03:09.418714 [debug] [ThreadPool]: On create_weather_analytics: Close
[0m20:03:09.623712 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_weather_analytics, now list_weather_analytics)
[0m20:03:09.635968 [debug] [ThreadPool]: Using snowflake connection "list_weather_analytics"
[0m20:03:09.636549 [debug] [ThreadPool]: On list_weather_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_weather_analytics"} */
show objects in weather.analytics limit 10000
[0m20:03:09.637029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:03:10.333237 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.696 seconds
[0m20:03:10.336047 [debug] [ThreadPool]: On list_weather_analytics: Close
[0m20:03:10.535727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_analytics, now list_weather_snapshot)
[0m20:03:10.540310 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m20:03:10.540959 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m20:03:10.541496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:03:11.121322 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8b3b3-0004-3865-0002-71d700068e52
[0m20:03:11.123156 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m20:03:11.124275 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m20:03:11.124869 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:03:11.125492 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m20:03:11.251445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15c714f3-75e4-4992-8b52-6385dc3e290c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9730e600>]}
[0m20:03:11.252921 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m20:03:11.253517 [info ] [MainThread]: 
[0m20:03:11.268280 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m20:03:11.269376 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m20:03:11.270570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now model.weather_dbt.daily_avg_weather_trend)
[0m20:03:11.271583 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m20:03:11.279941 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m20:03:11.282956 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m20:03:11.304165 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m20:03:11.306605 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m20:03:11.307041 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table weather.analytics.daily_avg_weather_trend
         as
        (WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m20:03:11.307471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:11.881547 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b3b3-0004-3865-0002-71d700068e56
[0m20:03:11.882347 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'OPENWEATHER' does not exist or not authorized.
[0m20:03:11.883333 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m20:03:12.065715 [debug] [Thread-1 (]: Database Error in model daily_avg_weather_trend (models/output/daily_avg_weather_trend.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/output/daily_avg_weather_trend.sql
[0m20:03:12.068115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15c714f3-75e4-4992-8b52-6385dc3e290c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb88be0f0>]}
[0m20:03:12.069013 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model analytics.daily_avg_weather_trend ........ [[31mERROR[0m in 0.80s]
[0m20:03:12.069703 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m20:03:12.070492 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m20:03:12.072064 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m20:03:12.072989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m20:03:12.073653 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m20:03:12.077226 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m20:03:12.078689 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m20:03:12.080853 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m20:03:12.083005 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m20:03:12.083585 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table weather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m20:03:12.084331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:12.540864 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b3b3-0004-3865-0002-71d700068e5a
[0m20:03:12.542656 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'OPENWEATHER' does not exist or not authorized.
[0m20:03:12.543804 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m20:03:12.680325 [debug] [Thread-1 (]: Database Error in model extreme_weather_events (models/output/extreme_weather_events.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/output/extreme_weather_events.sql
[0m20:03:12.681574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15c714f3-75e4-4992-8b52-6385dc3e290c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97b86f90>]}
[0m20:03:12.682674 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model analytics.extreme_weather_events ......... [[31mERROR[0m in 0.61s]
[0m20:03:12.683695 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m20:03:12.684481 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m20:03:12.685265 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m20:03:12.686097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m20:03:12.686874 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m20:03:12.690509 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m20:03:12.692308 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m20:03:12.695681 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m20:03:12.697893 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m20:03:12.698488 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table weather.analytics.hourly_weather_patterns
         as
        (WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    *
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY
        );
[0m20:03:12.699027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:13.251265 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b3b3-0004-3865-0002-71d700068e5e
[0m20:03:13.253026 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'OPENWEATHER' does not exist or not authorized.
[0m20:03:13.254132 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m20:03:13.417711 [debug] [Thread-1 (]: Database Error in model hourly_weather_patterns (models/output/hourly_weather_patterns.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/output/hourly_weather_patterns.sql
[0m20:03:13.419010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15c714f3-75e4-4992-8b52-6385dc3e290c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9730cfe0>]}
[0m20:03:13.420065 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model analytics.hourly_weather_patterns ........ [[31mERROR[0m in 0.73s]
[0m20:03:13.420947 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m20:03:13.422110 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m20:03:13.423097 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m20:03:13.423980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m20:03:13.424933 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m20:03:13.428984 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m20:03:13.431065 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m20:03:13.450995 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m20:03:13.453133 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m20:03:13.453558 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view weather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m20:03:13.453907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:13.960857 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b3b3-0004-386b-0002-71d700067e6a
[0m20:03:13.961785 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'OPENWEATHER' does not exist or not authorized.
[0m20:03:13.962438 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m20:03:14.101166 [debug] [Thread-1 (]: Database Error in model openweather_join (models/input/openweather_join.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/input/openweather_join.sql
[0m20:03:14.105637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15c714f3-75e4-4992-8b52-6385dc3e290c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7d95ee0>]}
[0m20:03:14.107231 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model analytics.openweather_join ................ [[31mERROR[0m in 0.68s]
[0m20:03:14.111567 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m20:03:14.112306 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m20:03:14.113225 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m20:03:14.114263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m20:03:14.115296 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m20:03:14.119725 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m20:03:14.121883 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m20:03:14.125391 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m20:03:14.128168 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m20:03:14.128824 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table weather.analytics.weather_condition_freq
         as
        (WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    *
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME
        );
[0m20:03:14.129289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:14.641990 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b3b3-0004-3987-0002-71d70007097e
[0m20:03:14.644202 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'OPENWEATHER' does not exist or not authorized.
[0m20:03:14.645123 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m20:03:14.791974 [debug] [Thread-1 (]: Database Error in model weather_condition_freq (models/output/weather_condition_freq.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/output/weather_condition_freq.sql
[0m20:03:14.793724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15c714f3-75e4-4992-8b52-6385dc3e290c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbbcb2ff0>]}
[0m20:03:14.796248 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model analytics.weather_condition_freq ......... [[31mERROR[0m in 0.68s]
[0m20:03:14.797865 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m20:03:14.801606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:03:14.802366 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m20:03:14.802910 [info ] [MainThread]: 
[0m20:03:14.803447 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 7.97 seconds (7.97s).
[0m20:03:14.805126 [debug] [MainThread]: Command end result
[0m20:03:14.834451 [info ] [MainThread]: 
[0m20:03:14.834974 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m20:03:14.835510 [info ] [MainThread]: 
[0m20:03:14.836076 [error] [MainThread]:   Database Error in model daily_avg_weather_trend (models/output/daily_avg_weather_trend.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/output/daily_avg_weather_trend.sql
[0m20:03:14.836504 [info ] [MainThread]: 
[0m20:03:14.837015 [error] [MainThread]:   Database Error in model extreme_weather_events (models/output/extreme_weather_events.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/output/extreme_weather_events.sql
[0m20:03:14.837585 [info ] [MainThread]: 
[0m20:03:14.838089 [error] [MainThread]:   Database Error in model hourly_weather_patterns (models/output/hourly_weather_patterns.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/output/hourly_weather_patterns.sql
[0m20:03:14.838413 [info ] [MainThread]: 
[0m20:03:14.838797 [error] [MainThread]:   Database Error in model openweather_join (models/input/openweather_join.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/input/openweather_join.sql
[0m20:03:14.839187 [info ] [MainThread]: 
[0m20:03:14.839712 [error] [MainThread]:   Database Error in model weather_condition_freq (models/output/weather_condition_freq.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/output/weather_condition_freq.sql
[0m20:03:14.840081 [info ] [MainThread]: 
[0m20:03:14.840576 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 TOTAL=5
[0m20:03:14.841630 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.381115, "process_user_time": 3.575618, "process_kernel_time": 0.250113, "process_mem_max_rss": "215476", "process_out_blocks": "4487", "command_success": false, "process_in_blocks": "0"}
[0m20:03:14.842685 [debug] [MainThread]: Command `dbt run` failed at 20:03:14.842579 after 9.38 seconds
[0m20:03:14.843218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8395130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f2f830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9739e8a0>]}
[0m20:03:14.843635 [debug] [MainThread]: Flushing usage events
[0m12:03:42.515195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102898d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ebd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ebb10>]}


============================== 12:03:42.518060 | 2ed20935-8ee0-4040-81c9-58ae3509a1ce ==============================
[0m12:03:42.518060 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:03:42.518382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:03:42.523950 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m12:03:42.525689 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.045805626, "process_in_blocks": "0", "process_kernel_time": 0.111076, "process_mem_max_rss": "96239616", "process_out_blocks": "0", "process_user_time": 0.571313}
[0m12:03:42.526031 [debug] [MainThread]: Command `dbt run` failed at 12:03:42.525977 after 0.05 seconds
[0m12:03:42.526203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a19e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ed20f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e17f00>]}
[0m12:03:42.526373 [debug] [MainThread]: Flushing usage events
[0m12:03:56.571438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080fbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080fbb10>]}


============================== 12:03:56.574310 | c4c854e3-982e-4c07-8de6-08a592e069b2 ==============================
[0m12:03:56.574310 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:03:56.574636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:03:56.580431 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m12:03:56.582157 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.044710707, "process_in_blocks": "0", "process_kernel_time": 0.078872, "process_mem_max_rss": "97796096", "process_out_blocks": "0", "process_user_time": 0.5688}
[0m12:03:56.582679 [debug] [MainThread]: Command `dbt run` failed at 12:03:56.582609 after 0.05 seconds
[0m12:03:56.582868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108125e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eba0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dfbf00>]}
[0m12:03:56.583040 [debug] [MainThread]: Flushing usage events
[0m20:06:35.532870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82c64c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d228d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83c33c80>]}


============================== 20:06:35.536706 | 0a753d1f-e22d-4a5c-8d3d-025e19c90bc1 ==============================
[0m20:06:35.536706 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:06:35.537400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/weather_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/weather_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/weather_dbt --project-dir /opt/airflow/weather_dbt', 'send_anonymous_usage_stats': 'True'}
[0m20:06:35.963041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a753d1f-e22d-4a5c-8d3d-025e19c90bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66359be0>]}
[0m20:06:35.987256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a753d1f-e22d-4a5c-8d3d-025e19c90bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81c6fd70>]}
[0m20:06:35.987718 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:06:36.036836 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:06:36.114256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:06:36.114554 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:06:36.141175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a753d1f-e22d-4a5c-8d3d-025e19c90bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65cb4e30>]}
[0m20:06:36.204449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a753d1f-e22d-4a5c-8d3d-025e19c90bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67e104a0>]}
[0m20:06:36.204760 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m20:06:36.205350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a753d1f-e22d-4a5c-8d3d-025e19c90bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65c63aa0>]}
[0m20:06:36.206627 [info ] [MainThread]: 
[0m20:06:36.207271 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:06:36.209761 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m20:06:36.217603 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m20:06:36.217984 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m20:06:36.218284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:06:36.766534 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.548 seconds
[0m20:06:36.768304 [debug] [ThreadPool]: On list_weather: Close
[0m20:06:36.910727 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather_snapshot'
[0m20:06:36.922082 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m20:06:36.922599 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m20:06:36.923012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:06:37.375508 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8b3b6-0004-386b-0002-71d700067e72
[0m20:06:37.376583 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m20:06:37.377298 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m20:06:37.377797 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:06:37.378379 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m20:06:37.512992 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_snapshot, now list_weather_analytics)
[0m20:06:37.516893 [debug] [ThreadPool]: Using snowflake connection "list_weather_analytics"
[0m20:06:37.517522 [debug] [ThreadPool]: On list_weather_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_weather_analytics"} */
show objects in weather.analytics limit 10000
[0m20:06:37.518156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:06:38.110593 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.592 seconds
[0m20:06:38.114647 [debug] [ThreadPool]: On list_weather_analytics: Close
[0m20:06:38.235082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a753d1f-e22d-4a5c-8d3d-025e19c90bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65c34bc0>]}
[0m20:06:38.235942 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m20:06:38.236249 [info ] [MainThread]: 
[0m20:06:38.242182 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m20:06:38.242606 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m20:06:38.242909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m20:06:38.243377 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m20:06:38.248507 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m20:06:38.249654 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m20:06:38.265633 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m20:06:38.267345 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m20:06:38.267762 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table weather.analytics.daily_avg_weather_trend
         as
        (WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m20:06:38.268104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:38.724440 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b3b6-0004-386c-0002-71d700069e92
[0m20:06:38.725453 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'OPENWEATHER' does not exist or not authorized.
[0m20:06:38.725874 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m20:06:38.859561 [debug] [Thread-1 (]: Database Error in model daily_avg_weather_trend (models/output/daily_avg_weather_trend.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/output/daily_avg_weather_trend.sql
[0m20:06:38.860625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a753d1f-e22d-4a5c-8d3d-025e19c90bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d3c260>]}
[0m20:06:38.861048 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model analytics.daily_avg_weather_trend ........ [[31mERROR[0m in 0.62s]
[0m20:06:38.861446 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m20:06:38.861934 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m20:06:38.862784 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m20:06:38.863167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m20:06:38.863518 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m20:06:38.865517 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m20:06:38.866530 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m20:06:38.867995 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m20:06:38.869229 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m20:06:38.869500 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table weather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m20:06:38.869720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:39.291602 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b3b6-0004-3863-0002-71d70006be42
[0m20:06:39.292919 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'OPENWEATHER' does not exist or not authorized.
[0m20:06:39.294098 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m20:06:39.425342 [debug] [Thread-1 (]: Database Error in model extreme_weather_events (models/output/extreme_weather_events.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/output/extreme_weather_events.sql
[0m20:06:39.426339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a753d1f-e22d-4a5c-8d3d-025e19c90bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64c63fb0>]}
[0m20:06:39.427363 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model analytics.extreme_weather_events ......... [[31mERROR[0m in 0.56s]
[0m20:06:39.428384 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m20:06:39.429554 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m20:06:39.430708 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m20:06:39.431526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m20:06:39.432184 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m20:06:39.436165 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m20:06:39.437924 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m20:06:39.440633 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m20:06:39.442759 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m20:06:39.443809 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table weather.analytics.hourly_weather_patterns
         as
        (WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    *
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY
        );
[0m20:06:39.444554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:39.920852 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b3b6-0004-3868-0002-71d70006ada2
[0m20:06:39.922211 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'OPENWEATHER' does not exist or not authorized.
[0m20:06:39.923158 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m20:06:40.044502 [debug] [Thread-1 (]: Database Error in model hourly_weather_patterns (models/output/hourly_weather_patterns.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/output/hourly_weather_patterns.sql
[0m20:06:40.045037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a753d1f-e22d-4a5c-8d3d-025e19c90bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64cf52e0>]}
[0m20:06:40.045467 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model analytics.hourly_weather_patterns ........ [[31mERROR[0m in 0.61s]
[0m20:06:40.045841 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m20:06:40.046268 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m20:06:40.046988 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m20:06:40.047588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m20:06:40.048136 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m20:06:40.051276 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m20:06:40.053099 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m20:06:40.066049 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m20:06:40.068332 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m20:06:40.068709 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view weather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m20:06:40.068957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:40.431598 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b3b6-0004-3868-0002-71d70006ada6
[0m20:06:40.433312 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'OPENWEATHER' does not exist or not authorized.
[0m20:06:40.434265 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m20:06:40.577998 [debug] [Thread-1 (]: Database Error in model openweather_join (models/input/openweather_join.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/input/openweather_join.sql
[0m20:06:40.578980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a753d1f-e22d-4a5c-8d3d-025e19c90bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64cf5010>]}
[0m20:06:40.580010 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model analytics.openweather_join ................ [[31mERROR[0m in 0.53s]
[0m20:06:40.580865 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m20:06:40.581523 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m20:06:40.582403 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m20:06:40.583182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m20:06:40.583794 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m20:06:40.587460 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m20:06:40.589078 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m20:06:40.591658 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m20:06:40.593367 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m20:06:40.593872 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table weather.analytics.weather_condition_freq
         as
        (WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    *
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME
        );
[0m20:06:40.594672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:41.013008 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b3b6-0004-3864-0002-71d70006f986
[0m20:06:41.014156 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'OPENWEATHER' does not exist or not authorized.
[0m20:06:41.014881 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m20:06:41.152336 [debug] [Thread-1 (]: Database Error in model weather_condition_freq (models/output/weather_condition_freq.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/output/weather_condition_freq.sql
[0m20:06:41.153414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a753d1f-e22d-4a5c-8d3d-025e19c90bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64c620f0>]}
[0m20:06:41.154441 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model analytics.weather_condition_freq ......... [[31mERROR[0m in 0.57s]
[0m20:06:41.155297 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m20:06:41.157945 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:06:41.158690 [debug] [MainThread]: Connection 'list_weather' was properly closed.
[0m20:06:41.159230 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m20:06:41.159813 [info ] [MainThread]: 
[0m20:06:41.160369 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 4.95 seconds (4.95s).
[0m20:06:41.161930 [debug] [MainThread]: Command end result
[0m20:06:41.195866 [info ] [MainThread]: 
[0m20:06:41.196261 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m20:06:41.196644 [info ] [MainThread]: 
[0m20:06:41.196974 [error] [MainThread]:   Database Error in model daily_avg_weather_trend (models/output/daily_avg_weather_trend.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/output/daily_avg_weather_trend.sql
[0m20:06:41.197303 [info ] [MainThread]: 
[0m20:06:41.197653 [error] [MainThread]:   Database Error in model extreme_weather_events (models/output/extreme_weather_events.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/output/extreme_weather_events.sql
[0m20:06:41.197891 [info ] [MainThread]: 
[0m20:06:41.198190 [error] [MainThread]:   Database Error in model hourly_weather_patterns (models/output/hourly_weather_patterns.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/output/hourly_weather_patterns.sql
[0m20:06:41.198536 [info ] [MainThread]: 
[0m20:06:41.199205 [error] [MainThread]:   Database Error in model openweather_join (models/input/openweather_join.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/input/openweather_join.sql
[0m20:06:41.199618 [info ] [MainThread]: 
[0m20:06:41.200283 [error] [MainThread]:   Database Error in model weather_condition_freq (models/output/weather_condition_freq.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/output/weather_condition_freq.sql
[0m20:06:41.200568 [info ] [MainThread]: 
[0m20:06:41.201046 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 TOTAL=5
[0m20:06:41.201881 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.712455, "process_user_time": 2.720002, "process_kernel_time": 0.161, "process_mem_max_rss": "210380", "process_out_blocks": "2063", "command_success": false, "process_in_blocks": "0"}
[0m20:06:41.202355 [debug] [MainThread]: Command `dbt run` failed at 20:06:41.202284 after 5.71 seconds
[0m20:06:41.202685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d228d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82aca300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6586da00>]}
[0m20:06:41.203078 [debug] [MainThread]: Flushing usage events
[0m12:07:21.048779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113414cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113414e10>]}


============================== 12:07:21.051830 | deb90d3b-55fc-4333-b22d-a337d0877f95 ==============================
[0m12:07:21.051830 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:07:21.052145 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:07:21.053797 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  The profiles.yml file at /Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/profiles.yml is empty
  
[0m12:07:21.055164 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.022321418, "process_in_blocks": "0", "process_kernel_time": 0.112426, "process_mem_max_rss": "94371840", "process_out_blocks": "0", "process_user_time": 0.5515}
[0m12:07:21.055582 [debug] [MainThread]: Command `dbt run` failed at 12:07:21.055528 after 0.02 seconds
[0m12:07:21.055770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113428640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116f5370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113013bd0>]}
[0m12:07:21.055951 [debug] [MainThread]: Flushing usage events
[0m12:07:35.835426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102704d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104007d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104007b10>]}


============================== 12:07:35.838888 | 2a46ea0a-b487-4441-b2f7-7cee4c36321e ==============================
[0m12:07:35.838888 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:07:35.839247 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:07:36.110791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a46ea0a-b487-4441-b2f7-7cee4c36321e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10618a520>]}
[0m12:07:36.135081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a46ea0a-b487-4441-b2f7-7cee4c36321e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ffc050>]}
[0m12:07:36.135928 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:07:36.197038 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:07:36.265166 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m12:07:36.265567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2a46ea0a-b487-4441-b2f7-7cee4c36321e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066cc350>]}
[0m12:07:36.838797 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:07:36.839115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2a46ea0a-b487-4441-b2f7-7cee4c36321e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066de5d0>]}
[0m12:07:36.955721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a46ea0a-b487-4441-b2f7-7cee4c36321e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106acc750>]}
[0m12:07:37.021934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a46ea0a-b487-4441-b2f7-7cee4c36321e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106510d50>]}
[0m12:07:37.022215 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m12:07:37.022373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a46ea0a-b487-4441-b2f7-7cee4c36321e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b7ed50>]}
[0m12:07:37.023352 [info ] [MainThread]: 
[0m12:07:37.023620 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:07:37.025673 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m12:07:37.032098 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m12:07:37.032318 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m12:07:37.032466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:38.237998 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.205 seconds
[0m12:07:38.241955 [debug] [ThreadPool]: On list_openweather: Close
[0m12:07:38.387650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m12:07:38.397474 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m12:07:38.397869 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m12:07:38.398105 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:39.008732 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.610 seconds
[0m12:07:39.012599 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m12:07:39.125928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m12:07:39.127832 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m12:07:39.128029 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m12:07:39.128189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:39.598745 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.470 seconds
[0m12:07:39.603808 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m12:07:39.716297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a46ea0a-b487-4441-b2f7-7cee4c36321e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd7490>]}
[0m12:07:39.717110 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:07:39.717503 [info ] [MainThread]: 
[0m12:07:39.722262 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m12:07:39.722857 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m12:07:39.723327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now model.weather_dbt.daily_avg_weather_trend)
[0m12:07:39.724137 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m12:07:39.733164 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m12:07:39.734079 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m12:07:39.756071 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m12:07:39.757229 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m12:07:39.757548 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m12:07:39.757777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:41.800320 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.040 seconds
[0m12:07:41.827135 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m12:07:41.967428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a46ea0a-b487-4441-b2f7-7cee4c36321e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035cba70>]}
[0m12:07:41.968233 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 2.24s]
[0m12:07:41.968824 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m12:07:41.969231 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m12:07:41.969771 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m12:07:41.970254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m12:07:41.970579 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m12:07:41.973275 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m12:07:41.973994 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m12:07:41.976864 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m12:07:41.978552 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m12:07:41.978888 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m12:07:41.979175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:43.745488 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.766 seconds
[0m12:07:43.751404 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m12:07:43.865372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a46ea0a-b487-4441-b2f7-7cee4c36321e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061743d0>]}
[0m12:07:43.866326 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.89s]
[0m12:07:43.867036 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m12:07:43.867515 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m12:07:43.868175 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m12:07:43.868800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m12:07:43.869208 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m12:07:43.872685 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m12:07:43.874033 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m12:07:43.876644 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m12:07:43.878336 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m12:07:43.878979 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    *
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY
        );
[0m12:07:43.879521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:45.691803 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.812 seconds
[0m12:07:45.695708 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m12:07:45.812484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a46ea0a-b487-4441-b2f7-7cee4c36321e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026408a0>]}
[0m12:07:45.813291 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.hourly_weather_patterns ............ [[32mSUCCESS 1[0m in 1.94s]
[0m12:07:45.813762 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m12:07:45.814085 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m12:07:45.814423 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m12:07:45.814972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m12:07:45.815413 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m12:07:45.817945 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m12:07:45.818572 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m12:07:45.835037 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m12:07:45.836189 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m12:07:45.836542 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m12:07:45.836929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:46.714950 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.877 seconds
[0m12:07:46.720650 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m12:07:46.833055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a46ea0a-b487-4441-b2f7-7cee4c36321e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115604d0>]}
[0m12:07:46.834313 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 1.02s]
[0m12:07:46.835149 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m12:07:46.835712 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m12:07:46.836438 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m12:07:46.837148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m12:07:46.837658 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m12:07:46.841889 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m12:07:46.843158 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m12:07:46.845652 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m12:07:46.847293 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m12:07:46.848018 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "dev", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    *
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME
        );
[0m12:07:46.848409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:48.557171 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.708 seconds
[0m12:07:48.561783 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m12:07:48.700928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a46ea0a-b487-4441-b2f7-7cee4c36321e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111562f90>]}
[0m12:07:48.702045 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.86s]
[0m12:07:48.702807 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m12:07:48.704357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:48.704677 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m12:07:48.705074 [info ] [MainThread]: 
[0m12:07:48.705409 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 11.68 seconds (11.68s).
[0m12:07:48.706653 [debug] [MainThread]: Command end result
[0m12:07:48.734476 [info ] [MainThread]: 
[0m12:07:48.734823 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:07:48.735021 [info ] [MainThread]: 
[0m12:07:48.735226 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:07:48.737112 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.94425, "process_in_blocks": "0", "process_kernel_time": 0.344954, "process_mem_max_rss": "149946368", "process_out_blocks": "0", "process_user_time": 2.346849}
[0m12:07:48.737567 [debug] [MainThread]: Command `dbt run` succeeded at 12:07:48.737489 after 12.94 seconds
[0m12:07:48.737840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103aa4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111563650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115637d0>]}
[0m12:07:48.738088 [debug] [MainThread]: Flushing usage events
[0m12:07:53.699538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bd7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bd7b10>]}


============================== 12:07:53.702414 | ae01ab26-b4b5-41ca-aa69-9686230d076b ==============================
[0m12:07:53.702414 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:07:53.702732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:07:53.753077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae01ab26-b4b5-41ca-aa69-9686230d076b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b7f360>]}
[0m12:07:53.762984 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.100667454, "process_in_blocks": "0", "process_kernel_time": 0.125838, "process_mem_max_rss": "98566144", "process_out_blocks": "0", "process_user_time": 0.651958}
[0m12:07:53.763265 [debug] [MainThread]: Command `dbt clean` succeeded at 12:07:53.763209 after 0.10 seconds
[0m12:07:53.763423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e02580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e02690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aa6950>]}
[0m12:07:53.763577 [debug] [MainThread]: Flushing usage events
[0m20:10:25.929341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca10a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c46eff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dff57c0>]}


============================== 20:10:25.933849 | 540fa02c-122d-4916-8d63-a09afa8a6045 ==============================
[0m20:10:25.933849 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:10:25.934424 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/weather_dbt', 'log_path': '/opt/airflow/weather_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/weather_dbt --project-dir /opt/airflow/weather_dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:10:26.393415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '540fa02c-122d-4916-8d63-a09afa8a6045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80459ee0>]}
[0m20:10:26.423580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '540fa02c-122d-4916-8d63-a09afa8a6045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d7dc4a0>]}
[0m20:10:26.424422 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:10:26.477706 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:10:26.478388 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:10:26.479035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '540fa02c-122d-4916-8d63-a09afa8a6045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1d3b90>]}
[0m20:10:27.106365 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:10:27.107662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '540fa02c-122d-4916-8d63-a09afa8a6045', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1d3da0>]}
[0m20:10:27.286282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '540fa02c-122d-4916-8d63-a09afa8a6045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b11b0e0>]}
[0m20:10:27.354291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '540fa02c-122d-4916-8d63-a09afa8a6045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b954350>]}
[0m20:10:27.354648 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m20:10:27.355201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '540fa02c-122d-4916-8d63-a09afa8a6045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d2c2cf0>]}
[0m20:10:27.356500 [info ] [MainThread]: 
[0m20:10:27.357458 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:10:27.359847 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_weather'
[0m20:10:27.366730 [debug] [ThreadPool]: Using snowflake connection "list_weather"
[0m20:10:27.367066 [debug] [ThreadPool]: On list_weather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_weather"} */
show terse schemas in database weather
    limit 10000
[0m20:10:27.367389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:27.929028 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.561 seconds
[0m20:10:27.931584 [debug] [ThreadPool]: On list_weather: Close
[0m20:10:28.061567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather, now list_weather_analytics)
[0m20:10:28.074076 [debug] [ThreadPool]: Using snowflake connection "list_weather_analytics"
[0m20:10:28.074966 [debug] [ThreadPool]: On list_weather_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_weather_analytics"} */
show objects in weather.analytics limit 10000
[0m20:10:28.075834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:28.623905 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.548 seconds
[0m20:10:28.625526 [debug] [ThreadPool]: On list_weather_analytics: Close
[0m20:10:28.764428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_analytics, now list_weather_snapshot)
[0m20:10:28.768644 [debug] [ThreadPool]: Using snowflake connection "list_weather_snapshot"
[0m20:10:28.769311 [debug] [ThreadPool]: On list_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_weather_snapshot"} */
show objects in weather.snapshot limit 10000
[0m20:10:28.769865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:29.233549 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8b3ba-0004-386b-0002-71d700067e7a
[0m20:10:29.234488 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m20:10:29.235087 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m20:10:29.235493 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:10:29.235960 [debug] [ThreadPool]: On list_weather_snapshot: Close
[0m20:10:29.394177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '540fa02c-122d-4916-8d63-a09afa8a6045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d7e810>]}
[0m20:10:29.396496 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m20:10:29.397520 [info ] [MainThread]: 
[0m20:10:29.412325 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m20:10:29.413869 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m20:10:29.415328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_weather_snapshot, now model.weather_dbt.daily_avg_weather_trend)
[0m20:10:29.416184 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m20:10:29.424508 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m20:10:29.428186 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m20:10:29.449885 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m20:10:29.452080 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m20:10:29.452383 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table weather.analytics.daily_avg_weather_trend
         as
        (WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m20:10:29.452648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:29.925842 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b3ba-0004-3863-0002-71d70006be46
[0m20:10:29.927108 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'OPENWEATHER' does not exist or not authorized.
[0m20:10:29.928090 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m20:10:30.045140 [debug] [Thread-1 (]: Database Error in model daily_avg_weather_trend (models/output/daily_avg_weather_trend.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/output/daily_avg_weather_trend.sql
[0m20:10:30.047348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '540fa02c-122d-4916-8d63-a09afa8a6045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca12570>]}
[0m20:10:30.048288 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model analytics.daily_avg_weather_trend ........ [[31mERROR[0m in 0.63s]
[0m20:10:30.049098 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m20:10:30.050302 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m20:10:30.052009 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m20:10:30.052902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m20:10:30.053575 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m20:10:30.059397 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m20:10:30.061119 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m20:10:30.063906 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m20:10:30.066738 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m20:10:30.067291 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table weather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m20:10:30.067651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:30.568741 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b3ba-0004-3864-0002-71d70006f98a
[0m20:10:30.569826 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'OPENWEATHER' does not exist or not authorized.
[0m20:10:30.570626 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m20:10:30.749138 [debug] [Thread-1 (]: Database Error in model extreme_weather_events (models/output/extreme_weather_events.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/output/extreme_weather_events.sql
[0m20:10:30.750105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '540fa02c-122d-4916-8d63-a09afa8a6045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bd6c170>]}
[0m20:10:30.751137 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model analytics.extreme_weather_events ......... [[31mERROR[0m in 0.70s]
[0m20:10:30.752330 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m20:10:30.753348 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m20:10:30.754226 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m20:10:30.754956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m20:10:30.755586 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m20:10:30.759187 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m20:10:30.760685 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m20:10:30.763028 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m20:10:30.764611 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m20:10:30.765201 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table weather.analytics.hourly_weather_patterns
         as
        (WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    *
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY
        );
[0m20:10:30.765781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:31.179294 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b3ba-0004-3864-0002-71d70006f98e
[0m20:10:31.180980 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'OPENWEATHER' does not exist or not authorized.
[0m20:10:31.182152 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m20:10:31.309429 [debug] [Thread-1 (]: Database Error in model hourly_weather_patterns (models/output/hourly_weather_patterns.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/output/hourly_weather_patterns.sql
[0m20:10:31.310853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '540fa02c-122d-4916-8d63-a09afa8a6045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bcd7a10>]}
[0m20:10:31.311944 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model analytics.hourly_weather_patterns ........ [[31mERROR[0m in 0.56s]
[0m20:10:31.312912 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m20:10:31.313811 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m20:10:31.314729 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m20:10:31.316140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m20:10:31.316887 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m20:10:31.320886 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m20:10:31.323063 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m20:10:31.343499 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m20:10:31.345590 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m20:10:31.345960 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view weather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m20:10:31.346294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:31.881277 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b3ba-0004-3863-0002-71d70006be4a
[0m20:10:31.882340 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'OPENWEATHER' does not exist or not authorized.
[0m20:10:31.883189 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m20:10:32.018036 [debug] [Thread-1 (]: Database Error in model openweather_join (models/input/openweather_join.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/input/openweather_join.sql
[0m20:10:32.019323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '540fa02c-122d-4916-8d63-a09afa8a6045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bcd62d0>]}
[0m20:10:32.020555 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model analytics.openweather_join ................ [[31mERROR[0m in 0.70s]
[0m20:10:32.021765 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m20:10:32.022989 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m20:10:32.023989 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m20:10:32.024943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m20:10:32.025771 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m20:10:32.029884 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m20:10:32.031519 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m20:10:32.034344 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m20:10:32.036625 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m20:10:32.037324 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table weather.analytics.weather_condition_freq
         as
        (WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    *
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME
        );
[0m20:10:32.037982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:10:32.488333 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b3ba-0004-3869-0002-71d70006cd5a
[0m20:10:32.490057 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'OPENWEATHER' does not exist or not authorized.
[0m20:10:32.491211 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m20:10:32.611346 [debug] [Thread-1 (]: Database Error in model weather_condition_freq (models/output/weather_condition_freq.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/output/weather_condition_freq.sql
[0m20:10:32.612327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '540fa02c-122d-4916-8d63-a09afa8a6045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a5466f0>]}
[0m20:10:32.613333 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model analytics.weather_condition_freq ......... [[31mERROR[0m in 0.59s]
[0m20:10:32.614213 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m20:10:32.616995 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:32.617787 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m20:10:32.618474 [info ] [MainThread]: 
[0m20:10:32.619069 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 5.26 seconds (5.26s).
[0m20:10:32.620813 [debug] [MainThread]: Command end result
[0m20:10:32.658032 [info ] [MainThread]: 
[0m20:10:32.658497 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m20:10:32.659007 [info ] [MainThread]: 
[0m20:10:32.659593 [error] [MainThread]:   Database Error in model daily_avg_weather_trend (models/output/daily_avg_weather_trend.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/output/daily_avg_weather_trend.sql
[0m20:10:32.660007 [info ] [MainThread]: 
[0m20:10:32.660377 [error] [MainThread]:   Database Error in model extreme_weather_events (models/output/extreme_weather_events.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/output/extreme_weather_events.sql
[0m20:10:32.660979 [info ] [MainThread]: 
[0m20:10:32.661650 [error] [MainThread]:   Database Error in model hourly_weather_patterns (models/output/hourly_weather_patterns.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/output/hourly_weather_patterns.sql
[0m20:10:32.662005 [info ] [MainThread]: 
[0m20:10:32.662776 [error] [MainThread]:   Database Error in model openweather_join (models/input/openweather_join.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/input/openweather_join.sql
[0m20:10:32.663092 [info ] [MainThread]: 
[0m20:10:32.664024 [error] [MainThread]:   Database Error in model weather_condition_freq (models/output/weather_condition_freq.sql)
  002003 (02000): SQL compilation error:
  Database 'OPENWEATHER' does not exist or not authorized.
  compiled code at target/run/weather_dbt/models/output/weather_condition_freq.sql
[0m20:10:32.664441 [info ] [MainThread]: 
[0m20:10:32.665200 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 TOTAL=5
[0m20:10:32.666098 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.8022423, "process_user_time": 3.514489, "process_kernel_time": 0.22606, "process_mem_max_rss": "214120", "process_out_blocks": "3022", "command_success": false, "process_in_blocks": "0"}
[0m20:10:32.666542 [debug] [MainThread]: Command `dbt run` failed at 20:10:32.666471 after 6.80 seconds
[0m20:10:32.666856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ce54c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c55f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c55e900>]}
[0m20:10:32.667227 [debug] [MainThread]: Flushing usage events
[0m20:11:50.467358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c187e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c187b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c187d10>]}


============================== 20:11:50.471198 | adf89a75-572e-4e41-b187-58073658b33a ==============================
[0m20:11:50.471198 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:11:50.471932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/weather_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/weather_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/weather_dbt --project-dir /opt/airflow/weather_dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:11:50.889900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adf89a75-572e-4e41-b187-58073658b33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80322c30>]}
[0m20:11:50.913795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adf89a75-572e-4e41-b187-58073658b33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d31a30>]}
[0m20:11:50.914281 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:11:50.964046 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:11:51.025353 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:11:51.026089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'adf89a75-572e-4e41-b187-58073658b33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c9c4da0>]}
[0m20:11:51.585991 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:11:51.587059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'adf89a75-572e-4e41-b187-58073658b33a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98962a50>]}
[0m20:11:51.707153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adf89a75-572e-4e41-b187-58073658b33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80121b50>]}
[0m20:11:51.772895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adf89a75-572e-4e41-b187-58073658b33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bba3bc0>]}
[0m20:11:51.773247 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m20:11:51.773799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adf89a75-572e-4e41-b187-58073658b33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ee207d0>]}
[0m20:11:51.774968 [info ] [MainThread]: 
[0m20:11:51.775767 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:11:51.778347 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m20:11:51.785596 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m20:11:51.785992 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m20:11:51.786261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:52.191163 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m20:11:52.192214 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:11:52.192890 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m20:11:52.193435 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:11:52.194202 [debug] [ThreadPool]: On list_openweather: No close available on handle
[0m20:11:52.195260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:11:52.195833 [debug] [MainThread]: Connection 'list_openweather' was properly closed.
[0m20:11:52.196320 [info ] [MainThread]: 
[0m20:11:52.196889 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m20:11:52.198151 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "openweather"
  Database Error
    250001 (08001): Failed to connect to DB: ngcpqde-qub95232.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m20:11:52.200137 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.7778378, "process_user_time": 2.866414, "process_kernel_time": 0.122188, "process_mem_max_rss": "212180", "process_out_blocks": "1989", "command_success": false, "process_in_blocks": "0"}
[0m20:11:52.201219 [debug] [MainThread]: Command `dbt run` failed at 20:11:52.201076 after 1.78 seconds
[0m20:11:52.201780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca21280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc20dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bd6c8c0>]}
[0m20:11:52.202277 [debug] [MainThread]: Flushing usage events
[0m20:13:02.647857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1607a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0dcdc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0dce210>]}


============================== 20:13:02.651588 | af7a8094-b986-42fa-80bb-868626777b13 ==============================
[0m20:13:02.651588 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:13:02.652280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/weather_dbt/logs', 'profiles_dir': '/opt/airflow/weather_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/weather_dbt --project-dir /opt/airflow/weather_dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:13:03.085504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af7a8094-b986-42fa-80bb-868626777b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff966d25a0>]}
[0m20:13:03.113599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af7a8094-b986-42fa-80bb-868626777b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94af0f80>]}
[0m20:13:03.114331 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:13:03.163594 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:13:03.242708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:13:03.243047 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:13:03.271568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af7a8094-b986-42fa-80bb-868626777b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94301b80>]}
[0m20:13:03.336949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af7a8094-b986-42fa-80bb-868626777b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff72870>]}
[0m20:13:03.337333 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m20:13:03.337872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af7a8094-b986-42fa-80bb-868626777b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ada24e0>]}
[0m20:13:03.339066 [info ] [MainThread]: 
[0m20:13:03.339655 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:13:03.342028 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m20:13:03.350066 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m20:13:03.350345 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m20:13:03.350576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:03.791943 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m20:13:03.793222 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:13:03.793975 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m20:13:03.794512 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:13:03.795154 [debug] [ThreadPool]: On list_openweather: No close available on handle
[0m20:13:03.796322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:13:03.796971 [debug] [MainThread]: Connection 'list_openweather' was properly closed.
[0m20:13:03.797551 [info ] [MainThread]: 
[0m20:13:03.798092 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m20:13:03.799708 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "openweather"
  Database Error
    250001 (08001): Failed to connect to DB: ngcpqde-qub95232.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m20:13:03.801507 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1983566, "process_user_time": 2.261098, "process_kernel_time": 0.102412, "process_mem_max_rss": "206276", "process_out_blocks": "1030", "command_success": false, "process_in_blocks": "0"}
[0m20:13:03.802767 [debug] [MainThread]: Command `dbt run` failed at 20:13:03.802642 after 1.20 seconds
[0m20:13:03.803356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0dce210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff74410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd1c7d0>]}
[0m20:13:03.803895 [debug] [MainThread]: Flushing usage events
[0m20:17:05.119574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa934de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac1e0da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac1e16d0>]}


============================== 20:17:05.123386 | 2e8e557b-a663-4fac-9bfa-c137a7ec4e81 ==============================
[0m20:17:05.123386 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:17:05.123729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/weather_dbt', 'log_path': '/opt/airflow/weather_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/weather_dbt --project-dir /opt/airflow/weather_dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:17:05.541878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e8e557b-a663-4fac-9bfa-c137a7ec4e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa83c0d40>]}
[0m20:17:05.565540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e8e557b-a663-4fac-9bfa-c137a7ec4e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f56f1d0>]}
[0m20:17:05.566024 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:17:05.615841 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:17:05.695847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:17:05.696156 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:17:05.723816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e8e557b-a663-4fac-9bfa-c137a7ec4e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d1c3230>]}
[0m20:17:05.789321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e8e557b-a663-4fac-9bfa-c137a7ec4e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ced6f90>]}
[0m20:17:05.789670 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m20:17:05.789961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e8e557b-a663-4fac-9bfa-c137a7ec4e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cf01160>]}
[0m20:17:05.791406 [info ] [MainThread]: 
[0m20:17:05.791948 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:17:05.794398 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m20:17:05.802252 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m20:17:05.802550 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m20:17:05.802770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:17:06.145153 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m20:17:06.145528 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:17:06.145822 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m20:17:06.146057 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:17:06.146293 [debug] [ThreadPool]: On list_openweather: No close available on handle
[0m20:17:06.146734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:17:06.146997 [debug] [MainThread]: Connection 'list_openweather' was properly closed.
[0m20:17:06.147219 [info ] [MainThread]: 
[0m20:17:06.147437 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m20:17:06.148025 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "openweather"
  Database Error
    250001 (08001): Failed to connect to DB: ngcpqde-qub95232.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m20:17:06.148763 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0792171, "process_user_time": 2.297025, "process_kernel_time": 0.135714, "process_mem_max_rss": "206288", "process_out_blocks": "1030", "command_success": false, "process_in_blocks": "0"}
[0m20:17:06.149457 [debug] [MainThread]: Command `dbt run` failed at 20:17:06.149381 after 1.08 seconds
[0m20:17:06.149759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa934de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ceefa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d1c3050>]}
[0m20:17:06.150004 [debug] [MainThread]: Flushing usage events
[0m20:19:13.629123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2509ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b8e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2508710>]}


============================== 20:19:13.632833 | 055277f2-42ea-4aa2-bff9-1485ae28129c ==============================
[0m20:19:13.632833 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:19:13.633474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/weather_dbt/logs', 'profiles_dir': '/opt/airflow/weather_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/weather_dbt --project-dir /opt/airflow/weather_dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:19:14.079370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '055277f2-42ea-4aa2-bff9-1485ae28129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff974904a0>]}
[0m20:19:14.103618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '055277f2-42ea-4aa2-bff9-1485ae28129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c5bf860>]}
[0m20:19:14.104118 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:19:14.152176 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:19:14.230261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:19:14.230552 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:19:14.257708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '055277f2-42ea-4aa2-bff9-1485ae28129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95cb6510>]}
[0m20:19:14.323379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '055277f2-42ea-4aa2-bff9-1485ae28129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95951b20>]}
[0m20:19:14.323777 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m20:19:14.324472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '055277f2-42ea-4aa2-bff9-1485ae28129c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97490410>]}
[0m20:19:14.325768 [info ] [MainThread]: 
[0m20:19:14.326413 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:19:14.328938 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m20:19:14.337231 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m20:19:14.337613 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m20:19:14.337867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:14.776523 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m20:19:14.777216 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:19:14.777781 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m20:19:14.778165 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:19:14.778470 [debug] [ThreadPool]: On list_openweather: No close available on handle
[0m20:19:14.778916 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:19:14.779263 [debug] [MainThread]: Connection 'list_openweather' was properly closed.
[0m20:19:14.779634 [info ] [MainThread]: 
[0m20:19:14.780013 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m20:19:14.780822 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "openweather"
  Database Error
    250001 (08001): Failed to connect to DB: ngcpqde-qub95232.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m20:19:14.782099 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1973449, "process_user_time": 2.266677, "process_kernel_time": 0.10418, "process_mem_max_rss": "206252", "process_out_blocks": "1030", "command_success": false, "process_in_blocks": "0"}
[0m20:19:14.782644 [debug] [MainThread]: Command `dbt run` failed at 20:19:14.782580 after 1.20 seconds
[0m20:19:14.782999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3375b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b525d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff958bd0a0>]}
[0m20:19:14.783436 [debug] [MainThread]: Flushing usage events
[0m20:21:57.042713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa62eb500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6306e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8153d10>]}


============================== 20:21:57.046474 | 672a25ff-d3cb-4479-9e31-4e8e51e7c66d ==============================
[0m20:21:57.046474 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:21:57.047113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/weather_dbt', 'log_path': '/opt/airflow/weather_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/weather_dbt --project-dir /opt/airflow/weather_dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:21:57.472344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '672a25ff-d3cb-4479-9e31-4e8e51e7c66d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff865b8d40>]}
[0m20:21:57.496231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '672a25ff-d3cb-4479-9e31-4e8e51e7c66d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c4c7080>]}
[0m20:21:57.496723 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:21:57.545720 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:21:57.619199 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:21:57.619513 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:21:57.646201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '672a25ff-d3cb-4479-9e31-4e8e51e7c66d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86085f10>]}
[0m20:21:57.709467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '672a25ff-d3cb-4479-9e31-4e8e51e7c66d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85da1550>]}
[0m20:21:57.709818 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m20:21:57.710417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '672a25ff-d3cb-4479-9e31-4e8e51e7c66d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff863d1160>]}
[0m20:21:57.711797 [info ] [MainThread]: 
[0m20:21:57.712560 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:21:57.715000 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m20:21:57.723049 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m20:21:57.723485 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m20:21:57.723904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:58.134007 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m20:21:58.135187 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:21:58.135983 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m20:21:58.136595 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:21:58.137252 [debug] [ThreadPool]: On list_openweather: No close available on handle
[0m20:21:58.138428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:21:58.139094 [debug] [MainThread]: Connection 'list_openweather' was properly closed.
[0m20:21:58.139806 [info ] [MainThread]: 
[0m20:21:58.140846 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m20:21:58.142387 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "openweather"
  Database Error
    250001 (08001): Failed to connect to DB: ngcpqde-qub95232.snowflakecomputing.com:443. Your user account has been temporarily locked due to too many failed attempts. Try again after 15 minutes or contact your account administrator for assistance. For more information about this error, go to https://community.snowflake.com/s/error-your-user-login-has-been-locked.
[0m20:21:58.144344 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1470013, "process_user_time": 2.249897, "process_kernel_time": 0.126274, "process_mem_max_rss": "206252", "process_out_blocks": "1030", "command_success": false, "process_in_blocks": "0"}
[0m20:21:58.145267 [debug] [MainThread]: Command `dbt run` failed at 20:21:58.145084 after 1.15 seconds
[0m20:21:58.145962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6f316a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86085f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85dcbc20>]}
[0m20:21:58.146583 [debug] [MainThread]: Flushing usage events
[0m20:22:38.988441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8abc4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b5c26c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8abc4800>]}


============================== 20:22:38.992437 | ef2f66a8-d683-429e-b515-3631a0c892b8 ==============================
[0m20:22:38.992437 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:22:38.992777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/weather_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/weather_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/weather_dbt --project-dir /opt/airflow/weather_dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:22:39.430261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef2f66a8-d683-429e-b515-3631a0c892b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ad2b290>]}
[0m20:22:39.454167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef2f66a8-d683-429e-b515-3631a0c892b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bbbbbf0>]}
[0m20:22:39.454655 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:22:39.504151 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:22:39.581269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:22:39.581645 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:22:39.609022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef2f66a8-d683-429e-b515-3631a0c892b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a2c65d0>]}
[0m20:22:39.673363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef2f66a8-d683-429e-b515-3631a0c892b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69fce510>]}
[0m20:22:39.673692 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m20:22:39.673933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef2f66a8-d683-429e-b515-3631a0c892b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69ffb5f0>]}
[0m20:22:39.675269 [info ] [MainThread]: 
[0m20:22:39.675843 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:22:39.678422 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m20:22:39.686738 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m20:22:39.687186 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m20:22:39.687567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:39.986496 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m20:22:39.987045 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:22:39.987517 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m20:22:39.987860 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:22:39.988241 [debug] [ThreadPool]: On list_openweather: No close available on handle
[0m20:22:39.988932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:22:39.989403 [debug] [MainThread]: Connection 'list_openweather' was properly closed.
[0m20:22:39.989788 [info ] [MainThread]: 
[0m20:22:39.990202 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m20:22:39.991085 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "openweather"
  Database Error
    250001 (08001): Failed to connect to DB: ngcpqde-qub95232.snowflakecomputing.com:443. Your user account has been temporarily locked due to too many failed attempts. Try again after 15 minutes or contact your account administrator for assistance. For more information about this error, go to https://community.snowflake.com/s/error-your-user-login-has-been-locked.
[0m20:22:39.992808 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0647364, "process_user_time": 2.319406, "process_kernel_time": 0.132972, "process_mem_max_rss": "206228", "process_out_blocks": "1030", "command_success": false, "process_in_blocks": "0"}
[0m20:22:39.993478 [debug] [MainThread]: Command `dbt run` failed at 20:22:39.993362 after 1.07 seconds
[0m20:22:39.993910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a6c9160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69fe7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69518500>]}
[0m20:22:39.994306 [debug] [MainThread]: Flushing usage events
[0m12:37:26.633383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064cfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064cfb10>]}


============================== 12:37:26.637526 | bfc25b51-1606-4732-8df4-4ee1d79b2989 ==============================
[0m12:37:26.637526 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:37:26.637989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:37:26.701415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfc25b51-1606-4732-8df4-4ee1d79b2989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105337360>]}
[0m12:37:26.714215 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.121494584, "process_in_blocks": "0", "process_kernel_time": 0.13182, "process_mem_max_rss": "99270656", "process_out_blocks": "0", "process_user_time": 0.640144}
[0m12:37:26.714625 [debug] [MainThread]: Command `dbt clean` succeeded at 12:37:26.714564 after 0.12 seconds
[0m12:37:26.714840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f6580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f6690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10625e950>]}
[0m12:37:26.715028 [debug] [MainThread]: Flushing usage events
[0m20:37:37.433366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae0b7b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaead74a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae610980>]}


============================== 20:37:37.437667 | 2c0b0c5a-0953-45b1-a9bf-b384f334fddf ==============================
[0m20:37:37.437667 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:37:37.438414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/weather_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/weather_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/weather_dbt --project-dir /opt/airflow/weather_dbt', 'send_anonymous_usage_stats': 'True'}
[0m20:37:37.886102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c0b0c5a-0953-45b1-a9bf-b384f334fddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94968aa0>]}
[0m20:37:37.911006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c0b0c5a-0953-45b1-a9bf-b384f334fddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff930c3080>]}
[0m20:37:37.911511 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:37:37.962833 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:37:37.963602 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:37:37.964212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2c0b0c5a-0953-45b1-a9bf-b384f334fddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91c830e0>]}
[0m20:37:38.525283 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:37:38.526305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2c0b0c5a-0953-45b1-a9bf-b384f334fddf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff915e0890>]}
[0m20:37:38.704237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c0b0c5a-0953-45b1-a9bf-b384f334fddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff911f1f70>]}
[0m20:37:38.775193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c0b0c5a-0953-45b1-a9bf-b384f334fddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91988c50>]}
[0m20:37:38.775677 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m20:37:38.776034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c0b0c5a-0953-45b1-a9bf-b384f334fddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeebec30>]}
[0m20:37:38.777565 [info ] [MainThread]: 
[0m20:37:38.778386 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:37:38.780863 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m20:37:38.788130 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m20:37:38.788504 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m20:37:38.788719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:39.189953 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m20:37:39.191259 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:37:39.193074 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m20:37:39.194007 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:37:39.195626 [debug] [ThreadPool]: On list_openweather: No close available on handle
[0m20:37:39.196908 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:37:39.197661 [debug] [MainThread]: Connection 'list_openweather' was properly closed.
[0m20:37:39.198394 [info ] [MainThread]: 
[0m20:37:39.199122 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m20:37:39.200303 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "openweather"
  Database Error
    250001 (08001): Failed to connect to DB: ngcpqde-qub95232.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m20:37:39.201948 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.8169017, "process_user_time": 2.902957, "process_kernel_time": 0.180121, "process_mem_max_rss": "212168", "process_out_blocks": "1989", "command_success": false, "process_in_blocks": "0"}
[0m20:37:39.202958 [debug] [MainThread]: Command `dbt run` failed at 20:37:39.202847 after 1.82 seconds
[0m20:37:39.203428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadeb5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91554680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91555f70>]}
[0m20:37:39.203855 [debug] [MainThread]: Flushing usage events
[0m20:44:25.948358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a25d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff836edbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8351ef60>]}


============================== 20:44:25.952979 | 030d06e5-2ef4-4d98-affa-52904ca5b777 ==============================
[0m20:44:25.952979 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:44:25.953752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/weather_dbt', 'log_path': '/opt/airflow/weather_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/weather_dbt --project-dir /opt/airflow/weather_dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:44:26.416899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '030d06e5-2ef4-4d98-affa-52904ca5b777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65bdf2c0>]}
[0m20:44:26.441998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '030d06e5-2ef4-4d98-affa-52904ca5b777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81780dd0>]}
[0m20:44:26.442548 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:44:26.494005 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:44:26.576621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:44:26.576950 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:44:26.604757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '030d06e5-2ef4-4d98-affa-52904ca5b777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6556e150>]}
[0m20:44:26.670132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '030d06e5-2ef4-4d98-affa-52904ca5b777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6526cb30>]}
[0m20:44:26.670459 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m20:44:26.671038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '030d06e5-2ef4-4d98-affa-52904ca5b777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65296f90>]}
[0m20:44:26.672342 [info ] [MainThread]: 
[0m20:44:26.672970 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:44:26.675557 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m20:44:26.683893 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m20:44:26.684238 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m20:44:26.684471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:44:27.077250 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m20:44:27.078170 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:44:27.078744 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m20:44:27.079187 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:44:27.079734 [debug] [ThreadPool]: On list_openweather: No close available on handle
[0m20:44:27.080616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:44:27.081198 [debug] [MainThread]: Connection 'list_openweather' was properly closed.
[0m20:44:27.081766 [info ] [MainThread]: 
[0m20:44:27.082254 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m20:44:27.083022 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "openweather"
  Database Error
    250001 (08001): Failed to connect to DB: ngcpqde-qub95232.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m20:44:27.085301 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1848539, "process_user_time": 2.317362, "process_kernel_time": 0.163813, "process_mem_max_rss": "206268", "process_out_blocks": "1030", "command_success": false, "process_in_blocks": "0"}
[0m20:44:27.086163 [debug] [MainThread]: Command `dbt run` failed at 20:44:27.086018 after 1.19 seconds
[0m20:44:27.086682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85e0aa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff663921e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65283f80>]}
[0m20:44:27.087169 [debug] [MainThread]: Flushing usage events
[0m20:47:22.823129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba1e1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb421130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8da7c50>]}


============================== 20:47:22.827154 | ae000a73-91fa-402e-9e87-84b5678935dd ==============================
[0m20:47:22.827154 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:47:22.827869 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/weather_dbt/logs', 'profiles_dir': '/opt/airflow/weather_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/weather_dbt --project-dir /opt/airflow/weather_dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:47:23.266173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae000a73-91fa-402e-9e87-84b5678935dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb859d8b0>]}
[0m20:47:23.294230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae000a73-91fa-402e-9e87-84b5678935dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e827560>]}
[0m20:47:23.294791 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:47:23.345972 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:47:23.426083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:47:23.426406 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:47:23.453639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae000a73-91fa-402e-9e87-84b5678935dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c4b0e90>]}
[0m20:47:23.523690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae000a73-91fa-402e-9e87-84b5678935dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1ae5a0>]}
[0m20:47:23.524030 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m20:47:23.524584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae000a73-91fa-402e-9e87-84b5678935dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1db650>]}
[0m20:47:23.525857 [info ] [MainThread]: 
[0m20:47:23.526656 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:47:23.529119 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m20:47:23.537224 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m20:47:23.537507 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m20:47:23.537721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:23.902265 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m20:47:23.903252 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:47:23.903859 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m20:47:23.904647 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:47:23.905288 [debug] [ThreadPool]: On list_openweather: No close available on handle
[0m20:47:23.906396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:47:23.907153 [debug] [MainThread]: Connection 'list_openweather' was properly closed.
[0m20:47:23.907697 [info ] [MainThread]: 
[0m20:47:23.908174 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m20:47:23.908934 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "openweather"
  Database Error
    250001 (08001): Failed to connect to DB: ngcpqde-qub95232.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m20:47:23.910694 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1335171, "process_user_time": 2.263962, "process_kernel_time": 0.175229, "process_mem_max_rss": "206228", "process_out_blocks": "1030", "command_success": false, "process_in_blocks": "0"}
[0m20:47:23.911641 [debug] [MainThread]: Command `dbt run` failed at 20:47:23.911460 after 1.13 seconds
[0m20:47:23.912188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba1e1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1c7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97f24380>]}
[0m20:47:23.912682 [debug] [MainThread]: Flushing usage events
[0m20:49:49.919773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9e6f9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba1bf380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9e6fdd0>]}


============================== 20:49:49.923694 | b09ef3a7-37aa-4d26-a688-236330b51c58 ==============================
[0m20:49:49.923694 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:49:49.924380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/weather_dbt/logs', 'profiles_dir': '/opt/airflow/weather_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/weather_dbt --project-dir /opt/airflow/weather_dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:49:50.344887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b09ef3a7-37aa-4d26-a688-236330b51c58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb597bf0>]}
[0m20:49:50.368856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b09ef3a7-37aa-4d26-a688-236330b51c58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb99d8080>]}
[0m20:49:50.369369 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:49:50.420034 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:49:50.498872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:49:50.499226 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:49:50.526947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b09ef3a7-37aa-4d26-a688-236330b51c58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e2ec60>]}
[0m20:49:50.591833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b09ef3a7-37aa-4d26-a688-236330b51c58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff999b1880>]}
[0m20:49:50.592183 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m20:49:50.592699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b09ef3a7-37aa-4d26-a688-236330b51c58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99cb1a90>]}
[0m20:49:50.593877 [info ] [MainThread]: 
[0m20:49:50.594533 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:49:50.597073 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m20:49:50.604816 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m20:49:50.605150 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m20:49:50.605521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:50.925346 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m20:49:50.926074 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:49:50.926555 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m20:49:50.926918 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:49:50.927315 [debug] [ThreadPool]: On list_openweather: No close available on handle
[0m20:49:50.928021 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:50.928445 [debug] [MainThread]: Connection 'list_openweather' was properly closed.
[0m20:49:50.928827 [info ] [MainThread]: 
[0m20:49:50.929247 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m20:49:50.930319 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "openweather"
  Database Error
    250001 (08001): Failed to connect to DB: ngcpqde-qub95232.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m20:49:50.931785 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0573843, "process_user_time": 2.221715, "process_kernel_time": 0.11709, "process_mem_max_rss": "206296", "process_out_blocks": "1030", "command_success": false, "process_in_blocks": "0"}
[0m20:49:50.932426 [debug] [MainThread]: Command `dbt run` failed at 20:49:50.932307 after 1.06 seconds
[0m20:49:50.932883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba0650a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99be1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f24770>]}
[0m20:49:50.933291 [debug] [MainThread]: Flushing usage events
[0m12:50:59.262129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103218d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b1bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b1bb10>]}


============================== 12:50:59.264874 | 9015488e-9134-4aa5-bdc9-141b9df546ac ==============================
[0m12:50:59.264874 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:50:59.265195 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m12:50:59.318671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9015488e-9134-4aa5-bdc9-141b9df546ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103987360>]}
[0m12:50:59.328326 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.102510415, "process_in_blocks": "0", "process_kernel_time": 0.120368, "process_mem_max_rss": "99647488", "process_out_blocks": "0", "process_user_time": 0.609311}
[0m12:50:59.328631 [debug] [MainThread]: Command `dbt clean` succeeded at 12:50:59.328575 after 0.10 seconds
[0m12:50:59.328792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c46580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c46690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ae950>]}
[0m12:50:59.328944 [debug] [MainThread]: Flushing usage events
[0m12:51:21.912656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107113b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107113d90>]}


============================== 12:51:21.915500 | 8486b24e-d072-472c-bd85-9f47ee3f6097 ==============================
[0m12:51:21.915500 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:51:21.915847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:51:22.157994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8486b24e-d072-472c-bd85-9f47ee3f6097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11087ab10>]}
[0m12:51:22.183391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8486b24e-d072-472c-bd85-9f47ee3f6097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11087c050>]}
[0m12:51:22.185020 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:51:22.247574 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:51:22.248119 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:51:22.248317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8486b24e-d072-472c-bd85-9f47ee3f6097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110770a50>]}
[0m12:51:22.848358 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:51:22.848705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8486b24e-d072-472c-bd85-9f47ee3f6097', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d2bd40>]}
[0m12:51:22.973261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8486b24e-d072-472c-bd85-9f47ee3f6097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f1e5f0>]}
[0m12:51:23.037916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8486b24e-d072-472c-bd85-9f47ee3f6097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112453c70>]}
[0m12:51:23.038230 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m12:51:23.038399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8486b24e-d072-472c-bd85-9f47ee3f6097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112482150>]}
[0m12:51:23.039440 [info ] [MainThread]: 
[0m12:51:23.039731 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:51:23.041807 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m12:51:23.048578 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m12:51:23.048805 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m12:51:23.048944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:23.433769 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m12:51:23.434226 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:51:23.434552 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m12:51:23.434759 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:51:23.435039 [debug] [ThreadPool]: On list_openweather: No close available on handle
[0m12:51:23.435760 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:23.436021 [debug] [MainThread]: Connection 'list_openweather' was properly closed.
[0m12:51:23.436282 [info ] [MainThread]: 
[0m12:51:23.436546 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m12:51:23.436928 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "openweather"
  Database Error
    250001 (08001): Failed to connect to DB: ngcpqde-qub95232.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m12:51:23.438855 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5619888, "process_in_blocks": "0", "process_kernel_time": 0.209237, "process_mem_max_rss": "142721024", "process_out_blocks": "0", "process_user_time": 1.574992}
[0m12:51:23.439315 [debug] [MainThread]: Command `dbt run` failed at 12:51:23.439236 after 1.56 seconds
[0m12:51:23.439605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126a76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112762530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127623f0>]}
[0m12:51:23.439895 [debug] [MainThread]: Flushing usage events
[0m20:53:15.661556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bccbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c51ecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bccbe00>]}


============================== 20:53:15.665351 | ff9fbb01-460e-4a48-98e2-f15975512c31 ==============================
[0m20:53:15.665351 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:53:15.665974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/weather_dbt/logs', 'profiles_dir': '/opt/airflow/weather_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/weather_dbt --project-dir /opt/airflow/weather_dbt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:53:16.084756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff9fbb01-460e-4a48-98e2-f15975512c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61867ad0>]}
[0m20:53:16.110526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff9fbb01-460e-4a48-98e2-f15975512c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5bd070e0>]}
[0m20:53:16.111101 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:53:16.161575 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:53:16.223360 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:53:16.224119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ff9fbb01-460e-4a48-98e2-f15975512c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b378e00>]}
[0m20:53:16.796479 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:53:16.796992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ff9fbb01-460e-4a48-98e2-f15975512c31', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ba80980>]}
[0m20:53:16.922761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff9fbb01-460e-4a48-98e2-f15975512c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ad161e0>]}
[0m20:53:16.989454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff9fbb01-460e-4a48-98e2-f15975512c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5a911e50>]}
[0m20:53:16.989913 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m20:53:16.990484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff9fbb01-460e-4a48-98e2-f15975512c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b5ae5d0>]}
[0m20:53:16.991725 [info ] [MainThread]: 
[0m20:53:16.992258 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:53:16.995049 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m20:53:17.002107 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m20:53:17.002723 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m20:53:17.003034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:17.366239 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m20:53:17.367301 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:53:17.367969 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m20:53:17.368503 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:53:17.369127 [debug] [ThreadPool]: On list_openweather: No close available on handle
[0m20:53:17.370135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:53:17.370805 [debug] [MainThread]: Connection 'list_openweather' was properly closed.
[0m20:53:17.371439 [info ] [MainThread]: 
[0m20:53:17.371998 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m20:53:17.372971 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "openweather"
  Database Error
    250001 (08001): Failed to connect to DB: ngcpqde-qub95232.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m20:53:17.374651 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.757675, "process_user_time": 2.880972, "process_kernel_time": 0.110845, "process_mem_max_rss": "212136", "process_out_blocks": "1989", "command_success": false, "process_in_blocks": "0"}
[0m20:53:17.376025 [debug] [MainThread]: Command `dbt run` failed at 20:53:17.375878 after 1.76 seconds
[0m20:53:17.376665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c09ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bf0bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b5acad0>]}
[0m20:53:17.377245 [debug] [MainThread]: Flushing usage events
[0m12:53:31.369784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025a4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ecfb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ecfd90>]}


============================== 12:53:31.373238 | 9fcd56ac-5571-4e72-9235-ba3f539fa8a1 ==============================
[0m12:53:31.373238 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:53:31.373602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:53:31.624334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fcd56ac-5571-4e72-9235-ba3f539fa8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b1ab10>]}
[0m12:53:31.648990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fcd56ac-5571-4e72-9235-ba3f539fa8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b1c050>]}
[0m12:53:31.649731 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:53:31.709829 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:53:31.774130 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m12:53:31.774432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9fcd56ac-5571-4e72-9235-ba3f539fa8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eec350>]}
[0m12:53:32.328713 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:53:32.329014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9fcd56ac-5571-4e72-9235-ba3f539fa8a1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eda8a0>]}
[0m12:53:32.447656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fcd56ac-5571-4e72-9235-ba3f539fa8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051f0750>]}
[0m12:53:32.511997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fcd56ac-5571-4e72-9235-ba3f539fa8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d3d090>]}
[0m12:53:32.512311 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m12:53:32.512482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fcd56ac-5571-4e72-9235-ba3f539fa8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10528ec90>]}
[0m12:53:32.513541 [info ] [MainThread]: 
[0m12:53:32.513836 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:53:32.516012 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m12:53:32.522737 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m12:53:32.522961 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m12:53:32.523100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:33.078834 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.555 seconds
[0m12:53:33.083002 [debug] [ThreadPool]: On list_openweather: Close
[0m12:53:33.232963 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m12:53:33.245030 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m12:53:33.245410 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m12:53:33.245697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:33.790228 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.544 seconds
[0m12:53:33.794526 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m12:53:33.922230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m12:53:33.926739 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m12:53:33.927221 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m12:53:33.927603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:34.466304 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.539 seconds
[0m12:53:34.468889 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m12:53:34.601284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fcd56ac-5571-4e72-9235-ba3f539fa8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052e7490>]}
[0m12:53:34.601826 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m12:53:34.602110 [info ] [MainThread]: 
[0m12:53:34.605841 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m12:53:34.606498 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m12:53:34.606930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now model.weather_dbt.daily_avg_weather_trend)
[0m12:53:34.607235 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m12:53:34.613386 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m12:53:34.614503 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m12:53:34.634650 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m12:53:34.636167 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m12:53:34.636481 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m12:53:34.636704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:36.698719 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.062 seconds
[0m12:53:36.718151 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m12:53:36.901154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fcd56ac-5571-4e72-9235-ba3f539fa8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103493a70>]}
[0m12:53:36.902386 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 2.29s]
[0m12:53:36.903134 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m12:53:36.903660 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m12:53:36.904313 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m12:53:36.904928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m12:53:36.905362 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m12:53:36.909336 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m12:53:36.910551 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m12:53:36.913849 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m12:53:36.916049 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m12:53:36.916478 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m12:53:36.916815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:38.659956 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.742 seconds
[0m12:53:38.664827 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m12:53:38.792510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fcd56ac-5571-4e72-9235-ba3f539fa8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052a1b50>]}
[0m12:53:38.793691 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.89s]
[0m12:53:38.794395 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m12:53:38.794888 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m12:53:38.795537 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m12:53:38.796120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m12:53:38.796494 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m12:53:38.799943 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m12:53:38.801348 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m12:53:38.804593 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m12:53:38.806196 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m12:53:38.806636 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    *
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY
        );
[0m12:53:38.806976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:40.283489 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.476 seconds
[0m12:53:40.288544 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m12:53:40.460347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fcd56ac-5571-4e72-9235-ba3f539fa8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10555fa10>]}
[0m12:53:40.461417 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.hourly_weather_patterns ............ [[32mSUCCESS 1[0m in 1.66s]
[0m12:53:40.462189 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m12:53:40.462676 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m12:53:40.463217 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m12:53:40.463734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m12:53:40.464124 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m12:53:40.468232 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m12:53:40.469704 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m12:53:40.494774 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m12:53:40.495947 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m12:53:40.496225 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m12:53:40.496472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:41.311547 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.814 seconds
[0m12:53:41.316814 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m12:53:41.456194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fcd56ac-5571-4e72-9235-ba3f539fa8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105567590>]}
[0m12:53:41.457845 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.99s]
[0m12:53:41.458598 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m12:53:41.459013 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m12:53:41.459579 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m12:53:41.460040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m12:53:41.460343 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m12:53:41.463389 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m12:53:41.464349 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m12:53:41.467168 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m12:53:41.468400 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m12:53:41.468683 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    *
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME
        );
[0m12:53:41.468938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:42.533811 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.065 seconds
[0m12:53:42.536696 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m12:53:42.658087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fcd56ac-5571-4e72-9235-ba3f539fa8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1015aac90>]}
[0m12:53:42.658717 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.20s]
[0m12:53:42.659158 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m12:53:42.660109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:42.660377 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m12:53:42.660659 [info ] [MainThread]: 
[0m12:53:42.660876 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 10.15 seconds (10.15s).
[0m12:53:42.661615 [debug] [MainThread]: Command end result
[0m12:53:42.681254 [info ] [MainThread]: 
[0m12:53:42.681531 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:53:42.681707 [info ] [MainThread]: 
[0m12:53:42.681889 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:53:42.683217 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.353211, "process_in_blocks": "0", "process_kernel_time": 0.285729, "process_mem_max_rss": "147881984", "process_out_blocks": "0", "process_user_time": 2.191978}
[0m12:53:42.683514 [debug] [MainThread]: Command `dbt run` succeeded at 12:53:42.683463 after 11.35 seconds
[0m12:53:42.683720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d2d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054c34d0>]}
[0m12:53:42.683911 [debug] [MainThread]: Flushing usage events
[0m12:53:48.005606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105328d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2fd90>]}


============================== 12:53:48.008314 | 853940ee-3272-473f-aea2-397ef39a9822 ==============================
[0m12:53:48.008314 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:53:48.008633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m12:53:48.058855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '853940ee-3272-473f-aea2-397ef39a9822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a97360>]}
[0m12:53:48.066731 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.098407164, "process_in_blocks": "0", "process_kernel_time": 0.088826, "process_mem_max_rss": "99483648", "process_out_blocks": "0", "process_user_time": 0.617206}
[0m12:53:48.067007 [debug] [MainThread]: Command `dbt clean` succeeded at 12:53:48.066958 after 0.10 seconds
[0m12:53:48.067177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d56580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d56690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069be950>]}
[0m12:53:48.067336 [debug] [MainThread]: Flushing usage events
[0m20:55:25.831228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5560e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5562420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5562450>]}


============================== 20:55:25.835116 | 873b38a2-b914-4eb9-9540-a7c0b0304612 ==============================
[0m20:55:25.835116 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:55:25.835923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/weather_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/weather_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/weather_dbt --project-dir /opt/airflow/weather_dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:55:26.247030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '873b38a2-b914-4eb9-9540-a7c0b0304612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89812270>]}
[0m20:55:26.270733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '873b38a2-b914-4eb9-9540-a7c0b0304612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff899a7530>]}
[0m20:55:26.271208 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:55:26.321192 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:55:26.321955 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:55:26.322549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '873b38a2-b914-4eb9-9540-a7c0b0304612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5194290>]}
[0m20:55:26.885525 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:55:26.886544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '873b38a2-b914-4eb9-9540-a7c0b0304612', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f04bc0>]}
[0m20:55:27.063758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '873b38a2-b914-4eb9-9540-a7c0b0304612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b670fe0>]}
[0m20:55:27.151116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '873b38a2-b914-4eb9-9540-a7c0b0304612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89039100>]}
[0m20:55:27.151501 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m20:55:27.152044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '873b38a2-b914-4eb9-9540-a7c0b0304612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b91820>]}
[0m20:55:27.153463 [info ] [MainThread]: 
[0m20:55:27.154011 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:55:27.156588 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m20:55:27.163699 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m20:55:27.164114 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m20:55:27.164482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:27.510479 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m20:55:27.511375 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:55:27.511936 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m20:55:27.512368 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:55:27.512875 [debug] [ThreadPool]: On list_openweather: No close available on handle
[0m20:55:27.513740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:55:27.514276 [debug] [MainThread]: Connection 'list_openweather' was properly closed.
[0m20:55:27.514816 [info ] [MainThread]: 
[0m20:55:27.515363 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m20:55:27.516618 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "openweather"
  Database Error
    250001 (08001): Failed to connect to DB: ngcpqde-qub95232.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m20:55:27.518476 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.7296662, "process_user_time": 2.836655, "process_kernel_time": 0.117778, "process_mem_max_rss": "212124", "process_out_blocks": "1989", "command_success": false, "process_in_blocks": "0"}
[0m20:55:27.519338 [debug] [MainThread]: Command `dbt run` failed at 20:55:27.519233 after 1.73 seconds
[0m20:55:27.519846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa56c7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88be7d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8906e9f0>]}
[0m20:55:27.520341 [debug] [MainThread]: Flushing usage events
[0m21:00:47.407208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff869c7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86780a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff862a3a10>]}


============================== 21:00:47.411000 | d07342b3-d1a4-4e75-886a-bbabf7a8a1ff ==============================
[0m21:00:47.411000 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:00:47.411696 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/weather_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/weather_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/weather_dbt --project-dir /opt/airflow/weather_dbt', 'send_anonymous_usage_stats': 'True'}
[0m21:00:47.825641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd07342b3-d1a4-4e75-886a-bbabf7a8a1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff661c8110>]}
[0m21:00:47.849851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd07342b3-d1a4-4e75-886a-bbabf7a8a1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67737410>]}
[0m21:00:47.850341 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:00:47.901400 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:00:47.979659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:00:47.979955 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:00:48.006778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd07342b3-d1a4-4e75-886a-bbabf7a8a1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84f63440>]}
[0m21:00:48.074882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd07342b3-d1a4-4e75-886a-bbabf7a8a1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65f22d80>]}
[0m21:00:48.075253 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m21:00:48.075912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd07342b3-d1a4-4e75-886a-bbabf7a8a1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c191310>]}
[0m21:00:48.077215 [info ] [MainThread]: 
[0m21:00:48.077869 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:00:48.080555 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m21:00:48.088368 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m21:00:48.088776 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m21:00:48.089117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:48.764400 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.675 seconds
[0m21:00:48.767523 [debug] [ThreadPool]: On list_openweather: Close
[0m21:00:48.945211 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m21:00:48.956997 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m21:00:48.957551 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m21:00:48.957980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:49.502809 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.545 seconds
[0m21:00:49.506528 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m21:00:49.653624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m21:00:49.657799 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m21:00:49.658245 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m21:00:49.658556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:50.244519 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.586 seconds
[0m21:00:50.248247 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m21:00:50.377765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd07342b3-d1a4-4e75-886a-bbabf7a8a1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65f52c00>]}
[0m21:00:50.379182 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m21:00:50.380012 [info ] [MainThread]: 
[0m21:00:50.393910 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m21:00:50.394916 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m21:00:50.395550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now model.weather_dbt.daily_avg_weather_trend)
[0m21:00:50.396692 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m21:00:50.406064 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m21:00:50.409270 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m21:00:50.430400 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m21:00:50.433065 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m21:00:50.433494 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m21:00:50.433805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:52.424214 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.990 seconds
[0m21:00:52.447930 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m21:00:52.590399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd07342b3-d1a4-4e75-886a-bbabf7a8a1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66108c20>]}
[0m21:00:52.591720 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 2.19s]
[0m21:00:52.592630 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m21:00:52.593560 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m21:00:52.594406 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m21:00:52.595700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m21:00:52.596488 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m21:00:52.600160 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m21:00:52.601980 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m21:00:52.604751 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m21:00:52.607259 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m21:00:52.607886 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m21:00:52.608414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:54.159203 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.550 seconds
[0m21:00:54.164281 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m21:00:54.350587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd07342b3-d1a4-4e75-886a-bbabf7a8a1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff658f51f0>]}
[0m21:00:54.351889 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.75s]
[0m21:00:54.352800 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m21:00:54.354088 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m21:00:54.355194 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m21:00:54.356141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m21:00:54.356976 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m21:00:54.361325 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m21:00:54.363198 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m21:00:54.366094 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m21:00:54.368440 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m21:00:54.369089 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    *
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY
        );
[0m21:00:54.369762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:55.703854 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.333 seconds
[0m21:00:55.708315 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m21:00:55.830790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd07342b3-d1a4-4e75-886a-bbabf7a8a1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64f6e420>]}
[0m21:00:55.831826 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.hourly_weather_patterns ............ [[32mSUCCESS 1[0m in 1.47s]
[0m21:00:55.832495 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m21:00:55.833504 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m21:00:55.834269 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m21:00:55.834899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m21:00:55.835489 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m21:00:55.840474 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m21:00:55.842498 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m21:00:55.859694 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m21:00:55.861615 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m21:00:55.862004 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m21:00:55.862276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:57.126934 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.264 seconds
[0m21:00:57.129964 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m21:00:57.298186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd07342b3-d1a4-4e75-886a-bbabf7a8a1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64f47380>]}
[0m21:00:57.298901 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 1.46s]
[0m21:00:57.299357 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m21:00:57.299929 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m21:00:57.300378 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m21:00:57.300822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m21:00:57.301224 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m21:00:57.303531 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m21:00:57.304535 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m21:00:57.306006 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m21:00:57.307105 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m21:00:57.307378 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    *
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME
        );
[0m21:00:57.307619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:58.697487 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.389 seconds
[0m21:00:58.701311 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m21:00:58.833648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd07342b3-d1a4-4e75-886a-bbabf7a8a1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff658bcdd0>]}
[0m21:00:58.835123 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.53s]
[0m21:00:58.836545 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m21:00:58.839197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:58.839857 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m21:00:58.840541 [info ] [MainThread]: 
[0m21:00:58.841302 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 10.76 seconds (10.76s).
[0m21:00:58.843432 [debug] [MainThread]: Command end result
[0m21:00:58.884434 [info ] [MainThread]: 
[0m21:00:58.884895 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:00:58.885269 [info ] [MainThread]: 
[0m21:00:58.885891 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:00:58.886889 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.524368, "process_user_time": 2.77266, "process_kernel_time": 0.181912, "process_mem_max_rss": "208176", "process_out_blocks": "2055", "process_in_blocks": "0"}
[0m21:00:58.887343 [debug] [MainThread]: Command `dbt run` succeeded at 21:00:58.887253 after 11.52 seconds
[0m21:00:58.887635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff869c7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65f52a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff867af6e0>]}
[0m21:00:58.887947 [debug] [MainThread]: Flushing usage events
[0m21:01:00.649955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3eaacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa43e4d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa38f4bf0>]}


============================== 21:01:00.653634 | 5bd67921-1768-41dd-b093-a5bc84ca16f6 ==============================
[0m21:01:00.653634 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:01:00.653987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/weather_dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/weather_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/weather_dbt --project-dir /opt/airflow/weather_dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:01:01.069252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bd67921-1768-41dd-b093-a5bc84ca16f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d26810>]}
[0m21:01:01.094382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bd67921-1768-41dd-b093-a5bc84ca16f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88c620c0>]}
[0m21:01:01.095048 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:01:01.145334 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:01:01.221221 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:01:01.221575 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:01:01.248821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bd67921-1768-41dd-b093-a5bc84ca16f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff833ba600>]}
[0m21:01:01.319566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bd67921-1768-41dd-b093-a5bc84ca16f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82ee8ad0>]}
[0m21:01:01.319927 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m21:01:01.320149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bd67921-1768-41dd-b093-a5bc84ca16f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8311bdd0>]}
[0m21:01:01.321389 [info ] [MainThread]: 
[0m21:01:01.321793 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:01:01.324266 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_snapshot'
[0m21:01:01.333861 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m21:01:01.334276 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m21:01:01.334543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:01.942593 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.608 seconds
[0m21:01:01.946295 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m21:01:02.081105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m21:01:02.088257 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m21:01:02.089135 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m21:01:02.089793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:01:02.710015 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.620 seconds
[0m21:01:02.714006 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m21:01:02.908607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bd67921-1768-41dd-b093-a5bc84ca16f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838bf2c0>]}
[0m21:01:02.910076 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m21:01:02.910917 [info ] [MainThread]: 
[0m21:01:02.924389 [debug] [Thread-1 (]: Began running node test.weather_dbt.duplication_record_test_daily_avg
[0m21:01:02.925299 [info ] [Thread-1 (]: 1 of 7 START test duplication_record_test_daily_avg ............................ [RUN]
[0m21:01:02.926183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now test.weather_dbt.duplication_record_test_daily_avg)
[0m21:01:02.927058 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.duplication_record_test_daily_avg
[0m21:01:02.934713 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.duplication_record_test_daily_avg"
[0m21:01:02.937029 [debug] [Thread-1 (]: Began executing node test.weather_dbt.duplication_record_test_daily_avg
[0m21:01:02.953836 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.duplication_record_test_daily_avg"
[0m21:01:02.955724 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.duplication_record_test_daily_avg"
[0m21:01:02.956209 [debug] [Thread-1 (]: On test.weather_dbt.duplication_record_test_daily_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.duplication_record_test_daily_avg"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- duplicate record test
SELECT CITY_ID, WEATHER_DATE, COUNT(*)
FROM openweather.analytics.daily_avg_weather_trend
GROUP BY CITY_ID, WEATHER_DATE
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m21:01:02.956751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:03.784849 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.828 seconds
[0m21:01:03.797819 [debug] [Thread-1 (]: On test.weather_dbt.duplication_record_test_daily_avg: Close
[0m21:01:03.923389 [info ] [Thread-1 (]: 1 of 7 PASS duplication_record_test_daily_avg .................................. [[32mPASS[0m in 1.00s]
[0m21:01:03.924868 [debug] [Thread-1 (]: Finished running node test.weather_dbt.duplication_record_test_daily_avg
[0m21:01:03.925830 [debug] [Thread-1 (]: Began running node test.weather_dbt.humidity_range_daily_avg
[0m21:01:03.926770 [info ] [Thread-1 (]: 2 of 7 START test humidity_range_daily_avg ..................................... [RUN]
[0m21:01:03.927582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.duplication_record_test_daily_avg, now test.weather_dbt.humidity_range_daily_avg)
[0m21:01:03.928451 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.humidity_range_daily_avg
[0m21:01:03.932219 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.humidity_range_daily_avg"
[0m21:01:03.934174 [debug] [Thread-1 (]: Began executing node test.weather_dbt.humidity_range_daily_avg
[0m21:01:03.936966 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.humidity_range_daily_avg"
[0m21:01:03.938800 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.humidity_range_daily_avg"
[0m21:01:03.939303 [debug] [Thread-1 (]: On test.weather_dbt.humidity_range_daily_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.humidity_range_daily_avg"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- humidity range
SELECT *
FROM openweather.analytics.daily_avg_weather_trend
WHERE AVG_HUMIDITY < 0 OR AVG_HUMIDITY > 100
      
    ) dbt_internal_test
[0m21:01:03.939744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:04.797634 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.858 seconds
[0m21:01:04.799369 [debug] [Thread-1 (]: On test.weather_dbt.humidity_range_daily_avg: Close
[0m21:01:04.939802 [info ] [Thread-1 (]: 2 of 7 PASS humidity_range_daily_avg ........................................... [[32mPASS[0m in 1.01s]
[0m21:01:04.941171 [debug] [Thread-1 (]: Finished running node test.weather_dbt.humidity_range_daily_avg
[0m21:01:04.942377 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m21:01:04.943303 [info ] [Thread-1 (]: 3 of 7 START test not_null_daily_avg_weather_trend_avg_humidity ................ [RUN]
[0m21:01:04.944109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.humidity_range_daily_avg, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07)
[0m21:01:04.944896 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m21:01:04.957439 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m21:01:04.959683 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m21:01:04.962067 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m21:01:04.963617 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m21:01:04.964092 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_humidity
from openweather.analytics.daily_avg_weather_trend
where avg_humidity is null



      
    ) dbt_internal_test
[0m21:01:04.964440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:05.745308 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.781 seconds
[0m21:01:05.746836 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: Close
[0m21:01:05.887477 [info ] [Thread-1 (]: 3 of 7 PASS not_null_daily_avg_weather_trend_avg_humidity ...................... [[32mPASS[0m in 0.94s]
[0m21:01:05.888544 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m21:01:05.889581 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m21:01:05.890469 [info ] [Thread-1 (]: 4 of 7 START test not_null_daily_avg_weather_trend_avg_temp_fahrenheit ......... [RUN]
[0m21:01:05.891360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372)
[0m21:01:05.892911 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m21:01:05.897569 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m21:01:05.899744 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m21:01:05.902278 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m21:01:05.904214 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m21:01:05.904751 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp_fahrenheit
from openweather.analytics.daily_avg_weather_trend
where avg_temp_fahrenheit is null



      
    ) dbt_internal_test
[0m21:01:05.905162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:06.451140 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.546 seconds
[0m21:01:06.454062 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: Close
[0m21:01:06.583237 [info ] [Thread-1 (]: 4 of 7 PASS not_null_daily_avg_weather_trend_avg_temp_fahrenheit ............... [[32mPASS[0m in 0.69s]
[0m21:01:06.584959 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m21:01:06.585556 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m21:01:06.586123 [info ] [Thread-1 (]: 5 of 7 START test not_null_daily_avg_weather_trend_city_id ..................... [RUN]
[0m21:01:06.586705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372, now test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790)
[0m21:01:06.587302 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m21:01:06.590807 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m21:01:06.592107 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m21:01:06.594095 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m21:01:06.596374 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m21:01:06.596893 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_id
from openweather.analytics.daily_avg_weather_trend
where city_id is null



      
    ) dbt_internal_test
[0m21:01:06.597307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:07.192586 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m21:01:07.198407 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: Close
[0m21:01:07.353248 [info ] [Thread-1 (]: 5 of 7 PASS not_null_daily_avg_weather_trend_city_id ........................... [[32mPASS[0m in 0.77s]
[0m21:01:07.354141 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m21:01:07.354778 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m21:01:07.355248 [info ] [Thread-1 (]: 6 of 7 START test not_null_daily_avg_weather_trend_weather_date ................ [RUN]
[0m21:01:07.355736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790, now test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b)
[0m21:01:07.356260 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m21:01:07.359529 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m21:01:07.361394 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m21:01:07.362939 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m21:01:07.363859 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m21:01:07.364156 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_date
from openweather.analytics.daily_avg_weather_trend
where weather_date is null



      
    ) dbt_internal_test
[0m21:01:07.364407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:07.955352 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.591 seconds
[0m21:01:07.958562 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: Close
[0m21:01:08.098247 [info ] [Thread-1 (]: 6 of 7 PASS not_null_daily_avg_weather_trend_weather_date ...................... [[32mPASS[0m in 0.74s]
[0m21:01:08.099362 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m21:01:08.099857 [debug] [Thread-1 (]: Began running node test.weather_dbt.temp_range_daily_avg
[0m21:01:08.100338 [info ] [Thread-1 (]: 7 of 7 START test temp_range_daily_avg ......................................... [RUN]
[0m21:01:08.100832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b, now test.weather_dbt.temp_range_daily_avg)
[0m21:01:08.101247 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.temp_range_daily_avg
[0m21:01:08.103284 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.temp_range_daily_avg"
[0m21:01:08.104302 [debug] [Thread-1 (]: Began executing node test.weather_dbt.temp_range_daily_avg
[0m21:01:08.106211 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.temp_range_daily_avg"
[0m21:01:08.107531 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.temp_range_daily_avg"
[0m21:01:08.107940 [debug] [Thread-1 (]: On test.weather_dbt.temp_range_daily_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.temp_range_daily_avg"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- temperature range
SELECT *
FROM openweather.analytics.daily_avg_weather_trend
WHERE AVG_TEMP_FAHRENHEIT < -50 OR AVG_TEMP_FAHRENHEIT > 130
      
    ) dbt_internal_test
[0m21:01:08.108271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:08.617935 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.509 seconds
[0m21:01:08.621472 [debug] [Thread-1 (]: On test.weather_dbt.temp_range_daily_avg: Close
[0m21:01:08.792090 [info ] [Thread-1 (]: 7 of 7 PASS temp_range_daily_avg ............................................... [[32mPASS[0m in 0.69s]
[0m21:01:08.793609 [debug] [Thread-1 (]: Finished running node test.weather_dbt.temp_range_daily_avg
[0m21:01:08.796510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:01:08.797231 [debug] [MainThread]: Connection 'test.weather_dbt.temp_range_daily_avg' was properly closed.
[0m21:01:08.797886 [info ] [MainThread]: 
[0m21:01:08.798526 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 7.48 seconds (7.48s).
[0m21:01:08.800987 [debug] [MainThread]: Command end result
[0m21:01:08.837443 [info ] [MainThread]: 
[0m21:01:08.837900 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:01:08.838215 [info ] [MainThread]: 
[0m21:01:08.838869 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m21:01:08.839781 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 8.23252, "process_user_time": 2.765967, "process_kernel_time": 0.165476, "process_mem_max_rss": "210496", "process_out_blocks": "2046", "process_in_blocks": "0"}
[0m21:01:08.840188 [debug] [MainThread]: Command `dbt test` succeeded at 21:01:08.840125 after 8.23 seconds
[0m21:01:08.840499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3497980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5e08410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa43fa510>]}
[0m21:01:08.840809 [debug] [MainThread]: Flushing usage events
[0m21:01:10.611228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838b9be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff842a2840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8382a420>]}


============================== 21:01:10.615546 | 002ba372-a829-4f8b-9fab-354ee9983fc1 ==============================
[0m21:01:10.615546 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:01:10.616050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/weather_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/weather_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/weather_dbt --project-dir /opt/airflow/weather_dbt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:01:11.050133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '002ba372-a829-4f8b-9fab-354ee9983fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83510590>]}
[0m21:01:11.077542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '002ba372-a829-4f8b-9fab-354ee9983fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63e1b080>]}
[0m21:01:11.078375 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:01:11.130088 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:01:11.209877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:01:11.210238 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:01:11.238263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '002ba372-a829-4f8b-9fab-354ee9983fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72dbf530>]}
[0m21:01:11.303872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '002ba372-a829-4f8b-9fab-354ee9983fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff637d35c0>]}
[0m21:01:11.304209 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m21:01:11.304428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '002ba372-a829-4f8b-9fab-354ee9983fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff637211f0>]}
[0m21:01:11.305647 [info ] [MainThread]: 
[0m21:01:11.306306 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:01:11.308921 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m21:01:11.316638 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m21:01:11.316924 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m21:01:11.317143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:11.824609 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.507 seconds
[0m21:01:11.828172 [debug] [ThreadPool]: On list_openweather: Close
[0m21:01:11.950645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_snapshot)
[0m21:01:11.962711 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m21:01:11.963409 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m21:01:11.963982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:01:12.500737 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.537 seconds
[0m21:01:12.505133 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m21:01:12.636914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m21:01:12.641098 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m21:01:12.641841 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m21:01:12.642288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:01:13.085680 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.443 seconds
[0m21:01:13.089297 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m21:01:13.240860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '002ba372-a829-4f8b-9fab-354ee9983fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84d754c0>]}
[0m21:01:13.242155 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m21:01:13.242701 [info ] [MainThread]: 
[0m21:01:13.255596 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_snapshot
[0m21:01:13.257163 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.daily_average_weather_snapshot .................. [RUN]
[0m21:01:13.258044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now snapshot.weather_dbt.daily_average_weather_snapshot)
[0m21:01:13.258984 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_snapshot
[0m21:01:13.269443 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_snapshot
[0m21:01:13.307783 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m21:01:13.308359 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."DAILY_AVERAGE_WEATHER_SNAPSHOT"
[0m21:01:13.308703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:13.785649 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.477 seconds
[0m21:01:13.831815 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m21:01:13.832488 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."DAILY_AVERAGE_WEATHER_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    CITY_ID,
    CITY_NAME,
    WEATHER_DATE,
    AVG_TEMP_FAHRENHEIT,
    AVG_HUMIDITY,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME


    ),

    snapshotted_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."DAILY_AVERAGE_WEATHER_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            LAST_UPDATED as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m21:01:16.074676 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.242 seconds
[0m21:01:16.080448 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m21:01:16.081172 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."DAILY_AVERAGE_WEATHER_SNAPSHOT__dbt_tmp"
[0m21:01:16.195124 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.113 seconds
[0m21:01:16.200782 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m21:01:16.201479 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."DAILY_AVERAGE_WEATHER_SNAPSHOT"
[0m21:01:16.371282 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.169 seconds
[0m21:01:16.378992 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m21:01:16.379714 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."DAILY_AVERAGE_WEATHER_SNAPSHOT__dbt_tmp"
[0m21:01:16.516204 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.135 seconds
[0m21:01:16.522241 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m21:01:16.522967 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."DAILY_AVERAGE_WEATHER_SNAPSHOT"
[0m21:01:16.625195 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.101 seconds
[0m21:01:16.633056 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m21:01:16.633607 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."DAILY_AVERAGE_WEATHER_SNAPSHOT__dbt_tmp"
[0m21:01:16.761803 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.128 seconds
[0m21:01:16.779782 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m21:01:16.780296 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
select * from (
        

    with snapshot_query as (

        



WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    CITY_ID,
    CITY_NAME,
    WEATHER_DATE,
    AVG_TEMP_FAHRENHEIT,
    AVG_HUMIDITY,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME


    ),

    snapshotted_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."DAILY_AVERAGE_WEATHER_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            LAST_UPDATED as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m21:01:17.134544 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.353 seconds
[0m21:01:17.139209 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m21:01:17.139714 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m21:01:17.263871 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.124 seconds
[0m21:01:17.264434 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m21:01:17.265914 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m21:01:17.266151 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
BEGIN
[0m21:01:17.499327 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.233 seconds
[0m21:01:17.500743 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m21:01:17.501492 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
merge into "OPENWEATHER"."SNAPSHOT"."DAILY_AVERAGE_WEATHER_SNAPSHOT" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."DAILY_AVERAGE_WEATHER_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_ID", "CITY_NAME", "WEATHER_DATE", "AVG_TEMP_FAHRENHEIT", "AVG_HUMIDITY", "LAST_UPDATED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_ID", "CITY_NAME", "WEATHER_DATE", "AVG_TEMP_FAHRENHEIT", "AVG_HUMIDITY", "LAST_UPDATED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m21:02:00.164241 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b3ed-0004-3863-0002-59430004410a
[0m21:02:00.167175 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m21:02:00.168153 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: Close
[0m21:02:00.291486 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_snapshot (snapshots/daily_average_weather_trend_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/daily_average_weather_trend_snapshot.sql
[0m21:02:00.294129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '002ba372-a829-4f8b-9fab-354ee9983fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63124380>]}
[0m21:02:00.295462 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshot.daily_average_weather_snapshot .............. [[31mERROR[0m in 47.03s]
[0m21:02:00.296838 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_snapshot
[0m21:02:00.298050 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events_snapshot
[0m21:02:00.299757 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.extreme_weather_events_snapshot ................. [RUN]
[0m21:02:00.300559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_snapshot, now snapshot.weather_dbt.extreme_weather_events_snapshot)
[0m21:02:00.301353 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events_snapshot
[0m21:02:00.306360 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events_snapshot
[0m21:02:00.311963 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m21:02:00.312716 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."EXTREME_WEATHER_EVENTS_SNAPSHOT"
[0m21:02:00.313289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:02:00.955746 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.642 seconds
[0m21:02:00.967913 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m21:02:00.968924 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."EXTREME_WEATHER_EVENTS_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    CITY_ID,
    CITY_NAME,
    DATE_TIME,
    TEMP_FAHRENHEIT,
    WIND_SPEED,
    WEATHER_ALERT,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME


    ),

    snapshotted_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."EXTREME_WEATHER_EVENTS_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            LAST_UPDATED as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m21:02:02.971569 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.002 seconds
[0m21:02:02.976555 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m21:02:02.977383 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."EXTREME_WEATHER_EVENTS_SNAPSHOT__dbt_tmp"
[0m21:02:03.088466 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.110 seconds
[0m21:02:03.095361 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m21:02:03.096062 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."EXTREME_WEATHER_EVENTS_SNAPSHOT"
[0m21:02:03.204948 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.108 seconds
[0m21:02:03.212196 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m21:02:03.212878 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."EXTREME_WEATHER_EVENTS_SNAPSHOT__dbt_tmp"
[0m21:02:03.320110 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.107 seconds
[0m21:02:03.324159 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m21:02:03.324675 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."EXTREME_WEATHER_EVENTS_SNAPSHOT"
[0m21:02:03.393832 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.069 seconds
[0m21:02:03.398585 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m21:02:03.399234 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."EXTREME_WEATHER_EVENTS_SNAPSHOT__dbt_tmp"
[0m21:02:03.509696 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.109 seconds
[0m21:02:03.517693 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m21:02:03.518464 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
select * from (
        

    with snapshot_query as (

        



WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    CITY_ID,
    CITY_NAME,
    DATE_TIME,
    TEMP_FAHRENHEIT,
    WIND_SPEED,
    WEATHER_ALERT,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME


    ),

    snapshotted_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."EXTREME_WEATHER_EVENTS_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            LAST_UPDATED as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m21:02:03.828644 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.309 seconds
[0m21:02:03.830984 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m21:02:03.831651 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m21:02:03.941569 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.109 seconds
[0m21:02:03.942622 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m21:02:03.945768 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m21:02:03.946377 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
BEGIN
[0m21:02:04.306895 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.359 seconds
[0m21:02:04.308539 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m21:02:04.309293 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
merge into "OPENWEATHER"."SNAPSHOT"."EXTREME_WEATHER_EVENTS_SNAPSHOT" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."EXTREME_WEATHER_EVENTS_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_ID", "CITY_NAME", "DATE_TIME", "TEMP_FAHRENHEIT", "WIND_SPEED", "WEATHER_ALERT", "LAST_UPDATED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_ID", "CITY_NAME", "DATE_TIME", "TEMP_FAHRENHEIT", "WIND_SPEED", "WEATHER_ALERT", "LAST_UPDATED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m21:02:37.663707 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b3ee-0004-3865-0002-59430003f19a
[0m21:02:37.665584 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m21:02:37.666197 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: Close
[0m21:02:37.785461 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events_snapshot (snapshots/extreme_weather_events_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/extreme_weather_events_snapshot.sql
[0m21:02:37.786225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '002ba372-a829-4f8b-9fab-354ee9983fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61d75af0>]}
[0m21:02:37.787053 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshot.extreme_weather_events_snapshot ............. [[31mERROR[0m in 37.49s]
[0m21:02:37.787639 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events_snapshot
[0m21:02:37.788637 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns_snapshot
[0m21:02:37.789403 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.hourly_weather_patterns_snapshot ................ [RUN]
[0m21:02:37.790056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events_snapshot, now snapshot.weather_dbt.hourly_weather_patterns_snapshot)
[0m21:02:37.790740 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns_snapshot
[0m21:02:37.794408 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns_snapshot
[0m21:02:37.798786 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m21:02:37.799500 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."HOURLY_WEATHER_PATTERNS_SNAPSHOT"
[0m21:02:37.800015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:02:38.377594 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.577 seconds
[0m21:02:38.384785 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m21:02:38.385577 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."HOURLY_WEATHER_PATTERNS_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    CITY_ID,
    CITY_NAME,
    HOUR_OF_DAY,
    AVG_TEMP_FAHRENHEIT,
    AVG_WIND_SPEED,
    AVG_HUMIDITY,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY


    ),

    snapshotted_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."HOURLY_WEATHER_PATTERNS_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            LAST_UPDATED as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m21:02:39.938828 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.552 seconds
[0m21:02:39.943979 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m21:02:39.944688 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."HOURLY_WEATHER_PATTERNS_SNAPSHOT__dbt_tmp"
[0m21:02:40.041538 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.096 seconds
[0m21:02:40.045810 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m21:02:40.046198 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."HOURLY_WEATHER_PATTERNS_SNAPSHOT"
[0m21:02:40.146067 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.099 seconds
[0m21:02:40.150635 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m21:02:40.151134 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."HOURLY_WEATHER_PATTERNS_SNAPSHOT__dbt_tmp"
[0m21:02:40.262254 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.110 seconds
[0m21:02:40.269520 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m21:02:40.270222 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."HOURLY_WEATHER_PATTERNS_SNAPSHOT"
[0m21:02:40.370914 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.099 seconds
[0m21:02:40.378742 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m21:02:40.379531 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."HOURLY_WEATHER_PATTERNS_SNAPSHOT__dbt_tmp"
[0m21:02:40.524101 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.143 seconds
[0m21:02:40.532029 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m21:02:40.532798 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
select * from (
        

    with snapshot_query as (

        



WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    CITY_ID,
    CITY_NAME,
    HOUR_OF_DAY,
    AVG_TEMP_FAHRENHEIT,
    AVG_WIND_SPEED,
    AVG_HUMIDITY,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY


    ),

    snapshotted_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."HOURLY_WEATHER_PATTERNS_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            LAST_UPDATED as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m21:02:40.863265 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.329 seconds
[0m21:02:40.866495 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m21:02:40.867060 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m21:02:40.985621 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.118 seconds
[0m21:02:40.987534 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m21:02:40.990957 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m21:02:40.991651 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
BEGIN
[0m21:02:41.144110 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m21:02:41.145367 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m21:02:41.145958 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
merge into "OPENWEATHER"."SNAPSHOT"."HOURLY_WEATHER_PATTERNS_SNAPSHOT" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."HOURLY_WEATHER_PATTERNS_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_ID", "CITY_NAME", "HOUR_OF_DAY", "AVG_TEMP_FAHRENHEIT", "AVG_WIND_SPEED", "AVG_HUMIDITY", "LAST_UPDATED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_ID", "CITY_NAME", "HOUR_OF_DAY", "AVG_TEMP_FAHRENHEIT", "AVG_WIND_SPEED", "AVG_HUMIDITY", "LAST_UPDATED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m21:02:44.640451 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b3ee-0004-386b-0002-5943000460e2
[0m21:02:44.641915 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m21:02:44.642706 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: Close
[0m21:02:44.756147 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns_snapshot (snapshots/hourly_weather_patterns_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/hourly_weather_patterns_snapshot.sql
[0m21:02:44.756666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '002ba372-a829-4f8b-9fab-354ee9983fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63125c40>]}
[0m21:02:44.757276 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshot.hourly_weather_patterns_snapshot ............ [[31mERROR[0m in 6.97s]
[0m21:02:44.757727 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns_snapshot
[0m21:02:44.758244 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency_snapshot
[0m21:02:44.758688 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.weather_conditions_frequency_snapshot ........... [RUN]
[0m21:02:44.759076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns_snapshot, now snapshot.weather_dbt.weather_conditions_frequency_snapshot)
[0m21:02:44.759396 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency_snapshot
[0m21:02:44.761807 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency_snapshot
[0m21:02:44.764236 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m21:02:44.764546 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."WEATHER_CONDITIONS_FREQUENCY_SNAPSHOT"
[0m21:02:44.764782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:02:45.139331 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.374 seconds
[0m21:02:45.145448 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m21:02:45.146047 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."WEATHER_CONDITIONS_FREQUENCY_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    CITY_ID,
    CITY_NAME,
    WEATHER_MAIN,
    CONDITION_COUNT,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME


    ),

    snapshotted_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."WEATHER_CONDITIONS_FREQUENCY_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            LAST_UPDATED as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m21:02:46.495499 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.349 seconds
[0m21:02:46.500705 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m21:02:46.501415 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."WEATHER_CONDITIONS_FREQUENCY_SNAPSHOT__dbt_tmp"
[0m21:02:46.652002 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.150 seconds
[0m21:02:46.657449 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m21:02:46.658206 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."WEATHER_CONDITIONS_FREQUENCY_SNAPSHOT"
[0m21:02:46.811047 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.152 seconds
[0m21:02:46.817075 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m21:02:46.817749 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."WEATHER_CONDITIONS_FREQUENCY_SNAPSHOT__dbt_tmp"
[0m21:02:46.917773 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.099 seconds
[0m21:02:46.922835 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m21:02:46.923408 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."WEATHER_CONDITIONS_FREQUENCY_SNAPSHOT"
[0m21:02:47.007338 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.083 seconds
[0m21:02:47.015253 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m21:02:47.015995 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."WEATHER_CONDITIONS_FREQUENCY_SNAPSHOT__dbt_tmp"
[0m21:02:47.136047 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.119 seconds
[0m21:02:47.144371 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m21:02:47.145228 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
select * from (
        

    with snapshot_query as (

        



WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    CITY_ID,
    CITY_NAME,
    WEATHER_MAIN,
    CONDITION_COUNT,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME


    ),

    snapshotted_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."WEATHER_CONDITIONS_FREQUENCY_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            LAST_UPDATED as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m21:02:47.745244 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.599 seconds
[0m21:02:47.748006 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m21:02:47.748723 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m21:02:47.833383 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.084 seconds
[0m21:02:47.834756 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m21:02:47.838463 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m21:02:47.839174 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
BEGIN
[0m21:02:47.956053 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.116 seconds
[0m21:02:47.957004 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m21:02:47.957729 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
merge into "OPENWEATHER"."SNAPSHOT"."WEATHER_CONDITIONS_FREQUENCY_SNAPSHOT" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."WEATHER_CONDITIONS_FREQUENCY_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_ID", "CITY_NAME", "WEATHER_MAIN", "CONDITION_COUNT", "LAST_UPDATED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_ID", "CITY_NAME", "WEATHER_MAIN", "CONDITION_COUNT", "LAST_UPDATED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m21:02:48.543397 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b3ee-0004-3864-0002-59430003eaf6
[0m21:02:48.545539 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m21:02:48.546392 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: Close
[0m21:02:48.685665 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency_snapshot (snapshots/weather_condition_freq_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/weather_condition_freq_snapshot.sql
[0m21:02:48.687299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '002ba372-a829-4f8b-9fab-354ee9983fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61dd4440>]}
[0m21:02:48.688798 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshot.weather_conditions_frequency_snapshot ....... [[31mERROR[0m in 3.93s]
[0m21:02:48.690134 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency_snapshot
[0m21:02:48.693153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:02:48.693903 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency_snapshot' was properly closed.
[0m21:02:48.694444 [info ] [MainThread]: 
[0m21:02:48.695116 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 1 minutes and 37.39 seconds (97.39s).
[0m21:02:48.697212 [debug] [MainThread]: Command end result
[0m21:02:48.753778 [info ] [MainThread]: 
[0m21:02:48.754211 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m21:02:48.754634 [info ] [MainThread]: 
[0m21:02:48.755223 [error] [MainThread]:   Database Error in snapshot daily_average_weather_snapshot (snapshots/daily_average_weather_trend_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/daily_average_weather_trend_snapshot.sql
[0m21:02:48.755570 [info ] [MainThread]: 
[0m21:02:48.756527 [error] [MainThread]:   Database Error in snapshot extreme_weather_events_snapshot (snapshots/extreme_weather_events_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/extreme_weather_events_snapshot.sql
[0m21:02:48.756834 [info ] [MainThread]: 
[0m21:02:48.757299 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns_snapshot (snapshots/hourly_weather_patterns_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/hourly_weather_patterns_snapshot.sql
[0m21:02:48.757683 [info ] [MainThread]: 
[0m21:02:48.758298 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency_snapshot (snapshots/weather_condition_freq_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/weather_condition_freq_snapshot.sql
[0m21:02:48.758630 [info ] [MainThread]: 
[0m21:02:48.759106 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m21:02:48.760206 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 98.21863, "process_user_time": 3.29663, "process_kernel_time": 0.207804, "process_mem_max_rss": "210256", "process_out_blocks": "2158", "command_success": false, "process_in_blocks": "0"}
[0m21:02:48.760637 [debug] [MainThread]: Command `dbt snapshot` failed at 21:02:48.760551 after 98.22 seconds
[0m21:02:48.761098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8409da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838ba1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87deb380>]}
[0m21:02:48.761433 [debug] [MainThread]: Flushing usage events
[0m13:03:06.514275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bd4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ffb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ffd90>]}


============================== 13:03:06.517228 | 50631f79-ae69-4d6b-a539-9f5a895a04a1 ==============================
[0m13:03:06.517228 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:03:06.517572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:03:06.757228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50631f79-ae69-4d6b-a539-9f5a895a04a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10514ab10>]}
[0m13:03:06.781139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50631f79-ae69-4d6b-a539-9f5a895a04a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10514c050>]}
[0m13:03:06.781793 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:03:06.841488 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:03:06.903238 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m13:03:06.903506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '50631f79-ae69-4d6b-a539-9f5a895a04a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10551c350>]}
[0m13:03:07.494505 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:03:07.494810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '50631f79-ae69-4d6b-a539-9f5a895a04a1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550a8a0>]}
[0m13:03:07.614412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50631f79-ae69-4d6b-a539-9f5a895a04a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10580c750>]}
[0m13:03:07.678494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50631f79-ae69-4d6b-a539-9f5a895a04a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10536d090>]}
[0m13:03:07.678771 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m13:03:07.678932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50631f79-ae69-4d6b-a539-9f5a895a04a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058beed0>]}
[0m13:03:07.679912 [info ] [MainThread]: 
[0m13:03:07.680176 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:03:07.682167 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m13:03:07.688456 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m13:03:07.688675 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m13:03:07.688811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:08.305183 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.616 seconds
[0m13:03:08.309482 [debug] [ThreadPool]: On list_openweather: Close
[0m13:03:08.457919 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m13:03:08.468625 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m13:03:08.468972 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m13:03:08.469246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:03:08.983668 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.514 seconds
[0m13:03:08.987370 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m13:03:09.142597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m13:03:09.147479 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m13:03:09.147980 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m13:03:09.148326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:03:09.725331 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.577 seconds
[0m13:03:09.727849 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m13:03:09.883234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50631f79-ae69-4d6b-a539-9f5a895a04a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105917800>]}
[0m13:03:09.883646 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m13:03:09.883835 [info ] [MainThread]: 
[0m13:03:09.886376 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_snapshot
[0m13:03:09.886681 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.daily_average_weather_snapshot .................. [RUN]
[0m13:03:09.886929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now snapshot.weather_dbt.daily_average_weather_snapshot)
[0m13:03:09.887119 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_snapshot
[0m13:03:09.891912 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_snapshot
[0m13:03:09.921221 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m13:03:09.921491 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."DAILY_AVERAGE_WEATHER_SNAPSHOT"
[0m13:03:09.921654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:10.381303 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.459 seconds
[0m13:03:10.419353 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m13:03:10.419871 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."DAILY_AVERAGE_WEATHER_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    CITY_ID,
    CITY_NAME,
    WEATHER_DATE,
    AVG_TEMP_FAHRENHEIT,
    AVG_HUMIDITY,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME


    ),

    snapshotted_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."DAILY_AVERAGE_WEATHER_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            LAST_UPDATED as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m13:03:11.897483 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.477 seconds
[0m13:03:11.901890 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m13:03:11.902405 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."DAILY_AVERAGE_WEATHER_SNAPSHOT__dbt_tmp"
[0m13:03:12.006021 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.103 seconds
[0m13:03:12.012464 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m13:03:12.013013 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."DAILY_AVERAGE_WEATHER_SNAPSHOT"
[0m13:03:12.116537 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.103 seconds
[0m13:03:12.129071 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m13:03:12.129684 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."DAILY_AVERAGE_WEATHER_SNAPSHOT__dbt_tmp"
[0m13:03:12.222240 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.092 seconds
[0m13:03:12.228350 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m13:03:12.229024 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."DAILY_AVERAGE_WEATHER_SNAPSHOT"
[0m13:03:12.320647 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.091 seconds
[0m13:03:12.330287 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m13:03:12.330775 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."DAILY_AVERAGE_WEATHER_SNAPSHOT__dbt_tmp"
[0m13:03:12.445483 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.114 seconds
[0m13:03:12.467717 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m13:03:12.468260 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
select * from (
        

    with snapshot_query as (

        



WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    CITY_ID,
    CITY_NAME,
    WEATHER_DATE,
    AVG_TEMP_FAHRENHEIT,
    AVG_HUMIDITY,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME


    ),

    snapshotted_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."DAILY_AVERAGE_WEATHER_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            LAST_UPDATED as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m13:03:12.663155 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.194 seconds
[0m13:03:12.669508 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m13:03:12.670424 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m13:03:12.767797 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.096 seconds
[0m13:03:12.770093 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m13:03:12.774125 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m13:03:12.774589 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
BEGIN
[0m13:03:12.939508 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.164 seconds
[0m13:03:12.940750 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m13:03:12.941385 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
merge into "OPENWEATHER"."SNAPSHOT"."DAILY_AVERAGE_WEATHER_SNAPSHOT" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."DAILY_AVERAGE_WEATHER_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_ID", "CITY_NAME", "WEATHER_DATE", "AVG_TEMP_FAHRENHEIT", "AVG_HUMIDITY", "LAST_UPDATED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_ID", "CITY_NAME", "WEATHER_DATE", "AVG_TEMP_FAHRENHEIT", "AVG_HUMIDITY", "LAST_UPDATED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m13:03:54.801447 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b3ef-0004-3868-0002-59430004016a
[0m13:03:54.802062 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m13:03:54.802618 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: Close
[0m13:03:54.944571 [debug] [Thread-1 (]: Database Error in snapshot daily_average_weather_snapshot (snapshots/daily_average_weather_trend_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/daily_average_weather_trend_snapshot.sql
[0m13:03:54.946456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50631f79-ae69-4d6b-a539-9f5a895a04a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ac3a70>]}
[0m13:03:54.947411 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshot.daily_average_weather_snapshot .............. [[31mERROR[0m in 45.06s]
[0m13:03:54.948071 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_snapshot
[0m13:03:54.948514 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events_snapshot
[0m13:03:54.949747 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.extreme_weather_events_snapshot ................. [RUN]
[0m13:03:54.950260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_snapshot, now snapshot.weather_dbt.extreme_weather_events_snapshot)
[0m13:03:54.950583 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events_snapshot
[0m13:03:54.955469 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events_snapshot
[0m13:03:54.959385 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m13:03:54.959979 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."EXTREME_WEATHER_EVENTS_SNAPSHOT"
[0m13:03:54.960280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:55.685892 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.725 seconds
[0m13:03:55.696613 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m13:03:55.697296 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."EXTREME_WEATHER_EVENTS_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    CITY_ID,
    CITY_NAME,
    DATE_TIME,
    TEMP_FAHRENHEIT,
    WIND_SPEED,
    WEATHER_ALERT,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME


    ),

    snapshotted_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."EXTREME_WEATHER_EVENTS_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            LAST_UPDATED as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m13:03:57.256906 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.559 seconds
[0m13:03:57.261977 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m13:03:57.262573 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."EXTREME_WEATHER_EVENTS_SNAPSHOT__dbt_tmp"
[0m13:03:57.366562 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.103 seconds
[0m13:03:57.370246 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m13:03:57.370531 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."EXTREME_WEATHER_EVENTS_SNAPSHOT"
[0m13:03:57.483723 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.112 seconds
[0m13:03:57.489596 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m13:03:57.490216 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."EXTREME_WEATHER_EVENTS_SNAPSHOT__dbt_tmp"
[0m13:03:57.584700 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.094 seconds
[0m13:03:57.590426 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m13:03:57.590949 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."EXTREME_WEATHER_EVENTS_SNAPSHOT"
[0m13:03:57.696551 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.105 seconds
[0m13:03:57.700475 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m13:03:57.700836 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."EXTREME_WEATHER_EVENTS_SNAPSHOT__dbt_tmp"
[0m13:03:57.840844 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.139 seconds
[0m13:03:57.851226 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m13:03:57.852089 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
select * from (
        

    with snapshot_query as (

        



WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    CITY_ID,
    CITY_NAME,
    DATE_TIME,
    TEMP_FAHRENHEIT,
    WIND_SPEED,
    WEATHER_ALERT,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME


    ),

    snapshotted_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."EXTREME_WEATHER_EVENTS_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            LAST_UPDATED as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m13:03:58.276162 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.423 seconds
[0m13:03:58.279199 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m13:03:58.279977 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m13:03:58.357748 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.077 seconds
[0m13:03:58.359023 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m13:03:58.361251 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m13:03:58.361710 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
BEGIN
[0m13:03:58.516966 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.155 seconds
[0m13:03:58.517768 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m13:03:58.518331 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
merge into "OPENWEATHER"."SNAPSHOT"."EXTREME_WEATHER_EVENTS_SNAPSHOT" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."EXTREME_WEATHER_EVENTS_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_ID", "CITY_NAME", "DATE_TIME", "TEMP_FAHRENHEIT", "WIND_SPEED", "WEATHER_ALERT", "LAST_UPDATED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_ID", "CITY_NAME", "DATE_TIME", "TEMP_FAHRENHEIT", "WIND_SPEED", "WEATHER_ALERT", "LAST_UPDATED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m13:04:31.255330 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b3ef-0004-3869-0002-5943000420fe
[0m13:04:31.258001 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m13:04:31.258771 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: Close
[0m13:04:31.372775 [debug] [Thread-1 (]: Database Error in snapshot extreme_weather_events_snapshot (snapshots/extreme_weather_events_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/extreme_weather_events_snapshot.sql
[0m13:04:31.373323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50631f79-ae69-4d6b-a539-9f5a895a04a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106603c50>]}
[0m13:04:31.374090 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshot.extreme_weather_events_snapshot ............. [[31mERROR[0m in 36.42s]
[0m13:04:31.374677 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events_snapshot
[0m13:04:31.375062 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns_snapshot
[0m13:04:31.375414 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.hourly_weather_patterns_snapshot ................ [RUN]
[0m13:04:31.375823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events_snapshot, now snapshot.weather_dbt.hourly_weather_patterns_snapshot)
[0m13:04:31.376296 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns_snapshot
[0m13:04:31.379262 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns_snapshot
[0m13:04:31.383430 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m13:04:31.383810 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."HOURLY_WEATHER_PATTERNS_SNAPSHOT"
[0m13:04:31.384080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:31.854161 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.470 seconds
[0m13:04:31.865411 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m13:04:31.866232 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."HOURLY_WEATHER_PATTERNS_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    CITY_ID,
    CITY_NAME,
    HOUR_OF_DAY,
    AVG_TEMP_FAHRENHEIT,
    AVG_WIND_SPEED,
    AVG_HUMIDITY,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY


    ),

    snapshotted_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."HOURLY_WEATHER_PATTERNS_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            LAST_UPDATED as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m13:04:33.399913 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.533 seconds
[0m13:04:33.403562 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m13:04:33.404048 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."HOURLY_WEATHER_PATTERNS_SNAPSHOT__dbt_tmp"
[0m13:04:33.547313 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.142 seconds
[0m13:04:33.554544 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m13:04:33.555063 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."HOURLY_WEATHER_PATTERNS_SNAPSHOT"
[0m13:04:33.700479 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.145 seconds
[0m13:04:33.705387 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m13:04:33.705864 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."HOURLY_WEATHER_PATTERNS_SNAPSHOT__dbt_tmp"
[0m13:04:33.944829 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.238 seconds
[0m13:04:33.951831 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m13:04:33.952336 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."HOURLY_WEATHER_PATTERNS_SNAPSHOT"
[0m13:04:34.051207 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.098 seconds
[0m13:04:34.056434 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m13:04:34.056733 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."HOURLY_WEATHER_PATTERNS_SNAPSHOT__dbt_tmp"
[0m13:04:34.165945 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.109 seconds
[0m13:04:34.173290 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m13:04:34.173919 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
select * from (
        

    with snapshot_query as (

        



WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    CITY_ID,
    CITY_NAME,
    HOUR_OF_DAY,
    AVG_TEMP_FAHRENHEIT,
    AVG_WIND_SPEED,
    AVG_HUMIDITY,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY


    ),

    snapshotted_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."HOURLY_WEATHER_PATTERNS_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            LAST_UPDATED as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m13:04:34.638048 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.463 seconds
[0m13:04:34.641270 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m13:04:34.641889 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m13:04:34.743107 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.101 seconds
[0m13:04:34.744133 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m13:04:34.745905 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m13:04:34.746191 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
BEGIN
[0m13:04:34.909099 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.162 seconds
[0m13:04:34.910687 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m13:04:34.911236 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
merge into "OPENWEATHER"."SNAPSHOT"."HOURLY_WEATHER_PATTERNS_SNAPSHOT" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."HOURLY_WEATHER_PATTERNS_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_ID", "CITY_NAME", "HOUR_OF_DAY", "AVG_TEMP_FAHRENHEIT", "AVG_WIND_SPEED", "AVG_HUMIDITY", "LAST_UPDATED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_ID", "CITY_NAME", "HOUR_OF_DAY", "AVG_TEMP_FAHRENHEIT", "AVG_WIND_SPEED", "AVG_HUMIDITY", "LAST_UPDATED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m13:04:38.213721 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b3f0-0004-3869-0002-594300042102
[0m13:04:38.214814 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m13:04:38.215560 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: Close
[0m13:04:38.342220 [debug] [Thread-1 (]: Database Error in snapshot hourly_weather_patterns_snapshot (snapshots/hourly_weather_patterns_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/hourly_weather_patterns_snapshot.sql
[0m13:04:38.342556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50631f79-ae69-4d6b-a539-9f5a895a04a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b323c0>]}
[0m13:04:38.342972 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshot.hourly_weather_patterns_snapshot ............ [[31mERROR[0m in 6.97s]
[0m13:04:38.343263 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns_snapshot
[0m13:04:38.343459 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency_snapshot
[0m13:04:38.343714 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.weather_conditions_frequency_snapshot ........... [RUN]
[0m13:04:38.343927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns_snapshot, now snapshot.weather_dbt.weather_conditions_frequency_snapshot)
[0m13:04:38.344093 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency_snapshot
[0m13:04:38.345825 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency_snapshot
[0m13:04:38.348209 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m13:04:38.348423 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."WEATHER_CONDITIONS_FREQUENCY_SNAPSHOT"
[0m13:04:38.348590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:38.845776 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.496 seconds
[0m13:04:38.856752 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m13:04:38.857394 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."WEATHER_CONDITIONS_FREQUENCY_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    CITY_ID,
    CITY_NAME,
    WEATHER_MAIN,
    CONDITION_COUNT,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME


    ),

    snapshotted_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."WEATHER_CONDITIONS_FREQUENCY_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            LAST_UPDATED as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m13:04:39.954129 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.096 seconds
[0m13:04:39.959580 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m13:04:39.960170 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."WEATHER_CONDITIONS_FREQUENCY_SNAPSHOT__dbt_tmp"
[0m13:04:40.042309 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.081 seconds
[0m13:04:40.045865 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m13:04:40.046157 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."WEATHER_CONDITIONS_FREQUENCY_SNAPSHOT"
[0m13:04:40.155217 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.109 seconds
[0m13:04:40.163421 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m13:04:40.163955 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."WEATHER_CONDITIONS_FREQUENCY_SNAPSHOT__dbt_tmp"
[0m13:04:40.264434 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.100 seconds
[0m13:04:40.270559 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m13:04:40.271293 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."WEATHER_CONDITIONS_FREQUENCY_SNAPSHOT"
[0m13:04:40.404287 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.132 seconds
[0m13:04:40.411330 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m13:04:40.411707 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
describe table "OPENWEATHER"."SNAPSHOT"."WEATHER_CONDITIONS_FREQUENCY_SNAPSHOT__dbt_tmp"
[0m13:04:40.505916 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.094 seconds
[0m13:04:40.515317 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m13:04:40.516139 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
select * from (
        

    with snapshot_query as (

        



WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    CITY_ID,
    CITY_NAME,
    WEATHER_MAIN,
    CONDITION_COUNT,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME


    ),

    snapshotted_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."WEATHER_CONDITIONS_FREQUENCY_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    
,
            LAST_UPDATED as dbt_updated_at,
            LAST_UPDATED as dbt_valid_from,
            LAST_UPDATED as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_ID as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.LAST_UPDATED)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m13:04:40.874375 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.357 seconds
[0m13:04:40.878709 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m13:04:40.879769 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m13:04:40.960628 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.080 seconds
[0m13:04:40.962034 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m13:04:40.965120 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m13:04:40.965780 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
BEGIN
[0m13:04:41.135716 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.169 seconds
[0m13:04:41.136731 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m13:04:41.137329 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
merge into "OPENWEATHER"."SNAPSHOT"."WEATHER_CONDITIONS_FREQUENCY_SNAPSHOT" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."WEATHER_CONDITIONS_FREQUENCY_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_ID", "CITY_NAME", "WEATHER_MAIN", "CONDITION_COUNT", "LAST_UPDATED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_ID", "CITY_NAME", "WEATHER_MAIN", "CONDITION_COUNT", "LAST_UPDATED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m13:04:41.695191 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b3f0-0004-386b-0002-5943000460fa
[0m13:04:41.696482 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m13:04:41.697444 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: Close
[0m13:04:41.839931 [debug] [Thread-1 (]: Database Error in snapshot weather_conditions_frequency_snapshot (snapshots/weather_condition_freq_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/weather_condition_freq_snapshot.sql
[0m13:04:41.840826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50631f79-ae69-4d6b-a539-9f5a895a04a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020548f0>]}
[0m13:04:41.841748 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshot.weather_conditions_frequency_snapshot ....... [[31mERROR[0m in 3.50s]
[0m13:04:41.842373 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency_snapshot
[0m13:04:41.843986 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:41.844289 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency_snapshot' was properly closed.
[0m13:04:41.844607 [info ] [MainThread]: 
[0m13:04:41.844897 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 1 minutes and 34.16 seconds (94.16s).
[0m13:04:41.845886 [debug] [MainThread]: Command end result
[0m13:04:41.870511 [info ] [MainThread]: 
[0m13:04:41.870884 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m13:04:41.871154 [info ] [MainThread]: 
[0m13:04:41.871414 [error] [MainThread]:   Database Error in snapshot daily_average_weather_snapshot (snapshots/daily_average_weather_trend_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/daily_average_weather_trend_snapshot.sql
[0m13:04:41.871600 [info ] [MainThread]: 
[0m13:04:41.871805 [error] [MainThread]:   Database Error in snapshot extreme_weather_events_snapshot (snapshots/extreme_weather_events_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/extreme_weather_events_snapshot.sql
[0m13:04:41.871966 [info ] [MainThread]: 
[0m13:04:41.872223 [error] [MainThread]:   Database Error in snapshot hourly_weather_patterns_snapshot (snapshots/hourly_weather_patterns_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/hourly_weather_patterns_snapshot.sql
[0m13:04:41.872521 [info ] [MainThread]: 
[0m13:04:41.872753 [error] [MainThread]:   Database Error in snapshot weather_conditions_frequency_snapshot (snapshots/weather_condition_freq_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/weather_condition_freq_snapshot.sql
[0m13:04:41.872930 [info ] [MainThread]: 
[0m13:04:41.873107 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m13:04:41.874592 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 95.39844, "process_in_blocks": "0", "process_kernel_time": 0.325122, "process_mem_max_rss": "149880832", "process_out_blocks": "0", "process_user_time": 2.644243}
[0m13:04:41.875027 [debug] [MainThread]: Command `dbt snapshot` failed at 13:04:41.874956 after 95.40 seconds
[0m13:04:41.875305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042b7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106787d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106787cb0>]}
[0m13:04:41.875535 [debug] [MainThread]: Flushing usage events
[0m21:05:52.951510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9466f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93fb2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93fb3860>]}


============================== 21:05:52.955292 | 78131289-0246-40ad-85f3-09f937d4489c ==============================
[0m21:05:52.955292 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:05:52.956019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/weather_dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/weather_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/weather_dbt --project-dir /opt/airflow/weather_dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:05:53.378968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78131289-0246-40ad-85f3-09f937d4489c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940211f0>]}
[0m21:05:53.403127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78131289-0246-40ad-85f3-09f937d4489c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7958b080>]}
[0m21:05:53.403645 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:05:53.453195 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:05:53.515100 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m21:05:53.515761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '78131289-0246-40ad-85f3-09f937d4489c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff738b8b90>]}
[0m21:05:54.077996 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:05:54.079518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '78131289-0246-40ad-85f3-09f937d4489c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79e76930>]}
[0m21:05:54.201558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78131289-0246-40ad-85f3-09f937d4489c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff737951f0>]}
[0m21:05:54.265192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78131289-0246-40ad-85f3-09f937d4489c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff733236e0>]}
[0m21:05:54.265516 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m21:05:54.266094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78131289-0246-40ad-85f3-09f937d4489c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff738ba990>]}
[0m21:05:54.267270 [info ] [MainThread]: 
[0m21:05:54.267863 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:05:54.270325 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m21:05:54.277401 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m21:05:54.277721 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m21:05:54.277939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:54.786580 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.509 seconds
[0m21:05:54.787675 [debug] [ThreadPool]: On list_openweather: Close
[0m21:05:54.901563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m21:05:54.909154 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m21:05:54.909581 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m21:05:54.909931 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:05:55.350018 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.440 seconds
[0m21:05:55.352790 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m21:05:55.476858 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m21:05:55.482659 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m21:05:55.483295 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m21:05:55.484230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:05:55.990527 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8b3f1-0004-3864-0002-59430003eb36
[0m21:05:55.991676 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:05:55.992652 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:05:55.993207 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:05:55.993759 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m21:05:56.136968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78131289-0246-40ad-85f3-09f937d4489c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93bd2660>]}
[0m21:05:56.138604 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m21:05:56.139485 [info ] [MainThread]: 
[0m21:05:56.153672 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m21:05:56.154630 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m21:05:56.155570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now model.weather_dbt.daily_avg_weather_trend)
[0m21:05:56.156390 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m21:05:56.164861 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m21:05:56.168257 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m21:05:56.189458 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m21:05:56.191619 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m21:05:56.192035 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m21:05:56.192367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:57.511199 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.319 seconds
[0m21:05:57.531288 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m21:05:57.640520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78131289-0246-40ad-85f3-09f937d4489c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73de0500>]}
[0m21:05:57.641588 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.48s]
[0m21:05:57.643330 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m21:05:57.644223 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m21:05:57.645153 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m21:05:57.646590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m21:05:57.647813 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m21:05:57.651491 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m21:05:57.653099 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m21:05:57.655968 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m21:05:57.658362 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m21:05:57.659219 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m21:05:57.659887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:58.906082 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.245 seconds
[0m21:05:58.910635 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m21:05:59.066324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78131289-0246-40ad-85f3-09f937d4489c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73315df0>]}
[0m21:05:59.067647 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.42s]
[0m21:05:59.069203 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m21:05:59.070234 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m21:05:59.071315 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m21:05:59.072376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m21:05:59.073420 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m21:05:59.078358 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m21:05:59.080567 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m21:05:59.084028 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m21:05:59.086946 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m21:05:59.087590 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    *
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY
        );
[0m21:05:59.088176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:00.237531 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.149 seconds
[0m21:06:00.241506 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m21:06:00.372943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78131289-0246-40ad-85f3-09f937d4489c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72391cd0>]}
[0m21:06:00.374651 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.hourly_weather_patterns ............ [[32mSUCCESS 1[0m in 1.30s]
[0m21:06:00.376254 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m21:06:00.377454 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m21:06:00.378530 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m21:06:00.379572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m21:06:00.380517 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m21:06:00.385240 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m21:06:00.388768 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m21:06:00.408746 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m21:06:00.410437 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m21:06:00.410789 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m21:06:00.411152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:01.109095 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.698 seconds
[0m21:06:01.113124 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m21:06:01.275900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78131289-0246-40ad-85f3-09f937d4489c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff733f18b0>]}
[0m21:06:01.277710 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.90s]
[0m21:06:01.278699 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m21:06:01.279746 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m21:06:01.280875 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m21:06:01.281708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m21:06:01.282596 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m21:06:01.287382 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m21:06:01.289191 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m21:06:01.292094 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m21:06:01.294583 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m21:06:01.295486 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    *
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME
        );
[0m21:06:01.296178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:02.696731 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.400 seconds
[0m21:06:02.700212 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m21:06:02.845434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78131289-0246-40ad-85f3-09f937d4489c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73317d10>]}
[0m21:06:02.847114 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.56s]
[0m21:06:02.848308 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m21:06:02.851292 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:06:02.851982 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m21:06:02.852708 [info ] [MainThread]: 
[0m21:06:02.853366 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 8.58 seconds (8.58s).
[0m21:06:02.855137 [debug] [MainThread]: Command end result
[0m21:06:02.892366 [info ] [MainThread]: 
[0m21:06:02.892877 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:06:02.893462 [info ] [MainThread]: 
[0m21:06:02.893915 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:06:02.895080 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.9876995, "process_user_time": 3.411312, "process_kernel_time": 0.176222, "process_mem_max_rss": "214436", "process_out_blocks": "3014", "process_in_blocks": "0"}
[0m21:06:02.895530 [debug] [MainThread]: Command `dbt run` succeeded at 21:06:02.895441 after 9.99 seconds
[0m21:06:02.895875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d237d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73892780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93ccf920>]}
[0m21:06:02.896196 [debug] [MainThread]: Flushing usage events
[0m21:06:04.686635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b131670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a1be1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca95e80>]}


============================== 21:06:04.690718 | 99aeac18-6bcc-4a3a-a983-d128eeb66bb2 ==============================
[0m21:06:04.690718 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:06:04.691057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/weather_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/weather_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/weather_dbt --project-dir /opt/airflow/weather_dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:06:05.118986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99aeac18-6bcc-4a3a-a983-d128eeb66bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e916a80>]}
[0m21:06:05.142906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99aeac18-6bcc-4a3a-a983-d128eeb66bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6aa86cc0>]}
[0m21:06:05.143373 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:06:05.191632 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:06:05.266667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:06:05.266978 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:06:05.294062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99aeac18-6bcc-4a3a-a983-d128eeb66bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a7ec680>]}
[0m21:06:05.364167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99aeac18-6bcc-4a3a-a983-d128eeb66bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69af8560>]}
[0m21:06:05.364559 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m21:06:05.364785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99aeac18-6bcc-4a3a-a983-d128eeb66bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70de2960>]}
[0m21:06:05.366086 [info ] [MainThread]: 
[0m21:06:05.366566 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:06:05.369088 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_analytics'
[0m21:06:05.378982 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m21:06:05.379349 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m21:06:05.379796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:05.918315 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.538 seconds
[0m21:06:05.922125 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m21:06:06.051086 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m21:06:06.056432 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m21:06:06.057131 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m21:06:06.057689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:06:06.488545 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8b3f2-0004-3867-0002-59430004512e
[0m21:06:06.489487 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:06:06.490045 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:06:06.490432 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:06:06.490918 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m21:06:06.607676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99aeac18-6bcc-4a3a-a983-d128eeb66bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69fc4d70>]}
[0m21:06:06.609559 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m21:06:06.610197 [info ] [MainThread]: 
[0m21:06:06.623295 [debug] [Thread-1 (]: Began running node test.weather_dbt.duplication_record_test_daily_avg
[0m21:06:06.626202 [info ] [Thread-1 (]: 1 of 7 START test duplication_record_test_daily_avg ............................ [RUN]
[0m21:06:06.629079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now test.weather_dbt.duplication_record_test_daily_avg)
[0m21:06:06.645404 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.duplication_record_test_daily_avg
[0m21:06:06.658054 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.duplication_record_test_daily_avg"
[0m21:06:06.659534 [debug] [Thread-1 (]: Began executing node test.weather_dbt.duplication_record_test_daily_avg
[0m21:06:06.673338 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.duplication_record_test_daily_avg"
[0m21:06:06.674925 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.duplication_record_test_daily_avg"
[0m21:06:06.675330 [debug] [Thread-1 (]: On test.weather_dbt.duplication_record_test_daily_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.duplication_record_test_daily_avg"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- duplicate record test
SELECT CITY_ID, WEATHER_DATE, COUNT(*)
FROM openweather.analytics.daily_avg_weather_trend
GROUP BY CITY_ID, WEATHER_DATE
HAVING COUNT(*) > 1
      
    ) dbt_internal_test
[0m21:06:06.675729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:07.257078 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.581 seconds
[0m21:06:07.270233 [debug] [Thread-1 (]: On test.weather_dbt.duplication_record_test_daily_avg: Close
[0m21:06:07.392128 [info ] [Thread-1 (]: 1 of 7 PASS duplication_record_test_daily_avg .................................. [[32mPASS[0m in 0.76s]
[0m21:06:07.392873 [debug] [Thread-1 (]: Finished running node test.weather_dbt.duplication_record_test_daily_avg
[0m21:06:07.393349 [debug] [Thread-1 (]: Began running node test.weather_dbt.humidity_range_daily_avg
[0m21:06:07.393768 [info ] [Thread-1 (]: 2 of 7 START test humidity_range_daily_avg ..................................... [RUN]
[0m21:06:07.394189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.duplication_record_test_daily_avg, now test.weather_dbt.humidity_range_daily_avg)
[0m21:06:07.394597 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.humidity_range_daily_avg
[0m21:06:07.396408 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.humidity_range_daily_avg"
[0m21:06:07.397271 [debug] [Thread-1 (]: Began executing node test.weather_dbt.humidity_range_daily_avg
[0m21:06:07.398547 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.humidity_range_daily_avg"
[0m21:06:07.399307 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.humidity_range_daily_avg"
[0m21:06:07.399559 [debug] [Thread-1 (]: On test.weather_dbt.humidity_range_daily_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.humidity_range_daily_avg"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- humidity range
SELECT *
FROM openweather.analytics.daily_avg_weather_trend
WHERE AVG_HUMIDITY < 0 OR AVG_HUMIDITY > 100
      
    ) dbt_internal_test
[0m21:06:07.399794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:07.932532 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.532 seconds
[0m21:06:07.937985 [debug] [Thread-1 (]: On test.weather_dbt.humidity_range_daily_avg: Close
[0m21:06:08.088349 [info ] [Thread-1 (]: 2 of 7 PASS humidity_range_daily_avg ........................................... [[32mPASS[0m in 0.69s]
[0m21:06:08.089914 [debug] [Thread-1 (]: Finished running node test.weather_dbt.humidity_range_daily_avg
[0m21:06:08.090996 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m21:06:08.091811 [info ] [Thread-1 (]: 3 of 7 START test not_null_daily_avg_weather_trend_avg_humidity ................ [RUN]
[0m21:06:08.092680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.humidity_range_daily_avg, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07)
[0m21:06:08.093593 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m21:06:08.106491 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m21:06:08.109003 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m21:06:08.111936 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m21:06:08.114063 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m21:06:08.114511 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_humidity
from openweather.analytics.daily_avg_weather_trend
where avg_humidity is null



      
    ) dbt_internal_test
[0m21:06:08.115054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:08.578991 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.463 seconds
[0m21:06:08.583422 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07: Close
[0m21:06:08.722762 [info ] [Thread-1 (]: 3 of 7 PASS not_null_daily_avg_weather_trend_avg_humidity ...................... [[32mPASS[0m in 0.63s]
[0m21:06:08.723506 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m21:06:08.724247 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m21:06:08.724780 [info ] [Thread-1 (]: 4 of 7 START test not_null_daily_avg_weather_trend_avg_temp_fahrenheit ......... [RUN]
[0m21:06:08.725257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372)
[0m21:06:08.725768 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m21:06:08.729103 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m21:06:08.730231 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m21:06:08.731992 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m21:06:08.733165 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m21:06:08.733552 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp_fahrenheit
from openweather.analytics.daily_avg_weather_trend
where avg_temp_fahrenheit is null



      
    ) dbt_internal_test
[0m21:06:08.733850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:09.261427 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.527 seconds
[0m21:06:09.265339 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372: Close
[0m21:06:09.384155 [info ] [Thread-1 (]: 4 of 7 PASS not_null_daily_avg_weather_trend_avg_temp_fahrenheit ............... [[32mPASS[0m in 0.66s]
[0m21:06:09.385361 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m21:06:09.386081 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m21:06:09.386748 [info ] [Thread-1 (]: 5 of 7 START test not_null_daily_avg_weather_trend_city_id ..................... [RUN]
[0m21:06:09.387749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372, now test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790)
[0m21:06:09.388751 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m21:06:09.394235 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m21:06:09.395956 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m21:06:09.398311 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m21:06:09.399888 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m21:06:09.400491 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_id
from openweather.analytics.daily_avg_weather_trend
where city_id is null



      
    ) dbt_internal_test
[0m21:06:09.401070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:09.938377 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.537 seconds
[0m21:06:09.942577 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790: Close
[0m21:06:10.084039 [info ] [Thread-1 (]: 5 of 7 PASS not_null_daily_avg_weather_trend_city_id ........................... [[32mPASS[0m in 0.70s]
[0m21:06:10.086041 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m21:06:10.087117 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m21:06:10.087957 [info ] [Thread-1 (]: 6 of 7 START test not_null_daily_avg_weather_trend_weather_date ................ [RUN]
[0m21:06:10.089004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790, now test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b)
[0m21:06:10.089865 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m21:06:10.095596 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m21:06:10.097717 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m21:06:10.100745 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m21:06:10.103479 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m21:06:10.104106 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_date
from openweather.analytics.daily_avg_weather_trend
where weather_date is null



      
    ) dbt_internal_test
[0m21:06:10.104768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:10.553734 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.448 seconds
[0m21:06:10.558814 [debug] [Thread-1 (]: On test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b: Close
[0m21:06:10.686289 [info ] [Thread-1 (]: 6 of 7 PASS not_null_daily_avg_weather_trend_weather_date ...................... [[32mPASS[0m in 0.60s]
[0m21:06:10.687603 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m21:06:10.688537 [debug] [Thread-1 (]: Began running node test.weather_dbt.temp_range_daily_avg
[0m21:06:10.689357 [info ] [Thread-1 (]: 7 of 7 START test temp_range_daily_avg ......................................... [RUN]
[0m21:06:10.690381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b, now test.weather_dbt.temp_range_daily_avg)
[0m21:06:10.691467 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.temp_range_daily_avg
[0m21:06:10.695615 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.temp_range_daily_avg"
[0m21:06:10.697552 [debug] [Thread-1 (]: Began executing node test.weather_dbt.temp_range_daily_avg
[0m21:06:10.700292 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.temp_range_daily_avg"
[0m21:06:10.702450 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.temp_range_daily_avg"
[0m21:06:10.702962 [debug] [Thread-1 (]: On test.weather_dbt.temp_range_daily_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.temp_range_daily_avg"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- temperature range
SELECT *
FROM openweather.analytics.daily_avg_weather_trend
WHERE AVG_TEMP_FAHRENHEIT < -50 OR AVG_TEMP_FAHRENHEIT > 130
      
    ) dbt_internal_test
[0m21:06:10.703743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:11.180659 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.477 seconds
[0m21:06:11.184929 [debug] [Thread-1 (]: On test.weather_dbt.temp_range_daily_avg: Close
[0m21:06:11.316116 [info ] [Thread-1 (]: 7 of 7 PASS temp_range_daily_avg ............................................... [[32mPASS[0m in 0.63s]
[0m21:06:11.317370 [debug] [Thread-1 (]: Finished running node test.weather_dbt.temp_range_daily_avg
[0m21:06:11.319448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:06:11.320060 [debug] [MainThread]: Connection 'test.weather_dbt.temp_range_daily_avg' was properly closed.
[0m21:06:11.320501 [info ] [MainThread]: 
[0m21:06:11.320957 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 5.95 seconds (5.95s).
[0m21:06:11.322724 [debug] [MainThread]: Command end result
[0m21:06:11.356071 [info ] [MainThread]: 
[0m21:06:11.356531 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:06:11.357115 [info ] [MainThread]: 
[0m21:06:11.357722 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m21:06:11.358771 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.715908, "process_user_time": 2.711575, "process_kernel_time": 0.177579, "process_mem_max_rss": "211028", "process_out_blocks": "2047", "process_in_blocks": "0"}
[0m21:06:11.359248 [debug] [MainThread]: Command `dbt test` succeeded at 21:06:11.359153 after 6.72 seconds
[0m21:06:11.359638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b131670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a1eecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a4f6810>]}
[0m21:06:11.359978 [debug] [MainThread]: Flushing usage events
[0m21:06:13.017008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca29b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eaf1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bca05f0>]}


============================== 21:06:13.020726 | 4ae2c288-b431-4aa8-9ce8-d41864685dd5 ==============================
[0m21:06:13.020726 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:06:13.021074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/weather_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/weather_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/weather_dbt --project-dir /opt/airflow/weather_dbt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:06:13.436533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ae2c288-b431-4aa8-9ce8-d41864685dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cbeb860>]}
[0m21:06:13.460400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ae2c288-b431-4aa8-9ce8-d41864685dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60cdb080>]}
[0m21:06:13.460962 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:06:13.509939 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:06:13.582968 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:06:13.583289 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:06:13.610223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ae2c288-b431-4aa8-9ce8-d41864685dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff608a18e0>]}
[0m21:06:13.673409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ae2c288-b431-4aa8-9ce8-d41864685dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b777bc0>]}
[0m21:06:13.673738 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m21:06:13.673967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ae2c288-b431-4aa8-9ce8-d41864685dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ba49880>]}
[0m21:06:13.675181 [info ] [MainThread]: 
[0m21:06:13.675727 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:06:13.678130 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m21:06:13.686216 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m21:06:13.686602 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m21:06:13.686861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:14.076104 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.389 seconds
[0m21:06:14.080070 [debug] [ThreadPool]: On list_openweather: Close
[0m21:06:14.220154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now create_openweather_snapshot)
[0m21:06:14.221270 [debug] [ThreadPool]: Creating schema "database: "openweather"
schema: "snapshot"
"
[0m21:06:14.228605 [debug] [ThreadPool]: Using snowflake connection "create_openweather_snapshot"
[0m21:06:14.229242 [debug] [ThreadPool]: On create_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "create_openweather_snapshot"} */
create schema if not exists openweather.snapshot
[0m21:06:14.229762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:06:14.688802 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.459 seconds
[0m21:06:14.691366 [debug] [ThreadPool]: On create_openweather_snapshot: Close
[0m21:06:14.794708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_openweather_snapshot, now list_openweather_snapshot)
[0m21:06:14.799414 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m21:06:14.799681 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m21:06:14.799903 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:06:15.262115 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.462 seconds
[0m21:06:15.266272 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m21:06:15.412733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m21:06:15.418928 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m21:06:15.419468 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m21:06:15.420035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:06:15.852960 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.433 seconds
[0m21:06:15.857109 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m21:06:15.979642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ae2c288-b431-4aa8-9ce8-d41864685dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d2a5010>]}
[0m21:06:15.980943 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m21:06:15.981747 [info ] [MainThread]: 
[0m21:06:15.995041 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_snapshot
[0m21:06:15.996299 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.daily_average_weather_snapshot .................. [RUN]
[0m21:06:15.997239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now snapshot.weather_dbt.daily_average_weather_snapshot)
[0m21:06:15.998088 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_snapshot
[0m21:06:16.007362 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_snapshot
[0m21:06:16.056232 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m21:06:16.056730 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to

    from (
        



WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    CITY_ID,
    CITY_NAME,
    WEATHER_DATE,
    AVG_TEMP_FAHRENHEIT,
    AVG_HUMIDITY,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m21:06:16.057032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:16.448746 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.391 seconds
[0m21:06:16.457653 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m21:06:16.458376 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m21:06:16.582548 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.123 seconds
[0m21:06:16.584371 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m21:06:16.588850 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.daily_average_weather_snapshot"
[0m21:06:16.589606 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.daily_average_weather_snapshot"} */
create or replace transient table openweather.snapshot.daily_average_weather_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to

    from (
        



WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    CITY_ID,
    CITY_NAME,
    WEATHER_DATE,
    AVG_TEMP_FAHRENHEIT,
    AVG_HUMIDITY,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME

    ) sbq



        );
[0m21:06:17.538544 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.948 seconds
[0m21:06:17.558616 [debug] [Thread-1 (]: On snapshot.weather_dbt.daily_average_weather_snapshot: Close
[0m21:06:17.669257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ae2c288-b431-4aa8-9ce8-d41864685dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c4364b0>]}
[0m21:06:17.670518 [info ] [Thread-1 (]: 1 of 4 OK snapshotted snapshot.daily_average_weather_snapshot .................. [[32mSUCCESS 1[0m in 1.67s]
[0m21:06:17.671631 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_snapshot
[0m21:06:17.672882 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events_snapshot
[0m21:06:17.673738 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.extreme_weather_events_snapshot ................. [RUN]
[0m21:06:17.674410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_snapshot, now snapshot.weather_dbt.extreme_weather_events_snapshot)
[0m21:06:17.675344 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events_snapshot
[0m21:06:17.679522 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events_snapshot
[0m21:06:17.684069 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m21:06:17.684948 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to

    from (
        



WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    CITY_ID,
    CITY_NAME,
    DATE_TIME,
    TEMP_FAHRENHEIT,
    WIND_SPEED,
    WEATHER_ALERT,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m21:06:17.685667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:18.095722 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.409 seconds
[0m21:06:18.098642 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m21:06:18.099438 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m21:06:18.193181 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.093 seconds
[0m21:06:18.194008 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m21:06:18.197144 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.extreme_weather_events_snapshot"
[0m21:06:18.197693 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.extreme_weather_events_snapshot"} */
create or replace transient table openweather.snapshot.extreme_weather_events_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to

    from (
        



WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    CITY_ID,
    CITY_NAME,
    DATE_TIME,
    TEMP_FAHRENHEIT,
    WIND_SPEED,
    WEATHER_ALERT,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME

    ) sbq



        );
[0m21:06:18.977955 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.779 seconds
[0m21:06:18.982592 [debug] [Thread-1 (]: On snapshot.weather_dbt.extreme_weather_events_snapshot: Close
[0m21:06:19.114380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ae2c288-b431-4aa8-9ce8-d41864685dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ab8bdd0>]}
[0m21:06:19.115866 [info ] [Thread-1 (]: 2 of 4 OK snapshotted snapshot.extreme_weather_events_snapshot ................. [[32mSUCCESS 1[0m in 1.44s]
[0m21:06:19.116779 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events_snapshot
[0m21:06:19.117638 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns_snapshot
[0m21:06:19.118411 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.hourly_weather_patterns_snapshot ................ [RUN]
[0m21:06:19.119402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events_snapshot, now snapshot.weather_dbt.hourly_weather_patterns_snapshot)
[0m21:06:19.120206 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns_snapshot
[0m21:06:19.124948 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns_snapshot
[0m21:06:19.129218 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m21:06:19.129773 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to

    from (
        



WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    CITY_ID,
    CITY_NAME,
    HOUR_OF_DAY,
    AVG_TEMP_FAHRENHEIT,
    AVG_WIND_SPEED,
    AVG_HUMIDITY,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m21:06:19.130300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:19.793664 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.663 seconds
[0m21:06:19.796775 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m21:06:19.797660 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m21:06:19.886251 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.087 seconds
[0m21:06:19.888193 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m21:06:19.892808 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.hourly_weather_patterns_snapshot"
[0m21:06:19.893583 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.hourly_weather_patterns_snapshot"} */
create or replace transient table openweather.snapshot.hourly_weather_patterns_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to

    from (
        



WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    CITY_ID,
    CITY_NAME,
    HOUR_OF_DAY,
    AVG_TEMP_FAHRENHEIT,
    AVG_WIND_SPEED,
    AVG_HUMIDITY,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY

    ) sbq



        );
[0m21:06:20.899249 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.004 seconds
[0m21:06:20.903544 [debug] [Thread-1 (]: On snapshot.weather_dbt.hourly_weather_patterns_snapshot: Close
[0m21:06:21.032666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ae2c288-b431-4aa8-9ce8-d41864685dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ab78e60>]}
[0m21:06:21.034469 [info ] [Thread-1 (]: 3 of 4 OK snapshotted snapshot.hourly_weather_patterns_snapshot ................ [[32mSUCCESS 1[0m in 1.91s]
[0m21:06:21.035827 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns_snapshot
[0m21:06:21.037016 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency_snapshot
[0m21:06:21.038091 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.weather_conditions_frequency_snapshot ........... [RUN]
[0m21:06:21.038938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns_snapshot, now snapshot.weather_dbt.weather_conditions_frequency_snapshot)
[0m21:06:21.039704 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency_snapshot
[0m21:06:21.044961 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency_snapshot
[0m21:06:21.049517 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m21:06:21.050150 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to

    from (
        



WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    CITY_ID,
    CITY_NAME,
    WEATHER_MAIN,
    CONDITION_COUNT,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m21:06:21.050712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:21.534200 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.483 seconds
[0m21:06:21.537456 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m21:06:21.538287 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m21:06:21.642016 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.103 seconds
[0m21:06:21.643128 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m21:06:21.646495 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.weather_conditions_frequency_snapshot"
[0m21:06:21.647196 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.weather_conditions_frequency_snapshot"} */
create or replace transient table openweather.snapshot.weather_conditions_frequency_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_ID as varchar ), '')
         || '|' || coalesce(cast(LAST_UPDATED as varchar ), '')
        ) as dbt_scd_id,
        LAST_UPDATED as dbt_updated_at,
        LAST_UPDATED as dbt_valid_from,
        
  
  coalesce(nullif(LAST_UPDATED, LAST_UPDATED), null)
  as dbt_valid_to

    from (
        



WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    CITY_ID,
    CITY_NAME,
    WEATHER_MAIN,
    CONDITION_COUNT,
    CURRENT_TIMESTAMP AS LAST_UPDATED  -- Simulated timestamp column for change detection
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME

    ) sbq



        );
[0m21:06:22.357307 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.709 seconds
[0m21:06:22.361417 [debug] [Thread-1 (]: On snapshot.weather_dbt.weather_conditions_frequency_snapshot: Close
[0m21:06:22.480638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ae2c288-b431-4aa8-9ce8-d41864685dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ba50b60>]}
[0m21:06:22.481974 [info ] [Thread-1 (]: 4 of 4 OK snapshotted snapshot.weather_conditions_frequency_snapshot ........... [[32mSUCCESS 1[0m in 1.44s]
[0m21:06:22.482708 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency_snapshot
[0m21:06:22.485049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:06:22.485602 [debug] [MainThread]: Connection 'snapshot.weather_dbt.weather_conditions_frequency_snapshot' was properly closed.
[0m21:06:22.486072 [info ] [MainThread]: 
[0m21:06:22.486618 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 8.81 seconds (8.81s).
[0m21:06:22.487887 [debug] [MainThread]: Command end result
[0m21:06:22.517736 [info ] [MainThread]: 
[0m21:06:22.518154 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:06:22.518647 [info ] [MainThread]: 
[0m21:06:22.519083 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m21:06:22.519972 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 9.546564, "process_user_time": 2.808572, "process_kernel_time": 0.188971, "process_mem_max_rss": "208412", "process_out_blocks": "2074", "process_in_blocks": "0"}
[0m21:06:22.520347 [debug] [MainThread]: Command `dbt snapshot` succeeded at 21:06:22.520286 after 9.55 seconds
[0m21:06:22.520659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eaf1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bf86cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5aba98b0>]}
[0m21:06:22.520918 [debug] [MainThread]: Flushing usage events
[0m21:06:24.222303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff823a60f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82246e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff823a6540>]}


============================== 21:06:24.226008 | a38b080a-14f2-4eeb-abf3-9797512253ec ==============================
[0m21:06:24.226008 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:06:24.226343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/weather_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/weather_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/weather_dbt --project-dir /opt/airflow/weather_dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:06:24.638634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a38b080a-14f2-4eeb-abf3-9797512253ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff816efb90>]}
[0m21:06:24.662279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a38b080a-14f2-4eeb-abf3-9797512253ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff828074a0>]}
[0m21:06:24.662755 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:06:24.714375 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:06:24.796990 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:06:24.797304 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:06:24.824465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a38b080a-14f2-4eeb-abf3-9797512253ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66cc2960>]}
[0m21:06:24.832176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a38b080a-14f2-4eeb-abf3-9797512253ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65889a00>]}
[0m21:06:24.834150 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m21:06:24.834383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a38b080a-14f2-4eeb-abf3-9797512253ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff659d3380>]}
[0m21:06:24.835860 [info ] [MainThread]: 
[0m21:06:24.836332 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:06:24.838830 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_snapshot'
[0m21:06:24.850390 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m21:06:24.850863 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m21:06:24.851226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:25.371512 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.520 seconds
[0m21:06:25.375158 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m21:06:25.488529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m21:06:25.493485 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m21:06:25.494127 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m21:06:25.494681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:06:26.001478 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.507 seconds
[0m21:06:26.005451 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m21:06:26.111320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a38b080a-14f2-4eeb-abf3-9797512253ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff658827e0>]}
[0m21:06:26.112424 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m21:06:26.112978 [info ] [MainThread]: 
[0m21:06:26.123822 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m21:06:26.124670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m21:06:26.125104 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m21:06:26.131315 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m21:06:26.132638 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m21:06:26.133348 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m21:06:26.133845 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m21:06:26.134471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m21:06:26.135006 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m21:06:26.137245 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m21:06:26.137998 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m21:06:26.138476 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m21:06:26.138785 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m21:06:26.139081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m21:06:26.139316 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m21:06:26.141167 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m21:06:26.141911 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m21:06:26.142467 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m21:06:26.142811 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m21:06:26.143247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m21:06:26.143768 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m21:06:26.145726 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m21:06:26.146533 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m21:06:26.146999 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m21:06:26.147307 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m21:06:26.147613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m21:06:26.147847 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m21:06:26.149569 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m21:06:26.150153 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m21:06:26.150595 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m21:06:26.150866 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.daily_average_weather_snapshot
[0m21:06:26.151126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.weather_condition_freq, now snapshot.weather_dbt.daily_average_weather_snapshot)
[0m21:06:26.151330 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.daily_average_weather_snapshot
[0m21:06:26.153349 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.daily_average_weather_snapshot
[0m21:06:26.153799 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.daily_average_weather_snapshot
[0m21:06:26.154085 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.extreme_weather_events_snapshot
[0m21:06:26.154344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.daily_average_weather_snapshot, now snapshot.weather_dbt.extreme_weather_events_snapshot)
[0m21:06:26.154595 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.extreme_weather_events_snapshot
[0m21:06:26.156422 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.extreme_weather_events_snapshot
[0m21:06:26.156809 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.extreme_weather_events_snapshot
[0m21:06:26.157051 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.hourly_weather_patterns_snapshot
[0m21:06:26.157288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.extreme_weather_events_snapshot, now snapshot.weather_dbt.hourly_weather_patterns_snapshot)
[0m21:06:26.157514 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.hourly_weather_patterns_snapshot
[0m21:06:26.159723 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.hourly_weather_patterns_snapshot
[0m21:06:26.160369 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.hourly_weather_patterns_snapshot
[0m21:06:26.160792 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.weather_conditions_frequency_snapshot
[0m21:06:26.161099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.hourly_weather_patterns_snapshot, now snapshot.weather_dbt.weather_conditions_frequency_snapshot)
[0m21:06:26.161346 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.weather_conditions_frequency_snapshot
[0m21:06:26.163512 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.weather_conditions_frequency_snapshot
[0m21:06:26.163946 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.weather_conditions_frequency_snapshot
[0m21:06:26.164182 [debug] [Thread-1 (]: Began running node test.weather_dbt.duplication_record_test_daily_avg
[0m21:06:26.164433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.weather_conditions_frequency_snapshot, now test.weather_dbt.duplication_record_test_daily_avg)
[0m21:06:26.164641 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.duplication_record_test_daily_avg
[0m21:06:26.166091 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.duplication_record_test_daily_avg"
[0m21:06:26.166832 [debug] [Thread-1 (]: Began executing node test.weather_dbt.duplication_record_test_daily_avg
[0m21:06:26.167313 [debug] [Thread-1 (]: Finished running node test.weather_dbt.duplication_record_test_daily_avg
[0m21:06:26.167571 [debug] [Thread-1 (]: Began running node test.weather_dbt.humidity_range_daily_avg
[0m21:06:26.167830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.duplication_record_test_daily_avg, now test.weather_dbt.humidity_range_daily_avg)
[0m21:06:26.168034 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.humidity_range_daily_avg
[0m21:06:26.169256 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.humidity_range_daily_avg"
[0m21:06:26.169743 [debug] [Thread-1 (]: Began executing node test.weather_dbt.humidity_range_daily_avg
[0m21:06:26.170080 [debug] [Thread-1 (]: Finished running node test.weather_dbt.humidity_range_daily_avg
[0m21:06:26.170327 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m21:06:26.170547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.humidity_range_daily_avg, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07)
[0m21:06:26.170774 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m21:06:26.177627 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07"
[0m21:06:26.178343 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m21:06:26.178882 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07
[0m21:06:26.179222 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m21:06:26.179533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07, now test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372)
[0m21:06:26.179763 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m21:06:26.181862 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372"
[0m21:06:26.182411 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m21:06:26.182807 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372
[0m21:06:26.183058 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m21:06:26.183287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372, now test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790)
[0m21:06:26.183501 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m21:06:26.185326 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790"
[0m21:06:26.185800 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m21:06:26.186130 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790
[0m21:06:26.186397 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m21:06:26.186633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790, now test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b)
[0m21:06:26.186833 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m21:06:26.188696 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b"
[0m21:06:26.189538 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m21:06:26.189992 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b
[0m21:06:26.190250 [debug] [Thread-1 (]: Began running node test.weather_dbt.temp_range_daily_avg
[0m21:06:26.190503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b, now test.weather_dbt.temp_range_daily_avg)
[0m21:06:26.190730 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.temp_range_daily_avg
[0m21:06:26.192055 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.temp_range_daily_avg"
[0m21:06:26.192612 [debug] [Thread-1 (]: Began executing node test.weather_dbt.temp_range_daily_avg
[0m21:06:26.192970 [debug] [Thread-1 (]: Finished running node test.weather_dbt.temp_range_daily_avg
[0m21:06:26.193690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:06:26.193910 [debug] [MainThread]: Connection 'test.weather_dbt.temp_range_daily_avg' was properly closed.
[0m21:06:26.195088 [debug] [MainThread]: Command end result
[0m21:06:26.258887 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m21:06:26.259148 [info ] [MainThread]: Building catalog
[0m21:06:26.264406 [debug] [ThreadPool]: Acquiring new snowflake connection 'openweather.information_schema'
[0m21:06:26.273474 [debug] [ThreadPool]: Using snowflake connection "openweather.information_schema"
[0m21:06:26.274059 [debug] [ThreadPool]: On openweather.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "openweather.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from openweather.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'raw_data' and upper("table_schema") = upper('raw_data')

                    and 
    "table_name" ilike 'WEATHER_FACT_TABLE' and upper("table_name") = upper('WEATHER_FACT_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'raw_data' and upper("table_schema") = upper('raw_data')

                    and 
    "table_name" ilike 'CITY_DIMENSION_TABLE' and upper("table_name") = upper('CITY_DIMENSION_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'daily_average_weather_snapshot' and upper("table_name") = upper('daily_average_weather_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'weather_condition_freq' and upper("table_name") = upper('weather_condition_freq')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'hourly_weather_patterns' and upper("table_name") = upper('hourly_weather_patterns')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'hourly_weather_patterns_snapshot' and upper("table_name") = upper('hourly_weather_patterns_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'extreme_weather_events' and upper("table_name") = upper('extreme_weather_events')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'extreme_weather_events_snapshot' and upper("table_name") = upper('extreme_weather_events_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'weather_conditions_frequency_snapshot' and upper("table_name") = upper('weather_conditions_frequency_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'daily_avg_weather_trend' and upper("table_name") = upper('daily_avg_weather_trend')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'openweather_join' and upper("table_name") = upper('openweather_join')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from openweather.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'raw_data' and upper("table_schema") = upper('raw_data')

                    and 
    "table_name" ilike 'WEATHER_FACT_TABLE' and upper("table_name") = upper('WEATHER_FACT_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'raw_data' and upper("table_schema") = upper('raw_data')

                    and 
    "table_name" ilike 'CITY_DIMENSION_TABLE' and upper("table_name") = upper('CITY_DIMENSION_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'daily_average_weather_snapshot' and upper("table_name") = upper('daily_average_weather_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'weather_condition_freq' and upper("table_name") = upper('weather_condition_freq')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'hourly_weather_patterns' and upper("table_name") = upper('hourly_weather_patterns')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'hourly_weather_patterns_snapshot' and upper("table_name") = upper('hourly_weather_patterns_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'extreme_weather_events' and upper("table_name") = upper('extreme_weather_events')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'extreme_weather_events_snapshot' and upper("table_name") = upper('extreme_weather_events_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'weather_conditions_frequency_snapshot' and upper("table_name") = upper('weather_conditions_frequency_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'daily_avg_weather_trend' and upper("table_name") = upper('daily_avg_weather_trend')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'openweather_join' and upper("table_name") = upper('openweather_join')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m21:06:26.274595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:30.584400 [debug] [ThreadPool]: SQL status: SUCCESS 87 in 4.310 seconds
[0m21:06:30.601485 [debug] [ThreadPool]: On openweather.information_schema: Close
[0m21:06:30.769865 [info ] [MainThread]: Catalog written to /opt/airflow/weather_dbt/target/catalog.json
[0m21:06:30.770725 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 6.591438, "process_user_time": 2.486038, "process_kernel_time": 0.146, "process_mem_max_rss": "209216", "process_out_blocks": "5097", "process_in_blocks": "0"}
[0m21:06:30.771176 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:06:30.771097 after 6.59 seconds
[0m21:06:30.771456 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:06:30.771700 [debug] [MainThread]: Connection 'openweather.information_schema' was properly closed.
[0m21:06:30.771977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8228b0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64bdfce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65866c30>]}
[0m21:06:30.772231 [debug] [MainThread]: Flushing usage events
[0m13:41:11.777633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106560d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e67b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e67d90>]}


============================== 13:41:11.780934 | bbbbb1b1-287a-429f-8f0a-1bc5b1452ccd ==============================
[0m13:41:11.780934 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:41:11.781294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:41:12.023438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbbbb1b1-287a-429f-8f0a-1bc5b1452ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ceab10>]}
[0m13:41:12.049032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbbbb1b1-287a-429f-8f0a-1bc5b1452ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cec050>]}
[0m13:41:12.049826 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:41:12.110990 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:41:12.172844 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m13:41:12.173118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bbbbb1b1-287a-429f-8f0a-1bc5b1452ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110bc350>]}
[0m13:41:12.730308 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:41:12.730619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bbbbb1b1-287a-429f-8f0a-1bc5b1452ccd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110a28a0>]}
[0m13:41:12.852213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbbbb1b1-287a-429f-8f0a-1bc5b1452ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115c4750>]}
[0m13:41:12.916014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbbbb1b1-287a-429f-8f0a-1bc5b1452ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f11090>]}
[0m13:41:12.916305 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m13:41:12.916474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbbbb1b1-287a-429f-8f0a-1bc5b1452ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f56c90>]}
[0m13:41:12.917479 [info ] [MainThread]: 
[0m13:41:12.917751 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:41:12.919789 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m13:41:12.926198 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m13:41:12.926409 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m13:41:12.926541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:13.536772 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.610 seconds
[0m13:41:13.538247 [debug] [ThreadPool]: On list_openweather: Close
[0m13:41:13.706658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m13:41:13.718949 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m13:41:13.719379 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m13:41:13.719637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:41:14.143739 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.424 seconds
[0m13:41:14.146700 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m13:41:14.264861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m13:41:14.268723 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m13:41:14.269072 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m13:41:14.269345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:41:14.705196 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.435 seconds
[0m13:41:14.709099 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m13:41:14.824926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbbbb1b1-287a-429f-8f0a-1bc5b1452ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111faf490>]}
[0m13:41:14.825824 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m13:41:14.826309 [info ] [MainThread]: 
[0m13:41:14.830547 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m13:41:14.831303 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m13:41:14.831873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now model.weather_dbt.daily_avg_weather_trend)
[0m13:41:14.832710 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m13:41:14.841770 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m13:41:14.843432 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m13:41:14.866126 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m13:41:14.867373 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m13:41:14.867638 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m13:41:14.867863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:16.804195 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.936 seconds
[0m13:41:16.827534 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m13:41:16.967338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbbbb1b1-287a-429f-8f0a-1bc5b1452ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107427a70>]}
[0m13:41:16.969164 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 2.13s]
[0m13:41:16.970322 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m13:41:16.970968 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m13:41:16.971740 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m13:41:16.972366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m13:41:16.972747 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m13:41:16.976537 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m13:41:16.977779 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m13:41:16.981071 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m13:41:16.982623 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m13:41:16.983077 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m13:41:16.983430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:18.388501 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.405 seconds
[0m13:41:18.393049 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m13:41:18.886111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbbbb1b1-287a-429f-8f0a-1bc5b1452ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124e32d0>]}
[0m13:41:18.887077 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.91s]
[0m13:41:18.887657 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m13:41:18.888044 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m13:41:18.888570 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m13:41:18.889031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m13:41:18.889359 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m13:41:18.892629 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m13:41:18.893919 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m13:41:18.897636 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m13:41:18.899273 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m13:41:18.899682 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    *
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY
        );
[0m13:41:18.900043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:20.426492 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.526 seconds
[0m13:41:20.427767 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m13:41:20.894054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbbbb1b1-287a-429f-8f0a-1bc5b1452ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11244fa10>]}
[0m13:41:20.895258 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.hourly_weather_patterns ............ [[32mSUCCESS 1[0m in 2.00s]
[0m13:41:20.896107 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m13:41:20.896693 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m13:41:20.897413 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m13:41:20.898013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m13:41:20.898442 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m13:41:20.902644 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m13:41:20.903749 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m13:41:20.928276 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m13:41:20.929482 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m13:41:20.929854 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    c.Latitude,
    c.Longitude,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m13:41:20.930112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:22.413070 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b415-0004-3865-0002-59430003f30a
[0m13:41:22.413859 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 4
invalid identifier 'C.LATITUDE'
[0m13:41:22.414466 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m13:41:22.565600 [debug] [Thread-1 (]: Database Error in model openweather_join (models/input/openweather_join.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/input/openweather_join.sql
[0m13:41:22.566234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbbbb1b1-287a-429f-8f0a-1bc5b1452ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112762f90>]}
[0m13:41:22.566958 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model analytics.openweather_join ................ [[31mERROR[0m in 1.67s]
[0m13:41:22.567567 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m13:41:22.567999 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m13:41:22.569273 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m13:41:22.569758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m13:41:22.570105 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m13:41:22.573628 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m13:41:22.575115 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m13:41:22.578508 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m13:41:22.580041 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m13:41:22.580382 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    *
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME
        );
[0m13:41:22.580671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:24.833120 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.252 seconds
[0m13:41:24.837217 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m13:41:24.992845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbbbb1b1-287a-429f-8f0a-1bc5b1452ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10553ec90>]}
[0m13:41:24.993895 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 2.42s]
[0m13:41:24.994734 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m13:41:24.996399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:41:24.996835 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m13:41:24.997295 [info ] [MainThread]: 
[0m13:41:24.997673 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 12.08 seconds (12.08s).
[0m13:41:24.998986 [debug] [MainThread]: Command end result
[0m13:41:25.026313 [info ] [MainThread]: 
[0m13:41:25.026656 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:41:25.026861 [info ] [MainThread]: 
[0m13:41:25.027191 [error] [MainThread]:   Database Error in model openweather_join (models/input/openweather_join.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/input/openweather_join.sql
[0m13:41:25.027534 [info ] [MainThread]: 
[0m13:41:25.027770 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m13:41:25.029565 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.292195, "process_in_blocks": "0", "process_kernel_time": 0.287667, "process_mem_max_rss": "148635648", "process_out_blocks": "0", "process_user_time": 2.242438}
[0m13:41:25.030093 [debug] [MainThread]: Command `dbt run` failed at 13:41:25.030009 after 13.29 seconds
[0m13:41:25.030365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112454e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127afe30>]}
[0m13:41:25.030597 [debug] [MainThread]: Flushing usage events
[0m13:43:22.728438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1209dbb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1209dbd90>]}


============================== 13:43:22.731833 | b6fb605d-0793-44d8-a5c9-a319791c2833 ==============================
[0m13:43:22.731833 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:43:22.732165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:43:22.956185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6fb605d-0793-44d8-a5c9-a319791c2833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ae6b10>]}
[0m13:43:22.979655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6fb605d-0793-44d8-a5c9-a319791c2833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1239fc050>]}
[0m13:43:22.980550 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:43:23.039806 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:43:23.121395 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:43:23.121752 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/input/openweather_join.sql
[0m13:43:23.235506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6fb605d-0793-44d8-a5c9-a319791c2833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123fe0a50>]}
[0m13:43:23.331327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6fb605d-0793-44d8-a5c9-a319791c2833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1209dd8b0>]}
[0m13:43:23.331633 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m13:43:23.331810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6fb605d-0793-44d8-a5c9-a319791c2833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1240158d0>]}
[0m13:43:23.332872 [info ] [MainThread]: 
[0m13:43:23.333168 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:43:23.335283 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m13:43:23.342010 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m13:43:23.342224 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m13:43:23.342363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:23.923849 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.581 seconds
[0m13:43:23.926309 [debug] [ThreadPool]: On list_openweather: Close
[0m13:43:24.057376 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now create_openweather_analytics)
[0m13:43:24.058538 [debug] [ThreadPool]: Creating schema "database: "openweather"
schema: "analytics"
"
[0m13:43:24.065112 [debug] [ThreadPool]: Using snowflake connection "create_openweather_analytics"
[0m13:43:24.065536 [debug] [ThreadPool]: On create_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "create_openweather_analytics"} */
create schema if not exists openweather.analytics
[0m13:43:24.065878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:24.612686 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.547 seconds
[0m13:43:24.614017 [debug] [ThreadPool]: On create_openweather_analytics: Close
[0m13:43:24.727861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_openweather_analytics, now list_openweather_snapshot)
[0m13:43:24.733301 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m13:43:24.733528 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m13:43:24.733707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:25.272841 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.539 seconds
[0m13:43:25.276778 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m13:43:25.411033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m13:43:25.414924 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m13:43:25.415369 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m13:43:25.415683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:25.834766 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.419 seconds
[0m13:43:25.837165 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m13:43:25.963044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6fb605d-0793-44d8-a5c9-a319791c2833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124174d50>]}
[0m13:43:25.963758 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m13:43:25.964117 [info ] [MainThread]: 
[0m13:43:25.968302 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m13:43:25.968897 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m13:43:25.969395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m13:43:25.970309 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m13:43:25.978401 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m13:43:25.979571 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m13:43:26.002172 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m13:43:26.003261 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m13:43:26.003524 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m13:43:26.003749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:27.380803 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.377 seconds
[0m13:43:27.402854 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m13:43:27.529073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fb605d-0793-44d8-a5c9-a319791c2833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12435d250>]}
[0m13:43:27.530129 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.56s]
[0m13:43:27.531006 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m13:43:27.531655 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m13:43:27.532475 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m13:43:27.533097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m13:43:27.533519 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m13:43:27.537010 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m13:43:27.538137 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m13:43:27.541633 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m13:43:27.543569 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m13:43:27.544012 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m13:43:27.544391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:28.905245 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.361 seconds
[0m13:43:28.907752 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m13:43:29.061441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fb605d-0793-44d8-a5c9-a319791c2833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12441b540>]}
[0m13:43:29.062559 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.53s]
[0m13:43:29.063291 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m13:43:29.063787 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m13:43:29.064438 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m13:43:29.065036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m13:43:29.065464 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m13:43:29.069725 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m13:43:29.070892 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m13:43:29.074215 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m13:43:29.075785 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m13:43:29.076158 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    *
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY
        );
[0m13:43:29.076484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:30.554602 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.478 seconds
[0m13:43:30.559886 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m13:43:30.681240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fb605d-0793-44d8-a5c9-a319791c2833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124433070>]}
[0m13:43:30.682058 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.hourly_weather_patterns ............ [[32mSUCCESS 1[0m in 1.62s]
[0m13:43:30.682669 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m13:43:30.683107 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m13:43:30.683623 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m13:43:30.684045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m13:43:30.684347 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m13:43:30.687440 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m13:43:30.688436 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m13:43:30.709697 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m13:43:30.710681 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m13:43:30.710928 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    c.Latitude AS CITY_LATITUDE,
    c.Longitude AS CITY_LONGITUDE,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m13:43:30.711151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:31.176954 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b417-0004-386c-0002-594300043256
[0m13:43:31.177653 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 4
invalid identifier 'C.LATITUDE'
[0m13:43:31.178275 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m13:43:31.350801 [debug] [Thread-1 (]: Database Error in model openweather_join (models/input/openweather_join.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/input/openweather_join.sql
[0m13:43:31.351462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fb605d-0793-44d8-a5c9-a319791c2833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123e371d0>]}
[0m13:43:31.352147 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model analytics.openweather_join ................ [[31mERROR[0m in 0.67s]
[0m13:43:31.352681 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m13:43:31.353054 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m13:43:31.354200 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m13:43:31.354657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m13:43:31.354975 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m13:43:31.358194 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m13:43:31.359047 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m13:43:31.361937 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m13:43:31.363216 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m13:43:31.363527 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    *
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME
        );
[0m13:43:31.363802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:32.697819 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.333 seconds
[0m13:43:32.701608 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m13:43:32.821659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6fb605d-0793-44d8-a5c9-a319791c2833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12442ab30>]}
[0m13:43:32.822708 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.47s]
[0m13:43:32.823313 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m13:43:32.824715 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:32.825004 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m13:43:32.825370 [info ] [MainThread]: 
[0m13:43:32.825669 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 9.49 seconds (9.49s).
[0m13:43:32.826758 [debug] [MainThread]: Command end result
[0m13:43:32.850915 [info ] [MainThread]: 
[0m13:43:32.851269 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:43:32.851471 [info ] [MainThread]: 
[0m13:43:32.851730 [error] [MainThread]:   Database Error in model openweather_join (models/input/openweather_join.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/input/openweather_join.sql
[0m13:43:32.851931 [info ] [MainThread]: 
[0m13:43:32.852123 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m13:43:32.853611 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.162654, "process_in_blocks": "0", "process_kernel_time": 0.279424, "process_mem_max_rss": "142721024", "process_out_blocks": "0", "process_user_time": 1.760066}
[0m13:43:32.853937 [debug] [MainThread]: Command `dbt run` failed at 13:43:32.853883 after 10.16 seconds
[0m13:43:32.854174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1244349b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10616a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1248a8710>]}
[0m13:43:32.854383 [debug] [MainThread]: Flushing usage events
[0m13:44:05.623523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fbcd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088bfb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088bfd90>]}


============================== 13:44:05.625842 | da70173b-2512-4cc1-b284-e0147053ce70 ==============================
[0m13:44:05.625842 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:44:05.626199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:44:05.801115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da70173b-2512-4cc1-b284-e0147053ce70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109506b10>]}
[0m13:44:05.830574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da70173b-2512-4cc1-b284-e0147053ce70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10941c050>]}
[0m13:44:05.831183 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:44:05.886066 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:44:05.956998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:44:05.957332 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/input/openweather_join.sql
[0m13:44:06.072608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da70173b-2512-4cc1-b284-e0147053ce70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098e0950>]}
[0m13:44:06.164166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da70173b-2512-4cc1-b284-e0147053ce70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c18b0>]}
[0m13:44:06.164477 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m13:44:06.164645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da70173b-2512-4cc1-b284-e0147053ce70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099158d0>]}
[0m13:44:06.165873 [info ] [MainThread]: 
[0m13:44:06.166249 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:44:06.168401 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m13:44:06.175158 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m13:44:06.175359 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m13:44:06.175503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:06.717429 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.542 seconds
[0m13:44:06.720483 [debug] [ThreadPool]: On list_openweather: Close
[0m13:44:06.861211 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m13:44:06.872164 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m13:44:06.872659 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m13:44:06.872948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:07.351354 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.478 seconds
[0m13:44:07.354059 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m13:44:07.467853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m13:44:07.471203 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m13:44:07.471582 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m13:44:07.471888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:07.899270 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.427 seconds
[0m13:44:07.901998 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m13:44:08.043772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da70173b-2512-4cc1-b284-e0147053ce70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a0e9c0>]}
[0m13:44:08.044987 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m13:44:08.045434 [info ] [MainThread]: 
[0m13:44:08.048810 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m13:44:08.049528 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m13:44:08.050042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now model.weather_dbt.daily_avg_weather_trend)
[0m13:44:08.050442 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m13:44:08.059759 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m13:44:08.060802 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m13:44:08.083364 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m13:44:08.084356 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m13:44:08.084607 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m13:44:08.084825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:09.560431 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.475 seconds
[0m13:44:09.588438 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m13:44:09.709531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da70173b-2512-4cc1-b284-e0147053ce70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b604d0>]}
[0m13:44:09.710505 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.66s]
[0m13:44:09.711233 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m13:44:09.711730 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m13:44:09.712425 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m13:44:09.713009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m13:44:09.713431 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m13:44:09.716898 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m13:44:09.717895 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m13:44:09.720822 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m13:44:09.722555 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m13:44:09.723273 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m13:44:09.723647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:11.015745 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.292 seconds
[0m13:44:11.018127 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m13:44:11.147466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da70173b-2512-4cc1-b284-e0147053ce70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108891ff0>]}
[0m13:44:11.148405 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.43s]
[0m13:44:11.148982 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m13:44:11.149437 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m13:44:11.149944 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m13:44:11.150350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m13:44:11.150644 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m13:44:11.153805 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m13:44:11.154761 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m13:44:11.156809 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m13:44:11.158158 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m13:44:11.158471 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    *
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY
        );
[0m13:44:11.158750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:12.331124 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.172 seconds
[0m13:44:12.335181 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m13:44:12.483135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da70173b-2512-4cc1-b284-e0147053ce70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cc6710>]}
[0m13:44:12.484719 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.hourly_weather_patterns ............ [[32mSUCCESS 1[0m in 1.33s]
[0m13:44:12.485630 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m13:44:12.486185 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m13:44:12.486767 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m13:44:12.487339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m13:44:12.487789 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m13:44:12.491671 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m13:44:12.492740 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m13:44:12.516801 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m13:44:12.518387 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m13:44:12.518699 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    c.Latitude,
    c.Longitude,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m13:44:12.518950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:12.946190 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b418-0004-3867-0002-59430004527e
[0m13:44:12.946961 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 4
invalid identifier 'C.LATITUDE'
[0m13:44:12.947562 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m13:44:13.082191 [debug] [Thread-1 (]: Database Error in model openweather_join (models/input/openweather_join.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/input/openweather_join.sql
[0m13:44:13.083010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da70173b-2512-4cc1-b284-e0147053ce70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109810650>]}
[0m13:44:13.083756 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model analytics.openweather_join ................ [[31mERROR[0m in 0.60s]
[0m13:44:13.084361 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m13:44:13.084783 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m13:44:13.085217 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m13:44:13.086481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m13:44:13.086846 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m13:44:13.089783 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m13:44:13.090614 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m13:44:13.092620 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m13:44:13.093733 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m13:44:13.094057 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    *
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME
        );
[0m13:44:13.094359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:14.579989 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.485 seconds
[0m13:44:14.583686 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m13:44:14.709979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da70173b-2512-4cc1-b284-e0147053ce70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077573f0>]}
[0m13:44:14.711095 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.62s]
[0m13:44:14.711824 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m13:44:14.713427 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:14.713842 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m13:44:14.714294 [info ] [MainThread]: 
[0m13:44:14.714662 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 8.55 seconds (8.55s).
[0m13:44:14.715947 [debug] [MainThread]: Command end result
[0m13:44:14.743190 [info ] [MainThread]: 
[0m13:44:14.743609 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:44:14.743825 [info ] [MainThread]: 
[0m13:44:14.744086 [error] [MainThread]:   Database Error in model openweather_join (models/input/openweather_join.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/input/openweather_join.sql
[0m13:44:14.744288 [info ] [MainThread]: 
[0m13:44:14.744490 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m13:44:14.745708 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.154613, "process_in_blocks": "0", "process_kernel_time": 0.234763, "process_mem_max_rss": "144523264", "process_out_blocks": "0", "process_user_time": 1.681666}
[0m13:44:14.746085 [debug] [MainThread]: Command `dbt run` failed at 13:44:14.746012 after 9.16 seconds
[0m13:44:14.746356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c87d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109db3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109db3ef0>]}
[0m13:44:14.746589 [debug] [MainThread]: Flushing usage events
[0m13:44:31.993668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10525cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d7d90>]}


============================== 13:44:31.996067 | 4dacec1e-d3cf-49b7-b19a-8cbfa23b3456 ==============================
[0m13:44:31.996067 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:44:31.996391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:44:32.163766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4dacec1e-d3cf-49b7-b19a-8cbfa23b3456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f06b10>]}
[0m13:44:32.186227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4dacec1e-d3cf-49b7-b19a-8cbfa23b3456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f0c050>]}
[0m13:44:32.186632 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:44:32.241570 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:44:32.314941 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:44:32.315164 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:44:32.342449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4dacec1e-d3cf-49b7-b19a-8cbfa23b3456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e71450>]}
[0m13:44:32.404259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4dacec1e-d3cf-49b7-b19a-8cbfa23b3456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10949caa0>]}
[0m13:44:32.404577 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m13:44:32.404747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dacec1e-d3cf-49b7-b19a-8cbfa23b3456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109548d70>]}
[0m13:44:32.405799 [info ] [MainThread]: 
[0m13:44:32.406099 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:44:32.408187 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m13:44:32.415517 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m13:44:32.415746 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m13:44:32.415884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:32.968223 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.552 seconds
[0m13:44:32.971549 [debug] [ThreadPool]: On list_openweather: Close
[0m13:44:33.084537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m13:44:33.094374 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m13:44:33.094809 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m13:44:33.095097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:33.899450 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.804 seconds
[0m13:44:33.901939 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m13:44:34.006074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m13:44:34.009592 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m13:44:34.009986 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m13:44:34.011681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:34.654149 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.642 seconds
[0m13:44:34.656463 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m13:44:34.779637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dacec1e-d3cf-49b7-b19a-8cbfa23b3456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10955fd40>]}
[0m13:44:34.780503 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m13:44:34.780933 [info ] [MainThread]: 
[0m13:44:34.784157 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m13:44:34.784887 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m13:44:34.785387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now model.weather_dbt.daily_avg_weather_trend)
[0m13:44:34.785680 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m13:44:34.794390 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m13:44:34.795377 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m13:44:34.818386 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m13:44:34.819526 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m13:44:34.819785 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m13:44:34.820010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:36.284176 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.464 seconds
[0m13:44:36.306923 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m13:44:36.443214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dacec1e-d3cf-49b7-b19a-8cbfa23b3456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10986c4d0>]}
[0m13:44:36.444209 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.66s]
[0m13:44:36.444856 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m13:44:36.445604 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m13:44:36.446294 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m13:44:36.446978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m13:44:36.447349 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m13:44:36.450302 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m13:44:36.451381 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m13:44:36.454366 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m13:44:36.455852 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m13:44:36.456357 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m13:44:36.456678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:37.612456 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.156 seconds
[0m13:44:37.614596 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m13:44:37.746949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dacec1e-d3cf-49b7-b19a-8cbfa23b3456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a9ff0>]}
[0m13:44:37.748159 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.30s]
[0m13:44:37.748918 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m13:44:37.749396 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m13:44:37.750028 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m13:44:37.750623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m13:44:37.751056 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m13:44:37.754729 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m13:44:37.755634 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m13:44:37.758295 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m13:44:37.760007 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m13:44:37.760506 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    *
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY
        );
[0m13:44:37.760893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:39.049861 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.288 seconds
[0m13:44:39.051877 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m13:44:39.177103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dacec1e-d3cf-49b7-b19a-8cbfa23b3456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e556d0>]}
[0m13:44:39.178219 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.hourly_weather_patterns ............ [[32mSUCCESS 1[0m in 1.43s]
[0m13:44:39.179066 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m13:44:39.179651 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m13:44:39.180442 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m13:44:39.181184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m13:44:39.181741 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m13:44:39.186061 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m13:44:39.187476 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m13:44:39.207756 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m13:44:39.208931 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m13:44:39.209249 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    c.Latitude,
    c.Longitude,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m13:44:39.209526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:39.694696 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b418-0004-3868-0002-5943000402f6
[0m13:44:39.695563 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 4
invalid identifier 'C.LATITUDE'
[0m13:44:39.696232 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m13:44:39.856843 [debug] [Thread-1 (]: Database Error in model openweather_join (models/input/openweather_join.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/input/openweather_join.sql
[0m13:44:39.857615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dacec1e-d3cf-49b7-b19a-8cbfa23b3456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107076fd0>]}
[0m13:44:39.858349 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model analytics.openweather_join ................ [[31mERROR[0m in 0.68s]
[0m13:44:39.858973 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m13:44:39.859394 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m13:44:39.860865 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m13:44:39.861643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m13:44:39.862083 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m13:44:39.865474 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m13:44:39.866597 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m13:44:39.868697 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m13:44:39.869791 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m13:44:39.870112 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    *
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME
        );
[0m13:44:39.870411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:41.352866 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.482 seconds
[0m13:44:41.360800 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m13:44:41.489911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dacec1e-d3cf-49b7-b19a-8cbfa23b3456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109941400>]}
[0m13:44:41.490765 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.63s]
[0m13:44:41.491328 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m13:44:41.492700 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:41.492991 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m13:44:41.493323 [info ] [MainThread]: 
[0m13:44:41.493569 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 9.09 seconds (9.09s).
[0m13:44:41.494479 [debug] [MainThread]: Command end result
[0m13:44:41.516688 [info ] [MainThread]: 
[0m13:44:41.517004 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:44:41.517185 [info ] [MainThread]: 
[0m13:44:41.517420 [error] [MainThread]:   Database Error in model openweather_join (models/input/openweather_join.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'C.LATITUDE'
  compiled code at target/run/weather_dbt/models/input/openweather_join.sql
[0m13:44:41.517594 [info ] [MainThread]: 
[0m13:44:41.517771 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m13:44:41.518858 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.559261, "process_in_blocks": "0", "process_kernel_time": 0.224214, "process_mem_max_rss": "138870784", "process_out_blocks": "0", "process_user_time": 1.560193}
[0m13:44:41.519158 [debug] [MainThread]: Command `dbt run` failed at 13:44:41.519108 after 9.56 seconds
[0m13:44:41.519364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057e9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e1ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e1fe30>]}
[0m13:44:41.519548 [debug] [MainThread]: Flushing usage events
[0m13:44:51.346375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ccd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060cfb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060cfd90>]}


============================== 13:44:51.348671 | 857dfea0-02be-4e12-89e0-5166eee5a031 ==============================
[0m13:44:51.348671 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:44:51.348988 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:44:51.507950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '857dfea0-02be-4e12-89e0-5166eee5a031', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d1ab10>]}
[0m13:44:51.530611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '857dfea0-02be-4e12-89e0-5166eee5a031', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d1c050>]}
[0m13:44:51.531032 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:44:51.586437 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:44:51.656318 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:44:51.656661 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/input/openweather_join.sql
[0m13:44:51.768735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '857dfea0-02be-4e12-89e0-5166eee5a031', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f0950>]}
[0m13:44:51.863791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '857dfea0-02be-4e12-89e0-5166eee5a031', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d18b0>]}
[0m13:44:51.864122 [info ] [MainThread]: Found 5 models, 4 snapshots, 7 data tests, 2 sources, 459 macros
[0m13:44:51.864304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '857dfea0-02be-4e12-89e0-5166eee5a031', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071258d0>]}
[0m13:44:51.865348 [info ] [MainThread]: 
[0m13:44:51.865636 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:44:51.867737 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m13:44:51.874740 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m13:44:51.874971 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m13:44:51.875113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:52.420765 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.545 seconds
[0m13:44:52.424557 [debug] [ThreadPool]: On list_openweather: Close
[0m13:44:52.567276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_snapshot)
[0m13:44:52.575485 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m13:44:52.575797 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m13:44:52.576032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:53.193216 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.617 seconds
[0m13:44:53.198369 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m13:44:53.330327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m13:44:53.334437 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m13:44:53.334834 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m13:44:53.335153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:53.901862 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.566 seconds
[0m13:44:53.906314 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m13:44:54.070895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '857dfea0-02be-4e12-89e0-5166eee5a031', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072429c0>]}
[0m13:44:54.071936 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m13:44:54.072434 [info ] [MainThread]: 
[0m13:44:54.075508 [debug] [Thread-1 (]: Began running node model.weather_dbt.daily_avg_weather_trend
[0m13:44:54.076216 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.daily_avg_weather_trend ................. [RUN]
[0m13:44:54.076751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.daily_avg_weather_trend)
[0m13:44:54.077529 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.daily_avg_weather_trend
[0m13:44:54.087685 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.daily_avg_weather_trend"
[0m13:44:54.088843 [debug] [Thread-1 (]: Began executing node model.weather_dbt.daily_avg_weather_trend
[0m13:44:54.110737 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.daily_avg_weather_trend"
[0m13:44:54.111777 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.daily_avg_weather_trend"
[0m13:44:54.112031 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.daily_avg_weather_trend"} */
create or replace transient table openweather.analytics.daily_avg_weather_trend
         as
        (WITH Daily_Average_Weather_Trend AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('day', w.DATE_TIME) AS WEATHER_DATE,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", DATE_TRUNC('day', w.DATE_TIME)
)
SELECT
    *
FROM
    Daily_Average_Weather_Trend
ORDER BY
    WEATHER_DATE, CITY_NAME
        );
[0m13:44:54.112254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:55.482568 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.370 seconds
[0m13:44:55.502467 [debug] [Thread-1 (]: On model.weather_dbt.daily_avg_weather_trend: Close
[0m13:44:55.613636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '857dfea0-02be-4e12-89e0-5166eee5a031', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073744d0>]}
[0m13:44:55.614706 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.daily_avg_weather_trend ............ [[32mSUCCESS 1[0m in 1.54s]
[0m13:44:55.615565 [debug] [Thread-1 (]: Finished running node model.weather_dbt.daily_avg_weather_trend
[0m13:44:55.616091 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m13:44:55.616777 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m13:44:55.617410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.daily_avg_weather_trend, now model.weather_dbt.extreme_weather_events)
[0m13:44:55.617854 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m13:44:55.621438 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m13:44:55.622424 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m13:44:55.625871 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m13:44:55.627774 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m13:44:55.628252 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m13:44:55.628591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:56.869839 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.241 seconds
[0m13:44:56.874112 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m13:44:57.015669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '857dfea0-02be-4e12-89e0-5166eee5a031', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a1ff0>]}
[0m13:44:57.016842 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.40s]
[0m13:44:57.017721 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m13:44:57.018344 [debug] [Thread-1 (]: Began running node model.weather_dbt.hourly_weather_patterns
[0m13:44:57.019145 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.hourly_weather_patterns ................. [RUN]
[0m13:44:57.019906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.hourly_weather_patterns)
[0m13:44:57.020445 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.hourly_weather_patterns
[0m13:44:57.024832 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.hourly_weather_patterns"
[0m13:44:57.026026 [debug] [Thread-1 (]: Began executing node model.weather_dbt.hourly_weather_patterns
[0m13:44:57.028529 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.hourly_weather_patterns"
[0m13:44:57.030770 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.hourly_weather_patterns"
[0m13:44:57.031200 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.hourly_weather_patterns"} */
create or replace transient table openweather.analytics.hourly_weather_patterns
         as
        (WITH Hourly_Weather_Patterns AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME, -- Include city name for better insights
        EXTRACT(HOUR FROM w.DATE_TIME) AS HOUR_OF_DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", EXTRACT(HOUR FROM w.DATE_TIME)
)
SELECT
    *
FROM
    Hourly_Weather_Patterns
ORDER BY
    CITY_NAME, HOUR_OF_DAY
        );
[0m13:44:57.031556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:58.508450 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.477 seconds
[0m13:44:58.511325 [debug] [Thread-1 (]: On model.weather_dbt.hourly_weather_patterns: Close
[0m13:44:58.634756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '857dfea0-02be-4e12-89e0-5166eee5a031', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074da710>]}
[0m13:44:58.635787 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.hourly_weather_patterns ............ [[32mSUCCESS 1[0m in 1.61s]
[0m13:44:58.636556 [debug] [Thread-1 (]: Finished running node model.weather_dbt.hourly_weather_patterns
[0m13:44:58.637044 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m13:44:58.637659 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.openweather_join ......................... [RUN]
[0m13:44:58.638258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.hourly_weather_patterns, now model.weather_dbt.openweather_join)
[0m13:44:58.638687 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m13:44:58.642720 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m13:44:58.644020 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m13:44:58.671001 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m13:44:58.672402 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m13:44:58.672682 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    c."Latitude" AS CITY_LATITUDE,
    c."Longitude" AS CITY_LONGITUDE,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m13:44:58.673129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:59.511903 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.838 seconds
[0m13:44:59.516555 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m13:44:59.648667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '857dfea0-02be-4e12-89e0-5166eee5a031', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a99d0>]}
[0m13:44:59.649688 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 1.01s]
[0m13:44:59.650523 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m13:44:59.651091 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_condition_freq
[0m13:44:59.651854 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.weather_condition_freq .................. [RUN]
[0m13:44:59.652426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.weather_condition_freq)
[0m13:44:59.652882 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_condition_freq
[0m13:44:59.656877 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_condition_freq"
[0m13:44:59.657818 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_condition_freq
[0m13:44:59.660361 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_condition_freq"
[0m13:44:59.661678 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_condition_freq"
[0m13:44:59.662312 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_condition_freq"} */
create or replace transient table openweather.analytics.weather_condition_freq
         as
        (WITH Weather_Conditions_Frequency AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.WEATHER_MAIN,
        COUNT(*) AS CONDITION_COUNT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY
        w.CITY_ID, c."Name", w.WEATHER_MAIN
)
SELECT
    *
FROM
    Weather_Conditions_Frequency
ORDER BY
    CONDITION_COUNT DESC, CITY_NAME
        );
[0m13:44:59.662693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:00.864022 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.201 seconds
[0m13:45:00.867862 [debug] [Thread-1 (]: On model.weather_dbt.weather_condition_freq: Close
[0m13:45:01.004921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '857dfea0-02be-4e12-89e0-5166eee5a031', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10754bbd0>]}
[0m13:45:01.006076 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.weather_condition_freq ............. [[32mSUCCESS 1[0m in 1.35s]
[0m13:45:01.007409 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_condition_freq
[0m13:45:01.009328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:45:01.009804 [debug] [MainThread]: Connection 'model.weather_dbt.weather_condition_freq' was properly closed.
[0m13:45:01.010256 [info ] [MainThread]: 
[0m13:45:01.010627 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 9.14 seconds (9.14s).
[0m13:45:01.011939 [debug] [MainThread]: Command end result
[0m13:45:01.056860 [info ] [MainThread]: 
[0m13:45:01.057142 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:45:01.057297 [info ] [MainThread]: 
[0m13:45:01.057452 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:45:01.058355 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.743977, "process_in_blocks": "0", "process_kernel_time": 0.203566, "process_mem_max_rss": "140066816", "process_out_blocks": "0", "process_user_time": 1.69357}
[0m13:45:01.058615 [debug] [MainThread]: Command `dbt run` succeeded at 13:45:01.058568 after 9.74 seconds
[0m13:45:01.058787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ef1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10750fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10750fbf0>]}
[0m13:45:01.058947 [debug] [MainThread]: Flushing usage events
[0m14:12:24.588069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c44d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106547b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106547d90>]}


============================== 14:12:24.590963 | e39018c0-add8-46b9-bd34-f34ad1442b54 ==============================
[0m14:12:24.590963 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:12:24.591290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:12:24.644813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e39018c0-add8-46b9-bd34-f34ad1442b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053b3360>]}
[0m14:12:24.659025 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.10937392, "process_in_blocks": "0", "process_kernel_time": 0.133802, "process_mem_max_rss": "97812480", "process_out_blocks": "0", "process_user_time": 0.638705}
[0m14:12:24.659504 [debug] [MainThread]: Command `dbt clean` succeeded at 14:12:24.659426 after 0.11 seconds
[0m14:12:24.659708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106672580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106672690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062da950>]}
[0m14:12:24.659892 [debug] [MainThread]: Flushing usage events
[0m14:13:12.373842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103144d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a47b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a47d90>]}


============================== 14:13:12.376620 | 80bb7534-1597-464f-8f43-c171b192e342 ==============================
[0m14:13:12.376620 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:13:12.376937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:13:12.606603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80bb7534-1597-464f-8f43-c171b192e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105692b10>]}
[0m14:13:12.629305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80bb7534-1597-464f-8f43-c171b192e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105694050>]}
[0m14:13:12.629894 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:13:12.687151 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:13:12.687676 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:13:12.687861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '80bb7534-1597-464f-8f43-c171b192e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105518a50>]}
[0m14:13:13.186955 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:13:13.187269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '80bb7534-1597-464f-8f43-c171b192e342', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a498b0>]}
[0m14:13:13.192469 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'daily_avg_weather_trend' in the 'models' section of file 'models/schema.yml'
[0m14:13:13.265399 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.humidity_range_daily_avg' (tests/humidity_range_daily_avg.sql) depends on a node named 'daily_avg_weather_trend' in package '' which was not found
[0m14:13:13.265709 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.duplication_record_test_daily_avg' (tests/duplication_record_test_daily_avg.sql) depends on a node named 'daily_avg_weather_trend' in package '' which was not found
[0m14:13:13.265884 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.temp_range_daily_avg' (tests/temp_range_daily_avg.sql) depends on a node named 'daily_avg_weather_trend' in package '' which was not found
[0m14:13:13.266046 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_daily_avg_weather_trend_city_id.260a718790' (models/schema.yml) depends on a node named 'daily_avg_weather_trend' in package '' which was not found
[0m14:13:13.266194 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_daily_avg_weather_trend_weather_date.2c33d6d64b' (models/schema.yml) depends on a node named 'daily_avg_weather_trend' in package '' which was not found
[0m14:13:13.266344 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_daily_avg_weather_trend_avg_temp_fahrenheit.7a94a43372' (models/schema.yml) depends on a node named 'daily_avg_weather_trend' in package '' which was not found
[0m14:13:13.266484 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_daily_avg_weather_trend_avg_humidity.93e6ef1b07' (models/schema.yml) depends on a node named 'daily_avg_weather_trend' in package '' which was not found
[0m14:13:13.313756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80bb7534-1597-464f-8f43-c171b192e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aecc90>]}
[0m14:13:13.374692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80bb7534-1597-464f-8f43-c171b192e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a3ad0>]}
[0m14:13:13.375007 [info ] [MainThread]: Found 7 models, 2 sources, 459 macros
[0m14:13:13.375170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80bb7534-1597-464f-8f43-c171b192e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a35910>]}
[0m14:13:13.376146 [info ] [MainThread]: 
[0m14:13:13.376430 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:13:13.378724 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m14:13:13.384904 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m14:13:13.385115 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m14:13:13.385252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:14.078012 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.693 seconds
[0m14:13:14.080469 [debug] [ThreadPool]: On list_openweather: Close
[0m14:13:14.208633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m14:13:14.219798 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m14:13:14.220189 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m14:13:14.220475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:13:14.682603 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.462 seconds
[0m14:13:14.685973 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m14:13:14.813909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80bb7534-1597-464f-8f43-c171b192e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cbf6a0>]}
[0m14:13:14.815039 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m14:13:14.815553 [info ] [MainThread]: 
[0m14:13:14.820497 [debug] [Thread-1 (]: Began running node model.weather_dbt.cloud_coverage_over_time
[0m14:13:14.821321 [info ] [Thread-1 (]: 1 of 7 START sql table model analytics.cloud_coverage_over_time ................ [RUN]
[0m14:13:14.821973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.cloud_coverage_over_time)
[0m14:13:14.822364 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.cloud_coverage_over_time
[0m14:13:14.830108 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.cloud_coverage_over_time"
[0m14:13:14.831801 [debug] [Thread-1 (]: Began executing node model.weather_dbt.cloud_coverage_over_time
[0m14:13:14.857975 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.cloud_coverage_over_time"
[0m14:13:14.859265 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.cloud_coverage_over_time"
[0m14:13:14.859518 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.cloud_coverage_over_time"} */
create or replace transient table openweather.analytics.cloud_coverage_over_time
         as
        (WITH CloudCoverage AS (
    SELECT 
        c.CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        c.CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY;
[0m14:13:14.859740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:15.322817 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b435-0004-3869-0002-59430004234a
[0m14:13:15.323576 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 19 at position 12 unexpected ';'.
[0m14:13:15.324197 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: Close
[0m14:13:15.476248 [debug] [Thread-1 (]: Database Error in model cloud_coverage_over_time (models/output/cloud_coverage_over_time.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 12 unexpected ';'.
  compiled code at target/run/weather_dbt/models/output/cloud_coverage_over_time.sql
[0m14:13:15.477117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80bb7534-1597-464f-8f43-c171b192e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10400ba70>]}
[0m14:13:15.477450 [error] [Thread-1 (]: 1 of 7 ERROR creating sql table model analytics.cloud_coverage_over_time ....... [[31mERROR[0m in 0.65s]
[0m14:13:15.477913 [debug] [Thread-1 (]: Finished running node model.weather_dbt.cloud_coverage_over_time
[0m14:13:15.478576 [debug] [Thread-1 (]: Began running node model.weather_dbt.correlation
[0m14:13:15.478855 [info ] [Thread-1 (]: 2 of 7 START sql table model analytics.correlation ............................. [RUN]
[0m14:13:15.479686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.cloud_coverage_over_time, now model.weather_dbt.correlation)
[0m14:13:15.479881 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.correlation
[0m14:13:15.481819 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.correlation"
[0m14:13:15.484021 [debug] [Thread-1 (]: Began executing node model.weather_dbt.correlation
[0m14:13:15.485681 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.correlation"
[0m14:13:15.486334 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.correlation"
[0m14:13:15.486511 [debug] [Thread-1 (]: On model.weather_dbt.correlation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.correlation"} */
create or replace transient table openweather.analytics.correlation
         as
        (WITH CorrelationData AS (
    SELECT 
        c.CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        c.CITY_NAME
)
SELECT *
FROM CorrelationData;
[0m14:13:15.486676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:15.904925 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b435-0004-386b-0002-594300046312
[0m14:13:15.906233 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 20 unexpected ';'.
[0m14:13:15.907069 [debug] [Thread-1 (]: On model.weather_dbt.correlation: Close
[0m14:13:16.063843 [debug] [Thread-1 (]: Database Error in model correlation (models/output/correlation.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 20 unexpected ';'.
  compiled code at target/run/weather_dbt/models/output/correlation.sql
[0m14:13:16.065850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80bb7534-1597-464f-8f43-c171b192e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c9b050>]}
[0m14:13:16.066315 [error] [Thread-1 (]: 2 of 7 ERROR creating sql table model analytics.correlation .................... [[31mERROR[0m in 0.59s]
[0m14:13:16.066704 [debug] [Thread-1 (]: Finished running node model.weather_dbt.correlation
[0m14:13:16.066973 [debug] [Thread-1 (]: Began running node model.weather_dbt.humidity_vs_temp
[0m14:13:16.067365 [info ] [Thread-1 (]: 3 of 7 START sql table model analytics.humidity_vs_temp ........................ [RUN]
[0m14:13:16.067711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.correlation, now model.weather_dbt.humidity_vs_temp)
[0m14:13:16.067961 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.humidity_vs_temp
[0m14:13:16.070062 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.humidity_vs_temp"
[0m14:13:16.070641 [debug] [Thread-1 (]: Began executing node model.weather_dbt.humidity_vs_temp
[0m14:13:16.072731 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.humidity_vs_temp"
[0m14:13:16.073602 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.humidity_vs_temp"
[0m14:13:16.073847 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.humidity_vs_temp"} */
create or replace transient table openweather.analytics.humidity_vs_temp
         as
        (WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c.CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT *
FROM HumidityTemp;
[0m14:13:16.074062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:16.558167 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b435-0004-386a-0002-5943000413da
[0m14:13:16.559344 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 19 at position 17 unexpected ';'.
[0m14:13:16.560018 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: Close
[0m14:13:16.679748 [debug] [Thread-1 (]: Database Error in model humidity_vs_temp (models/output/humidity_vs_temp.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 17 unexpected ';'.
  compiled code at target/run/weather_dbt/models/output/humidity_vs_temp.sql
[0m14:13:16.680095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80bb7534-1597-464f-8f43-c171b192e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105985390>]}
[0m14:13:16.680456 [error] [Thread-1 (]: 3 of 7 ERROR creating sql table model analytics.humidity_vs_temp ............... [[31mERROR[0m in 0.61s]
[0m14:13:16.680775 [debug] [Thread-1 (]: Finished running node model.weather_dbt.humidity_vs_temp
[0m14:13:16.680996 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m14:13:16.681307 [info ] [Thread-1 (]: 4 of 7 START sql view model analytics.openweather_join ......................... [RUN]
[0m14:13:16.681588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.humidity_vs_temp, now model.weather_dbt.openweather_join)
[0m14:13:16.681788 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m14:13:16.684502 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m14:13:16.685560 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m14:13:16.703497 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m14:13:16.704626 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m14:13:16.704900 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    c."Latitude" AS CITY_LATITUDE,
    c."Longitude" AS CITY_LONGITUDE,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m14:13:16.705142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:17.733001 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.027 seconds
[0m14:13:17.759009 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m14:13:17.872556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80bb7534-1597-464f-8f43-c171b192e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f83b0>]}
[0m14:13:17.873741 [info ] [Thread-1 (]: 4 of 7 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 1.19s]
[0m14:13:17.874580 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m14:13:17.875161 [debug] [Thread-1 (]: Began running node model.weather_dbt.temp_trends_by_city
[0m14:13:17.875907 [info ] [Thread-1 (]: 5 of 7 START sql table model analytics.temp_trends_by_city ..................... [RUN]
[0m14:13:17.876544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.temp_trends_by_city)
[0m14:13:17.876978 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.temp_trends_by_city
[0m14:13:17.880932 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.temp_trends_by_city"
[0m14:13:17.882266 [debug] [Thread-1 (]: Began executing node model.weather_dbt.temp_trends_by_city
[0m14:13:17.885510 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.temp_trends_by_city"
[0m14:13:17.887487 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.temp_trends_by_city"
[0m14:13:17.887958 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.temp_trends_by_city"} */
create or replace transient table openweather.analytics.temp_trends_by_city
         as
        (WITH TempTrends AS (
    SELECT 
        CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY;
[0m14:13:17.888287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:18.360439 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b435-0004-3868-0002-59430004041a
[0m14:13:18.361728 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 19 at position 23 unexpected ';'.
[0m14:13:18.362508 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: Close
[0m14:13:18.520873 [debug] [Thread-1 (]: Database Error in model temp_trends_by_city (models/output/temp_trends_by_city.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 23 unexpected ';'.
  compiled code at target/run/weather_dbt/models/output/temp_trends_by_city.sql
[0m14:13:18.521768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80bb7534-1597-464f-8f43-c171b192e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f9070>]}
[0m14:13:18.522514 [error] [Thread-1 (]: 5 of 7 ERROR creating sql table model analytics.temp_trends_by_city ............ [[31mERROR[0m in 0.65s]
[0m14:13:18.523118 [debug] [Thread-1 (]: Finished running node model.weather_dbt.temp_trends_by_city
[0m14:13:18.523520 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_cond_distribution
[0m14:13:18.524086 [info ] [Thread-1 (]: 6 of 7 START sql table model analytics.weather_cond_distribution ............... [RUN]
[0m14:13:18.524616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.temp_trends_by_city, now model.weather_dbt.weather_cond_distribution)
[0m14:13:18.524982 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_cond_distribution
[0m14:13:18.528229 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_cond_distribution"
[0m14:13:18.529296 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_cond_distribution
[0m14:13:18.531754 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_cond_distribution"
[0m14:13:18.533249 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_cond_distribution"
[0m14:13:18.533600 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_cond_distribution"} */
create or replace transient table openweather.analytics.weather_cond_distribution
         as
        (WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c.CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, c.CITY_NAME
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC;
[0m14:13:18.534010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:18.998687 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b435-0004-386a-0002-5943000413de
[0m14:13:18.999991 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 19 at position 19 unexpected ';'.
[0m14:13:19.000765 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: Close
[0m14:13:19.128299 [debug] [Thread-1 (]: Database Error in model weather_cond_distribution (models/output/weather_cond_distribution.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 19 unexpected ';'.
  compiled code at target/run/weather_dbt/models/output/weather_cond_distribution.sql
[0m14:13:19.129036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80bb7534-1597-464f-8f43-c171b192e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f8a70>]}
[0m14:13:19.129851 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model analytics.weather_cond_distribution ...... [[31mERROR[0m in 0.60s]
[0m14:13:19.130541 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_cond_distribution
[0m14:13:19.131023 [debug] [Thread-1 (]: Began running node model.weather_dbt.wind_speed_analysis
[0m14:13:19.131674 [info ] [Thread-1 (]: 7 of 7 START sql table model analytics.wind_speed_analysis ..................... [RUN]
[0m14:13:19.132236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.weather_cond_distribution, now model.weather_dbt.wind_speed_analysis)
[0m14:13:19.132607 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.wind_speed_analysis
[0m14:13:19.135980 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.wind_speed_analysis"
[0m14:13:19.137335 [debug] [Thread-1 (]: Began executing node model.weather_dbt.wind_speed_analysis
[0m14:13:19.139665 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.wind_speed_analysis"
[0m14:13:19.140732 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.wind_speed_analysis"
[0m14:13:19.141059 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.wind_speed_analysis"} */
create or replace transient table openweather.analytics.wind_speed_analysis
         as
        (WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c.CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL 
)
SELECT *
FROM WindSpeedData;
[0m14:13:19.141355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:19.561509 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b435-0004-3867-0002-5943000453aa
[0m14:13:19.562878 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 17 at position 18 unexpected ';'.
[0m14:13:19.563655 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: Close
[0m14:13:19.700767 [debug] [Thread-1 (]: Database Error in model wind_speed_analysis (models/output/wind_speed_analysis.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 18 unexpected ';'.
  compiled code at target/run/weather_dbt/models/output/wind_speed_analysis.sql
[0m14:13:19.701484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80bb7534-1597-464f-8f43-c171b192e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021235f0>]}
[0m14:13:19.702298 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model analytics.wind_speed_analysis ............ [[31mERROR[0m in 0.57s]
[0m14:13:19.702910 [debug] [Thread-1 (]: Finished running node model.weather_dbt.wind_speed_analysis
[0m14:13:19.704334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:19.704691 [debug] [MainThread]: Connection 'model.weather_dbt.wind_speed_analysis' was properly closed.
[0m14:13:19.705092 [info ] [MainThread]: 
[0m14:13:19.705410 [info ] [MainThread]: Finished running 6 table models, 1 view model in 0 hours 0 minutes and 6.33 seconds (6.33s).
[0m14:13:19.706769 [debug] [MainThread]: Command end result
[0m14:13:19.733047 [info ] [MainThread]: 
[0m14:13:19.733388 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m14:13:19.733587 [info ] [MainThread]: 
[0m14:13:19.733836 [error] [MainThread]:   Database Error in model cloud_coverage_over_time (models/output/cloud_coverage_over_time.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 12 unexpected ';'.
  compiled code at target/run/weather_dbt/models/output/cloud_coverage_over_time.sql
[0m14:13:19.734001 [info ] [MainThread]: 
[0m14:13:19.734196 [error] [MainThread]:   Database Error in model correlation (models/output/correlation.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 20 unexpected ';'.
  compiled code at target/run/weather_dbt/models/output/correlation.sql
[0m14:13:19.734350 [info ] [MainThread]: 
[0m14:13:19.734539 [error] [MainThread]:   Database Error in model humidity_vs_temp (models/output/humidity_vs_temp.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 17 unexpected ';'.
  compiled code at target/run/weather_dbt/models/output/humidity_vs_temp.sql
[0m14:13:19.734693 [info ] [MainThread]: 
[0m14:13:19.734876 [error] [MainThread]:   Database Error in model temp_trends_by_city (models/output/temp_trends_by_city.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 23 unexpected ';'.
  compiled code at target/run/weather_dbt/models/output/temp_trends_by_city.sql
[0m14:13:19.735031 [info ] [MainThread]: 
[0m14:13:19.735213 [error] [MainThread]:   Database Error in model weather_cond_distribution (models/output/weather_cond_distribution.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 19 unexpected ';'.
  compiled code at target/run/weather_dbt/models/output/weather_cond_distribution.sql
[0m14:13:19.735363 [info ] [MainThread]: 
[0m14:13:19.735541 [error] [MainThread]:   Database Error in model wind_speed_analysis (models/output/wind_speed_analysis.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 18 unexpected ';'.
  compiled code at target/run/weather_dbt/models/output/wind_speed_analysis.sql
[0m14:13:19.735695 [info ] [MainThread]: 
[0m14:13:19.735866 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=6 SKIP=0 TOTAL=7
[0m14:13:19.737391 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.3988533, "process_in_blocks": "0", "process_kernel_time": 0.273208, "process_mem_max_rss": "145752064", "process_out_blocks": "0", "process_user_time": 2.107038}
[0m14:13:19.737828 [debug] [MainThread]: Command `dbt run` failed at 14:13:19.737756 after 7.40 seconds
[0m14:13:19.738081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ff67b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060fbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060fbfb0>]}
[0m14:13:19.738304 [debug] [MainThread]: Flushing usage events
[0m14:13:51.273876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d30d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108633b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108633d90>]}


============================== 14:13:51.277002 | ffac9678-0679-44b0-8eac-05e73d5b25cf ==============================
[0m14:13:51.277002 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:13:51.277314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:13:51.495690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffac9678-0679-44b0-8eac-05e73d5b25cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10927eb10>]}
[0m14:13:51.520927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffac9678-0679-44b0-8eac-05e73d5b25cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109280050>]}
[0m14:13:51.521781 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:13:51.581951 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:13:51.660430 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m14:13:51.660954 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/correlation.sql
[0m14:13:51.661181 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/cloud_coverage_over_time.sql
[0m14:13:51.661365 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/temp_trends_by_city.sql
[0m14:13:51.661523 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/humidity_vs_temp.sql
[0m14:13:51.661686 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/weather_cond_distribution.sql
[0m14:13:51.661843 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/wind_speed_analysis.sql
[0m14:13:51.783662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffac9678-0679-44b0-8eac-05e73d5b25cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109528850>]}
[0m14:13:51.844742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffac9678-0679-44b0-8eac-05e73d5b25cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109624410>]}
[0m14:13:51.845050 [info ] [MainThread]: Found 7 models, 2 sources, 459 macros
[0m14:13:51.845221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffac9678-0679-44b0-8eac-05e73d5b25cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109710050>]}
[0m14:13:51.846265 [info ] [MainThread]: 
[0m14:13:51.846548 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:13:51.848717 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m14:13:51.890252 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m14:13:51.890565 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m14:13:51.890726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:52.581601 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.690 seconds
[0m14:13:52.585501 [debug] [ThreadPool]: On list_openweather: Close
[0m14:13:52.738203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m14:13:52.748798 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m14:13:52.749182 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m14:13:52.749478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:13:53.258880 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.508 seconds
[0m14:13:53.263988 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m14:13:53.403826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffac9678-0679-44b0-8eac-05e73d5b25cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096fea90>]}
[0m14:13:53.404618 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m14:13:53.405016 [info ] [MainThread]: 
[0m14:13:53.409116 [debug] [Thread-1 (]: Began running node model.weather_dbt.cloud_coverage_over_time
[0m14:13:53.409739 [info ] [Thread-1 (]: 1 of 7 START sql table model analytics.cloud_coverage_over_time ................ [RUN]
[0m14:13:53.410202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.cloud_coverage_over_time)
[0m14:13:53.411031 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.cloud_coverage_over_time
[0m14:13:53.419113 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.cloud_coverage_over_time"
[0m14:13:53.420249 [debug] [Thread-1 (]: Began executing node model.weather_dbt.cloud_coverage_over_time
[0m14:13:53.442504 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.cloud_coverage_over_time"
[0m14:13:53.443543 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.cloud_coverage_over_time"
[0m14:13:53.443803 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.cloud_coverage_over_time"} */
create or replace transient table openweather.analytics.cloud_coverage_over_time
         as
        (WITH CloudCoverage AS (
    SELECT 
        c.CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        c.CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY
        );
[0m14:13:53.444031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:54.019958 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b435-0004-3865-0002-59430003f456
[0m14:13:54.020744 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 8
invalid identifier 'C.CITY_NAME'
[0m14:13:54.021338 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: Close
[0m14:13:54.144765 [debug] [Thread-1 (]: Database Error in model cloud_coverage_over_time (models/output/cloud_coverage_over_time.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'C.CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/cloud_coverage_over_time.sql
[0m14:13:54.146766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffac9678-0679-44b0-8eac-05e73d5b25cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991c110>]}
[0m14:13:54.147508 [error] [Thread-1 (]: 1 of 7 ERROR creating sql table model analytics.cloud_coverage_over_time ....... [[31mERROR[0m in 0.74s]
[0m14:13:54.148249 [debug] [Thread-1 (]: Finished running node model.weather_dbt.cloud_coverage_over_time
[0m14:13:54.148705 [debug] [Thread-1 (]: Began running node model.weather_dbt.correlation
[0m14:13:54.149783 [info ] [Thread-1 (]: 2 of 7 START sql table model analytics.correlation ............................. [RUN]
[0m14:13:54.150244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.cloud_coverage_over_time, now model.weather_dbt.correlation)
[0m14:13:54.150586 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.correlation
[0m14:13:54.153190 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.correlation"
[0m14:13:54.153856 [debug] [Thread-1 (]: Began executing node model.weather_dbt.correlation
[0m14:13:54.156454 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.correlation"
[0m14:13:54.157473 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.correlation"
[0m14:13:54.157786 [debug] [Thread-1 (]: On model.weather_dbt.correlation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.correlation"} */
create or replace transient table openweather.analytics.correlation
         as
        (WITH CorrelationData AS (
    SELECT 
        c.CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        c.CITY_NAME
)
SELECT *
FROM CorrelationData
        );
[0m14:13:54.158066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:54.684883 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b435-0004-3868-0002-594300040422
[0m14:13:54.685699 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 8
invalid identifier 'C.CITY_NAME'
[0m14:13:54.686368 [debug] [Thread-1 (]: On model.weather_dbt.correlation: Close
[0m14:13:54.822073 [debug] [Thread-1 (]: Database Error in model correlation (models/output/correlation.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'C.CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/correlation.sql
[0m14:13:54.822788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffac9678-0679-44b0-8eac-05e73d5b25cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099c99c0>]}
[0m14:13:54.823646 [error] [Thread-1 (]: 2 of 7 ERROR creating sql table model analytics.correlation .................... [[31mERROR[0m in 0.67s]
[0m14:13:54.824361 [debug] [Thread-1 (]: Finished running node model.weather_dbt.correlation
[0m14:13:54.824858 [debug] [Thread-1 (]: Began running node model.weather_dbt.humidity_vs_temp
[0m14:13:54.825484 [info ] [Thread-1 (]: 3 of 7 START sql table model analytics.humidity_vs_temp ........................ [RUN]
[0m14:13:54.825961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.correlation, now model.weather_dbt.humidity_vs_temp)
[0m14:13:54.826299 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.humidity_vs_temp
[0m14:13:54.829620 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.humidity_vs_temp"
[0m14:13:54.830812 [debug] [Thread-1 (]: Began executing node model.weather_dbt.humidity_vs_temp
[0m14:13:54.833429 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.humidity_vs_temp"
[0m14:13:54.834530 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.humidity_vs_temp"
[0m14:13:54.834867 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.humidity_vs_temp"} */
create or replace transient table openweather.analytics.humidity_vs_temp
         as
        (WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c.CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT *
FROM HumidityTemp
        );
[0m14:13:54.835171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:55.284889 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b435-0004-3864-0002-59430003edfe
[0m14:13:55.286107 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 8
invalid identifier 'C.CITY_NAME'
[0m14:13:55.287152 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: Close
[0m14:13:55.430777 [debug] [Thread-1 (]: Database Error in model humidity_vs_temp (models/output/humidity_vs_temp.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'C.CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/humidity_vs_temp.sql
[0m14:13:55.431490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffac9678-0679-44b0-8eac-05e73d5b25cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10996caf0>]}
[0m14:13:55.432353 [error] [Thread-1 (]: 3 of 7 ERROR creating sql table model analytics.humidity_vs_temp ............... [[31mERROR[0m in 0.61s]
[0m14:13:55.433066 [debug] [Thread-1 (]: Finished running node model.weather_dbt.humidity_vs_temp
[0m14:13:55.433567 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m14:13:55.434162 [info ] [Thread-1 (]: 4 of 7 START sql view model analytics.openweather_join ......................... [RUN]
[0m14:13:55.434669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.humidity_vs_temp, now model.weather_dbt.openweather_join)
[0m14:13:55.435028 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m14:13:55.438388 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m14:13:55.439493 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m14:13:55.459388 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m14:13:55.460571 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m14:13:55.460962 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    c."Latitude" AS CITY_LATITUDE,
    c."Longitude" AS CITY_LONGITUDE,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m14:13:55.461234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:56.175033 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.713 seconds
[0m14:13:56.201452 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m14:13:56.323562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffac9678-0679-44b0-8eac-05e73d5b25cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c51dd0>]}
[0m14:13:56.324404 [info ] [Thread-1 (]: 4 of 7 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.89s]
[0m14:13:56.325032 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m14:13:56.325462 [debug] [Thread-1 (]: Began running node model.weather_dbt.temp_trends_by_city
[0m14:13:56.325981 [info ] [Thread-1 (]: 5 of 7 START sql table model analytics.temp_trends_by_city ..................... [RUN]
[0m14:13:56.326488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.temp_trends_by_city)
[0m14:13:56.326869 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.temp_trends_by_city
[0m14:13:56.329950 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.temp_trends_by_city"
[0m14:13:56.331004 [debug] [Thread-1 (]: Began executing node model.weather_dbt.temp_trends_by_city
[0m14:13:56.334320 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.temp_trends_by_city"
[0m14:13:56.335668 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.temp_trends_by_city"
[0m14:13:56.336028 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.temp_trends_by_city"} */
create or replace transient table openweather.analytics.temp_trends_by_city
         as
        (WITH TempTrends AS (
    SELECT 
        CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY
        );
[0m14:13:56.336339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:56.806148 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b435-0004-3863-0002-594300044402
[0m14:13:56.807251 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 8
invalid identifier 'CITY_NAME'
[0m14:13:56.807842 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: Close
[0m14:13:56.970538 [debug] [Thread-1 (]: Database Error in model temp_trends_by_city (models/output/temp_trends_by_city.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/temp_trends_by_city.sql
[0m14:13:56.971457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffac9678-0679-44b0-8eac-05e73d5b25cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c78600>]}
[0m14:13:56.972410 [error] [Thread-1 (]: 5 of 7 ERROR creating sql table model analytics.temp_trends_by_city ............ [[31mERROR[0m in 0.64s]
[0m14:13:56.973175 [debug] [Thread-1 (]: Finished running node model.weather_dbt.temp_trends_by_city
[0m14:13:56.973607 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_cond_distribution
[0m14:13:56.974218 [info ] [Thread-1 (]: 6 of 7 START sql table model analytics.weather_cond_distribution ............... [RUN]
[0m14:13:56.974729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.temp_trends_by_city, now model.weather_dbt.weather_cond_distribution)
[0m14:13:56.975094 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_cond_distribution
[0m14:13:56.978887 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_cond_distribution"
[0m14:13:56.980068 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_cond_distribution
[0m14:13:56.982388 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_cond_distribution"
[0m14:13:56.983460 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_cond_distribution"
[0m14:13:56.983801 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_cond_distribution"} */
create or replace transient table openweather.analytics.weather_cond_distribution
         as
        (WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c.CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, c.CITY_NAME
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC
        );
[0m14:13:56.984116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:57.496105 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b435-0004-386c-0002-594300043396
[0m14:13:57.497311 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 8
invalid identifier 'C.CITY_NAME'
[0m14:13:57.497946 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: Close
[0m14:13:57.646651 [debug] [Thread-1 (]: Database Error in model weather_cond_distribution (models/output/weather_cond_distribution.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'C.CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/weather_cond_distribution.sql
[0m14:13:57.647425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffac9678-0679-44b0-8eac-05e73d5b25cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c7f4d0>]}
[0m14:13:57.648055 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model analytics.weather_cond_distribution ...... [[31mERROR[0m in 0.67s]
[0m14:13:57.648569 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_cond_distribution
[0m14:13:57.648902 [debug] [Thread-1 (]: Began running node model.weather_dbt.wind_speed_analysis
[0m14:13:57.649364 [info ] [Thread-1 (]: 7 of 7 START sql table model analytics.wind_speed_analysis ..................... [RUN]
[0m14:13:57.649809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.weather_cond_distribution, now model.weather_dbt.wind_speed_analysis)
[0m14:13:57.650103 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.wind_speed_analysis
[0m14:13:57.652750 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.wind_speed_analysis"
[0m14:13:57.653551 [debug] [Thread-1 (]: Began executing node model.weather_dbt.wind_speed_analysis
[0m14:13:57.655598 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.wind_speed_analysis"
[0m14:13:57.656753 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.wind_speed_analysis"
[0m14:13:57.657031 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.wind_speed_analysis"} */
create or replace transient table openweather.analytics.wind_speed_analysis
         as
        (WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c.CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL 
)
SELECT *
FROM WindSpeedData
        );
[0m14:13:57.657273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:58.101414 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b435-0004-3867-0002-5943000453be
[0m14:13:58.103029 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 8
invalid identifier 'C.CITY_NAME'
[0m14:13:58.104009 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: Close
[0m14:13:58.244873 [debug] [Thread-1 (]: Database Error in model wind_speed_analysis (models/output/wind_speed_analysis.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'C.CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/wind_speed_analysis.sql
[0m14:13:58.245569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffac9678-0679-44b0-8eac-05e73d5b25cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d0ef90>]}
[0m14:13:58.246351 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model analytics.wind_speed_analysis ............ [[31mERROR[0m in 0.60s]
[0m14:13:58.247029 [debug] [Thread-1 (]: Finished running node model.weather_dbt.wind_speed_analysis
[0m14:13:58.248658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:58.249024 [debug] [MainThread]: Connection 'model.weather_dbt.wind_speed_analysis' was properly closed.
[0m14:13:58.249437 [info ] [MainThread]: 
[0m14:13:58.249762 [info ] [MainThread]: Finished running 6 table models, 1 view model in 0 hours 0 minutes and 6.40 seconds (6.40s).
[0m14:13:58.251163 [debug] [MainThread]: Command end result
[0m14:13:58.275780 [info ] [MainThread]: 
[0m14:13:58.276141 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m14:13:58.276345 [info ] [MainThread]: 
[0m14:13:58.276626 [error] [MainThread]:   Database Error in model cloud_coverage_over_time (models/output/cloud_coverage_over_time.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'C.CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/cloud_coverage_over_time.sql
[0m14:13:58.276822 [info ] [MainThread]: 
[0m14:13:58.277038 [error] [MainThread]:   Database Error in model correlation (models/output/correlation.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'C.CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/correlation.sql
[0m14:13:58.277211 [info ] [MainThread]: 
[0m14:13:58.277417 [error] [MainThread]:   Database Error in model humidity_vs_temp (models/output/humidity_vs_temp.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'C.CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/humidity_vs_temp.sql
[0m14:13:58.277656 [info ] [MainThread]: 
[0m14:13:58.278036 [error] [MainThread]:   Database Error in model temp_trends_by_city (models/output/temp_trends_by_city.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/temp_trends_by_city.sql
[0m14:13:58.278266 [info ] [MainThread]: 
[0m14:13:58.278492 [error] [MainThread]:   Database Error in model weather_cond_distribution (models/output/weather_cond_distribution.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'C.CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/weather_cond_distribution.sql
[0m14:13:58.278724 [info ] [MainThread]: 
[0m14:13:58.278939 [error] [MainThread]:   Database Error in model wind_speed_analysis (models/output/wind_speed_analysis.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'C.CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/wind_speed_analysis.sql
[0m14:13:58.279102 [info ] [MainThread]: 
[0m14:13:58.279295 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=6 SKIP=0 TOTAL=7
[0m14:13:58.280828 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.0451994, "process_in_blocks": "0", "process_kernel_time": 0.264203, "process_mem_max_rss": "143196160", "process_out_blocks": "0", "process_user_time": 1.784234}
[0m14:13:58.281187 [debug] [MainThread]: Command `dbt run` failed at 14:13:58.281130 after 7.05 seconds
[0m14:13:58.281415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f003a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0039b0>]}
[0m14:13:58.281615 [debug] [MainThread]: Flushing usage events
[0m14:14:29.542312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a13b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a13d90>]}


============================== 14:14:29.544553 | 24586885-838a-48d4-ba31-357b49d76071 ==============================
[0m14:14:29.544553 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:14:29.544885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:14:29.716619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24586885-838a-48d4-ba31-357b49d76071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11287ab10>]}
[0m14:14:29.739314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24586885-838a-48d4-ba31-357b49d76071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127f0050>]}
[0m14:14:29.739712 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:14:29.793906 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:14:29.857980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:14:29.858359 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/wind_speed_analysis.sql
[0m14:14:29.964866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24586885-838a-48d4-ba31-357b49d76071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d5ca50>]}
[0m14:14:30.017344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24586885-838a-48d4-ba31-357b49d76071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dec410>]}
[0m14:14:30.017633 [info ] [MainThread]: Found 7 models, 2 sources, 459 macros
[0m14:14:30.017798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24586885-838a-48d4-ba31-357b49d76071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ea7cb0>]}
[0m14:14:30.018781 [info ] [MainThread]: 
[0m14:14:30.019069 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:14:30.021180 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m14:14:30.061846 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m14:14:30.062134 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m14:14:30.062285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:30.672725 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.610 seconds
[0m14:14:30.678177 [debug] [ThreadPool]: On list_openweather: Close
[0m14:14:30.810737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m14:14:30.821439 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m14:14:30.821810 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m14:14:30.822103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:31.357106 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.535 seconds
[0m14:14:31.361721 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m14:14:31.486349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24586885-838a-48d4-ba31-357b49d76071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e9ab60>]}
[0m14:14:31.487375 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m14:14:31.487792 [info ] [MainThread]: 
[0m14:14:31.490786 [debug] [Thread-1 (]: Began running node model.weather_dbt.cloud_coverage_over_time
[0m14:14:31.491457 [info ] [Thread-1 (]: 1 of 7 START sql table model analytics.cloud_coverage_over_time ................ [RUN]
[0m14:14:31.491974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.cloud_coverage_over_time)
[0m14:14:31.492357 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.cloud_coverage_over_time
[0m14:14:31.500475 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.cloud_coverage_over_time"
[0m14:14:31.501944 [debug] [Thread-1 (]: Began executing node model.weather_dbt.cloud_coverage_over_time
[0m14:14:31.525526 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.cloud_coverage_over_time"
[0m14:14:31.526581 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.cloud_coverage_over_time"
[0m14:14:31.526835 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.cloud_coverage_over_time"} */
create or replace transient table openweather.analytics.cloud_coverage_over_time
         as
        (WITH CloudCoverage AS (
    SELECT 
        c.CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        c.CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY
        );
[0m14:14:31.527095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:32.008966 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b436-0004-3869-0002-594300042356
[0m14:14:32.009727 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 8
invalid identifier 'C.CITY_NAME'
[0m14:14:32.010321 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: Close
[0m14:14:32.150865 [debug] [Thread-1 (]: Database Error in model cloud_coverage_over_time (models/output/cloud_coverage_over_time.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'C.CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/cloud_coverage_over_time.sql
[0m14:14:32.153035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24586885-838a-48d4-ba31-357b49d76071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cb0110>]}
[0m14:14:32.153926 [error] [Thread-1 (]: 1 of 7 ERROR creating sql table model analytics.cloud_coverage_over_time ....... [[31mERROR[0m in 0.66s]
[0m14:14:32.154667 [debug] [Thread-1 (]: Finished running node model.weather_dbt.cloud_coverage_over_time
[0m14:14:32.155157 [debug] [Thread-1 (]: Began running node model.weather_dbt.correlation
[0m14:14:32.156411 [info ] [Thread-1 (]: 2 of 7 START sql table model analytics.correlation ............................. [RUN]
[0m14:14:32.156933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.cloud_coverage_over_time, now model.weather_dbt.correlation)
[0m14:14:32.157307 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.correlation
[0m14:14:32.160591 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.correlation"
[0m14:14:32.161731 [debug] [Thread-1 (]: Began executing node model.weather_dbt.correlation
[0m14:14:32.164828 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.correlation"
[0m14:14:32.166017 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.correlation"
[0m14:14:32.166526 [debug] [Thread-1 (]: On model.weather_dbt.correlation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.correlation"} */
create or replace transient table openweather.analytics.correlation
         as
        (WITH CorrelationData AS (
    SELECT 
        c.CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        c.CITY_NAME
)
SELECT *
FROM CorrelationData
        );
[0m14:14:32.166910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:32.669574 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b436-0004-3865-0002-59430003f45e
[0m14:14:32.671080 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 8
invalid identifier 'C.CITY_NAME'
[0m14:14:32.672222 [debug] [Thread-1 (]: On model.weather_dbt.correlation: Close
[0m14:14:32.807327 [debug] [Thread-1 (]: Database Error in model correlation (models/output/correlation.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'C.CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/correlation.sql
[0m14:14:32.808278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24586885-838a-48d4-ba31-357b49d76071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d559c0>]}
[0m14:14:32.809047 [error] [Thread-1 (]: 2 of 7 ERROR creating sql table model analytics.correlation .................... [[31mERROR[0m in 0.65s]
[0m14:14:32.809705 [debug] [Thread-1 (]: Finished running node model.weather_dbt.correlation
[0m14:14:32.810148 [debug] [Thread-1 (]: Began running node model.weather_dbt.humidity_vs_temp
[0m14:14:32.810578 [info ] [Thread-1 (]: 3 of 7 START sql table model analytics.humidity_vs_temp ........................ [RUN]
[0m14:14:32.811087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.correlation, now model.weather_dbt.humidity_vs_temp)
[0m14:14:32.811499 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.humidity_vs_temp
[0m14:14:32.814140 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.humidity_vs_temp"
[0m14:14:32.814799 [debug] [Thread-1 (]: Began executing node model.weather_dbt.humidity_vs_temp
[0m14:14:32.816771 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.humidity_vs_temp"
[0m14:14:32.817696 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.humidity_vs_temp"
[0m14:14:32.818004 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.humidity_vs_temp"} */
create or replace transient table openweather.analytics.humidity_vs_temp
         as
        (WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c.CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT *
FROM HumidityTemp
        );
[0m14:14:32.818290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:33.291500 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b436-0004-3987-0002-59430003ddfe
[0m14:14:33.292847 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 8
invalid identifier 'C.CITY_NAME'
[0m14:14:33.293955 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: Close
[0m14:14:33.440243 [debug] [Thread-1 (]: Database Error in model humidity_vs_temp (models/output/humidity_vs_temp.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'C.CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/humidity_vs_temp.sql
[0m14:14:33.441025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24586885-838a-48d4-ba31-357b49d76071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128c77f0>]}
[0m14:14:33.441776 [error] [Thread-1 (]: 3 of 7 ERROR creating sql table model analytics.humidity_vs_temp ............... [[31mERROR[0m in 0.63s]
[0m14:14:33.442369 [debug] [Thread-1 (]: Finished running node model.weather_dbt.humidity_vs_temp
[0m14:14:33.442776 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m14:14:33.443353 [info ] [Thread-1 (]: 4 of 7 START sql view model analytics.openweather_join ......................... [RUN]
[0m14:14:33.443867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.humidity_vs_temp, now model.weather_dbt.openweather_join)
[0m14:14:33.444223 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m14:14:33.447543 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m14:14:33.448533 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m14:14:33.467219 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m14:14:33.468643 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m14:14:33.468926 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    c."Latitude" AS CITY_LATITUDE,
    c."Longitude" AS CITY_LONGITUDE,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m14:14:33.469174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:34.633701 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.164 seconds
[0m14:14:34.659173 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m14:14:34.806430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24586885-838a-48d4-ba31-357b49d76071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126f78d0>]}
[0m14:14:34.807488 [info ] [Thread-1 (]: 4 of 7 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 1.36s]
[0m14:14:34.808339 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m14:14:34.808925 [debug] [Thread-1 (]: Began running node model.weather_dbt.temp_trends_by_city
[0m14:14:34.809539 [info ] [Thread-1 (]: 5 of 7 START sql table model analytics.temp_trends_by_city ..................... [RUN]
[0m14:14:34.810121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.temp_trends_by_city)
[0m14:14:34.810531 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.temp_trends_by_city
[0m14:14:34.814245 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.temp_trends_by_city"
[0m14:14:34.815381 [debug] [Thread-1 (]: Began executing node model.weather_dbt.temp_trends_by_city
[0m14:14:34.818607 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.temp_trends_by_city"
[0m14:14:34.819847 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.temp_trends_by_city"
[0m14:14:34.820241 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.temp_trends_by_city"} */
create or replace transient table openweather.analytics.temp_trends_by_city
         as
        (WITH TempTrends AS (
    SELECT 
        CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY
        );
[0m14:14:34.820616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:35.290380 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b436-0004-3867-0002-5943000453c6
[0m14:14:35.291136 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 8
invalid identifier 'CITY_NAME'
[0m14:14:35.291737 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: Close
[0m14:14:35.440732 [debug] [Thread-1 (]: Database Error in model temp_trends_by_city (models/output/temp_trends_by_city.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/temp_trends_by_city.sql
[0m14:14:35.441727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24586885-838a-48d4-ba31-357b49d76071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e148a0>]}
[0m14:14:35.442832 [error] [Thread-1 (]: 5 of 7 ERROR creating sql table model analytics.temp_trends_by_city ............ [[31mERROR[0m in 0.63s]
[0m14:14:35.443709 [debug] [Thread-1 (]: Finished running node model.weather_dbt.temp_trends_by_city
[0m14:14:35.444238 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_cond_distribution
[0m14:14:35.444801 [info ] [Thread-1 (]: 6 of 7 START sql table model analytics.weather_cond_distribution ............... [RUN]
[0m14:14:35.445325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.temp_trends_by_city, now model.weather_dbt.weather_cond_distribution)
[0m14:14:35.445690 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_cond_distribution
[0m14:14:35.449018 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_cond_distribution"
[0m14:14:35.450182 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_cond_distribution
[0m14:14:35.452443 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_cond_distribution"
[0m14:14:35.453474 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_cond_distribution"
[0m14:14:35.453802 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_cond_distribution"} */
create or replace transient table openweather.analytics.weather_cond_distribution
         as
        (WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c.CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, c.CITY_NAME
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC
        );
[0m14:14:35.454102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:35.871669 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b436-0004-3868-0002-59430004042e
[0m14:14:35.872556 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 8
invalid identifier 'C.CITY_NAME'
[0m14:14:35.873182 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: Close
[0m14:14:36.034716 [debug] [Thread-1 (]: Database Error in model weather_cond_distribution (models/output/weather_cond_distribution.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'C.CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/weather_cond_distribution.sql
[0m14:14:36.035463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24586885-838a-48d4-ba31-357b49d76071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e47dd0>]}
[0m14:14:36.036289 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model analytics.weather_cond_distribution ...... [[31mERROR[0m in 0.59s]
[0m14:14:36.036970 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_cond_distribution
[0m14:14:36.037438 [debug] [Thread-1 (]: Began running node model.weather_dbt.wind_speed_analysis
[0m14:14:36.038069 [info ] [Thread-1 (]: 7 of 7 START sql table model analytics.wind_speed_analysis ..................... [RUN]
[0m14:14:36.038592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.weather_cond_distribution, now model.weather_dbt.wind_speed_analysis)
[0m14:14:36.038954 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.wind_speed_analysis
[0m14:14:36.042371 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.wind_speed_analysis"
[0m14:14:36.043658 [debug] [Thread-1 (]: Began executing node model.weather_dbt.wind_speed_analysis
[0m14:14:36.045928 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.wind_speed_analysis"
[0m14:14:36.046970 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.wind_speed_analysis"
[0m14:14:36.047290 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.wind_speed_analysis"} */
create or replace transient table openweather.analytics.wind_speed_analysis
         as
        (WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c.NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL 
)
SELECT *
FROM WindSpeedData
        );
[0m14:14:36.047586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:36.600044 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b436-0004-386b-0002-594300046322
[0m14:14:36.601036 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 8
invalid identifier 'C.NAME'
[0m14:14:36.601944 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: Close
[0m14:14:36.775637 [debug] [Thread-1 (]: Database Error in model wind_speed_analysis (models/output/wind_speed_analysis.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'C.NAME'
  compiled code at target/run/weather_dbt/models/output/wind_speed_analysis.sql
[0m14:14:36.776323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24586885-838a-48d4-ba31-357b49d76071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cfaa50>]}
[0m14:14:36.777036 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model analytics.wind_speed_analysis ............ [[31mERROR[0m in 0.74s]
[0m14:14:36.777684 [debug] [Thread-1 (]: Finished running node model.weather_dbt.wind_speed_analysis
[0m14:14:36.779052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:36.779367 [debug] [MainThread]: Connection 'model.weather_dbt.wind_speed_analysis' was properly closed.
[0m14:14:36.779734 [info ] [MainThread]: 
[0m14:14:36.780059 [info ] [MainThread]: Finished running 6 table models, 1 view model in 0 hours 0 minutes and 6.76 seconds (6.76s).
[0m14:14:36.781517 [debug] [MainThread]: Command end result
[0m14:14:36.805689 [info ] [MainThread]: 
[0m14:14:36.806028 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m14:14:36.806233 [info ] [MainThread]: 
[0m14:14:36.806483 [error] [MainThread]:   Database Error in model cloud_coverage_over_time (models/output/cloud_coverage_over_time.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'C.CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/cloud_coverage_over_time.sql
[0m14:14:36.806671 [info ] [MainThread]: 
[0m14:14:36.806896 [error] [MainThread]:   Database Error in model correlation (models/output/correlation.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'C.CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/correlation.sql
[0m14:14:36.807069 [info ] [MainThread]: 
[0m14:14:36.807282 [error] [MainThread]:   Database Error in model humidity_vs_temp (models/output/humidity_vs_temp.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'C.CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/humidity_vs_temp.sql
[0m14:14:36.807455 [info ] [MainThread]: 
[0m14:14:36.807669 [error] [MainThread]:   Database Error in model temp_trends_by_city (models/output/temp_trends_by_city.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/temp_trends_by_city.sql
[0m14:14:36.807839 [info ] [MainThread]: 
[0m14:14:36.808044 [error] [MainThread]:   Database Error in model weather_cond_distribution (models/output/weather_cond_distribution.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'C.CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/weather_cond_distribution.sql
[0m14:14:36.808218 [info ] [MainThread]: 
[0m14:14:36.808427 [error] [MainThread]:   Database Error in model wind_speed_analysis (models/output/wind_speed_analysis.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'C.NAME'
  compiled code at target/run/weather_dbt/models/output/wind_speed_analysis.sql
[0m14:14:36.808609 [info ] [MainThread]: 
[0m14:14:36.808803 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=6 SKIP=0 TOTAL=7
[0m14:14:36.809978 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.3009357, "process_in_blocks": "0", "process_kernel_time": 0.232779, "process_mem_max_rss": "140853248", "process_out_blocks": "0", "process_user_time": 1.760928}
[0m14:14:36.810315 [debug] [MainThread]: Command `dbt run` failed at 14:14:36.810256 after 7.30 seconds
[0m14:14:36.810550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127bd3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a3a810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120003ef0>]}
[0m14:14:36.810774 [debug] [MainThread]: Flushing usage events
[0m14:15:50.589681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd7d90>]}


============================== 14:15:50.592343 | 19803361-0f1f-462b-aaf4-458fbce2f30e ==============================
[0m14:15:50.592343 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:15:50.592664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:15:50.805116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19803361-0f1f-462b-aaf4-458fbce2f30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a7ab10>]}
[0m14:15:50.827871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19803361-0f1f-462b-aaf4-458fbce2f30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1209fc050>]}
[0m14:15:50.828499 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:15:50.886834 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:15:50.963937 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 5 files changed.
[0m14:15:50.964262 [debug] [MainThread]: Partial parsing: added file: weather_dbt://models/output/extreme_weather_events.sql
[0m14:15:50.964448 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/temp_trends_by_city.sql
[0m14:15:50.964615 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/weather_cond_distribution.sql
[0m14:15:50.964773 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/correlation.sql
[0m14:15:50.964932 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/humidity_vs_temp.sql
[0m14:15:50.965095 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/wind_speed_analysis.sql
[0m14:15:51.081412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19803361-0f1f-462b-aaf4-458fbce2f30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120dcc850>]}
[0m14:15:51.139865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19803361-0f1f-462b-aaf4-458fbce2f30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120e58410>]}
[0m14:15:51.140176 [info ] [MainThread]: Found 8 models, 2 sources, 459 macros
[0m14:15:51.140357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19803361-0f1f-462b-aaf4-458fbce2f30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f0c210>]}
[0m14:15:51.141460 [info ] [MainThread]: 
[0m14:15:51.141808 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:15:51.144208 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m14:15:51.185661 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m14:15:51.185925 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m14:15:51.186069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:51.726478 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.540 seconds
[0m14:15:51.730432 [debug] [ThreadPool]: On list_openweather: Close
[0m14:15:51.847362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m14:15:51.858014 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m14:15:51.858385 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m14:15:51.858682 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:52.365187 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.506 seconds
[0m14:15:52.368932 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m14:15:52.500236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19803361-0f1f-462b-aaf4-458fbce2f30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213324e0>]}
[0m14:15:52.501270 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m14:15:52.501765 [info ] [MainThread]: 
[0m14:15:52.507067 [debug] [Thread-1 (]: Began running node model.weather_dbt.cloud_coverage_over_time
[0m14:15:52.507738 [info ] [Thread-1 (]: 1 of 8 START sql table model analytics.cloud_coverage_over_time ................ [RUN]
[0m14:15:52.508245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.cloud_coverage_over_time)
[0m14:15:52.509017 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.cloud_coverage_over_time
[0m14:15:52.517663 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.cloud_coverage_over_time"
[0m14:15:52.519372 [debug] [Thread-1 (]: Began executing node model.weather_dbt.cloud_coverage_over_time
[0m14:15:52.542065 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.cloud_coverage_over_time"
[0m14:15:52.543409 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.cloud_coverage_over_time"
[0m14:15:52.543689 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.cloud_coverage_over_time"} */
create or replace transient table openweather.analytics.cloud_coverage_over_time
         as
        (WITH CloudCoverage AS (
    SELECT 
        c.CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        c.CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY
        );
[0m14:15:52.543927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:52.980320 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b437-0004-3863-0002-594300044426
[0m14:15:52.981098 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 8
invalid identifier 'C.CITY_NAME'
[0m14:15:52.981681 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: Close
[0m14:15:53.103897 [debug] [Thread-1 (]: Database Error in model cloud_coverage_over_time (models/output/cloud_coverage_over_time.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'C.CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/cloud_coverage_over_time.sql
[0m14:15:53.106015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19803361-0f1f-462b-aaf4-458fbce2f30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ea8350>]}
[0m14:15:53.106812 [error] [Thread-1 (]: 1 of 8 ERROR creating sql table model analytics.cloud_coverage_over_time ....... [[31mERROR[0m in 0.60s]
[0m14:15:53.107479 [debug] [Thread-1 (]: Finished running node model.weather_dbt.cloud_coverage_over_time
[0m14:15:53.107925 [debug] [Thread-1 (]: Began running node model.weather_dbt.correlation
[0m14:15:53.109123 [info ] [Thread-1 (]: 2 of 8 START sql table model analytics.correlation ............................. [RUN]
[0m14:15:53.109628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.cloud_coverage_over_time, now model.weather_dbt.correlation)
[0m14:15:53.109954 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.correlation
[0m14:15:53.113021 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.correlation"
[0m14:15:53.114297 [debug] [Thread-1 (]: Began executing node model.weather_dbt.correlation
[0m14:15:53.117162 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.correlation"
[0m14:15:53.118312 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.correlation"
[0m14:15:53.118688 [debug] [Thread-1 (]: On model.weather_dbt.correlation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.correlation"} */
create or replace transient table openweather.analytics.correlation
         as
        (WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        c.CITY_NAME
)
SELECT *
FROM CorrelationData
        );
[0m14:15:53.119002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:53.553667 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b437-0004-3867-0002-5943000453d2
[0m14:15:53.553965 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 8
invalid identifier 'C.CITY_NAME'
[0m14:15:53.554223 [debug] [Thread-1 (]: On model.weather_dbt.correlation: Close
[0m14:15:53.694301 [debug] [Thread-1 (]: Database Error in model correlation (models/output/correlation.sql)
  000904 (42000): SQL compilation error: error line 17 at position 8
  invalid identifier 'C.CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/correlation.sql
[0m14:15:53.694896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19803361-0f1f-462b-aaf4-458fbce2f30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122855c80>]}
[0m14:15:53.695572 [error] [Thread-1 (]: 2 of 8 ERROR creating sql table model analytics.correlation .................... [[31mERROR[0m in 0.59s]
[0m14:15:53.696104 [debug] [Thread-1 (]: Finished running node model.weather_dbt.correlation
[0m14:15:53.696460 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m14:15:53.697000 [info ] [Thread-1 (]: 3 of 8 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m14:15:53.697441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.correlation, now model.weather_dbt.extreme_weather_events)
[0m14:15:53.697758 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m14:15:53.700625 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m14:15:53.701495 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m14:15:53.703545 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m14:15:53.704992 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m14:15:53.705917 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m14:15:53.706220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:55.532484 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.826 seconds
[0m14:15:55.553402 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m14:15:55.675090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19803361-0f1f-462b-aaf4-458fbce2f30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d7a70>]}
[0m14:15:55.676976 [info ] [Thread-1 (]: 3 of 8 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.98s]
[0m14:15:55.677992 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m14:15:55.678582 [debug] [Thread-1 (]: Began running node model.weather_dbt.humidity_vs_temp
[0m14:15:55.679212 [info ] [Thread-1 (]: 4 of 8 START sql table model analytics.humidity_vs_temp ........................ [RUN]
[0m14:15:55.679843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.humidity_vs_temp)
[0m14:15:55.680283 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.humidity_vs_temp
[0m14:15:55.684222 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.humidity_vs_temp"
[0m14:15:55.685383 [debug] [Thread-1 (]: Began executing node model.weather_dbt.humidity_vs_temp
[0m14:15:55.688591 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.humidity_vs_temp"
[0m14:15:55.690256 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.humidity_vs_temp"
[0m14:15:55.690826 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.humidity_vs_temp"} */
create or replace transient table openweather.analytics.humidity_vs_temp
         as
        (WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT *
FROM HumidityTemp
        );
[0m14:15:55.691173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:57.169228 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.478 seconds
[0m14:15:57.173080 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: Close
[0m14:15:57.298101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19803361-0f1f-462b-aaf4-458fbce2f30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dacbd0>]}
[0m14:15:57.299037 [info ] [Thread-1 (]: 4 of 8 OK created sql table model analytics.humidity_vs_temp ................... [[32mSUCCESS 1[0m in 1.62s]
[0m14:15:57.299515 [debug] [Thread-1 (]: Finished running node model.weather_dbt.humidity_vs_temp
[0m14:15:57.299848 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m14:15:57.300265 [info ] [Thread-1 (]: 5 of 8 START sql view model analytics.openweather_join ......................... [RUN]
[0m14:15:57.300666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.humidity_vs_temp, now model.weather_dbt.openweather_join)
[0m14:15:57.300953 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m14:15:57.303642 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m14:15:57.304484 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m14:15:57.319853 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m14:15:57.321336 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m14:15:57.321681 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    c."Latitude" AS CITY_LATITUDE,
    c."Longitude" AS CITY_LONGITUDE,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m14:15:57.321926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:58.096703 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.774 seconds
[0m14:15:58.104556 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m14:15:58.248434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19803361-0f1f-462b-aaf4-458fbce2f30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121efc4b0>]}
[0m14:15:58.249560 [info ] [Thread-1 (]: 5 of 8 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.95s]
[0m14:15:58.250423 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m14:15:58.251027 [debug] [Thread-1 (]: Began running node model.weather_dbt.temp_trends_by_city
[0m14:15:58.251714 [info ] [Thread-1 (]: 6 of 8 START sql table model analytics.temp_trends_by_city ..................... [RUN]
[0m14:15:58.252327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.temp_trends_by_city)
[0m14:15:58.252739 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.temp_trends_by_city
[0m14:15:58.256688 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.temp_trends_by_city"
[0m14:15:58.259372 [debug] [Thread-1 (]: Began executing node model.weather_dbt.temp_trends_by_city
[0m14:15:58.262098 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.temp_trends_by_city"
[0m14:15:58.263627 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.temp_trends_by_city"
[0m14:15:58.264066 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.temp_trends_by_city"} */
create or replace transient table openweather.analytics.temp_trends_by_city
         as
        (WITH TempTrends AS (
    SELECT 
        "Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY
        );
[0m14:15:58.264427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:59.639545 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.374 seconds
[0m14:15:59.644727 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: Close
[0m14:15:59.768160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19803361-0f1f-462b-aaf4-458fbce2f30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122a56b10>]}
[0m14:15:59.769302 [info ] [Thread-1 (]: 6 of 8 OK created sql table model analytics.temp_trends_by_city ................ [[32mSUCCESS 1[0m in 1.52s]
[0m14:15:59.770169 [debug] [Thread-1 (]: Finished running node model.weather_dbt.temp_trends_by_city
[0m14:15:59.770784 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_cond_distribution
[0m14:15:59.771470 [info ] [Thread-1 (]: 7 of 8 START sql table model analytics.weather_cond_distribution ............... [RUN]
[0m14:15:59.772081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.temp_trends_by_city, now model.weather_dbt.weather_cond_distribution)
[0m14:15:59.772517 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_cond_distribution
[0m14:15:59.776662 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_cond_distribution"
[0m14:15:59.777935 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_cond_distribution
[0m14:15:59.780334 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_cond_distribution"
[0m14:15:59.781681 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_cond_distribution"
[0m14:15:59.782072 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_cond_distribution"} */
create or replace transient table openweather.analytics.weather_cond_distribution
         as
        (WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, c.CITY_NAME
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC
        );
[0m14:15:59.782420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:00.204295 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b438-0004-386c-0002-5943000433ba
[0m14:16:00.205300 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 24
invalid identifier 'C.CITY_NAME'
[0m14:16:00.205870 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: Close
[0m14:16:00.361747 [debug] [Thread-1 (]: Database Error in model weather_cond_distribution (models/output/weather_cond_distribution.sql)
  000904 (42000): SQL compilation error: error line 15 at position 24
  invalid identifier 'C.CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/weather_cond_distribution.sql
[0m14:16:00.362450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19803361-0f1f-462b-aaf4-458fbce2f30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e7f110>]}
[0m14:16:00.363261 [error] [Thread-1 (]: 7 of 8 ERROR creating sql table model analytics.weather_cond_distribution ...... [[31mERROR[0m in 0.59s]
[0m14:16:00.363972 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_cond_distribution
[0m14:16:00.364454 [debug] [Thread-1 (]: Began running node model.weather_dbt.wind_speed_analysis
[0m14:16:00.365080 [info ] [Thread-1 (]: 8 of 8 START sql table model analytics.wind_speed_analysis ..................... [RUN]
[0m14:16:00.365594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.weather_cond_distribution, now model.weather_dbt.wind_speed_analysis)
[0m14:16:00.365967 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.wind_speed_analysis
[0m14:16:00.369358 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.wind_speed_analysis"
[0m14:16:00.370315 [debug] [Thread-1 (]: Began executing node model.weather_dbt.wind_speed_analysis
[0m14:16:00.372900 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.wind_speed_analysis"
[0m14:16:00.374150 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.wind_speed_analysis"
[0m14:16:00.374478 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.wind_speed_analysis"} */
create or replace transient table openweather.analytics.wind_speed_analysis
         as
        (WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL 
)
SELECT *
FROM WindSpeedData
        );
[0m14:16:00.374770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:01.888759 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.513 seconds
[0m14:16:01.893887 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: Close
[0m14:16:02.027740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19803361-0f1f-462b-aaf4-458fbce2f30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f67e30>]}
[0m14:16:02.029088 [info ] [Thread-1 (]: 8 of 8 OK created sql table model analytics.wind_speed_analysis ................ [[32mSUCCESS 1[0m in 1.66s]
[0m14:16:02.029947 [debug] [Thread-1 (]: Finished running node model.weather_dbt.wind_speed_analysis
[0m14:16:02.031799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:02.032215 [debug] [MainThread]: Connection 'model.weather_dbt.wind_speed_analysis' was properly closed.
[0m14:16:02.032684 [info ] [MainThread]: 
[0m14:16:02.033057 [info ] [MainThread]: Finished running 7 table models, 1 view model in 0 hours 0 minutes and 10.89 seconds (10.89s).
[0m14:16:02.034792 [debug] [MainThread]: Command end result
[0m14:16:02.062900 [info ] [MainThread]: 
[0m14:16:02.063285 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:16:02.063479 [info ] [MainThread]: 
[0m14:16:02.063738 [error] [MainThread]:   Database Error in model cloud_coverage_over_time (models/output/cloud_coverage_over_time.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'C.CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/cloud_coverage_over_time.sql
[0m14:16:02.063898 [info ] [MainThread]: 
[0m14:16:02.064082 [error] [MainThread]:   Database Error in model correlation (models/output/correlation.sql)
  000904 (42000): SQL compilation error: error line 17 at position 8
  invalid identifier 'C.CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/correlation.sql
[0m14:16:02.064228 [info ] [MainThread]: 
[0m14:16:02.064407 [error] [MainThread]:   Database Error in model weather_cond_distribution (models/output/weather_cond_distribution.sql)
  000904 (42000): SQL compilation error: error line 15 at position 24
  invalid identifier 'C.CITY_NAME'
  compiled code at target/run/weather_dbt/models/output/weather_cond_distribution.sql
[0m14:16:02.064553 [info ] [MainThread]: 
[0m14:16:02.064728 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=3 SKIP=0 TOTAL=8
[0m14:16:02.066611 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.510999, "process_in_blocks": "0", "process_kernel_time": 0.264516, "process_mem_max_rss": "140115968", "process_out_blocks": "0", "process_user_time": 1.817018}
[0m14:16:02.067009 [debug] [MainThread]: Command `dbt run` failed at 14:16:02.066951 after 11.51 seconds
[0m14:16:02.067299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122aebd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122ae8710>]}
[0m14:16:02.067510 [debug] [MainThread]: Flushing usage events
[0m14:17:05.980952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d7d90>]}


============================== 14:17:05.983183 | 2e392053-3336-4cbc-8943-4aaca8755ca2 ==============================
[0m14:17:05.983183 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:17:05.983499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:17:06.149995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e392053-3336-4cbc-8943-4aaca8755ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206eab10>]}
[0m14:17:06.172747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e392053-3336-4cbc-8943-4aaca8755ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206ec050>]}
[0m14:17:06.173141 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:17:06.231495 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:17:06.306568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:17:06.306932 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/cloud_coverage_over_time.sql
[0m14:17:06.307117 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/correlation.sql
[0m14:17:06.307283 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/weather_cond_distribution.sql
[0m14:17:06.417037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e392053-3336-4cbc-8943-4aaca8755ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120b60850>]}
[0m14:17:06.474357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e392053-3336-4cbc-8943-4aaca8755ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120bec410>]}
[0m14:17:06.474665 [info ] [MainThread]: Found 8 models, 2 sources, 459 macros
[0m14:17:06.474847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e392053-3336-4cbc-8943-4aaca8755ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120c9fe70>]}
[0m14:17:06.475955 [info ] [MainThread]: 
[0m14:17:06.476267 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:17:06.478599 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m14:17:06.520423 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m14:17:06.520687 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m14:17:06.520831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:07.066298 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.545 seconds
[0m14:17:07.071032 [debug] [ThreadPool]: On list_openweather: Close
[0m14:17:07.197479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m14:17:07.207556 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m14:17:07.207948 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m14:17:07.208249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:07.838798 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.630 seconds
[0m14:17:07.844402 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m14:17:07.963871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e392053-3336-4cbc-8943-4aaca8755ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120c9b860>]}
[0m14:17:07.964732 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m14:17:07.965213 [info ] [MainThread]: 
[0m14:17:07.969784 [debug] [Thread-1 (]: Began running node model.weather_dbt.cloud_coverage_over_time
[0m14:17:07.970466 [info ] [Thread-1 (]: 1 of 8 START sql table model analytics.cloud_coverage_over_time ................ [RUN]
[0m14:17:07.970993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.cloud_coverage_over_time)
[0m14:17:07.971848 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.cloud_coverage_over_time
[0m14:17:07.980249 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.cloud_coverage_over_time"
[0m14:17:07.981255 [debug] [Thread-1 (]: Began executing node model.weather_dbt.cloud_coverage_over_time
[0m14:17:08.005185 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.cloud_coverage_over_time"
[0m14:17:08.006142 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.cloud_coverage_over_time"
[0m14:17:08.006391 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.cloud_coverage_over_time"} */
create or replace transient table openweather.analytics.cloud_coverage_over_time
         as
        (WITH CloudCoverage AS (
    SELECT 
        c."NAME" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY
        );
[0m14:17:08.006609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:08.480665 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b439-0004-386c-0002-5943000433ce
[0m14:17:08.481413 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 8
invalid identifier 'C.NAME'
[0m14:17:08.482032 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: Close
[0m14:17:08.604522 [debug] [Thread-1 (]: Database Error in model cloud_coverage_over_time (models/output/cloud_coverage_over_time.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'C.NAME'
  compiled code at target/run/weather_dbt/models/output/cloud_coverage_over_time.sql
[0m14:17:08.606758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e392053-3336-4cbc-8943-4aaca8755ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120eb4050>]}
[0m14:17:08.607581 [error] [Thread-1 (]: 1 of 8 ERROR creating sql table model analytics.cloud_coverage_over_time ....... [[31mERROR[0m in 0.63s]
[0m14:17:08.608240 [debug] [Thread-1 (]: Finished running node model.weather_dbt.cloud_coverage_over_time
[0m14:17:08.608684 [debug] [Thread-1 (]: Began running node model.weather_dbt.correlation
[0m14:17:08.609113 [info ] [Thread-1 (]: 2 of 8 START sql table model analytics.correlation ............................. [RUN]
[0m14:17:08.609552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.cloud_coverage_over_time, now model.weather_dbt.correlation)
[0m14:17:08.609884 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.correlation
[0m14:17:08.613078 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.correlation"
[0m14:17:08.614762 [debug] [Thread-1 (]: Began executing node model.weather_dbt.correlation
[0m14:17:08.618019 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.correlation"
[0m14:17:08.619276 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.correlation"
[0m14:17:08.619618 [debug] [Thread-1 (]: On model.weather_dbt.correlation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.correlation"} */
create or replace transient table openweather.analytics.correlation
         as
        (WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData
        );
[0m14:17:08.619931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:09.981573 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.361 seconds
[0m14:17:10.003404 [debug] [Thread-1 (]: On model.weather_dbt.correlation: Close
[0m14:17:10.130980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e392053-3336-4cbc-8943-4aaca8755ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12105a620>]}
[0m14:17:10.132355 [info ] [Thread-1 (]: 2 of 8 OK created sql table model analytics.correlation ........................ [[32mSUCCESS 1[0m in 1.52s]
[0m14:17:10.133226 [debug] [Thread-1 (]: Finished running node model.weather_dbt.correlation
[0m14:17:10.133846 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m14:17:10.134652 [info ] [Thread-1 (]: 3 of 8 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m14:17:10.135341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.correlation, now model.weather_dbt.extreme_weather_events)
[0m14:17:10.135780 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m14:17:10.140008 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m14:17:10.141330 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m14:17:10.144784 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m14:17:10.146978 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m14:17:10.147506 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m14:17:10.147896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:11.205989 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.057 seconds
[0m14:17:11.214199 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m14:17:11.349476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e392053-3336-4cbc-8943-4aaca8755ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1210b9270>]}
[0m14:17:11.350691 [info ] [Thread-1 (]: 3 of 8 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.21s]
[0m14:17:11.351553 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m14:17:11.352149 [debug] [Thread-1 (]: Began running node model.weather_dbt.humidity_vs_temp
[0m14:17:11.352670 [info ] [Thread-1 (]: 4 of 8 START sql table model analytics.humidity_vs_temp ........................ [RUN]
[0m14:17:11.353145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.humidity_vs_temp)
[0m14:17:11.353527 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.humidity_vs_temp
[0m14:17:11.357343 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.humidity_vs_temp"
[0m14:17:11.358737 [debug] [Thread-1 (]: Began executing node model.weather_dbt.humidity_vs_temp
[0m14:17:11.362406 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.humidity_vs_temp"
[0m14:17:11.364057 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.humidity_vs_temp"
[0m14:17:11.364439 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.humidity_vs_temp"} */
create or replace transient table openweather.analytics.humidity_vs_temp
         as
        (WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT *
FROM HumidityTemp
        );
[0m14:17:11.364752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:12.946209 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.581 seconds
[0m14:17:12.950215 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: Close
[0m14:17:13.086190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e392053-3336-4cbc-8943-4aaca8755ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d49ed0>]}
[0m14:17:13.087330 [info ] [Thread-1 (]: 4 of 8 OK created sql table model analytics.humidity_vs_temp ................... [[32mSUCCESS 1[0m in 1.73s]
[0m14:17:13.088171 [debug] [Thread-1 (]: Finished running node model.weather_dbt.humidity_vs_temp
[0m14:17:13.088746 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m14:17:13.089480 [info ] [Thread-1 (]: 5 of 8 START sql view model analytics.openweather_join ......................... [RUN]
[0m14:17:13.090200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.humidity_vs_temp, now model.weather_dbt.openweather_join)
[0m14:17:13.090715 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m14:17:13.094759 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m14:17:13.095984 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m14:17:13.115745 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m14:17:13.116642 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m14:17:13.116846 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    c."Latitude" AS CITY_LATITUDE,
    c."Longitude" AS CITY_LONGITUDE,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m14:17:13.117280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:14.057365 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.940 seconds
[0m14:17:14.062029 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m14:17:14.195291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e392053-3336-4cbc-8943-4aaca8755ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1210e44b0>]}
[0m14:17:14.196656 [info ] [Thread-1 (]: 5 of 8 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 1.10s]
[0m14:17:14.197575 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m14:17:14.198207 [debug] [Thread-1 (]: Began running node model.weather_dbt.temp_trends_by_city
[0m14:17:14.198956 [info ] [Thread-1 (]: 6 of 8 START sql table model analytics.temp_trends_by_city ..................... [RUN]
[0m14:17:14.199631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.temp_trends_by_city)
[0m14:17:14.200071 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.temp_trends_by_city
[0m14:17:14.204299 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.temp_trends_by_city"
[0m14:17:14.205568 [debug] [Thread-1 (]: Began executing node model.weather_dbt.temp_trends_by_city
[0m14:17:14.213804 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.temp_trends_by_city"
[0m14:17:14.215245 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.temp_trends_by_city"
[0m14:17:14.215592 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.temp_trends_by_city"} */
create or replace transient table openweather.analytics.temp_trends_by_city
         as
        (WITH TempTrends AS (
    SELECT 
        "Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY
        );
[0m14:17:14.215913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:15.334813 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.118 seconds
[0m14:17:15.339620 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: Close
[0m14:17:15.449922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e392053-3336-4cbc-8943-4aaca8755ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df6c90>]}
[0m14:17:15.450976 [info ] [Thread-1 (]: 6 of 8 OK created sql table model analytics.temp_trends_by_city ................ [[32mSUCCESS 1[0m in 1.25s]
[0m14:17:15.451810 [debug] [Thread-1 (]: Finished running node model.weather_dbt.temp_trends_by_city
[0m14:17:15.452379 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_cond_distribution
[0m14:17:15.453113 [info ] [Thread-1 (]: 7 of 8 START sql table model analytics.weather_cond_distribution ............... [RUN]
[0m14:17:15.453822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.temp_trends_by_city, now model.weather_dbt.weather_cond_distribution)
[0m14:17:15.454255 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_cond_distribution
[0m14:17:15.458300 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_cond_distribution"
[0m14:17:15.459419 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_cond_distribution
[0m14:17:15.461838 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_cond_distribution"
[0m14:17:15.463241 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_cond_distribution"
[0m14:17:15.463848 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_cond_distribution"} */
create or replace transient table openweather.analytics.weather_cond_distribution
         as
        (WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, 3
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC
        );
[0m14:17:15.464207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:16.531859 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.067 seconds
[0m14:17:16.535826 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: Close
[0m14:17:16.656536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e392053-3336-4cbc-8943-4aaca8755ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df7470>]}
[0m14:17:16.657527 [info ] [Thread-1 (]: 7 of 8 OK created sql table model analytics.weather_cond_distribution .......... [[32mSUCCESS 1[0m in 1.20s]
[0m14:17:16.658180 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_cond_distribution
[0m14:17:16.658619 [debug] [Thread-1 (]: Began running node model.weather_dbt.wind_speed_analysis
[0m14:17:16.659203 [info ] [Thread-1 (]: 8 of 8 START sql table model analytics.wind_speed_analysis ..................... [RUN]
[0m14:17:16.659777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.weather_cond_distribution, now model.weather_dbt.wind_speed_analysis)
[0m14:17:16.660147 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.wind_speed_analysis
[0m14:17:16.663472 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.wind_speed_analysis"
[0m14:17:16.664677 [debug] [Thread-1 (]: Began executing node model.weather_dbt.wind_speed_analysis
[0m14:17:16.666911 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.wind_speed_analysis"
[0m14:17:16.667947 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.wind_speed_analysis"
[0m14:17:16.668273 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.wind_speed_analysis"} */
create or replace transient table openweather.analytics.wind_speed_analysis
         as
        (WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL 
)
SELECT *
FROM WindSpeedData
        );
[0m14:17:16.668579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:18.067256 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.398 seconds
[0m14:17:18.073051 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: Close
[0m14:17:18.185844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e392053-3336-4cbc-8943-4aaca8755ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df7e30>]}
[0m14:17:18.186745 [info ] [Thread-1 (]: 8 of 8 OK created sql table model analytics.wind_speed_analysis ................ [[32mSUCCESS 1[0m in 1.53s]
[0m14:17:18.187621 [debug] [Thread-1 (]: Finished running node model.weather_dbt.wind_speed_analysis
[0m14:17:18.189401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:18.189684 [debug] [MainThread]: Connection 'model.weather_dbt.wind_speed_analysis' was properly closed.
[0m14:17:18.190083 [info ] [MainThread]: 
[0m14:17:18.190379 [info ] [MainThread]: Finished running 7 table models, 1 view model in 0 hours 0 minutes and 11.71 seconds (11.71s).
[0m14:17:18.191796 [debug] [MainThread]: Command end result
[0m14:17:18.219315 [info ] [MainThread]: 
[0m14:17:18.219658 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:17:18.219802 [info ] [MainThread]: 
[0m14:17:18.219991 [error] [MainThread]:   Database Error in model cloud_coverage_over_time (models/output/cloud_coverage_over_time.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'C.NAME'
  compiled code at target/run/weather_dbt/models/output/cloud_coverage_over_time.sql
[0m14:17:18.220144 [info ] [MainThread]: 
[0m14:17:18.220299 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m14:17:18.222759 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.273919, "process_in_blocks": "0", "process_kernel_time": 0.246663, "process_mem_max_rss": "142360576", "process_out_blocks": "0", "process_user_time": 1.837103}
[0m14:17:18.223239 [debug] [MainThread]: Command `dbt run` failed at 14:17:18.223168 after 12.27 seconds
[0m14:17:18.223503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079feff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ddbdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ddbd70>]}
[0m14:17:18.223742 [debug] [MainThread]: Flushing usage events
[0m14:17:54.654258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fc0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd7d90>]}


============================== 14:17:54.656505 | 07de25fe-2d64-48af-8be3-ba3da9add6ea ==============================
[0m14:17:54.656505 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:17:54.656823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:17:54.823244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07de25fe-2d64-48af-8be3-ba3da9add6ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10780ab10>]}
[0m14:17:54.847301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07de25fe-2d64-48af-8be3-ba3da9add6ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10780c050>]}
[0m14:17:54.847792 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:17:54.904271 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:17:54.979397 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:17:54.979624 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:17:54.994097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07de25fe-2d64-48af-8be3-ba3da9add6ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107573050>]}
[0m14:17:55.060863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07de25fe-2d64-48af-8be3-ba3da9add6ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf0b90>]}
[0m14:17:55.061179 [info ] [MainThread]: Found 8 models, 2 sources, 459 macros
[0m14:17:55.061347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07de25fe-2d64-48af-8be3-ba3da9add6ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d2cd70>]}
[0m14:17:55.062340 [info ] [MainThread]: 
[0m14:17:55.062642 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:17:55.064795 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m14:17:55.072208 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m14:17:55.072424 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m14:17:55.072565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:55.626036 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.553 seconds
[0m14:17:55.628233 [debug] [ThreadPool]: On list_openweather: Close
[0m14:17:55.834853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m14:17:55.846083 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m14:17:55.846475 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m14:17:55.846765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:56.631109 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.784 seconds
[0m14:17:56.634334 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m14:17:56.788181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07de25fe-2d64-48af-8be3-ba3da9add6ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bfeb60>]}
[0m14:17:56.788596 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m14:17:56.788777 [info ] [MainThread]: 
[0m14:17:56.791594 [debug] [Thread-1 (]: Began running node model.weather_dbt.cloud_coverage_over_time
[0m14:17:56.792308 [info ] [Thread-1 (]: 1 of 8 START sql table model analytics.cloud_coverage_over_time ................ [RUN]
[0m14:17:56.792926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.cloud_coverage_over_time)
[0m14:17:56.793347 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.cloud_coverage_over_time
[0m14:17:56.802050 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.cloud_coverage_over_time"
[0m14:17:56.802988 [debug] [Thread-1 (]: Began executing node model.weather_dbt.cloud_coverage_over_time
[0m14:17:56.824647 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.cloud_coverage_over_time"
[0m14:17:56.825724 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.cloud_coverage_over_time"
[0m14:17:56.826100 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.cloud_coverage_over_time"} */
create or replace transient table openweather.analytics.cloud_coverage_over_time
         as
        (WITH CloudCoverage AS (
    SELECT 
        c."NAME" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY
        );
[0m14:17:56.826347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:57.456099 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b439-0004-386c-0002-5943000433ee
[0m14:17:57.456880 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 8
invalid identifier 'C.NAME'
[0m14:17:57.457513 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: Close
[0m14:17:57.597663 [debug] [Thread-1 (]: Database Error in model cloud_coverage_over_time (models/output/cloud_coverage_over_time.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'C.NAME'
  compiled code at target/run/weather_dbt/models/output/cloud_coverage_over_time.sql
[0m14:17:57.599198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07de25fe-2d64-48af-8be3-ba3da9add6ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f2af90>]}
[0m14:17:57.599799 [error] [Thread-1 (]: 1 of 8 ERROR creating sql table model analytics.cloud_coverage_over_time ....... [[31mERROR[0m in 0.81s]
[0m14:17:57.600321 [debug] [Thread-1 (]: Finished running node model.weather_dbt.cloud_coverage_over_time
[0m14:17:57.600717 [debug] [Thread-1 (]: Began running node model.weather_dbt.correlation
[0m14:17:57.601652 [info ] [Thread-1 (]: 2 of 8 START sql table model analytics.correlation ............................. [RUN]
[0m14:17:57.602034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.cloud_coverage_over_time, now model.weather_dbt.correlation)
[0m14:17:57.602326 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.correlation
[0m14:17:57.604696 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.correlation"
[0m14:17:57.605333 [debug] [Thread-1 (]: Began executing node model.weather_dbt.correlation
[0m14:17:57.607844 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.correlation"
[0m14:17:57.608934 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.correlation"
[0m14:17:57.609245 [debug] [Thread-1 (]: On model.weather_dbt.correlation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.correlation"} */
create or replace transient table openweather.analytics.correlation
         as
        (WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData
        );
[0m14:17:57.609523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:58.723188 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.113 seconds
[0m14:17:58.746518 [debug] [Thread-1 (]: On model.weather_dbt.correlation: Close
[0m14:17:58.857180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07de25fe-2d64-48af-8be3-ba3da9add6ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f52200>]}
[0m14:17:58.859344 [info ] [Thread-1 (]: 2 of 8 OK created sql table model analytics.correlation ........................ [[32mSUCCESS 1[0m in 1.25s]
[0m14:17:58.860305 [debug] [Thread-1 (]: Finished running node model.weather_dbt.correlation
[0m14:17:58.860862 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m14:17:58.861545 [info ] [Thread-1 (]: 3 of 8 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m14:17:58.862181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.correlation, now model.weather_dbt.extreme_weather_events)
[0m14:17:58.862585 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m14:17:58.866503 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m14:17:58.867671 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m14:17:58.871147 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m14:17:58.873073 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m14:17:58.873494 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m14:17:58.873829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:59.951431 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.077 seconds
[0m14:17:59.955467 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m14:18:00.102211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07de25fe-2d64-48af-8be3-ba3da9add6ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fa23f0>]}
[0m14:18:00.102727 [info ] [Thread-1 (]: 3 of 8 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.24s]
[0m14:18:00.103094 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m14:18:00.103383 [debug] [Thread-1 (]: Began running node model.weather_dbt.humidity_vs_temp
[0m14:18:00.103921 [info ] [Thread-1 (]: 4 of 8 START sql table model analytics.humidity_vs_temp ........................ [RUN]
[0m14:18:00.104275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.humidity_vs_temp)
[0m14:18:00.104516 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.humidity_vs_temp
[0m14:18:00.106713 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.humidity_vs_temp"
[0m14:18:00.107150 [debug] [Thread-1 (]: Began executing node model.weather_dbt.humidity_vs_temp
[0m14:18:00.108796 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.humidity_vs_temp"
[0m14:18:00.109825 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.humidity_vs_temp"
[0m14:18:00.110204 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.humidity_vs_temp"} */
create or replace transient table openweather.analytics.humidity_vs_temp
         as
        (WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT *
FROM HumidityTemp
        );
[0m14:18:00.110524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:01.498881 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.388 seconds
[0m14:18:01.502952 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: Close
[0m14:18:01.646872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07de25fe-2d64-48af-8be3-ba3da9add6ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b8e9d0>]}
[0m14:18:01.648018 [info ] [Thread-1 (]: 4 of 8 OK created sql table model analytics.humidity_vs_temp ................... [[32mSUCCESS 1[0m in 1.54s]
[0m14:18:01.648748 [debug] [Thread-1 (]: Finished running node model.weather_dbt.humidity_vs_temp
[0m14:18:01.649230 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m14:18:01.650062 [info ] [Thread-1 (]: 5 of 8 START sql view model analytics.openweather_join ......................... [RUN]
[0m14:18:01.650939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.humidity_vs_temp, now model.weather_dbt.openweather_join)
[0m14:18:01.651380 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m14:18:01.655102 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m14:18:01.656093 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m14:18:01.675950 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m14:18:01.676990 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m14:18:01.677274 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    c."Latitude" AS CITY_LATITUDE,
    c."Longitude" AS CITY_LONGITUDE,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m14:18:01.677515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:02.483390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.805 seconds
[0m14:18:02.488203 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m14:18:02.613894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07de25fe-2d64-48af-8be3-ba3da9add6ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dfc8a0>]}
[0m14:18:02.614499 [info ] [Thread-1 (]: 5 of 8 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.96s]
[0m14:18:02.614859 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m14:18:02.615100 [debug] [Thread-1 (]: Began running node model.weather_dbt.temp_trends_by_city
[0m14:18:02.615348 [info ] [Thread-1 (]: 6 of 8 START sql table model analytics.temp_trends_by_city ..................... [RUN]
[0m14:18:02.615592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.temp_trends_by_city)
[0m14:18:02.615791 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.temp_trends_by_city
[0m14:18:02.617541 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.temp_trends_by_city"
[0m14:18:02.618200 [debug] [Thread-1 (]: Began executing node model.weather_dbt.temp_trends_by_city
[0m14:18:02.619801 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.temp_trends_by_city"
[0m14:18:02.620538 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.temp_trends_by_city"
[0m14:18:02.620805 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.temp_trends_by_city"} */
create or replace transient table openweather.analytics.temp_trends_by_city
         as
        (WITH TempTrends AS (
    SELECT 
        "Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY
        );
[0m14:18:02.621065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:03.842215 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.221 seconds
[0m14:18:03.845127 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: Close
[0m14:18:03.994493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07de25fe-2d64-48af-8be3-ba3da9add6ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10227ac90>]}
[0m14:18:03.995350 [info ] [Thread-1 (]: 6 of 8 OK created sql table model analytics.temp_trends_by_city ................ [[32mSUCCESS 1[0m in 1.38s]
[0m14:18:03.996025 [debug] [Thread-1 (]: Finished running node model.weather_dbt.temp_trends_by_city
[0m14:18:03.996500 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_cond_distribution
[0m14:18:03.997315 [info ] [Thread-1 (]: 7 of 8 START sql table model analytics.weather_cond_distribution ............... [RUN]
[0m14:18:03.998204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.temp_trends_by_city, now model.weather_dbt.weather_cond_distribution)
[0m14:18:03.998688 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_cond_distribution
[0m14:18:04.002315 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_cond_distribution"
[0m14:18:04.003382 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_cond_distribution
[0m14:18:04.005753 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_cond_distribution"
[0m14:18:04.006811 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_cond_distribution"
[0m14:18:04.007395 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_cond_distribution"} */
create or replace transient table openweather.analytics.weather_cond_distribution
         as
        (WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, 3
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC
        );
[0m14:18:04.007733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:05.173290 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.165 seconds
[0m14:18:05.177775 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: Close
[0m14:18:05.296444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07de25fe-2d64-48af-8be3-ba3da9add6ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10227b4d0>]}
[0m14:18:05.297464 [info ] [Thread-1 (]: 7 of 8 OK created sql table model analytics.weather_cond_distribution .......... [[32mSUCCESS 1[0m in 1.30s]
[0m14:18:05.298253 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_cond_distribution
[0m14:18:05.298740 [debug] [Thread-1 (]: Began running node model.weather_dbt.wind_speed_analysis
[0m14:18:05.299517 [info ] [Thread-1 (]: 8 of 8 START sql table model analytics.wind_speed_analysis ..................... [RUN]
[0m14:18:05.300326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.weather_cond_distribution, now model.weather_dbt.wind_speed_analysis)
[0m14:18:05.300775 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.wind_speed_analysis
[0m14:18:05.304652 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.wind_speed_analysis"
[0m14:18:05.305727 [debug] [Thread-1 (]: Began executing node model.weather_dbt.wind_speed_analysis
[0m14:18:05.308186 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.wind_speed_analysis"
[0m14:18:05.309429 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.wind_speed_analysis"
[0m14:18:05.309848 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.wind_speed_analysis"} */
create or replace transient table openweather.analytics.wind_speed_analysis
         as
        (WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL 
)
SELECT *
FROM WindSpeedData
        );
[0m14:18:05.310161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:07.014724 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.704 seconds
[0m14:18:07.017879 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: Close
[0m14:18:07.138988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07de25fe-2d64-48af-8be3-ba3da9add6ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10227bd70>]}
[0m14:18:07.140180 [info ] [Thread-1 (]: 8 of 8 OK created sql table model analytics.wind_speed_analysis ................ [[32mSUCCESS 1[0m in 1.84s]
[0m14:18:07.140906 [debug] [Thread-1 (]: Finished running node model.weather_dbt.wind_speed_analysis
[0m14:18:07.143212 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:07.143573 [debug] [MainThread]: Connection 'model.weather_dbt.wind_speed_analysis' was properly closed.
[0m14:18:07.144011 [info ] [MainThread]: 
[0m14:18:07.144362 [info ] [MainThread]: Finished running 7 table models, 1 view model in 0 hours 0 minutes and 12.08 seconds (12.08s).
[0m14:18:07.146785 [debug] [MainThread]: Command end result
[0m14:18:07.175279 [info ] [MainThread]: 
[0m14:18:07.175601 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:18:07.175783 [info ] [MainThread]: 
[0m14:18:07.176010 [error] [MainThread]:   Database Error in model cloud_coverage_over_time (models/output/cloud_coverage_over_time.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'C.NAME'
  compiled code at target/run/weather_dbt/models/output/cloud_coverage_over_time.sql
[0m14:18:07.176185 [info ] [MainThread]: 
[0m14:18:07.176370 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m14:18:07.177526 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.557036, "process_in_blocks": "0", "process_kernel_time": 0.239704, "process_mem_max_rss": "142213120", "process_out_blocks": "0", "process_user_time": 1.67016}
[0m14:18:07.177834 [debug] [MainThread]: Command `dbt run` failed at 14:18:07.177781 after 12.56 seconds
[0m14:18:07.178051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10227b830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044d51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f48e30>]}
[0m14:18:07.178253 [debug] [MainThread]: Flushing usage events
[0m14:18:29.350932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117dbb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117dbd90>]}


============================== 14:18:29.354408 | 2b556478-3956-4ddd-a919-cf135935c4c7 ==============================
[0m14:18:29.354408 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:18:29.354744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:18:29.596637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b556478-3956-4ddd-a919-cf135935c4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11407ab10>]}
[0m14:18:29.619900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b556478-3956-4ddd-a919-cf135935c4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137fc050>]}
[0m14:18:29.620558 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:18:29.679911 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:18:29.755657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:18:29.756011 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/cloud_coverage_over_time.sql
[0m14:18:29.864792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b556478-3956-4ddd-a919-cf135935c4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f6ca50>]}
[0m14:18:29.924430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b556478-3956-4ddd-a919-cf135935c4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114fec410>]}
[0m14:18:29.924746 [info ] [MainThread]: Found 8 models, 2 sources, 459 macros
[0m14:18:29.924917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b556478-3956-4ddd-a919-cf135935c4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150a3e70>]}
[0m14:18:29.925947 [info ] [MainThread]: 
[0m14:18:29.926244 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:18:29.928451 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m14:18:29.969213 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m14:18:29.969493 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m14:18:29.969650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:30.645086 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.675 seconds
[0m14:18:30.650736 [debug] [ThreadPool]: On list_openweather: Close
[0m14:18:30.811792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m14:18:30.822700 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m14:18:30.823064 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m14:18:30.823348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:31.342678 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.519 seconds
[0m14:18:31.346935 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m14:18:31.516457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b556478-3956-4ddd-a919-cf135935c4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11509bc70>]}
[0m14:18:31.517317 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m14:18:31.517762 [info ] [MainThread]: 
[0m14:18:31.522528 [debug] [Thread-1 (]: Began running node model.weather_dbt.cloud_coverage_over_time
[0m14:18:31.523174 [info ] [Thread-1 (]: 1 of 8 START sql table model analytics.cloud_coverage_over_time ................ [RUN]
[0m14:18:31.523665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.cloud_coverage_over_time)
[0m14:18:31.524510 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.cloud_coverage_over_time
[0m14:18:31.532661 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.cloud_coverage_over_time"
[0m14:18:31.533701 [debug] [Thread-1 (]: Began executing node model.weather_dbt.cloud_coverage_over_time
[0m14:18:31.556453 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.cloud_coverage_over_time"
[0m14:18:31.557438 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.cloud_coverage_over_time"
[0m14:18:31.557693 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.cloud_coverage_over_time"} */
create or replace transient table openweather.analytics.cloud_coverage_over_time
         as
        (WITH CloudCoverage AS (
    SELECT 
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY
        );
[0m14:18:31.557910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:33.130235 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.572 seconds
[0m14:18:33.152433 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: Close
[0m14:18:33.303375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b556478-3956-4ddd-a919-cf135935c4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153b8710>]}
[0m14:18:33.304406 [info ] [Thread-1 (]: 1 of 8 OK created sql table model analytics.cloud_coverage_over_time ........... [[32mSUCCESS 1[0m in 1.78s]
[0m14:18:33.305159 [debug] [Thread-1 (]: Finished running node model.weather_dbt.cloud_coverage_over_time
[0m14:18:33.305675 [debug] [Thread-1 (]: Began running node model.weather_dbt.correlation
[0m14:18:33.306334 [info ] [Thread-1 (]: 2 of 8 START sql table model analytics.correlation ............................. [RUN]
[0m14:18:33.306946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.cloud_coverage_over_time, now model.weather_dbt.correlation)
[0m14:18:33.307366 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.correlation
[0m14:18:33.310578 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.correlation"
[0m14:18:33.311897 [debug] [Thread-1 (]: Began executing node model.weather_dbt.correlation
[0m14:18:33.315397 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.correlation"
[0m14:18:33.316682 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.correlation"
[0m14:18:33.317137 [debug] [Thread-1 (]: On model.weather_dbt.correlation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.correlation"} */
create or replace transient table openweather.analytics.correlation
         as
        (WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData
        );
[0m14:18:33.317509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:34.664663 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.347 seconds
[0m14:18:34.671465 [debug] [Thread-1 (]: On model.weather_dbt.correlation: Close
[0m14:18:34.784644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b556478-3956-4ddd-a919-cf135935c4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117adff0>]}
[0m14:18:34.785915 [info ] [Thread-1 (]: 2 of 8 OK created sql table model analytics.correlation ........................ [[32mSUCCESS 1[0m in 1.48s]
[0m14:18:34.786779 [debug] [Thread-1 (]: Finished running node model.weather_dbt.correlation
[0m14:18:34.787347 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m14:18:34.787993 [info ] [Thread-1 (]: 3 of 8 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m14:18:34.788589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.correlation, now model.weather_dbt.extreme_weather_events)
[0m14:18:34.789012 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m14:18:34.793241 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m14:18:34.794459 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m14:18:34.797688 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m14:18:34.799491 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m14:18:34.799969 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m14:18:34.800351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:35.793834 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.993 seconds
[0m14:18:35.797748 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m14:18:35.917736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b556478-3956-4ddd-a919-cf135935c4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154d56d0>]}
[0m14:18:35.918676 [info ] [Thread-1 (]: 3 of 8 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.13s]
[0m14:18:35.919393 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m14:18:35.919892 [debug] [Thread-1 (]: Began running node model.weather_dbt.humidity_vs_temp
[0m14:18:35.920502 [info ] [Thread-1 (]: 4 of 8 START sql table model analytics.humidity_vs_temp ........................ [RUN]
[0m14:18:35.921086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.humidity_vs_temp)
[0m14:18:35.921500 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.humidity_vs_temp
[0m14:18:35.925257 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.humidity_vs_temp"
[0m14:18:35.926516 [debug] [Thread-1 (]: Began executing node model.weather_dbt.humidity_vs_temp
[0m14:18:35.929766 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.humidity_vs_temp"
[0m14:18:35.930916 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.humidity_vs_temp"
[0m14:18:35.931316 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.humidity_vs_temp"} */
create or replace transient table openweather.analytics.humidity_vs_temp
         as
        (WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT *
FROM HumidityTemp
        );
[0m14:18:35.931666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:37.224239 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.292 seconds
[0m14:18:37.227763 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: Close
[0m14:18:37.366883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b556478-3956-4ddd-a919-cf135935c4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115095950>]}
[0m14:18:37.368074 [info ] [Thread-1 (]: 4 of 8 OK created sql table model analytics.humidity_vs_temp ................... [[32mSUCCESS 1[0m in 1.45s]
[0m14:18:37.368918 [debug] [Thread-1 (]: Finished running node model.weather_dbt.humidity_vs_temp
[0m14:18:37.369507 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m14:18:37.370035 [info ] [Thread-1 (]: 5 of 8 START sql view model analytics.openweather_join ......................... [RUN]
[0m14:18:37.370688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.humidity_vs_temp, now model.weather_dbt.openweather_join)
[0m14:18:37.371294 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m14:18:37.375321 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m14:18:37.376346 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m14:18:37.396017 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m14:18:37.397299 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m14:18:37.397587 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    c."Latitude" AS CITY_LATITUDE,
    c."Longitude" AS CITY_LONGITUDE,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m14:18:37.397836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:38.190882 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.792 seconds
[0m14:18:38.195546 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m14:18:38.358049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b556478-3956-4ddd-a919-cf135935c4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ff54e0>]}
[0m14:18:38.359809 [info ] [Thread-1 (]: 5 of 8 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.99s]
[0m14:18:38.361085 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m14:18:38.361747 [debug] [Thread-1 (]: Began running node model.weather_dbt.temp_trends_by_city
[0m14:18:38.362797 [info ] [Thread-1 (]: 6 of 8 START sql table model analytics.temp_trends_by_city ..................... [RUN]
[0m14:18:38.363630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.temp_trends_by_city)
[0m14:18:38.364102 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.temp_trends_by_city
[0m14:18:38.368217 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.temp_trends_by_city"
[0m14:18:38.369360 [debug] [Thread-1 (]: Began executing node model.weather_dbt.temp_trends_by_city
[0m14:18:38.377355 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.temp_trends_by_city"
[0m14:18:38.378757 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.temp_trends_by_city"
[0m14:18:38.379112 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.temp_trends_by_city"} */
create or replace transient table openweather.analytics.temp_trends_by_city
         as
        (WITH TempTrends AS (
    SELECT 
        "Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY
        );
[0m14:18:38.379423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:39.583487 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.204 seconds
[0m14:18:39.587458 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: Close
[0m14:18:39.780005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b556478-3956-4ddd-a919-cf135935c4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10629ac90>]}
[0m14:18:39.781390 [info ] [Thread-1 (]: 6 of 8 OK created sql table model analytics.temp_trends_by_city ................ [[32mSUCCESS 1[0m in 1.42s]
[0m14:18:39.782298 [debug] [Thread-1 (]: Finished running node model.weather_dbt.temp_trends_by_city
[0m14:18:39.782885 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_cond_distribution
[0m14:18:39.783653 [info ] [Thread-1 (]: 7 of 8 START sql table model analytics.weather_cond_distribution ............... [RUN]
[0m14:18:39.784274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.temp_trends_by_city, now model.weather_dbt.weather_cond_distribution)
[0m14:18:39.784706 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_cond_distribution
[0m14:18:39.788740 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_cond_distribution"
[0m14:18:39.789876 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_cond_distribution
[0m14:18:39.792281 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_cond_distribution"
[0m14:18:39.793598 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_cond_distribution"
[0m14:18:39.793995 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_cond_distribution"} */
create or replace transient table openweather.analytics.weather_cond_distribution
         as
        (WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, 3
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC
        );
[0m14:18:39.794337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:40.807930 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.013 seconds
[0m14:18:40.811064 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: Close
[0m14:18:40.941791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b556478-3956-4ddd-a919-cf135935c4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10629b4d0>]}
[0m14:18:40.942290 [info ] [Thread-1 (]: 7 of 8 OK created sql table model analytics.weather_cond_distribution .......... [[32mSUCCESS 1[0m in 1.16s]
[0m14:18:40.942682 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_cond_distribution
[0m14:18:40.943700 [debug] [Thread-1 (]: Began running node model.weather_dbt.wind_speed_analysis
[0m14:18:40.944277 [info ] [Thread-1 (]: 8 of 8 START sql table model analytics.wind_speed_analysis ..................... [RUN]
[0m14:18:40.944648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.weather_cond_distribution, now model.weather_dbt.wind_speed_analysis)
[0m14:18:40.944866 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.wind_speed_analysis
[0m14:18:40.946678 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.wind_speed_analysis"
[0m14:18:40.947146 [debug] [Thread-1 (]: Began executing node model.weather_dbt.wind_speed_analysis
[0m14:18:40.948633 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.wind_speed_analysis"
[0m14:18:40.949872 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.wind_speed_analysis"
[0m14:18:40.950082 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.wind_speed_analysis"} */
create or replace transient table openweather.analytics.wind_speed_analysis
         as
        (WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL 
)
SELECT *
FROM WindSpeedData
        );
[0m14:18:40.950269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:42.559221 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.609 seconds
[0m14:18:42.560923 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: Close
[0m14:18:42.764534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b556478-3956-4ddd-a919-cf135935c4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10629be30>]}
[0m14:18:42.765555 [info ] [Thread-1 (]: 8 of 8 OK created sql table model analytics.wind_speed_analysis ................ [[32mSUCCESS 1[0m in 1.82s]
[0m14:18:42.766374 [debug] [Thread-1 (]: Finished running node model.weather_dbt.wind_speed_analysis
[0m14:18:42.767973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:42.768412 [debug] [MainThread]: Connection 'model.weather_dbt.wind_speed_analysis' was properly closed.
[0m14:18:42.768918 [info ] [MainThread]: 
[0m14:18:42.769285 [info ] [MainThread]: Finished running 7 table models, 1 view model in 0 hours 0 minutes and 12.84 seconds (12.84s).
[0m14:18:42.770948 [debug] [MainThread]: Command end result
[0m14:18:42.798279 [info ] [MainThread]: 
[0m14:18:42.798691 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:18:42.798910 [info ] [MainThread]: 
[0m14:18:42.799136 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m14:18:42.801336 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.499448, "process_in_blocks": "0", "process_kernel_time": 0.306038, "process_mem_max_rss": "142852096", "process_out_blocks": "0", "process_user_time": 1.860471}
[0m14:18:42.801925 [debug] [MainThread]: Command `dbt run` succeeded at 14:18:42.801849 after 13.50 seconds
[0m14:18:42.802210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c5dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115417ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115417dd0>]}
[0m14:18:42.802470 [debug] [MainThread]: Flushing usage events
[0m14:23:35.094320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cc0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d7d90>]}


============================== 14:23:35.096943 | 348f75bd-54ce-443b-be05-c1665eb3804f ==============================
[0m14:23:35.096943 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:23:35.097258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:23:35.327429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '348f75bd-54ce-443b-be05-c1665eb3804f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10650ab10>]}
[0m14:23:35.349926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '348f75bd-54ce-443b-be05-c1665eb3804f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10650c050>]}
[0m14:23:35.350528 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:23:35.410441 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:23:35.486374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:23:35.486687 [debug] [MainThread]: Partial parsing: added file: weather_dbt://snapshots/extreme_weather_events_snapshot.sql
[0m14:23:35.486945 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/schema.yml
[0m14:23:35.591965 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:23:35.592258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '348f75bd-54ce-443b-be05-c1665eb3804f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10686d250>]}
[0m14:23:35.597396 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'wind_speed_data' in the 'models' section of file 'models/schema.yml'
[0m14:23:35.598694 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'temp_trends' in the 'models' section of file 'models/schema.yml'
[0m14:23:35.599361 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'cloud_coverage' in the 'models' section of file 'models/schema.yml'
[0m14:23:35.600705 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'hourly_weather_patterns' in the 'models' section of file 'models/schema.yml'
[0m14:23:35.601522 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'humidity_temp' in the 'models' section of file 'models/schema.yml'
[0m14:23:35.602294 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'correlation_data' in the 'models' section of file 'models/schema.yml'
[0m14:23:35.602971 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'weather_distribution' in the 'models' section of file 'models/schema.yml'
[0m14:23:35.696509 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_wind_speed_data_wind_speed.849d740c37' (models/schema.yml) depends on a node named 'wind_speed_data' in package '' which was not found
[0m14:23:35.696838 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_wind_speed_data_city_name.c4aaba08bd' (models/schema.yml) depends on a node named 'wind_speed_data' in package '' which was not found
[0m14:23:35.697003 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_temp_trends_city_name.4afc8e63b4' (models/schema.yml) depends on a node named 'temp_trends' in package '' which was not found
[0m14:23:35.697153 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_temp_trends_day.21c9d335e1' (models/schema.yml) depends on a node named 'temp_trends' in package '' which was not found
[0m14:23:35.697320 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_temp_trends_avg_temp_fahrenheit.729988e7dc' (models/schema.yml) depends on a node named 'temp_trends' in package '' which was not found
[0m14:23:35.697464 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_cloud_coverage_city_name.55d54eb298' (models/schema.yml) depends on a node named 'cloud_coverage' in package '' which was not found
[0m14:23:35.697600 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_cloud_coverage_day.036f8cb244' (models/schema.yml) depends on a node named 'cloud_coverage' in package '' which was not found
[0m14:23:35.697734 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_cloud_coverage_avg_cloud_coverage.7f49a2a3b4' (models/schema.yml) depends on a node named 'cloud_coverage' in package '' which was not found
[0m14:23:35.697868 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_hourly_weather_patterns_city_id.a6c19b8462' (models/schema.yml) depends on a node named 'hourly_weather_patterns' in package '' which was not found
[0m14:23:35.698002 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_hourly_weather_patterns_city_name.dc4759d9ef' (models/schema.yml) depends on a node named 'hourly_weather_patterns' in package '' which was not found
[0m14:23:35.698135 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_hourly_weather_patterns_hour_of_day.294d349ce8' (models/schema.yml) depends on a node named 'hourly_weather_patterns' in package '' which was not found
[0m14:23:35.698266 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_hourly_weather_patterns_avg_temp_fahrenheit.d256cc3ff4' (models/schema.yml) depends on a node named 'hourly_weather_patterns' in package '' which was not found
[0m14:23:35.698393 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_hourly_weather_patterns_avg_wind_speed.eb74dbd9a3' (models/schema.yml) depends on a node named 'hourly_weather_patterns' in package '' which was not found
[0m14:23:35.698520 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_hourly_weather_patterns_avg_humidity.80884db71a' (models/schema.yml) depends on a node named 'hourly_weather_patterns' in package '' which was not found
[0m14:23:35.698651 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_humidity_temp_temp_fahrenheit.2d59e10ba6' (models/schema.yml) depends on a node named 'humidity_temp' in package '' which was not found
[0m14:23:35.698780 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_humidity_temp_humidity.8ce6807cfc' (models/schema.yml) depends on a node named 'humidity_temp' in package '' which was not found
[0m14:23:35.698908 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_humidity_temp_city_name.18edcab884' (models/schema.yml) depends on a node named 'humidity_temp' in package '' which was not found
[0m14:23:35.699040 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_correlation_data_city_name.e5aaaaa06c' (models/schema.yml) depends on a node named 'correlation_data' in package '' which was not found
[0m14:23:35.699167 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_correlation_data_avg_temp.432210ec93' (models/schema.yml) depends on a node named 'correlation_data' in package '' which was not found
[0m14:23:35.699293 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_correlation_data_avg_humidity.0a6629a977' (models/schema.yml) depends on a node named 'correlation_data' in package '' which was not found
[0m14:23:35.699421 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_correlation_data_avg_pressure.98633ad2c3' (models/schema.yml) depends on a node named 'correlation_data' in package '' which was not found
[0m14:23:35.699546 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_correlation_data_avg_wind_speed.fa385c67fb' (models/schema.yml) depends on a node named 'correlation_data' in package '' which was not found
[0m14:23:35.699675 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_weather_distribution_weather_main.c767224175' (models/schema.yml) depends on a node named 'weather_distribution' in package '' which was not found
[0m14:23:35.699804 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_weather_distribution_count.43536ea1bb' (models/schema.yml) depends on a node named 'weather_distribution' in package '' which was not found
[0m14:23:35.699931 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_weather_distribution_city_name.12e2186229' (models/schema.yml) depends on a node named 'weather_distribution' in package '' which was not found
[0m14:23:35.742678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '348f75bd-54ce-443b-be05-c1665eb3804f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068eed50>]}
[0m14:23:35.819768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '348f75bd-54ce-443b-be05-c1665eb3804f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106916a50>]}
[0m14:23:35.820053 [info ] [MainThread]: Found 8 models, 1 snapshot, 2 sources, 459 macros
[0m14:23:35.820215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '348f75bd-54ce-443b-be05-c1665eb3804f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d63c70>]}
[0m14:23:35.821109 [info ] [MainThread]: 
[0m14:23:35.821280 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:23:35.821507 [debug] [MainThread]: Command end result
[0m14:23:35.838702 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7782956, "process_in_blocks": "0", "process_kernel_time": 0.204222, "process_mem_max_rss": "132038656", "process_out_blocks": "0", "process_user_time": 1.135602}
[0m14:23:35.839083 [debug] [MainThread]: Command `dbt test` succeeded at 14:23:35.839029 after 0.78 seconds
[0m14:23:35.839275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052cd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d594f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d595a0>]}
[0m14:23:35.839457 [debug] [MainThread]: Flushing usage events
[0m14:23:57.515258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1185c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11afd7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11afd7d90>]}


============================== 14:23:57.518258 | 46b592ab-12b0-4266-8a2b-969b9442d0f7 ==============================
[0m14:23:57.518258 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:23:57.518603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:23:57.752575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46b592ab-12b0-4266-8a2b-969b9442d0f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cfdeb10>]}
[0m14:23:57.777815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46b592ab-12b0-4266-8a2b-969b9442d0f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cfe4050>]}
[0m14:23:57.779208 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:23:57.844064 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:23:57.929275 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m14:23:57.929603 [debug] [MainThread]: Partial parsing: deleted file: weather_dbt://tests/duplication_record_test_daily_avg.sql
[0m14:23:57.929739 [debug] [MainThread]: Partial parsing: deleted file: weather_dbt://tests/temp_range_daily_avg.sql
[0m14:23:57.929856 [debug] [MainThread]: Partial parsing: deleted file: weather_dbt://tests/humidity_range_daily_avg.sql
[0m14:23:57.973440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46b592ab-12b0-4266-8a2b-969b9442d0f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d380450>]}
[0m14:23:58.040089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46b592ab-12b0-4266-8a2b-969b9442d0f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d4bb3e0>]}
[0m14:23:58.040383 [info ] [MainThread]: Found 8 models, 1 snapshot, 2 sources, 459 macros
[0m14:23:58.040555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46b592ab-12b0-4266-8a2b-969b9442d0f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d4c7850>]}
[0m14:23:58.041389 [info ] [MainThread]: 
[0m14:23:58.041573 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:23:58.042427 [debug] [MainThread]: Command end result
[0m14:23:58.093159 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.61408806, "process_in_blocks": "0", "process_kernel_time": 0.21969, "process_mem_max_rss": "129253376", "process_out_blocks": "0", "process_user_time": 1.011104}
[0m14:23:58.093490 [debug] [MainThread]: Command `dbt test` succeeded at 14:23:58.093443 after 0.61 seconds
[0m14:23:58.093678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ad3aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ad09910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d53e390>]}
[0m14:23:58.093841 [debug] [MainThread]: Flushing usage events
[0m14:24:27.043179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc3d90>]}


============================== 14:24:27.046155 | 208c254b-234d-48ce-a3ec-36a8c55799b4 ==============================
[0m14:24:27.046155 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:24:27.046482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:24:27.272262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '208c254b-234d-48ce-a3ec-36a8c55799b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10790eb10>]}
[0m14:24:27.295847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '208c254b-234d-48ce-a3ec-36a8c55799b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107814050>]}
[0m14:24:27.296584 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:24:27.356411 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:24:27.432826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:24:27.433058 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:24:27.451934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '208c254b-234d-48ce-a3ec-36a8c55799b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107797450>]}
[0m14:24:27.521820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '208c254b-234d-48ce-a3ec-36a8c55799b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dbb3e0>]}
[0m14:24:27.522116 [info ] [MainThread]: Found 8 models, 1 snapshot, 2 sources, 459 macros
[0m14:24:27.522279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '208c254b-234d-48ce-a3ec-36a8c55799b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db7230>]}
[0m14:24:27.523137 [info ] [MainThread]: 
[0m14:24:27.523316 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:24:27.524156 [debug] [MainThread]: Command end result
[0m14:24:27.574899 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5697675, "process_in_blocks": "0", "process_kernel_time": 0.200396, "process_mem_max_rss": "127205376", "process_out_blocks": "0", "process_user_time": 0.950514}
[0m14:24:27.575223 [debug] [MainThread]: Command `dbt test` succeeded at 14:24:27.575172 after 0.57 seconds
[0m14:24:27.575410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee7d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a7d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1c1d0>]}
[0m14:24:27.575581 [debug] [MainThread]: Flushing usage events
[0m14:27:03.218481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ee8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ebb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ebd90>]}


============================== 14:27:03.221587 | 2094b1e3-c212-4717-9f72-41985a9ae0ad ==============================
[0m14:27:03.221587 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:27:03.221958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:27:03.459501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2094b1e3-c212-4717-9f72-41985a9ae0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105436b10>]}
[0m14:27:03.484453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2094b1e3-c212-4717-9f72-41985a9ae0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105438050>]}
[0m14:27:03.485955 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:27:03.546150 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:27:03.630141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:27:03.630613 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/schema.yml
[0m14:27:03.656722 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:27:03.657023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2094b1e3-c212-4717-9f72-41985a9ae0ad', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052bd350>]}
[0m14:27:03.752667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2094b1e3-c212-4717-9f72-41985a9ae0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058199a0>]}
[0m14:27:03.862210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2094b1e3-c212-4717-9f72-41985a9ae0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053033f0>]}
[0m14:27:03.862507 [info ] [MainThread]: Found 8 models, 1 snapshot, 2 data tests, 2 sources, 459 macros
[0m14:27:03.862673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2094b1e3-c212-4717-9f72-41985a9ae0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa0bb0>]}
[0m14:27:03.863723 [info ] [MainThread]: 
[0m14:27:03.864072 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:27:03.866268 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_snapshot'
[0m14:27:03.874148 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m14:27:03.874351 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m14:27:03.874487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:04.506769 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.631 seconds
[0m14:27:04.510760 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m14:27:04.630285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m14:27:04.634356 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m14:27:04.634741 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m14:27:04.635063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:05.298087 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.663 seconds
[0m14:27:05.302541 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m14:27:05.423387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2094b1e3-c212-4717-9f72-41985a9ae0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c31490>]}
[0m14:27:05.424322 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m14:27:05.424774 [info ] [MainThread]: 
[0m14:27:05.429392 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:27:05.429873 [info ] [Thread-1 (]: 1 of 2 START test not_null_wind_speed_analysis_city_name ....................... [RUN]
[0m14:27:05.430353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9)
[0m14:27:05.431207 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:27:05.448098 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m14:27:05.449717 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:27:05.464919 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m14:27:05.465837 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m14:27:05.466081 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.wind_speed_analysis
where city_name is null



      
    ) dbt_internal_test
[0m14:27:05.466295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:06.075155 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.608 seconds
[0m14:27:06.087187 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9: Close
[0m14:27:06.210521 [info ] [Thread-1 (]: 1 of 2 PASS not_null_wind_speed_analysis_city_name ............................. [[32mPASS[0m in 0.78s]
[0m14:27:06.211153 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:27:06.211512 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:27:06.211908 [info ] [Thread-1 (]: 2 of 2 START test not_null_wind_speed_analysis_wind_speed ...................... [RUN]
[0m14:27:06.212341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9, now test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2)
[0m14:27:06.212668 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:27:06.216250 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m14:27:06.217061 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:27:06.219863 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m14:27:06.220970 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m14:27:06.221267 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select wind_speed
from openweather.analytics.wind_speed_analysis
where wind_speed is null



      
    ) dbt_internal_test
[0m14:27:06.221530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:06.743739 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.522 seconds
[0m14:27:06.746602 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2: Close
[0m14:27:06.875646 [info ] [Thread-1 (]: 2 of 2 PASS not_null_wind_speed_analysis_wind_speed ............................ [[32mPASS[0m in 0.66s]
[0m14:27:06.876836 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:27:06.878596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:06.879012 [debug] [MainThread]: Connection 'test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2' was properly closed.
[0m14:27:06.879402 [info ] [MainThread]: 
[0m14:27:06.879762 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m14:27:06.880889 [debug] [MainThread]: Command end result
[0m14:27:06.911606 [info ] [MainThread]: 
[0m14:27:06.911945 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:27:06.912146 [info ] [MainThread]: 
[0m14:27:06.912365 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:27:06.914095 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.7335994, "process_in_blocks": "0", "process_kernel_time": 0.259719, "process_mem_max_rss": "143163392", "process_out_blocks": "0", "process_user_time": 1.402091}
[0m14:27:06.914577 [debug] [MainThread]: Command `dbt test` succeeded at 14:27:06.914507 after 3.73 seconds
[0m14:27:06.914847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d7cf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc2d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc2530>]}
[0m14:27:06.915095 [debug] [MainThread]: Flushing usage events
[0m14:27:31.725678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fc0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105117b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105117d90>]}


============================== 14:27:31.728257 | a9fb28c0-361c-4a09-8f99-510104c9be93 ==============================
[0m14:27:31.728257 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:27:31.728614 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:27:31.906483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9fb28c0-361c-4a09-8f99-510104c9be93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a0ab10>]}
[0m14:27:31.931496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9fb28c0-361c-4a09-8f99-510104c9be93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067fc050>]}
[0m14:27:31.931959 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:27:31.988748 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:27:32.062575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:27:32.063089 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/schema.yml
[0m14:27:32.090412 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:27:32.090708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a9fb28c0-361c-4a09-8f99-510104c9be93', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106773750>]}
[0m14:27:32.096648 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'CorrelationData' in the 'models' section of file 'models/schema.yml'
[0m14:27:32.147612 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_CorrelationData_city_name.a5081b9d78' (models/schema.yml) depends on a node named 'CorrelationData' in package '' which was not found
[0m14:27:32.147895 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_CorrelationData_avg_temp.e603982f88' (models/schema.yml) depends on a node named 'CorrelationData' in package '' which was not found
[0m14:27:32.148053 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_CorrelationData_avg_humidity.1bc3c6dd79' (models/schema.yml) depends on a node named 'CorrelationData' in package '' which was not found
[0m14:27:32.148201 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_CorrelationData_avg_pressure.e93ab52614' (models/schema.yml) depends on a node named 'CorrelationData' in package '' which was not found
[0m14:27:32.148343 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.not_null_CorrelationData_avg_wind_speed.91a1cd2db2' (models/schema.yml) depends on a node named 'CorrelationData' in package '' which was not found
[0m14:27:32.192189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9fb28c0-361c-4a09-8f99-510104c9be93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ded9a0>]}
[0m14:27:32.294030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9fb28c0-361c-4a09-8f99-510104c9be93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c635b0>]}
[0m14:27:32.294299 [info ] [MainThread]: Found 8 models, 1 snapshot, 2 data tests, 2 sources, 459 macros
[0m14:27:32.294454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9fb28c0-361c-4a09-8f99-510104c9be93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107194d50>]}
[0m14:27:32.295580 [info ] [MainThread]: 
[0m14:27:32.295966 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:27:32.298464 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_snapshot'
[0m14:27:32.306267 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m14:27:32.306468 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m14:27:32.306605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:32.835756 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.529 seconds
[0m14:27:32.838453 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m14:27:32.966989 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m14:27:32.971213 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m14:27:32.971728 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m14:27:32.972060 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:33.466963 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.494 seconds
[0m14:27:33.469014 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m14:27:33.585330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9fb28c0-361c-4a09-8f99-510104c9be93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f24d10>]}
[0m14:27:33.586149 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m14:27:33.586504 [info ] [MainThread]: 
[0m14:27:33.588763 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:27:33.589177 [info ] [Thread-1 (]: 1 of 2 START test not_null_wind_speed_analysis_city_name ....................... [RUN]
[0m14:27:33.589601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9)
[0m14:27:33.589938 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:27:33.607606 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m14:27:33.608718 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:27:33.624012 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m14:27:33.624915 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m14:27:33.625182 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.wind_speed_analysis
where city_name is null



      
    ) dbt_internal_test
[0m14:27:33.625417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:34.017424 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.392 seconds
[0m14:27:34.031407 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9: Close
[0m14:27:34.197261 [info ] [Thread-1 (]: 1 of 2 PASS not_null_wind_speed_analysis_city_name ............................. [[32mPASS[0m in 0.61s]
[0m14:27:34.198263 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:27:34.198884 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:27:34.199543 [info ] [Thread-1 (]: 2 of 2 START test not_null_wind_speed_analysis_wind_speed ...................... [RUN]
[0m14:27:34.200247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9, now test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2)
[0m14:27:34.200722 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:27:34.206306 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m14:27:34.207504 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:27:34.210194 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m14:27:34.211599 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m14:27:34.211991 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select wind_speed
from openweather.analytics.wind_speed_analysis
where wind_speed is null



      
    ) dbt_internal_test
[0m14:27:34.212359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:34.704459 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.492 seconds
[0m14:27:34.706784 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2: Close
[0m14:27:34.820673 [info ] [Thread-1 (]: 2 of 2 PASS not_null_wind_speed_analysis_wind_speed ............................ [[32mPASS[0m in 0.62s]
[0m14:27:34.821639 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:27:34.823434 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:34.823835 [debug] [MainThread]: Connection 'test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2' was properly closed.
[0m14:27:34.824219 [info ] [MainThread]: 
[0m14:27:34.824548 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.53 seconds (2.53s).
[0m14:27:34.825403 [debug] [MainThread]: Command end result
[0m14:27:34.857848 [info ] [MainThread]: 
[0m14:27:34.858187 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:27:34.858385 [info ] [MainThread]: 
[0m14:27:34.858589 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:27:34.859716 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.1700149, "process_in_blocks": "0", "process_kernel_time": 0.216073, "process_mem_max_rss": "142655488", "process_out_blocks": "0", "process_user_time": 1.386612}
[0m14:27:34.860079 [debug] [MainThread]: Command `dbt test` succeeded at 14:27:34.860013 after 3.17 seconds
[0m14:27:34.860319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150654f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb9450>]}
[0m14:27:34.860546 [debug] [MainThread]: Flushing usage events
[0m14:35:36.715883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10308cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10498fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10498fd90>]}


============================== 14:35:36.719114 | 1ea47bb4-edfc-4a85-b206-b0e6d09e3981 ==============================
[0m14:35:36.719114 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:35:36.719496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:35:36.959558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ea47bb4-edfc-4a85-b206-b0e6d09e3981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056eab10>]}
[0m14:35:36.985387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ea47bb4-edfc-4a85-b206-b0e6d09e3981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056ec050>]}
[0m14:35:36.987010 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:35:37.048561 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:35:37.132157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:35:37.132750 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/schema.yml
[0m14:35:37.244046 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:35:37.244387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1ea47bb4-edfc-4a85-b206-b0e6d09e3981', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad5150>]}
[0m14:35:37.393152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ea47bb4-edfc-4a85-b206-b0e6d09e3981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105542210>]}
[0m14:35:37.469923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ea47bb4-edfc-4a85-b206-b0e6d09e3981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b41630>]}
[0m14:35:37.470196 [info ] [MainThread]: Found 8 models, 1 snapshot, 25 data tests, 2 sources, 459 macros
[0m14:35:37.470360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ea47bb4-edfc-4a85-b206-b0e6d09e3981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d17ad0>]}
[0m14:35:37.471731 [info ] [MainThread]: 
[0m14:35:37.472007 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:35:37.474191 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_snapshot'
[0m14:35:37.483205 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m14:35:37.483477 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m14:35:37.483629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:39.095698 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.612 seconds
[0m14:35:39.099367 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m14:35:39.223187 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m14:35:39.229199 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m14:35:39.229762 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m14:35:39.230127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:39.738912 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.509 seconds
[0m14:35:39.745498 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m14:35:39.874267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ea47bb4-edfc-4a85-b206-b0e6d09e3981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e48e90>]}
[0m14:35:39.875212 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m14:35:39.875615 [info ] [MainThread]: 
[0m14:35:39.879089 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m14:35:39.879554 [info ] [Thread-1 (]: 1 of 25 START test not_null_cloud_coverage_over_time_avg_cloud_coverage ........ [RUN]
[0m14:35:39.880038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86)
[0m14:35:39.880416 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m14:35:39.896168 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m14:35:39.896941 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m14:35:39.911745 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m14:35:39.912651 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m14:35:39.912902 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_cloud_coverage
from openweather.analytics.cloud_coverage_over_time
where avg_cloud_coverage is null



      
    ) dbt_internal_test
[0m14:35:39.913118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:40.495512 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.582 seconds
[0m14:35:40.509849 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86: Close
[0m14:35:40.622566 [info ] [Thread-1 (]: 1 of 25 PASS not_null_cloud_coverage_over_time_avg_cloud_coverage .............. [[32mPASS[0m in 0.74s]
[0m14:35:40.623619 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m14:35:40.624242 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m14:35:40.624901 [info ] [Thread-1 (]: 2 of 25 START test not_null_cloud_coverage_over_time_city_name ................. [RUN]
[0m14:35:40.625626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86, now test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f)
[0m14:35:40.626147 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m14:35:40.632505 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m14:35:40.633817 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m14:35:40.636104 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m14:35:40.637283 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m14:35:40.637676 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.cloud_coverage_over_time
where city_name is null



      
    ) dbt_internal_test
[0m14:35:40.638018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:41.158522 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.520 seconds
[0m14:35:41.162898 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f: Close
[0m14:35:41.297165 [info ] [Thread-1 (]: 2 of 25 PASS not_null_cloud_coverage_over_time_city_name ....................... [[32mPASS[0m in 0.67s]
[0m14:35:41.297965 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m14:35:41.298457 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m14:35:41.298996 [info ] [Thread-1 (]: 3 of 25 START test not_null_cloud_coverage_over_time_day ....................... [RUN]
[0m14:35:41.299602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f, now test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9)
[0m14:35:41.300040 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m14:35:41.305145 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m14:35:41.306283 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m14:35:41.308944 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m14:35:41.310044 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m14:35:41.310539 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from openweather.analytics.cloud_coverage_over_time
where day is null



      
    ) dbt_internal_test
[0m14:35:41.310845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:41.769798 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.458 seconds
[0m14:35:41.775373 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9: Close
[0m14:35:41.908666 [info ] [Thread-1 (]: 3 of 25 PASS not_null_cloud_coverage_over_time_day ............................. [[32mPASS[0m in 0.61s]
[0m14:35:41.909761 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m14:35:41.910260 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m14:35:41.910780 [info ] [Thread-1 (]: 4 of 25 START test not_null_correlation_avg_humidity ........................... [RUN]
[0m14:35:41.911382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9, now test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d)
[0m14:35:41.911815 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m14:35:41.917254 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m14:35:41.918375 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m14:35:41.921282 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m14:35:41.922212 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m14:35:41.922535 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_humidity
from openweather.analytics.correlation
where avg_humidity is null



      
    ) dbt_internal_test
[0m14:35:41.922820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:42.480561 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.557 seconds
[0m14:35:42.486671 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d: Close
[0m14:35:42.621881 [info ] [Thread-1 (]: 4 of 25 PASS not_null_correlation_avg_humidity ................................. [[32mPASS[0m in 0.71s]
[0m14:35:42.622834 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m14:35:42.623423 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m14:35:42.624062 [info ] [Thread-1 (]: 5 of 25 START test not_null_correlation_avg_pressure ........................... [RUN]
[0m14:35:42.624764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d, now test.weather_dbt.not_null_correlation_avg_pressure.46419021da)
[0m14:35:42.625282 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m14:35:42.630730 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m14:35:42.631609 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m14:35:42.633591 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m14:35:42.634577 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m14:35:42.634989 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_pressure.46419021da: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_pressure
from openweather.analytics.correlation
where avg_pressure is null



      
    ) dbt_internal_test
[0m14:35:42.635359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:43.142553 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.506 seconds
[0m14:35:43.147806 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_pressure.46419021da: Close
[0m14:35:43.288746 [info ] [Thread-1 (]: 5 of 25 PASS not_null_correlation_avg_pressure ................................. [[32mPASS[0m in 0.66s]
[0m14:35:43.289710 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m14:35:43.290316 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m14:35:43.290972 [info ] [Thread-1 (]: 6 of 25 START test not_null_correlation_avg_temp ............................... [RUN]
[0m14:35:43.291659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_pressure.46419021da, now test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61)
[0m14:35:43.292085 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m14:35:43.297793 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m14:35:43.298963 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m14:35:43.301353 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m14:35:43.302869 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m14:35:43.303447 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp
from openweather.analytics.correlation
where avg_temp is null



      
    ) dbt_internal_test
[0m14:35:43.303790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:43.900617 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.596 seconds
[0m14:35:43.905263 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61: Close
[0m14:35:44.037081 [info ] [Thread-1 (]: 6 of 25 PASS not_null_correlation_avg_temp ..................................... [[32mPASS[0m in 0.75s]
[0m14:35:44.038126 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m14:35:44.038735 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m14:35:44.039318 [info ] [Thread-1 (]: 7 of 25 START test not_null_correlation_avg_wind_speed ......................... [RUN]
[0m14:35:44.039899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61, now test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9)
[0m14:35:44.040315 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m14:35:44.045800 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m14:35:44.046946 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m14:35:44.049091 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m14:35:44.050758 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m14:35:44.051182 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_wind_speed
from openweather.analytics.correlation
where avg_wind_speed is null



      
    ) dbt_internal_test
[0m14:35:44.051494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:44.511562 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.459 seconds
[0m14:35:44.515941 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9: Close
[0m14:35:44.650765 [info ] [Thread-1 (]: 7 of 25 PASS not_null_correlation_avg_wind_speed ............................... [[32mPASS[0m in 0.61s]
[0m14:35:44.651774 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m14:35:44.652366 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m14:35:44.652958 [info ] [Thread-1 (]: 8 of 25 START test not_null_correlation_city_name .............................. [RUN]
[0m14:35:44.653513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9, now test.weather_dbt.not_null_correlation_city_name.d4bb85e888)
[0m14:35:44.653926 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m14:35:44.659189 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m14:35:44.660153 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m14:35:44.662212 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m14:35:44.663349 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m14:35:44.663883 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_city_name.d4bb85e888: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.correlation
where city_name is null



      
    ) dbt_internal_test
[0m14:35:44.664358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:45.175866 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.511 seconds
[0m14:35:45.180402 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_city_name.d4bb85e888: Close
[0m14:35:45.320590 [info ] [Thread-1 (]: 8 of 25 PASS not_null_correlation_city_name .................................... [[32mPASS[0m in 0.67s]
[0m14:35:45.321332 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m14:35:45.321822 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m14:35:45.322349 [info ] [Thread-1 (]: 9 of 25 START test not_null_extreme_weather_events_city_id ..................... [RUN]
[0m14:35:45.322965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_city_name.d4bb85e888, now test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4)
[0m14:35:45.323411 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m14:35:45.328354 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m14:35:45.329457 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m14:35:45.331675 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m14:35:45.332740 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m14:35:45.333239 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_id
from openweather.analytics.extreme_weather_events
where city_id is null



      
    ) dbt_internal_test
[0m14:35:45.333551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:45.805462 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.471 seconds
[0m14:35:45.809150 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4: Close
[0m14:35:45.926728 [info ] [Thread-1 (]: 9 of 25 PASS not_null_extreme_weather_events_city_id ........................... [[32mPASS[0m in 0.60s]
[0m14:35:45.927731 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m14:35:45.928262 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m14:35:45.928926 [info ] [Thread-1 (]: 10 of 25 START test not_null_extreme_weather_events_city_name .................. [RUN]
[0m14:35:45.929682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4, now test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589)
[0m14:35:45.930171 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m14:35:45.936001 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m14:35:45.937231 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m14:35:45.939672 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m14:35:45.940887 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m14:35:45.941310 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.extreme_weather_events
where city_name is null



      
    ) dbt_internal_test
[0m14:35:45.941655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:46.513769 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.571 seconds
[0m14:35:46.517696 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589: Close
[0m14:35:46.623882 [info ] [Thread-1 (]: 10 of 25 PASS not_null_extreme_weather_events_city_name ........................ [[32mPASS[0m in 0.69s]
[0m14:35:46.625197 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m14:35:46.625843 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m14:35:46.626453 [info ] [Thread-1 (]: 11 of 25 START test not_null_extreme_weather_events_date_time .................. [RUN]
[0m14:35:46.627091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589, now test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853)
[0m14:35:46.627530 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m14:35:46.633059 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m14:35:46.634070 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m14:35:46.636219 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m14:35:46.637535 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m14:35:46.638148 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_time
from openweather.analytics.extreme_weather_events
where date_time is null



      
    ) dbt_internal_test
[0m14:35:46.638496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:47.132353 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.493 seconds
[0m14:35:47.135825 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853: Close
[0m14:35:47.459427 [info ] [Thread-1 (]: 11 of 25 PASS not_null_extreme_weather_events_date_time ........................ [[32mPASS[0m in 0.83s]
[0m14:35:47.459832 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m14:35:47.460042 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m14:35:47.460209 [info ] [Thread-1 (]: 12 of 25 START test not_null_extreme_weather_events_temp_fahrenheit ............ [RUN]
[0m14:35:47.460419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853, now test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d)
[0m14:35:47.460575 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m14:35:47.462484 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m14:35:47.463836 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m14:35:47.466427 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m14:35:47.467730 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m14:35:47.468176 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_fahrenheit
from openweather.analytics.extreme_weather_events
where temp_fahrenheit is null



      
    ) dbt_internal_test
[0m14:35:47.468362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:47.953053 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.484 seconds
[0m14:35:47.957081 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d: Close
[0m14:35:48.100749 [info ] [Thread-1 (]: 12 of 25 PASS not_null_extreme_weather_events_temp_fahrenheit .................. [[32mPASS[0m in 0.64s]
[0m14:35:48.101912 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m14:35:48.102528 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m14:35:48.103177 [info ] [Thread-1 (]: 13 of 25 START test not_null_extreme_weather_events_weather_alert .............. [RUN]
[0m14:35:48.103942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d, now test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb)
[0m14:35:48.104470 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m14:35:48.110270 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m14:35:48.111601 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m14:35:48.114060 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m14:35:48.115396 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m14:35:48.115835 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_alert
from openweather.analytics.extreme_weather_events
where weather_alert is null



      
    ) dbt_internal_test
[0m14:35:48.116205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:48.598644 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.482 seconds
[0m14:35:48.602215 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb: Close
[0m14:35:48.722859 [info ] [Thread-1 (]: 13 of 25 PASS not_null_extreme_weather_events_weather_alert .................... [[32mPASS[0m in 0.62s]
[0m14:35:48.723550 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m14:35:48.723941 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m14:35:48.724354 [info ] [Thread-1 (]: 14 of 25 START test not_null_extreme_weather_events_wind_speed ................. [RUN]
[0m14:35:48.724812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb, now test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4)
[0m14:35:48.725130 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m14:35:48.729539 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m14:35:48.730840 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m14:35:48.733531 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m14:35:48.734712 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m14:35:48.735208 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select wind_speed
from openweather.analytics.extreme_weather_events
where wind_speed is null



      
    ) dbt_internal_test
[0m14:35:48.735550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:49.203393 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.467 seconds
[0m14:35:49.208905 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4: Close
[0m14:35:49.334676 [info ] [Thread-1 (]: 14 of 25 PASS not_null_extreme_weather_events_wind_speed ....................... [[32mPASS[0m in 0.61s]
[0m14:35:49.335719 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m14:35:49.336308 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m14:35:49.336934 [info ] [Thread-1 (]: 15 of 25 START test not_null_humidity_vs_temp_city_name ........................ [RUN]
[0m14:35:49.337609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4, now test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042)
[0m14:35:49.338042 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m14:35:49.343809 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m14:35:49.345153 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m14:35:49.347588 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m14:35:49.348710 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m14:35:49.349135 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.humidity_vs_temp
where city_name is null



      
    ) dbt_internal_test
[0m14:35:49.349467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:49.857552 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.508 seconds
[0m14:35:49.860519 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042: Close
[0m14:35:49.965969 [info ] [Thread-1 (]: 15 of 25 PASS not_null_humidity_vs_temp_city_name .............................. [[32mPASS[0m in 0.63s]
[0m14:35:49.966424 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m14:35:49.966668 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m14:35:49.966932 [info ] [Thread-1 (]: 16 of 25 START test not_null_humidity_vs_temp_humidity ......................... [RUN]
[0m14:35:49.967236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042, now test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573)
[0m14:35:49.967456 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m14:35:49.969871 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m14:35:49.970416 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m14:35:49.971643 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m14:35:49.972190 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m14:35:49.972595 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select humidity
from openweather.analytics.humidity_vs_temp
where humidity is null



      
    ) dbt_internal_test
[0m14:35:49.972844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:50.453117 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.479 seconds
[0m14:35:50.458137 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573: Close
[0m14:35:50.587109 [info ] [Thread-1 (]: 16 of 25 PASS not_null_humidity_vs_temp_humidity ............................... [[32mPASS[0m in 0.62s]
[0m14:35:50.587780 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m14:35:50.588205 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m14:35:50.588685 [info ] [Thread-1 (]: 17 of 25 START test not_null_humidity_vs_temp_temp_fahrenheit .................. [RUN]
[0m14:35:50.589200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573, now test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5)
[0m14:35:50.589565 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m14:35:50.594183 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m14:35:50.595237 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m14:35:50.597155 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m14:35:50.598048 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m14:35:50.598369 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_fahrenheit
from openweather.analytics.humidity_vs_temp
where temp_fahrenheit is null



      
    ) dbt_internal_test
[0m14:35:50.598875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:51.063139 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.464 seconds
[0m14:35:51.067320 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5: Close
[0m14:35:51.200631 [info ] [Thread-1 (]: 17 of 25 PASS not_null_humidity_vs_temp_temp_fahrenheit ........................ [[32mPASS[0m in 0.61s]
[0m14:35:51.201541 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m14:35:51.202110 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m14:35:51.202737 [info ] [Thread-1 (]: 18 of 25 START test not_null_temp_trends_by_city_avg_temp_fahrenheit ........... [RUN]
[0m14:35:51.203444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5, now test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae)
[0m14:35:51.203955 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m14:35:51.209476 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m14:35:51.210614 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m14:35:51.213058 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m14:35:51.214467 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m14:35:51.214898 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp_fahrenheit
from openweather.analytics.temp_trends_by_city
where avg_temp_fahrenheit is null



      
    ) dbt_internal_test
[0m14:35:51.215235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:51.735020 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.519 seconds
[0m14:35:51.739048 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae: Close
[0m14:35:52.001188 [info ] [Thread-1 (]: 18 of 25 PASS not_null_temp_trends_by_city_avg_temp_fahrenheit ................. [[32mPASS[0m in 0.80s]
[0m14:35:52.002066 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m14:35:52.002493 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m14:35:52.002931 [info ] [Thread-1 (]: 19 of 25 START test not_null_temp_trends_by_city_city_name ..................... [RUN]
[0m14:35:52.003438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae, now test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b)
[0m14:35:52.003791 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m14:35:52.008157 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m14:35:52.009756 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m14:35:52.011909 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m14:35:52.012984 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m14:35:52.013285 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.temp_trends_by_city
where city_name is null



      
    ) dbt_internal_test
[0m14:35:52.013549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:52.540557 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.526 seconds
[0m14:35:52.545423 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b: Close
[0m14:35:52.673975 [info ] [Thread-1 (]: 19 of 25 PASS not_null_temp_trends_by_city_city_name ........................... [[32mPASS[0m in 0.67s]
[0m14:35:52.675073 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m14:35:52.675494 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m14:35:52.675893 [info ] [Thread-1 (]: 20 of 25 START test not_null_temp_trends_by_city_day ........................... [RUN]
[0m14:35:52.676349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b, now test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019)
[0m14:35:52.676663 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m14:35:52.680800 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m14:35:52.681789 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m14:35:52.683525 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m14:35:52.684317 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m14:35:52.684594 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from openweather.analytics.temp_trends_by_city
where day is null



      
    ) dbt_internal_test
[0m14:35:52.684843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:53.382602 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.697 seconds
[0m14:35:53.388413 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019: Close
[0m14:35:53.509206 [info ] [Thread-1 (]: 20 of 25 PASS not_null_temp_trends_by_city_day ................................. [[32mPASS[0m in 0.83s]
[0m14:35:53.510168 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m14:35:53.510776 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m14:35:53.511309 [info ] [Thread-1 (]: 21 of 25 START test not_null_weather_cond_distribution_city_name ............... [RUN]
[0m14:35:53.511938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019, now test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec)
[0m14:35:53.512379 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m14:35:53.518193 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m14:35:53.520730 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m14:35:53.522840 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m14:35:53.523954 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m14:35:53.524311 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.weather_cond_distribution
where city_name is null



      
    ) dbt_internal_test
[0m14:35:53.524636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:54.012347 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.487 seconds
[0m14:35:54.016724 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec: Close
[0m14:35:54.133693 [info ] [Thread-1 (]: 21 of 25 PASS not_null_weather_cond_distribution_city_name ..................... [[32mPASS[0m in 0.62s]
[0m14:35:54.134865 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m14:35:54.135384 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m14:35:54.135920 [info ] [Thread-1 (]: 22 of 25 START test not_null_weather_cond_distribution_count ................... [RUN]
[0m14:35:54.136615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec, now test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4)
[0m14:35:54.137111 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m14:35:54.142727 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m14:35:54.143822 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m14:35:54.146072 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m14:35:54.147352 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m14:35:54.147831 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select count
from openweather.analytics.weather_cond_distribution
where count is null



      
    ) dbt_internal_test
[0m14:35:54.148162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:54.646284 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.497 seconds
[0m14:35:54.649982 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4: Close
[0m14:35:54.753768 [info ] [Thread-1 (]: 22 of 25 PASS not_null_weather_cond_distribution_count ......................... [[32mPASS[0m in 0.62s]
[0m14:35:54.754719 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m14:35:54.755305 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m14:35:54.755832 [info ] [Thread-1 (]: 23 of 25 START test not_null_weather_cond_distribution_weather_main ............ [RUN]
[0m14:35:54.756424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4, now test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6)
[0m14:35:54.756851 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m14:35:54.761986 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m14:35:54.762839 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m14:35:54.764860 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m14:35:54.765915 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m14:35:54.766259 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_main
from openweather.analytics.weather_cond_distribution
where weather_main is null



      
    ) dbt_internal_test
[0m14:35:54.766573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:55.212742 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.446 seconds
[0m14:35:55.218178 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6: Close
[0m14:35:55.341235 [info ] [Thread-1 (]: 23 of 25 PASS not_null_weather_cond_distribution_weather_main .................. [[32mPASS[0m in 0.58s]
[0m14:35:55.342140 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m14:35:55.342589 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:35:55.342941 [info ] [Thread-1 (]: 24 of 25 START test not_null_wind_speed_analysis_city_name ..................... [RUN]
[0m14:35:55.343360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6, now test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9)
[0m14:35:55.343690 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:35:55.348638 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m14:35:55.350000 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:35:55.352229 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m14:35:55.353323 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m14:35:55.353662 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.wind_speed_analysis
where city_name is null



      
    ) dbt_internal_test
[0m14:35:55.353958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:55.798214 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.444 seconds
[0m14:35:55.802945 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9: Close
[0m14:35:55.915813 [info ] [Thread-1 (]: 24 of 25 PASS not_null_wind_speed_analysis_city_name ........................... [[32mPASS[0m in 0.57s]
[0m14:35:55.916725 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:35:55.917164 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:35:55.917622 [info ] [Thread-1 (]: 25 of 25 START test not_null_wind_speed_analysis_wind_speed .................... [RUN]
[0m14:35:55.918140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9, now test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2)
[0m14:35:55.918520 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:35:55.923090 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m14:35:55.924143 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:35:55.926098 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m14:35:55.927006 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m14:35:55.927288 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select wind_speed
from openweather.analytics.wind_speed_analysis
where wind_speed is null



      
    ) dbt_internal_test
[0m14:35:55.927677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:56.419543 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.491 seconds
[0m14:35:56.425573 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2: Close
[0m14:35:56.564479 [info ] [Thread-1 (]: 25 of 25 PASS not_null_wind_speed_analysis_wind_speed .......................... [[32mPASS[0m in 0.65s]
[0m14:35:56.565456 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:35:56.567320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:56.567742 [debug] [MainThread]: Connection 'test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2' was properly closed.
[0m14:35:56.568137 [info ] [MainThread]: 
[0m14:35:56.568503 [info ] [MainThread]: Finished running 25 data tests in 0 hours 0 minutes and 19.10 seconds (19.10s).
[0m14:35:56.572594 [debug] [MainThread]: Command end result
[0m14:35:56.608123 [info ] [MainThread]: 
[0m14:35:56.608472 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:35:56.608683 [info ] [MainThread]: 
[0m14:35:56.608882 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=0 SKIP=0 TOTAL=25
[0m14:35:56.610379 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 19.93085, "process_in_blocks": "0", "process_kernel_time": 0.450724, "process_mem_max_rss": "148291584", "process_out_blocks": "0", "process_user_time": 3.182069}
[0m14:35:56.610742 [debug] [MainThread]: Command `dbt test` succeeded at 14:35:56.610682 after 19.93 seconds
[0m14:35:56.610973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a660a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11410a2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11410af30>]}
[0m14:35:56.611191 [debug] [MainThread]: Flushing usage events
[0m14:51:02.053617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c94d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106597b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106597d90>]}


============================== 14:51:02.056830 | 8ee072d0-ceb8-4dee-b46f-df19d69f41d7 ==============================
[0m14:51:02.056830 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:51:02.057173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:51:02.288798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ee072d0-ceb8-4dee-b46f-df19d69f41d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073eab10>]}
[0m14:51:02.312494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ee072d0-ceb8-4dee-b46f-df19d69f41d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ec050>]}
[0m14:51:02.313346 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:51:02.372920 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:51:02.454304 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:51:02.454653 [debug] [MainThread]: Partial parsing: added file: weather_dbt://tests/extreme_weather_cond_valid_temp_test.sql
[0m14:51:02.454840 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/extreme_weather_events_snapshot.sql
[0m14:51:02.574772 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.extreme_weather_cond_valid_temp_test' (tests/extreme_weather_cond_valid_temp_test.sql) depends on a node named 'Extreme_Weather_Events' in package '' which was not found
[0m14:51:02.651861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ee072d0-ceb8-4dee-b46f-df19d69f41d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107888c50>]}
[0m14:51:02.734963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ee072d0-ceb8-4dee-b46f-df19d69f41d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b26e40>]}
[0m14:51:02.735386 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 2 sources, 459 macros
[0m14:51:02.735612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ee072d0-ceb8-4dee-b46f-df19d69f41d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797a890>]}
[0m14:51:02.737211 [info ] [MainThread]: 
[0m14:51:02.737575 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:51:02.740036 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_snapshot'
[0m14:51:02.748268 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m14:51:02.748525 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m14:51:02.748661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:03.343964 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.595 seconds
[0m14:51:03.348121 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m14:51:03.485768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m14:51:03.489569 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m14:51:03.489974 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m14:51:03.490294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:04.000568 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.510 seconds
[0m14:51:04.003895 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m14:51:04.155211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ee072d0-ceb8-4dee-b46f-df19d69f41d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd1d90>]}
[0m14:51:04.156116 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m14:51:04.156581 [info ] [MainThread]: 
[0m14:51:04.161290 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m14:51:04.161836 [info ] [Thread-1 (]: 1 of 25 START test not_null_cloud_coverage_over_time_avg_cloud_coverage ........ [RUN]
[0m14:51:04.162384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86)
[0m14:51:04.163228 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m14:51:04.179263 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m14:51:04.180518 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m14:51:04.194953 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m14:51:04.196004 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m14:51:04.196275 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_cloud_coverage
from openweather.analytics.cloud_coverage_over_time
where avg_cloud_coverage is null



      
    ) dbt_internal_test
[0m14:51:04.196501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:04.627254 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.430 seconds
[0m14:51:04.641849 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86: Close
[0m14:51:04.796215 [info ] [Thread-1 (]: 1 of 25 PASS not_null_cloud_coverage_over_time_avg_cloud_coverage .............. [[32mPASS[0m in 0.63s]
[0m14:51:04.796671 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m14:51:04.796914 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m14:51:04.797183 [info ] [Thread-1 (]: 2 of 25 START test not_null_cloud_coverage_over_time_city_name ................. [RUN]
[0m14:51:04.797471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86, now test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f)
[0m14:51:04.797677 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m14:51:04.800580 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m14:51:04.801112 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m14:51:04.802414 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m14:51:04.803238 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m14:51:04.803830 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.cloud_coverage_over_time
where city_name is null



      
    ) dbt_internal_test
[0m14:51:04.804178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:05.333375 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.528 seconds
[0m14:51:05.337952 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f: Close
[0m14:51:05.504708 [info ] [Thread-1 (]: 2 of 25 PASS not_null_cloud_coverage_over_time_city_name ....................... [[32mPASS[0m in 0.71s]
[0m14:51:05.505480 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m14:51:05.505977 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m14:51:05.506519 [info ] [Thread-1 (]: 3 of 25 START test not_null_cloud_coverage_over_time_day ....................... [RUN]
[0m14:51:05.507090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f, now test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9)
[0m14:51:05.507504 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m14:51:05.512895 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m14:51:05.514078 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m14:51:05.517333 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m14:51:05.518324 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m14:51:05.518693 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from openweather.analytics.cloud_coverage_over_time
where day is null



      
    ) dbt_internal_test
[0m14:51:05.519039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:06.784213 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.265 seconds
[0m14:51:06.787439 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9: Close
[0m14:51:06.909513 [info ] [Thread-1 (]: 3 of 25 PASS not_null_cloud_coverage_over_time_day ............................. [[32mPASS[0m in 1.40s]
[0m14:51:06.910514 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m14:51:06.911033 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m14:51:06.911576 [info ] [Thread-1 (]: 4 of 25 START test not_null_correlation_avg_humidity ........................... [RUN]
[0m14:51:06.912170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9, now test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d)
[0m14:51:06.912593 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m14:51:06.917730 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m14:51:06.918813 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m14:51:06.922076 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m14:51:06.923172 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m14:51:06.923658 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_humidity
from openweather.analytics.correlation
where avg_humidity is null



      
    ) dbt_internal_test
[0m14:51:06.924215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:07.425832 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.501 seconds
[0m14:51:07.430749 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d: Close
[0m14:51:07.543121 [info ] [Thread-1 (]: 4 of 25 PASS not_null_correlation_avg_humidity ................................. [[32mPASS[0m in 0.63s]
[0m14:51:07.544087 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m14:51:07.544677 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m14:51:07.545287 [info ] [Thread-1 (]: 5 of 25 START test not_null_correlation_avg_pressure ........................... [RUN]
[0m14:51:07.546007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d, now test.weather_dbt.not_null_correlation_avg_pressure.46419021da)
[0m14:51:07.546523 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m14:51:07.552428 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m14:51:07.553545 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m14:51:07.556118 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m14:51:07.557167 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m14:51:07.557550 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_pressure.46419021da: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_pressure
from openweather.analytics.correlation
where avg_pressure is null



      
    ) dbt_internal_test
[0m14:51:07.557891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:07.968849 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.410 seconds
[0m14:51:07.973133 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_pressure.46419021da: Close
[0m14:51:08.110365 [info ] [Thread-1 (]: 5 of 25 PASS not_null_correlation_avg_pressure ................................. [[32mPASS[0m in 0.56s]
[0m14:51:08.111122 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m14:51:08.111548 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m14:51:08.111994 [info ] [Thread-1 (]: 6 of 25 START test not_null_correlation_avg_temp ............................... [RUN]
[0m14:51:08.112503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_pressure.46419021da, now test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61)
[0m14:51:08.112886 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m14:51:08.117576 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m14:51:08.118628 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m14:51:08.120581 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m14:51:08.121407 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m14:51:08.121717 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp
from openweather.analytics.correlation
where avg_temp is null



      
    ) dbt_internal_test
[0m14:51:08.122355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:08.529983 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.407 seconds
[0m14:51:08.535217 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61: Close
[0m14:51:08.658751 [info ] [Thread-1 (]: 6 of 25 PASS not_null_correlation_avg_temp ..................................... [[32mPASS[0m in 0.55s]
[0m14:51:08.660223 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m14:51:08.660921 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m14:51:08.661470 [info ] [Thread-1 (]: 7 of 25 START test not_null_correlation_avg_wind_speed ......................... [RUN]
[0m14:51:08.662083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61, now test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9)
[0m14:51:08.662501 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m14:51:08.668069 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m14:51:08.669278 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m14:51:08.671685 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m14:51:08.673144 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m14:51:08.673600 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_wind_speed
from openweather.analytics.correlation
where avg_wind_speed is null



      
    ) dbt_internal_test
[0m14:51:08.673958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:09.256809 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.582 seconds
[0m14:51:09.260940 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9: Close
[0m14:51:09.394527 [info ] [Thread-1 (]: 7 of 25 PASS not_null_correlation_avg_wind_speed ............................... [[32mPASS[0m in 0.73s]
[0m14:51:09.395643 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m14:51:09.396250 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m14:51:09.396883 [info ] [Thread-1 (]: 8 of 25 START test not_null_correlation_city_name .............................. [RUN]
[0m14:51:09.397620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9, now test.weather_dbt.not_null_correlation_city_name.d4bb85e888)
[0m14:51:09.398156 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m14:51:09.403538 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m14:51:09.404754 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m14:51:09.407364 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m14:51:09.408554 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m14:51:09.408937 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_city_name.d4bb85e888: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.correlation
where city_name is null



      
    ) dbt_internal_test
[0m14:51:09.409283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:09.855492 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.446 seconds
[0m14:51:09.859996 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_city_name.d4bb85e888: Close
[0m14:51:10.018369 [info ] [Thread-1 (]: 8 of 25 PASS not_null_correlation_city_name .................................... [[32mPASS[0m in 0.62s]
[0m14:51:10.019033 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m14:51:10.019340 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m14:51:10.019533 [info ] [Thread-1 (]: 9 of 25 START test not_null_extreme_weather_events_city_id ..................... [RUN]
[0m14:51:10.019895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_city_name.d4bb85e888, now test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4)
[0m14:51:10.020252 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m14:51:10.025202 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m14:51:10.026136 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m14:51:10.028505 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m14:51:10.029501 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m14:51:10.030058 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_id
from openweather.analytics.extreme_weather_events
where city_id is null



      
    ) dbt_internal_test
[0m14:51:10.030434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:10.454102 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.423 seconds
[0m14:51:10.457044 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4: Close
[0m14:51:10.586894 [info ] [Thread-1 (]: 9 of 25 PASS not_null_extreme_weather_events_city_id ........................... [[32mPASS[0m in 0.57s]
[0m14:51:10.587768 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m14:51:10.588329 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m14:51:10.588929 [info ] [Thread-1 (]: 10 of 25 START test not_null_extreme_weather_events_city_name .................. [RUN]
[0m14:51:10.589625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4, now test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589)
[0m14:51:10.590097 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m14:51:10.595639 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m14:51:10.596796 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m14:51:10.599268 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m14:51:10.600635 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m14:51:10.601025 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.extreme_weather_events
where city_name is null



      
    ) dbt_internal_test
[0m14:51:10.601367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:11.004646 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.403 seconds
[0m14:51:11.006028 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589: Close
[0m14:51:11.137142 [info ] [Thread-1 (]: 10 of 25 PASS not_null_extreme_weather_events_city_name ........................ [[32mPASS[0m in 0.55s]
[0m14:51:11.137990 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m14:51:11.138412 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m14:51:11.138848 [info ] [Thread-1 (]: 11 of 25 START test not_null_extreme_weather_events_date_time .................. [RUN]
[0m14:51:11.139341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589, now test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853)
[0m14:51:11.139705 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m14:51:11.144003 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m14:51:11.145020 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m14:51:11.147355 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m14:51:11.148465 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m14:51:11.148797 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_time
from openweather.analytics.extreme_weather_events
where date_time is null



      
    ) dbt_internal_test
[0m14:51:11.149092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:11.538041 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.389 seconds
[0m14:51:11.542263 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853: Close
[0m14:51:12.274402 [info ] [Thread-1 (]: 11 of 25 PASS not_null_extreme_weather_events_date_time ........................ [[32mPASS[0m in 1.13s]
[0m14:51:12.275437 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m14:51:12.275953 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m14:51:12.276495 [info ] [Thread-1 (]: 12 of 25 START test not_null_extreme_weather_events_temp_fahrenheit ............ [RUN]
[0m14:51:12.277097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853, now test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d)
[0m14:51:12.277544 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m14:51:12.282994 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m14:51:12.284104 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m14:51:12.286197 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m14:51:12.287764 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m14:51:12.288222 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_fahrenheit
from openweather.analytics.extreme_weather_events
where temp_fahrenheit is null



      
    ) dbt_internal_test
[0m14:51:12.288549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:12.741536 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.452 seconds
[0m14:51:12.746643 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d: Close
[0m14:51:12.907496 [info ] [Thread-1 (]: 12 of 25 PASS not_null_extreme_weather_events_temp_fahrenheit .................. [[32mPASS[0m in 0.63s]
[0m14:51:12.908668 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m14:51:12.909284 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m14:51:12.909939 [info ] [Thread-1 (]: 13 of 25 START test not_null_extreme_weather_events_weather_alert .............. [RUN]
[0m14:51:12.910703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d, now test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb)
[0m14:51:12.911238 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m14:51:12.916966 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m14:51:12.918314 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m14:51:12.920714 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m14:51:12.922220 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m14:51:12.922725 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_alert
from openweather.analytics.extreme_weather_events
where weather_alert is null



      
    ) dbt_internal_test
[0m14:51:12.923122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:14.057047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.134 seconds
[0m14:51:14.059545 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb: Close
[0m14:51:14.177710 [info ] [Thread-1 (]: 13 of 25 PASS not_null_extreme_weather_events_weather_alert .................... [[32mPASS[0m in 1.27s]
[0m14:51:14.178659 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m14:51:14.179255 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m14:51:14.179879 [info ] [Thread-1 (]: 14 of 25 START test not_null_extreme_weather_events_wind_speed ................. [RUN]
[0m14:51:14.180599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb, now test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4)
[0m14:51:14.181123 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m14:51:14.186399 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m14:51:14.187420 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m14:51:14.189478 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m14:51:14.190879 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m14:51:14.191267 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select wind_speed
from openweather.analytics.extreme_weather_events
where wind_speed is null



      
    ) dbt_internal_test
[0m14:51:14.191598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:14.801564 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.609 seconds
[0m14:51:14.806299 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4: Close
[0m14:51:14.919266 [info ] [Thread-1 (]: 14 of 25 PASS not_null_extreme_weather_events_wind_speed ....................... [[32mPASS[0m in 0.74s]
[0m14:51:14.920204 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m14:51:14.920787 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m14:51:14.921406 [info ] [Thread-1 (]: 15 of 25 START test not_null_humidity_vs_temp_city_name ........................ [RUN]
[0m14:51:14.922153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4, now test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042)
[0m14:51:14.922688 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m14:51:14.928053 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m14:51:14.929121 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m14:51:14.931258 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m14:51:14.932208 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m14:51:14.932632 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.humidity_vs_temp
where city_name is null



      
    ) dbt_internal_test
[0m14:51:14.933175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:15.414621 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.481 seconds
[0m14:51:15.420238 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042: Close
[0m14:51:15.545781 [info ] [Thread-1 (]: 15 of 25 PASS not_null_humidity_vs_temp_city_name .............................. [[32mPASS[0m in 0.62s]
[0m14:51:15.547072 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m14:51:15.547731 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m14:51:15.548367 [info ] [Thread-1 (]: 16 of 25 START test not_null_humidity_vs_temp_humidity ......................... [RUN]
[0m14:51:15.549057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042, now test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573)
[0m14:51:15.549549 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m14:51:15.554618 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m14:51:15.555661 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m14:51:15.557840 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m14:51:15.559499 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m14:51:15.560013 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select humidity
from openweather.analytics.humidity_vs_temp
where humidity is null



      
    ) dbt_internal_test
[0m14:51:15.560564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:16.026069 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.466 seconds
[0m14:51:16.027373 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573: Close
[0m14:51:16.139751 [info ] [Thread-1 (]: 16 of 25 PASS not_null_humidity_vs_temp_humidity ............................... [[32mPASS[0m in 0.59s]
[0m14:51:16.140383 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m14:51:16.140731 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m14:51:16.141093 [info ] [Thread-1 (]: 17 of 25 START test not_null_humidity_vs_temp_temp_fahrenheit .................. [RUN]
[0m14:51:16.141496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573, now test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5)
[0m14:51:16.141807 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m14:51:16.144993 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m14:51:16.145809 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m14:51:16.147557 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m14:51:16.148321 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m14:51:16.148610 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_fahrenheit
from openweather.analytics.humidity_vs_temp
where temp_fahrenheit is null



      
    ) dbt_internal_test
[0m14:51:16.148876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:16.611135 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.460 seconds
[0m14:51:16.616693 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5: Close
[0m14:51:16.724414 [info ] [Thread-1 (]: 17 of 25 PASS not_null_humidity_vs_temp_temp_fahrenheit ........................ [[32mPASS[0m in 0.58s]
[0m14:51:16.725385 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m14:51:16.725993 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m14:51:16.726630 [info ] [Thread-1 (]: 18 of 25 START test not_null_temp_trends_by_city_avg_temp_fahrenheit ........... [RUN]
[0m14:51:16.727342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5, now test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae)
[0m14:51:16.727861 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m14:51:16.733728 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m14:51:16.734857 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m14:51:16.737387 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m14:51:16.738537 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m14:51:16.738936 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp_fahrenheit
from openweather.analytics.temp_trends_by_city
where avg_temp_fahrenheit is null



      
    ) dbt_internal_test
[0m14:51:16.739283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:18.355022 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.615 seconds
[0m14:51:18.357994 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae: Close
[0m14:51:18.493425 [info ] [Thread-1 (]: 18 of 25 PASS not_null_temp_trends_by_city_avg_temp_fahrenheit ................. [[32mPASS[0m in 1.77s]
[0m14:51:18.493886 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m14:51:18.494097 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m14:51:18.494270 [info ] [Thread-1 (]: 19 of 25 START test not_null_temp_trends_by_city_city_name ..................... [RUN]
[0m14:51:18.494497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae, now test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b)
[0m14:51:18.495125 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m14:51:18.498719 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m14:51:18.499723 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m14:51:18.502479 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m14:51:18.503886 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m14:51:18.504410 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.temp_trends_by_city
where city_name is null



      
    ) dbt_internal_test
[0m14:51:18.504787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:18.853706 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.348 seconds
[0m14:51:18.858082 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b: Close
[0m14:51:18.994530 [info ] [Thread-1 (]: 19 of 25 PASS not_null_temp_trends_by_city_city_name ........................... [[32mPASS[0m in 0.50s]
[0m14:51:18.995771 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m14:51:18.996412 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m14:51:18.996747 [info ] [Thread-1 (]: 20 of 25 START test not_null_temp_trends_by_city_day ........................... [RUN]
[0m14:51:18.997032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b, now test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019)
[0m14:51:18.997311 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m14:51:19.002162 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m14:51:19.003120 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m14:51:19.005309 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m14:51:19.006216 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m14:51:19.006563 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from openweather.analytics.temp_trends_by_city
where day is null



      
    ) dbt_internal_test
[0m14:51:19.006886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:19.431900 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.425 seconds
[0m14:51:19.434882 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019: Close
[0m14:51:19.545977 [info ] [Thread-1 (]: 20 of 25 PASS not_null_temp_trends_by_city_day ................................. [[32mPASS[0m in 0.55s]
[0m14:51:19.546493 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m14:51:19.546776 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m14:51:19.547073 [info ] [Thread-1 (]: 21 of 25 START test not_null_weather_cond_distribution_city_name ............... [RUN]
[0m14:51:19.547375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019, now test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec)
[0m14:51:19.547592 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m14:51:19.551297 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m14:51:19.551790 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m14:51:19.553517 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m14:51:19.554606 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m14:51:19.555026 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.weather_cond_distribution
where city_name is null



      
    ) dbt_internal_test
[0m14:51:19.555403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:20.126294 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.570 seconds
[0m14:51:20.130799 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec: Close
[0m14:51:20.273673 [info ] [Thread-1 (]: 21 of 25 PASS not_null_weather_cond_distribution_city_name ..................... [[32mPASS[0m in 0.73s]
[0m14:51:20.274811 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m14:51:20.275422 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m14:51:20.275912 [info ] [Thread-1 (]: 22 of 25 START test not_null_weather_cond_distribution_count ................... [RUN]
[0m14:51:20.276304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec, now test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4)
[0m14:51:20.276569 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m14:51:20.282036 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m14:51:20.283332 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m14:51:20.285910 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m14:51:20.287310 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m14:51:20.287801 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select count
from openweather.analytics.weather_cond_distribution
where count is null



      
    ) dbt_internal_test
[0m14:51:20.288146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:20.726497 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.438 seconds
[0m14:51:20.731265 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4: Close
[0m14:51:20.887512 [info ] [Thread-1 (]: 22 of 25 PASS not_null_weather_cond_distribution_count ......................... [[32mPASS[0m in 0.61s]
[0m14:51:20.888155 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m14:51:20.888519 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m14:51:20.888813 [info ] [Thread-1 (]: 23 of 25 START test not_null_weather_cond_distribution_weather_main ............ [RUN]
[0m14:51:20.889189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4, now test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6)
[0m14:51:20.889455 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m14:51:20.894633 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m14:51:20.895880 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m14:51:20.898501 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m14:51:20.899669 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m14:51:20.900221 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_main
from openweather.analytics.weather_cond_distribution
where weather_main is null



      
    ) dbt_internal_test
[0m14:51:20.900712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:21.360316 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.459 seconds
[0m14:51:21.365848 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6: Close
[0m14:51:21.512083 [info ] [Thread-1 (]: 23 of 25 PASS not_null_weather_cond_distribution_weather_main .................. [[32mPASS[0m in 0.62s]
[0m14:51:21.513008 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m14:51:21.513588 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:51:21.514210 [info ] [Thread-1 (]: 24 of 25 START test not_null_wind_speed_analysis_city_name ..................... [RUN]
[0m14:51:21.514935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6, now test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9)
[0m14:51:21.515466 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:51:21.521138 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m14:51:21.522271 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:51:21.524679 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m14:51:21.525971 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m14:51:21.526455 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.wind_speed_analysis
where city_name is null



      
    ) dbt_internal_test
[0m14:51:21.526832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:21.980473 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.453 seconds
[0m14:51:21.985461 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9: Close
[0m14:51:22.102647 [info ] [Thread-1 (]: 24 of 25 PASS not_null_wind_speed_analysis_city_name ........................... [[32mPASS[0m in 0.59s]
[0m14:51:22.103877 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:51:22.104501 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:51:22.105124 [info ] [Thread-1 (]: 25 of 25 START test not_null_wind_speed_analysis_wind_speed .................... [RUN]
[0m14:51:22.105901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9, now test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2)
[0m14:51:22.106416 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:51:22.112084 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m14:51:22.113176 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:51:22.115594 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m14:51:22.116999 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m14:51:22.117484 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select wind_speed
from openweather.analytics.wind_speed_analysis
where wind_speed is null



      
    ) dbt_internal_test
[0m14:51:22.117926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:22.617518 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.499 seconds
[0m14:51:22.619885 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2: Close
[0m14:51:23.481414 [info ] [Thread-1 (]: 25 of 25 PASS not_null_wind_speed_analysis_wind_speed .......................... [[32mPASS[0m in 1.38s]
[0m14:51:23.482606 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:51:23.484454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:23.484809 [debug] [MainThread]: Connection 'test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2' was properly closed.
[0m14:51:23.485185 [info ] [MainThread]: 
[0m14:51:23.485523 [info ] [MainThread]: Finished running 25 data tests in 0 hours 0 minutes and 20.75 seconds (20.75s).
[0m14:51:23.489735 [debug] [MainThread]: Command end result
[0m14:51:23.523016 [info ] [MainThread]: 
[0m14:51:23.523372 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:23.523576 [info ] [MainThread]: 
[0m14:51:23.523775 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=0 SKIP=0 TOTAL=25
[0m14:51:23.525209 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 21.508602, "process_in_blocks": "0", "process_kernel_time": 0.409487, "process_mem_max_rss": "146046976", "process_out_blocks": "0", "process_user_time": 3.099421}
[0m14:51:23.525574 [debug] [MainThread]: Command `dbt test` succeeded at 14:51:23.525520 after 21.51 seconds
[0m14:51:23.525818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106351910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11258f3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11258efc0>]}
[0m14:51:23.526040 [debug] [MainThread]: Flushing usage events
[0m14:51:52.023846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cc0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d13b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d13d90>]}


============================== 14:51:52.026679 | 9a41903b-c0b6-45f4-b0b7-8f121c8ce543 ==============================
[0m14:51:52.026679 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:51:52.027007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:51:52.227008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a41903b-c0b6-45f4-b0b7-8f121c8ce543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d0ab10>]}
[0m14:51:52.249941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a41903b-c0b6-45f4-b0b7-8f121c8ce543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d0c050>]}
[0m14:51:52.250631 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:51:52.311494 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:51:52.396261 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m14:51:52.396586 [debug] [MainThread]: Partial parsing: deleted file: weather_dbt://tests/extreme_weather_cond_valid_temp_test.sql
[0m14:51:52.441024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a41903b-c0b6-45f4-b0b7-8f121c8ce543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d9050>]}
[0m14:51:52.545596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a41903b-c0b6-45f4-b0b7-8f121c8ce543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d158b0>]}
[0m14:51:52.545912 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 2 sources, 459 macros
[0m14:51:52.546089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a41903b-c0b6-45f4-b0b7-8f121c8ce543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1fcb0>]}
[0m14:51:52.547549 [info ] [MainThread]: 
[0m14:51:52.547854 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:51:52.550091 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_analytics'
[0m14:51:52.558655 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m14:51:52.558890 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m14:51:52.559029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:53.109708 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.550 seconds
[0m14:51:53.113211 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m14:51:53.227179 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m14:51:53.230045 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m14:51:53.230337 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m14:51:53.230569 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:53.799992 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.569 seconds
[0m14:51:53.803898 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m14:51:53.924464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a41903b-c0b6-45f4-b0b7-8f121c8ce543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10831add0>]}
[0m14:51:53.925063 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m14:51:53.925357 [info ] [MainThread]: 
[0m14:51:53.929476 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m14:51:53.929855 [info ] [Thread-1 (]: 1 of 25 START test not_null_cloud_coverage_over_time_avg_cloud_coverage ........ [RUN]
[0m14:51:53.930238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86)
[0m14:51:53.930973 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m14:51:53.944285 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m14:51:53.944904 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m14:51:53.958191 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m14:51:53.958870 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m14:51:53.959097 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_cloud_coverage
from openweather.analytics.cloud_coverage_over_time
where avg_cloud_coverage is null



      
    ) dbt_internal_test
[0m14:51:53.959297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:54.309841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.350 seconds
[0m14:51:54.322759 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86: Close
[0m14:51:54.440195 [info ] [Thread-1 (]: 1 of 25 PASS not_null_cloud_coverage_over_time_avg_cloud_coverage .............. [[32mPASS[0m in 0.51s]
[0m14:51:54.441884 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m14:51:54.442558 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m14:51:54.443189 [info ] [Thread-1 (]: 2 of 25 START test not_null_cloud_coverage_over_time_city_name ................. [RUN]
[0m14:51:54.443855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86, now test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f)
[0m14:51:54.444305 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m14:51:54.448980 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m14:51:54.449876 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m14:51:54.451999 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m14:51:54.452956 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m14:51:54.453642 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.cloud_coverage_over_time
where city_name is null



      
    ) dbt_internal_test
[0m14:51:54.453960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:54.839831 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.385 seconds
[0m14:51:54.844536 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f: Close
[0m14:51:55.013239 [info ] [Thread-1 (]: 2 of 25 PASS not_null_cloud_coverage_over_time_city_name ....................... [[32mPASS[0m in 0.57s]
[0m14:51:55.013998 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m14:51:55.014322 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m14:51:55.014640 [info ] [Thread-1 (]: 3 of 25 START test not_null_cloud_coverage_over_time_day ....................... [RUN]
[0m14:51:55.014992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f, now test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9)
[0m14:51:55.015233 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m14:51:55.019309 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m14:51:55.019872 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m14:51:55.022245 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m14:51:55.023446 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m14:51:55.023865 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from openweather.analytics.cloud_coverage_over_time
where day is null



      
    ) dbt_internal_test
[0m14:51:55.024281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:55.425970 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.401 seconds
[0m14:51:55.429359 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9: Close
[0m14:51:55.555693 [info ] [Thread-1 (]: 3 of 25 PASS not_null_cloud_coverage_over_time_day ............................. [[32mPASS[0m in 0.54s]
[0m14:51:55.556628 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m14:51:55.557210 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m14:51:55.557830 [info ] [Thread-1 (]: 4 of 25 START test not_null_correlation_avg_humidity ........................... [RUN]
[0m14:51:55.558538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9, now test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d)
[0m14:51:55.559055 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m14:51:55.564705 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m14:51:55.565867 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m14:51:55.568217 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m14:51:55.569572 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m14:51:55.570006 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_humidity
from openweather.analytics.correlation
where avg_humidity is null



      
    ) dbt_internal_test
[0m14:51:55.570353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:56.048429 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.478 seconds
[0m14:51:56.051741 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d: Close
[0m14:51:56.189529 [info ] [Thread-1 (]: 4 of 25 PASS not_null_correlation_avg_humidity ................................. [[32mPASS[0m in 0.63s]
[0m14:51:56.190557 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m14:51:56.191151 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m14:51:56.191762 [info ] [Thread-1 (]: 5 of 25 START test not_null_correlation_avg_pressure ........................... [RUN]
[0m14:51:56.192466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d, now test.weather_dbt.not_null_correlation_avg_pressure.46419021da)
[0m14:51:56.192984 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m14:51:56.198406 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m14:51:56.199553 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m14:51:56.201752 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m14:51:56.203150 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m14:51:56.203637 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_pressure.46419021da: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_pressure
from openweather.analytics.correlation
where avg_pressure is null



      
    ) dbt_internal_test
[0m14:51:56.203984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:56.841963 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.638 seconds
[0m14:51:56.845317 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_pressure.46419021da: Close
[0m14:51:56.962114 [info ] [Thread-1 (]: 5 of 25 PASS not_null_correlation_avg_pressure ................................. [[32mPASS[0m in 0.77s]
[0m14:51:56.963318 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m14:51:56.963955 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m14:51:56.964616 [info ] [Thread-1 (]: 6 of 25 START test not_null_correlation_avg_temp ............................... [RUN]
[0m14:51:56.965327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_pressure.46419021da, now test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61)
[0m14:51:56.965754 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m14:51:56.971144 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m14:51:56.972167 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m14:51:56.974721 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m14:51:56.976422 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m14:51:56.976861 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp
from openweather.analytics.correlation
where avg_temp is null



      
    ) dbt_internal_test
[0m14:51:56.977323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:57.460528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.483 seconds
[0m14:51:57.465308 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61: Close
[0m14:51:57.573756 [info ] [Thread-1 (]: 6 of 25 PASS not_null_correlation_avg_temp ..................................... [[32mPASS[0m in 0.61s]
[0m14:51:57.574834 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m14:51:57.575439 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m14:51:57.576063 [info ] [Thread-1 (]: 7 of 25 START test not_null_correlation_avg_wind_speed ......................... [RUN]
[0m14:51:57.576655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61, now test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9)
[0m14:51:57.577118 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m14:51:57.582705 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m14:51:57.583626 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m14:51:57.585711 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m14:51:57.586652 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m14:51:57.587010 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_wind_speed
from openweather.analytics.correlation
where avg_wind_speed is null



      
    ) dbt_internal_test
[0m14:51:57.587346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:59.047024 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.459 seconds
[0m14:51:59.053574 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9: Close
[0m14:51:59.170918 [info ] [Thread-1 (]: 7 of 25 PASS not_null_correlation_avg_wind_speed ............................... [[32mPASS[0m in 1.59s]
[0m14:51:59.171955 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m14:51:59.172574 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m14:51:59.173215 [info ] [Thread-1 (]: 8 of 25 START test not_null_correlation_city_name .............................. [RUN]
[0m14:51:59.173991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9, now test.weather_dbt.not_null_correlation_city_name.d4bb85e888)
[0m14:51:59.174535 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m14:51:59.180160 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m14:51:59.181375 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m14:51:59.183540 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m14:51:59.184510 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m14:51:59.184878 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_city_name.d4bb85e888: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.correlation
where city_name is null



      
    ) dbt_internal_test
[0m14:51:59.185203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:59.693793 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.508 seconds
[0m14:51:59.698349 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_city_name.d4bb85e888: Close
[0m14:51:59.846308 [info ] [Thread-1 (]: 8 of 25 PASS not_null_correlation_city_name .................................... [[32mPASS[0m in 0.67s]
[0m14:51:59.847397 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m14:51:59.848001 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m14:51:59.848542 [info ] [Thread-1 (]: 9 of 25 START test not_null_extreme_weather_events_city_id ..................... [RUN]
[0m14:51:59.849147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_city_name.d4bb85e888, now test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4)
[0m14:51:59.849603 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m14:51:59.855093 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m14:51:59.856135 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m14:51:59.858284 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m14:51:59.859671 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m14:51:59.860276 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_id
from openweather.analytics.extreme_weather_events
where city_id is null



      
    ) dbt_internal_test
[0m14:51:59.860671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:00.257407 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.397 seconds
[0m14:52:00.259926 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4: Close
[0m14:52:00.380454 [info ] [Thread-1 (]: 9 of 25 PASS not_null_extreme_weather_events_city_id ........................... [[32mPASS[0m in 0.53s]
[0m14:52:00.381497 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m14:52:00.382111 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m14:52:00.382742 [info ] [Thread-1 (]: 10 of 25 START test not_null_extreme_weather_events_city_name .................. [RUN]
[0m14:52:00.383479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4, now test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589)
[0m14:52:00.384007 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m14:52:00.389757 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m14:52:00.390850 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m14:52:00.393370 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m14:52:00.394687 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m14:52:00.395087 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.extreme_weather_events
where city_name is null



      
    ) dbt_internal_test
[0m14:52:00.395418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:00.806114 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.410 seconds
[0m14:52:00.811605 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589: Close
[0m14:52:00.929839 [info ] [Thread-1 (]: 10 of 25 PASS not_null_extreme_weather_events_city_name ........................ [[32mPASS[0m in 0.55s]
[0m14:52:00.930908 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m14:52:00.931508 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m14:52:00.932101 [info ] [Thread-1 (]: 11 of 25 START test not_null_extreme_weather_events_date_time .................. [RUN]
[0m14:52:00.932691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589, now test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853)
[0m14:52:00.933131 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m14:52:00.938450 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m14:52:00.939356 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m14:52:00.941416 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m14:52:00.942503 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m14:52:00.943081 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_time
from openweather.analytics.extreme_weather_events
where date_time is null



      
    ) dbt_internal_test
[0m14:52:00.943509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:01.391370 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.448 seconds
[0m14:52:01.394377 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853: Close
[0m14:52:01.615056 [info ] [Thread-1 (]: 11 of 25 PASS not_null_extreme_weather_events_date_time ........................ [[32mPASS[0m in 0.68s]
[0m14:52:01.615768 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m14:52:01.616206 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m14:52:01.616663 [info ] [Thread-1 (]: 12 of 25 START test not_null_extreme_weather_events_temp_fahrenheit ............ [RUN]
[0m14:52:01.617173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853, now test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d)
[0m14:52:01.617545 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m14:52:01.622200 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m14:52:01.623270 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m14:52:01.625207 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m14:52:01.626052 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m14:52:01.626384 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_fahrenheit
from openweather.analytics.extreme_weather_events
where temp_fahrenheit is null



      
    ) dbt_internal_test
[0m14:52:01.627002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:02.017681 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.390 seconds
[0m14:52:02.021207 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d: Close
[0m14:52:02.189923 [info ] [Thread-1 (]: 12 of 25 PASS not_null_extreme_weather_events_temp_fahrenheit .................. [[32mPASS[0m in 0.57s]
[0m14:52:02.190765 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m14:52:02.191270 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m14:52:02.191804 [info ] [Thread-1 (]: 13 of 25 START test not_null_extreme_weather_events_weather_alert .............. [RUN]
[0m14:52:02.192338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d, now test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb)
[0m14:52:02.192702 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m14:52:02.197351 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m14:52:02.198144 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m14:52:02.199964 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m14:52:02.200752 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m14:52:02.201062 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_alert
from openweather.analytics.extreme_weather_events
where weather_alert is null



      
    ) dbt_internal_test
[0m14:52:02.201346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:02.681862 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.480 seconds
[0m14:52:02.686236 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb: Close
[0m14:52:02.818551 [info ] [Thread-1 (]: 13 of 25 PASS not_null_extreme_weather_events_weather_alert .................... [[32mPASS[0m in 0.63s]
[0m14:52:02.819404 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m14:52:02.819922 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m14:52:02.820419 [info ] [Thread-1 (]: 14 of 25 START test not_null_extreme_weather_events_wind_speed ................. [RUN]
[0m14:52:02.820933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb, now test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4)
[0m14:52:02.821299 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m14:52:02.826316 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m14:52:02.827275 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m14:52:02.829200 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m14:52:02.830036 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m14:52:02.830504 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select wind_speed
from openweather.analytics.extreme_weather_events
where wind_speed is null



      
    ) dbt_internal_test
[0m14:52:02.830966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:03.278713 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.447 seconds
[0m14:52:03.282680 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4: Close
[0m14:52:03.388263 [info ] [Thread-1 (]: 14 of 25 PASS not_null_extreme_weather_events_wind_speed ....................... [[32mPASS[0m in 0.57s]
[0m14:52:03.388723 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m14:52:03.388975 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m14:52:03.389248 [info ] [Thread-1 (]: 15 of 25 START test not_null_humidity_vs_temp_city_name ........................ [RUN]
[0m14:52:03.389555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4, now test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042)
[0m14:52:03.389783 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m14:52:03.392214 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m14:52:03.392692 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m14:52:03.393821 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m14:52:03.394306 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m14:52:03.394505 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.humidity_vs_temp
where city_name is null



      
    ) dbt_internal_test
[0m14:52:03.394863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:03.954475 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.559 seconds
[0m14:52:03.960740 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042: Close
[0m14:52:04.095156 [info ] [Thread-1 (]: 15 of 25 PASS not_null_humidity_vs_temp_city_name .............................. [[32mPASS[0m in 0.71s]
[0m14:52:04.096025 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m14:52:04.096417 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m14:52:04.096797 [info ] [Thread-1 (]: 16 of 25 START test not_null_humidity_vs_temp_humidity ......................... [RUN]
[0m14:52:04.097237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042, now test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573)
[0m14:52:04.097533 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m14:52:04.101446 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m14:52:04.102305 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m14:52:04.104301 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m14:52:04.105178 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m14:52:04.105448 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select humidity
from openweather.analytics.humidity_vs_temp
where humidity is null



      
    ) dbt_internal_test
[0m14:52:04.105687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:04.529962 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.424 seconds
[0m14:52:04.534312 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573: Close
[0m14:52:04.669512 [info ] [Thread-1 (]: 16 of 25 PASS not_null_humidity_vs_temp_humidity ............................... [[32mPASS[0m in 0.57s]
[0m14:52:04.670374 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m14:52:04.670857 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m14:52:04.671406 [info ] [Thread-1 (]: 17 of 25 START test not_null_humidity_vs_temp_temp_fahrenheit .................. [RUN]
[0m14:52:04.671983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573, now test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5)
[0m14:52:04.672400 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m14:52:04.677352 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m14:52:04.678422 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m14:52:04.680339 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m14:52:04.681183 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m14:52:04.681795 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_fahrenheit
from openweather.analytics.humidity_vs_temp
where temp_fahrenheit is null



      
    ) dbt_internal_test
[0m14:52:04.682225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:05.068730 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.386 seconds
[0m14:52:05.072947 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5: Close
[0m14:52:05.200328 [info ] [Thread-1 (]: 17 of 25 PASS not_null_humidity_vs_temp_temp_fahrenheit ........................ [[32mPASS[0m in 0.53s]
[0m14:52:05.200818 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m14:52:05.201071 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m14:52:05.201334 [info ] [Thread-1 (]: 18 of 25 START test not_null_temp_trends_by_city_avg_temp_fahrenheit ........... [RUN]
[0m14:52:05.201627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5, now test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae)
[0m14:52:05.201846 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m14:52:05.204309 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m14:52:05.204827 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m14:52:05.206051 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m14:52:05.206633 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m14:52:05.206966 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp_fahrenheit
from openweather.analytics.temp_trends_by_city
where avg_temp_fahrenheit is null



      
    ) dbt_internal_test
[0m14:52:05.207227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:05.764588 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.557 seconds
[0m14:52:05.767306 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae: Close
[0m14:52:05.889216 [info ] [Thread-1 (]: 18 of 25 PASS not_null_temp_trends_by_city_avg_temp_fahrenheit ................. [[32mPASS[0m in 0.69s]
[0m14:52:05.890691 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m14:52:05.891370 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m14:52:05.892009 [info ] [Thread-1 (]: 19 of 25 START test not_null_temp_trends_by_city_city_name ..................... [RUN]
[0m14:52:05.892778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae, now test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b)
[0m14:52:05.893297 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m14:52:05.897638 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m14:52:05.898589 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m14:52:05.900882 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m14:52:05.902038 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m14:52:05.902513 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.temp_trends_by_city
where city_name is null



      
    ) dbt_internal_test
[0m14:52:05.902887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:06.295031 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.392 seconds
[0m14:52:06.298766 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b: Close
[0m14:52:06.415535 [info ] [Thread-1 (]: 19 of 25 PASS not_null_temp_trends_by_city_city_name ........................... [[32mPASS[0m in 0.52s]
[0m14:52:06.416611 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m14:52:06.417211 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m14:52:06.417840 [info ] [Thread-1 (]: 20 of 25 START test not_null_temp_trends_by_city_day ........................... [RUN]
[0m14:52:06.418509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b, now test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019)
[0m14:52:06.419021 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m14:52:06.424754 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m14:52:06.425864 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m14:52:06.428244 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m14:52:06.429727 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m14:52:06.430146 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from openweather.analytics.temp_trends_by_city
where day is null



      
    ) dbt_internal_test
[0m14:52:06.430491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:06.895087 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.464 seconds
[0m14:52:06.899804 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019: Close
[0m14:52:07.042475 [info ] [Thread-1 (]: 20 of 25 PASS not_null_temp_trends_by_city_day ................................. [[32mPASS[0m in 0.62s]
[0m14:52:07.043578 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m14:52:07.044189 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m14:52:07.044850 [info ] [Thread-1 (]: 21 of 25 START test not_null_weather_cond_distribution_city_name ............... [RUN]
[0m14:52:07.045564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019, now test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec)
[0m14:52:07.046110 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m14:52:07.052003 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m14:52:07.053335 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m14:52:07.055823 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m14:52:07.057506 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m14:52:07.057918 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.weather_cond_distribution
where city_name is null



      
    ) dbt_internal_test
[0m14:52:07.058245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:07.473934 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.416 seconds
[0m14:52:07.475881 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec: Close
[0m14:52:07.599581 [info ] [Thread-1 (]: 21 of 25 PASS not_null_weather_cond_distribution_city_name ..................... [[32mPASS[0m in 0.55s]
[0m14:52:07.601085 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m14:52:07.601838 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m14:52:07.602515 [info ] [Thread-1 (]: 22 of 25 START test not_null_weather_cond_distribution_count ................... [RUN]
[0m14:52:07.603198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec, now test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4)
[0m14:52:07.603625 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m14:52:07.609000 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m14:52:07.610164 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m14:52:07.612577 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m14:52:07.613653 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m14:52:07.614031 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select count
from openweather.analytics.weather_cond_distribution
where count is null



      
    ) dbt_internal_test
[0m14:52:07.614370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:08.076190 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.461 seconds
[0m14:52:08.079637 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4: Close
[0m14:52:08.212865 [info ] [Thread-1 (]: 22 of 25 PASS not_null_weather_cond_distribution_count ......................... [[32mPASS[0m in 0.61s]
[0m14:52:08.214352 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m14:52:08.215045 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m14:52:08.215615 [info ] [Thread-1 (]: 23 of 25 START test not_null_weather_cond_distribution_weather_main ............ [RUN]
[0m14:52:08.216240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4, now test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6)
[0m14:52:08.216684 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m14:52:08.222163 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m14:52:08.223298 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m14:52:08.225592 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m14:52:08.226936 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m14:52:08.227378 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_main
from openweather.analytics.weather_cond_distribution
where weather_main is null



      
    ) dbt_internal_test
[0m14:52:08.227706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:08.636389 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m14:52:08.641194 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6: Close
[0m14:52:08.765761 [info ] [Thread-1 (]: 23 of 25 PASS not_null_weather_cond_distribution_weather_main .................. [[32mPASS[0m in 0.55s]
[0m14:52:08.766553 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m14:52:08.767069 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:52:08.767583 [info ] [Thread-1 (]: 24 of 25 START test not_null_wind_speed_analysis_city_name ..................... [RUN]
[0m14:52:08.768123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6, now test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9)
[0m14:52:08.768498 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:52:08.773490 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m14:52:08.774622 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:52:08.776579 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m14:52:08.777544 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m14:52:08.778139 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.wind_speed_analysis
where city_name is null



      
    ) dbt_internal_test
[0m14:52:08.778552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:09.262440 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.483 seconds
[0m14:52:09.266547 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9: Close
[0m14:52:09.383938 [info ] [Thread-1 (]: 24 of 25 PASS not_null_wind_speed_analysis_city_name ........................... [[32mPASS[0m in 0.62s]
[0m14:52:09.384924 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:52:09.385527 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:52:09.386174 [info ] [Thread-1 (]: 25 of 25 START test not_null_wind_speed_analysis_wind_speed .................... [RUN]
[0m14:52:09.386891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9, now test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2)
[0m14:52:09.387353 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:52:09.392814 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m14:52:09.393743 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:52:09.395809 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m14:52:09.397410 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m14:52:09.397855 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select wind_speed
from openweather.analytics.wind_speed_analysis
where wind_speed is null



      
    ) dbt_internal_test
[0m14:52:09.398199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:10.086570 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.688 seconds
[0m14:52:10.089511 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2: Close
[0m14:52:10.233406 [info ] [Thread-1 (]: 25 of 25 PASS not_null_wind_speed_analysis_wind_speed .......................... [[32mPASS[0m in 0.85s]
[0m14:52:10.233979 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:52:10.235055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:10.235329 [debug] [MainThread]: Connection 'test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2' was properly closed.
[0m14:52:10.235583 [info ] [MainThread]: 
[0m14:52:10.235816 [info ] [MainThread]: Finished running 25 data tests in 0 hours 0 minutes and 17.69 seconds (17.69s).
[0m14:52:10.238235 [debug] [MainThread]: Command end result
[0m14:52:10.264519 [info ] [MainThread]: 
[0m14:52:10.264867 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:10.265063 [info ] [MainThread]: 
[0m14:52:10.265240 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=0 SKIP=0 TOTAL=25
[0m14:52:10.266579 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 18.277596, "process_in_blocks": "0", "process_kernel_time": 0.385945, "process_mem_max_rss": "142049280", "process_out_blocks": "0", "process_user_time": 2.919486}
[0m14:52:10.266948 [debug] [MainThread]: Command `dbt test` succeeded at 14:52:10.266894 after 18.28 seconds
[0m14:52:10.267157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106acd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e5e90>]}
[0m14:52:10.267337 [debug] [MainThread]: Flushing usage events
[0m14:53:32.716104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108473b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108473d90>]}


============================== 14:53:32.718413 | 32b7052b-4166-48c0-a5fc-64e006839bd4 ==============================
[0m14:53:32.718413 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:53:32.718745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m14:53:32.886468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32b7052b-4166-48c0-a5fc-64e006839bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090bab10>]}
[0m14:53:32.909005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32b7052b-4166-48c0-a5fc-64e006839bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090bc050>]}
[0m14:53:32.909414 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:53:32.966544 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:53:33.047608 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:53:33.048017 [debug] [MainThread]: Partial parsing: added file: weather_dbt://tests/valid_temp.sql
[0m14:53:33.105136 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.weather_dbt.valid_temp' (tests/valid_temp.sql) depends on a node named 'Extreme_Weather_Events' in package '' which was not found
[0m14:53:33.146667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32b7052b-4166-48c0-a5fc-64e006839bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109488250>]}
[0m14:53:33.257997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32b7052b-4166-48c0-a5fc-64e006839bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109720e60>]}
[0m14:53:33.258310 [info ] [MainThread]: Found 8 models, 25 data tests, 1 snapshot, 2 sources, 459 macros
[0m14:53:33.258479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32b7052b-4166-48c0-a5fc-64e006839bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10847baf0>]}
[0m14:53:33.259839 [info ] [MainThread]: 
[0m14:53:33.260134 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:53:33.262314 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_snapshot'
[0m14:53:33.270099 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m14:53:33.270323 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m14:53:33.270463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:34.112997 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.842 seconds
[0m14:53:34.116108 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m14:53:34.294105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m14:53:34.297917 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m14:53:34.298319 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m14:53:34.298644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:34.786614 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.488 seconds
[0m14:53:34.789891 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m14:53:34.911322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32b7052b-4166-48c0-a5fc-64e006839bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109843d40>]}
[0m14:53:34.912173 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m14:53:34.912620 [info ] [MainThread]: 
[0m14:53:34.916459 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m14:53:34.916991 [info ] [Thread-1 (]: 1 of 25 START test not_null_cloud_coverage_over_time_avg_cloud_coverage ........ [RUN]
[0m14:53:34.917573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86)
[0m14:53:34.918017 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m14:53:34.932902 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m14:53:34.933644 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m14:53:34.948789 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m14:53:34.949741 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m14:53:34.950106 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_cloud_coverage
from openweather.analytics.cloud_coverage_over_time
where avg_cloud_coverage is null



      
    ) dbt_internal_test
[0m14:53:34.950338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:35.301801 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.351 seconds
[0m14:53:35.316500 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86: Close
[0m14:53:35.466578 [info ] [Thread-1 (]: 1 of 25 PASS not_null_cloud_coverage_over_time_avg_cloud_coverage .............. [[32mPASS[0m in 0.55s]
[0m14:53:35.467628 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m14:53:35.468269 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m14:53:35.468958 [info ] [Thread-1 (]: 2 of 25 START test not_null_cloud_coverage_over_time_city_name ................. [RUN]
[0m14:53:35.469697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86, now test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f)
[0m14:53:35.470208 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m14:53:35.476184 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m14:53:35.477283 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m14:53:35.479462 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m14:53:35.480475 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m14:53:35.480841 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.cloud_coverage_over_time
where city_name is null



      
    ) dbt_internal_test
[0m14:53:35.481185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:35.931632 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.450 seconds
[0m14:53:35.935227 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f: Close
[0m14:53:36.062136 [info ] [Thread-1 (]: 2 of 25 PASS not_null_cloud_coverage_over_time_city_name ....................... [[32mPASS[0m in 0.59s]
[0m14:53:36.063174 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m14:53:36.063671 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m14:53:36.064281 [info ] [Thread-1 (]: 3 of 25 START test not_null_cloud_coverage_over_time_day ....................... [RUN]
[0m14:53:36.065093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f, now test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9)
[0m14:53:36.065681 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m14:53:36.071295 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m14:53:36.072429 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m14:53:36.075573 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m14:53:36.076543 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m14:53:36.076912 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from openweather.analytics.cloud_coverage_over_time
where day is null



      
    ) dbt_internal_test
[0m14:53:36.077249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:36.529469 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.451 seconds
[0m14:53:36.533314 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9: Close
[0m14:53:36.677782 [info ] [Thread-1 (]: 3 of 25 PASS not_null_cloud_coverage_over_time_day ............................. [[32mPASS[0m in 0.61s]
[0m14:53:36.678739 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m14:53:36.679264 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m14:53:36.679771 [info ] [Thread-1 (]: 4 of 25 START test not_null_correlation_avg_humidity ........................... [RUN]
[0m14:53:36.680293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9, now test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d)
[0m14:53:36.680698 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m14:53:36.685383 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m14:53:36.686322 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m14:53:36.689161 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m14:53:36.690180 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m14:53:36.690691 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_humidity
from openweather.analytics.correlation
where avg_humidity is null



      
    ) dbt_internal_test
[0m14:53:36.691004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:37.070230 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.379 seconds
[0m14:53:37.073717 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d: Close
[0m14:53:37.187827 [info ] [Thread-1 (]: 4 of 25 PASS not_null_correlation_avg_humidity ................................. [[32mPASS[0m in 0.51s]
[0m14:53:37.188646 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m14:53:37.189007 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m14:53:37.189278 [info ] [Thread-1 (]: 5 of 25 START test not_null_correlation_avg_pressure ........................... [RUN]
[0m14:53:37.189670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d, now test.weather_dbt.not_null_correlation_avg_pressure.46419021da)
[0m14:53:37.189915 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m14:53:37.193384 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m14:53:37.194023 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m14:53:37.195669 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m14:53:37.196464 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m14:53:37.196718 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_pressure.46419021da: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_pressure
from openweather.analytics.correlation
where avg_pressure is null



      
    ) dbt_internal_test
[0m14:53:37.196939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:37.687130 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.489 seconds
[0m14:53:37.692527 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_pressure.46419021da: Close
[0m14:53:37.809768 [info ] [Thread-1 (]: 5 of 25 PASS not_null_correlation_avg_pressure ................................. [[32mPASS[0m in 0.62s]
[0m14:53:37.810966 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m14:53:37.811572 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m14:53:37.812221 [info ] [Thread-1 (]: 6 of 25 START test not_null_correlation_avg_temp ............................... [RUN]
[0m14:53:37.812891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_pressure.46419021da, now test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61)
[0m14:53:37.813313 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m14:53:37.819057 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m14:53:37.820207 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m14:53:37.822651 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m14:53:37.823924 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m14:53:37.824361 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp
from openweather.analytics.correlation
where avg_temp is null



      
    ) dbt_internal_test
[0m14:53:37.824667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:38.278896 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.454 seconds
[0m14:53:38.282149 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61: Close
[0m14:53:38.445758 [info ] [Thread-1 (]: 6 of 25 PASS not_null_correlation_avg_temp ..................................... [[32mPASS[0m in 0.63s]
[0m14:53:38.447990 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m14:53:38.448248 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m14:53:38.448553 [info ] [Thread-1 (]: 7 of 25 START test not_null_correlation_avg_wind_speed ......................... [RUN]
[0m14:53:38.448914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61, now test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9)
[0m14:53:38.449110 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m14:53:38.451656 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m14:53:38.452228 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m14:53:38.453611 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m14:53:38.454542 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m14:53:38.454794 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_wind_speed
from openweather.analytics.correlation
where avg_wind_speed is null



      
    ) dbt_internal_test
[0m14:53:38.454969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:38.926050 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.471 seconds
[0m14:53:38.928270 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9: Close
[0m14:53:39.038767 [info ] [Thread-1 (]: 7 of 25 PASS not_null_correlation_avg_wind_speed ............................... [[32mPASS[0m in 0.59s]
[0m14:53:39.039430 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m14:53:39.039757 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m14:53:39.040016 [info ] [Thread-1 (]: 8 of 25 START test not_null_correlation_city_name .............................. [RUN]
[0m14:53:39.040345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9, now test.weather_dbt.not_null_correlation_city_name.d4bb85e888)
[0m14:53:39.040668 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m14:53:39.043550 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m14:53:39.044123 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m14:53:39.045951 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m14:53:39.046761 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m14:53:39.047019 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_city_name.d4bb85e888: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.correlation
where city_name is null



      
    ) dbt_internal_test
[0m14:53:39.047247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:39.507153 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.459 seconds
[0m14:53:39.511087 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_city_name.d4bb85e888: Close
[0m14:53:39.631834 [info ] [Thread-1 (]: 8 of 25 PASS not_null_correlation_city_name .................................... [[32mPASS[0m in 0.59s]
[0m14:53:39.632882 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m14:53:39.633434 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m14:53:39.634046 [info ] [Thread-1 (]: 9 of 25 START test not_null_extreme_weather_events_city_id ..................... [RUN]
[0m14:53:39.634753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_city_name.d4bb85e888, now test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4)
[0m14:53:39.635183 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m14:53:39.640846 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m14:53:39.641942 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m14:53:39.644360 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m14:53:39.645761 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m14:53:39.646193 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_id
from openweather.analytics.extreme_weather_events
where city_id is null



      
    ) dbt_internal_test
[0m14:53:39.646529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:40.242257 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m14:53:40.246061 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4: Close
[0m14:53:40.424109 [info ] [Thread-1 (]: 9 of 25 PASS not_null_extreme_weather_events_city_id ........................... [[32mPASS[0m in 0.79s]
[0m14:53:40.425049 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m14:53:40.425656 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m14:53:40.426305 [info ] [Thread-1 (]: 10 of 25 START test not_null_extreme_weather_events_city_name .................. [RUN]
[0m14:53:40.426927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4, now test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589)
[0m14:53:40.427367 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m14:53:40.433023 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m14:53:40.434171 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m14:53:40.436583 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m14:53:40.437864 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m14:53:40.438267 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.extreme_weather_events
where city_name is null



      
    ) dbt_internal_test
[0m14:53:40.438620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:41.071779 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.633 seconds
[0m14:53:41.075753 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589: Close
[0m14:53:41.214840 [info ] [Thread-1 (]: 10 of 25 PASS not_null_extreme_weather_events_city_name ........................ [[32mPASS[0m in 0.79s]
[0m14:53:41.216082 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m14:53:41.216689 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m14:53:41.217268 [info ] [Thread-1 (]: 11 of 25 START test not_null_extreme_weather_events_date_time .................. [RUN]
[0m14:53:41.217942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589, now test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853)
[0m14:53:41.218385 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m14:53:41.224020 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m14:53:41.225083 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m14:53:41.227427 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m14:53:41.228877 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m14:53:41.229257 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_time
from openweather.analytics.extreme_weather_events
where date_time is null



      
    ) dbt_internal_test
[0m14:53:41.229591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:41.697346 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.467 seconds
[0m14:53:41.702265 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853: Close
[0m14:53:41.828348 [info ] [Thread-1 (]: 11 of 25 PASS not_null_extreme_weather_events_date_time ........................ [[32mPASS[0m in 0.61s]
[0m14:53:41.829507 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m14:53:41.830195 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m14:53:41.830808 [info ] [Thread-1 (]: 12 of 25 START test not_null_extreme_weather_events_temp_fahrenheit ............ [RUN]
[0m14:53:41.831469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853, now test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d)
[0m14:53:41.831905 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m14:53:41.837327 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m14:53:41.838370 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m14:53:41.840508 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m14:53:41.842150 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m14:53:41.842595 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_fahrenheit
from openweather.analytics.extreme_weather_events
where temp_fahrenheit is null



      
    ) dbt_internal_test
[0m14:53:41.842951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:42.443173 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m14:53:42.446720 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d: Close
[0m14:53:42.584480 [info ] [Thread-1 (]: 12 of 25 PASS not_null_extreme_weather_events_temp_fahrenheit .................. [[32mPASS[0m in 0.75s]
[0m14:53:42.585422 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m14:53:42.586008 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m14:53:42.586653 [info ] [Thread-1 (]: 13 of 25 START test not_null_extreme_weather_events_weather_alert .............. [RUN]
[0m14:53:42.587416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d, now test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb)
[0m14:53:42.587946 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m14:53:42.593703 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m14:53:42.594933 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m14:53:42.597477 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m14:53:42.598645 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m14:53:42.599042 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_alert
from openweather.analytics.extreme_weather_events
where weather_alert is null



      
    ) dbt_internal_test
[0m14:53:42.599393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:43.056910 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.457 seconds
[0m14:53:43.061478 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb: Close
[0m14:53:43.180436 [info ] [Thread-1 (]: 13 of 25 PASS not_null_extreme_weather_events_weather_alert .................... [[32mPASS[0m in 0.59s]
[0m14:53:43.181543 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m14:53:43.182138 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m14:53:43.182889 [info ] [Thread-1 (]: 14 of 25 START test not_null_extreme_weather_events_wind_speed ................. [RUN]
[0m14:53:43.183756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb, now test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4)
[0m14:53:43.184224 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m14:53:43.189456 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m14:53:43.190609 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m14:53:43.193046 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m14:53:43.194404 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m14:53:43.194769 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select wind_speed
from openweather.analytics.extreme_weather_events
where wind_speed is null



      
    ) dbt_internal_test
[0m14:53:43.195094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:43.699488 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.504 seconds
[0m14:53:43.703961 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4: Close
[0m14:53:43.828441 [info ] [Thread-1 (]: 14 of 25 PASS not_null_extreme_weather_events_wind_speed ....................... [[32mPASS[0m in 0.64s]
[0m14:53:43.830041 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m14:53:43.830709 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m14:53:43.831260 [info ] [Thread-1 (]: 15 of 25 START test not_null_humidity_vs_temp_city_name ........................ [RUN]
[0m14:53:43.831878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4, now test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042)
[0m14:53:43.832315 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m14:53:43.838039 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m14:53:43.839157 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m14:53:43.841800 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m14:53:43.843008 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m14:53:43.843425 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.humidity_vs_temp
where city_name is null



      
    ) dbt_internal_test
[0m14:53:43.843798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:44.285342 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.441 seconds
[0m14:53:44.288315 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042: Close
[0m14:53:44.458316 [info ] [Thread-1 (]: 15 of 25 PASS not_null_humidity_vs_temp_city_name .............................. [[32mPASS[0m in 0.63s]
[0m14:53:44.459255 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m14:53:44.459844 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m14:53:44.460461 [info ] [Thread-1 (]: 16 of 25 START test not_null_humidity_vs_temp_humidity ......................... [RUN]
[0m14:53:44.461214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042, now test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573)
[0m14:53:44.461761 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m14:53:44.467360 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m14:53:44.468517 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m14:53:44.470982 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m14:53:44.472101 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m14:53:44.472495 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select humidity
from openweather.analytics.humidity_vs_temp
where humidity is null



      
    ) dbt_internal_test
[0m14:53:44.472823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:45.011186 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.538 seconds
[0m14:53:45.015231 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573: Close
[0m14:53:45.164064 [info ] [Thread-1 (]: 16 of 25 PASS not_null_humidity_vs_temp_humidity ............................... [[32mPASS[0m in 0.70s]
[0m14:53:45.165013 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m14:53:45.165470 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m14:53:45.166107 [info ] [Thread-1 (]: 17 of 25 START test not_null_humidity_vs_temp_temp_fahrenheit .................. [RUN]
[0m14:53:45.166844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573, now test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5)
[0m14:53:45.167371 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m14:53:45.172687 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m14:53:45.173880 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m14:53:45.176473 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m14:53:45.177688 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m14:53:45.178045 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_fahrenheit
from openweather.analytics.humidity_vs_temp
where temp_fahrenheit is null



      
    ) dbt_internal_test
[0m14:53:45.178368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:45.721614 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.543 seconds
[0m14:53:45.725516 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5: Close
[0m14:53:45.865388 [info ] [Thread-1 (]: 17 of 25 PASS not_null_humidity_vs_temp_temp_fahrenheit ........................ [[32mPASS[0m in 0.70s]
[0m14:53:45.866407 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m14:53:45.866958 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m14:53:45.867287 [info ] [Thread-1 (]: 18 of 25 START test not_null_temp_trends_by_city_avg_temp_fahrenheit ........... [RUN]
[0m14:53:45.867556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5, now test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae)
[0m14:53:45.867748 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m14:53:45.869837 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m14:53:45.870328 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m14:53:45.871291 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m14:53:45.871743 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m14:53:45.871919 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp_fahrenheit
from openweather.analytics.temp_trends_by_city
where avg_temp_fahrenheit is null



      
    ) dbt_internal_test
[0m14:53:45.872080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:46.302520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.430 seconds
[0m14:53:46.308044 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae: Close
[0m14:53:46.436355 [info ] [Thread-1 (]: 18 of 25 PASS not_null_temp_trends_by_city_avg_temp_fahrenheit ................. [[32mPASS[0m in 0.57s]
[0m14:53:46.437331 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m14:53:46.437819 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m14:53:46.438352 [info ] [Thread-1 (]: 19 of 25 START test not_null_temp_trends_by_city_city_name ..................... [RUN]
[0m14:53:46.438954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae, now test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b)
[0m14:53:46.439401 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m14:53:46.444849 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m14:53:46.445990 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m14:53:46.448146 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m14:53:46.449827 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m14:53:46.450252 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.temp_trends_by_city
where city_name is null



      
    ) dbt_internal_test
[0m14:53:46.450610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:46.910897 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.460 seconds
[0m14:53:46.912092 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b: Close
[0m14:53:47.017750 [info ] [Thread-1 (]: 19 of 25 PASS not_null_temp_trends_by_city_city_name ........................... [[32mPASS[0m in 0.58s]
[0m14:53:47.018332 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m14:53:47.018673 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m14:53:47.018954 [info ] [Thread-1 (]: 20 of 25 START test not_null_temp_trends_by_city_day ........................... [RUN]
[0m14:53:47.019276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b, now test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019)
[0m14:53:47.019518 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m14:53:47.022532 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m14:53:47.023231 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m14:53:47.025018 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m14:53:47.025888 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m14:53:47.026164 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from openweather.analytics.temp_trends_by_city
where day is null



      
    ) dbt_internal_test
[0m14:53:47.026409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:47.420625 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.394 seconds
[0m14:53:47.423301 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019: Close
[0m14:53:47.570928 [info ] [Thread-1 (]: 20 of 25 PASS not_null_temp_trends_by_city_day ................................. [[32mPASS[0m in 0.55s]
[0m14:53:47.572089 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m14:53:47.572653 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m14:53:47.573258 [info ] [Thread-1 (]: 21 of 25 START test not_null_weather_cond_distribution_city_name ............... [RUN]
[0m14:53:47.573853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019, now test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec)
[0m14:53:47.574282 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m14:53:47.579822 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m14:53:47.580951 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m14:53:47.583177 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m14:53:47.584117 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m14:53:47.584443 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.weather_cond_distribution
where city_name is null



      
    ) dbt_internal_test
[0m14:53:47.584737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:48.060292 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.475 seconds
[0m14:53:48.063969 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec: Close
[0m14:53:48.196879 [info ] [Thread-1 (]: 21 of 25 PASS not_null_weather_cond_distribution_city_name ..................... [[32mPASS[0m in 0.62s]
[0m14:53:48.197949 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m14:53:48.198444 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m14:53:48.198976 [info ] [Thread-1 (]: 22 of 25 START test not_null_weather_cond_distribution_count ................... [RUN]
[0m14:53:48.199522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec, now test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4)
[0m14:53:48.199776 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m14:53:48.203806 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m14:53:48.204852 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m14:53:48.207008 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m14:53:48.207910 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m14:53:48.208265 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select count
from openweather.analytics.weather_cond_distribution
where count is null



      
    ) dbt_internal_test
[0m14:53:48.208586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:48.632778 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.424 seconds
[0m14:53:48.634219 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4: Close
[0m14:53:48.772479 [info ] [Thread-1 (]: 22 of 25 PASS not_null_weather_cond_distribution_count ......................... [[32mPASS[0m in 0.57s]
[0m14:53:48.773074 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m14:53:48.773388 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m14:53:48.773724 [info ] [Thread-1 (]: 23 of 25 START test not_null_weather_cond_distribution_weather_main ............ [RUN]
[0m14:53:48.774108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4, now test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6)
[0m14:53:48.774392 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m14:53:48.777962 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m14:53:48.778727 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m14:53:48.780371 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m14:53:48.781027 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m14:53:48.781277 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_main
from openweather.analytics.weather_cond_distribution
where weather_main is null



      
    ) dbt_internal_test
[0m14:53:48.781503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:49.199484 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.417 seconds
[0m14:53:49.202762 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6: Close
[0m14:53:49.314902 [info ] [Thread-1 (]: 23 of 25 PASS not_null_weather_cond_distribution_weather_main .................. [[32mPASS[0m in 0.54s]
[0m14:53:49.315826 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m14:53:49.316248 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:53:49.316590 [info ] [Thread-1 (]: 24 of 25 START test not_null_wind_speed_analysis_city_name ..................... [RUN]
[0m14:53:49.316996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6, now test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9)
[0m14:53:49.317350 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:53:49.321794 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m14:53:49.322858 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:53:49.324822 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m14:53:49.325792 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m14:53:49.326097 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.wind_speed_analysis
where city_name is null



      
    ) dbt_internal_test
[0m14:53:49.326375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:49.768642 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.442 seconds
[0m14:53:49.771814 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9: Close
[0m14:53:49.907320 [info ] [Thread-1 (]: 24 of 25 PASS not_null_wind_speed_analysis_city_name ........................... [[32mPASS[0m in 0.59s]
[0m14:53:49.908244 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:53:49.908732 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:53:49.909528 [info ] [Thread-1 (]: 25 of 25 START test not_null_wind_speed_analysis_wind_speed .................... [RUN]
[0m14:53:49.910249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9, now test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2)
[0m14:53:49.910661 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:53:49.915204 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m14:53:49.916142 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:53:49.918158 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m14:53:49.919122 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m14:53:49.919875 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select wind_speed
from openweather.analytics.wind_speed_analysis
where wind_speed is null



      
    ) dbt_internal_test
[0m14:53:49.920270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:50.387442 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.467 seconds
[0m14:53:50.390962 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2: Close
[0m14:53:50.505498 [info ] [Thread-1 (]: 25 of 25 PASS not_null_wind_speed_analysis_wind_speed .......................... [[32mPASS[0m in 0.60s]
[0m14:53:50.506446 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:53:50.508599 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:50.509321 [debug] [MainThread]: Connection 'test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2' was properly closed.
[0m14:53:50.509861 [info ] [MainThread]: 
[0m14:53:50.510499 [info ] [MainThread]: Finished running 25 data tests in 0 hours 0 minutes and 17.25 seconds (17.25s).
[0m14:53:50.514267 [debug] [MainThread]: Command end result
[0m14:53:50.545085 [info ] [MainThread]: 
[0m14:53:50.545398 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:53:50.545590 [info ] [MainThread]: 
[0m14:53:50.545789 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=0 SKIP=0 TOTAL=25
[0m14:53:50.547299 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 17.863655, "process_in_blocks": "0", "process_kernel_time": 0.373959, "process_mem_max_rss": "146751488", "process_out_blocks": "0", "process_user_time": 2.897916}
[0m14:53:50.547762 [debug] [MainThread]: Command `dbt test` succeeded at 14:53:50.547693 after 17.86 seconds
[0m14:53:50.548070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108229910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109852360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a03330>]}
[0m14:53:50.548325 [debug] [MainThread]: Flushing usage events
[0m14:54:13.466771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bc0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd7d90>]}


============================== 14:54:13.468970 | 23e04793-efe9-4da3-bff4-e5a57487ffa0 ==============================
[0m14:54:13.468970 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:54:13.469282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m14:54:13.624047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23e04793-efe9-4da3-bff4-e5a57487ffa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b76b10>]}
[0m14:54:13.646741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23e04793-efe9-4da3-bff4-e5a57487ffa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b7c050>]}
[0m14:54:13.647175 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:54:13.705837 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:54:13.788013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:54:13.788459 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://tests/valid_temp.sql
[0m14:54:13.879136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23e04793-efe9-4da3-bff4-e5a57487ffa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d8050>]}
[0m14:54:13.983098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23e04793-efe9-4da3-bff4-e5a57487ffa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10746ce60>]}
[0m14:54:13.983385 [info ] [MainThread]: Found 8 models, 26 data tests, 1 snapshot, 2 sources, 459 macros
[0m14:54:13.983559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23e04793-efe9-4da3-bff4-e5a57487ffa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cdd550>]}
[0m14:54:13.984914 [info ] [MainThread]: 
[0m14:54:13.985179 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:54:13.987330 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_snapshot'
[0m14:54:13.995273 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m14:54:13.995506 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m14:54:13.995644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:14.551421 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.555 seconds
[0m14:54:14.555244 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m14:54:14.683417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m14:54:14.687556 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m14:54:14.688026 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m14:54:14.688391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:15.187673 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.499 seconds
[0m14:54:15.189685 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m14:54:15.301487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23e04793-efe9-4da3-bff4-e5a57487ffa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11488fd40>]}
[0m14:54:15.302317 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m14:54:15.302691 [info ] [MainThread]: 
[0m14:54:15.307133 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m14:54:15.307623 [info ] [Thread-1 (]: 1 of 26 START test not_null_cloud_coverage_over_time_avg_cloud_coverage ........ [RUN]
[0m14:54:15.308139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86)
[0m14:54:15.308741 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m14:54:15.324584 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m14:54:15.325565 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m14:54:15.340112 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m14:54:15.340875 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m14:54:15.341223 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_cloud_coverage
from openweather.analytics.cloud_coverage_over_time
where avg_cloud_coverage is null



      
    ) dbt_internal_test
[0m14:54:15.341453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:16.140727 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.799 seconds
[0m14:54:16.153246 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86: Close
[0m14:54:16.288090 [info ] [Thread-1 (]: 1 of 26 PASS not_null_cloud_coverage_over_time_avg_cloud_coverage .............. [[32mPASS[0m in 0.98s]
[0m14:54:16.289728 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m14:54:16.290552 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m14:54:16.291161 [info ] [Thread-1 (]: 2 of 26 START test not_null_cloud_coverage_over_time_city_name ................. [RUN]
[0m14:54:16.291705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86, now test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f)
[0m14:54:16.292062 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m14:54:16.297479 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m14:54:16.298676 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m14:54:16.300889 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m14:54:16.301872 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m14:54:16.302242 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.cloud_coverage_over_time
where city_name is null



      
    ) dbt_internal_test
[0m14:54:16.302589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:16.999402 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.696 seconds
[0m14:54:17.002823 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f: Close
[0m14:54:17.135197 [info ] [Thread-1 (]: 2 of 26 PASS not_null_cloud_coverage_over_time_city_name ....................... [[32mPASS[0m in 0.84s]
[0m14:54:17.135966 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m14:54:17.136397 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m14:54:17.136839 [info ] [Thread-1 (]: 3 of 26 START test not_null_cloud_coverage_over_time_day ....................... [RUN]
[0m14:54:17.137325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f, now test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9)
[0m14:54:17.137653 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m14:54:17.141424 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m14:54:17.142278 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m14:54:17.145194 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m14:54:17.146258 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m14:54:17.146554 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from openweather.analytics.cloud_coverage_over_time
where day is null



      
    ) dbt_internal_test
[0m14:54:17.147061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:17.588583 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.441 seconds
[0m14:54:17.593544 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9: Close
[0m14:54:17.718657 [info ] [Thread-1 (]: 3 of 26 PASS not_null_cloud_coverage_over_time_day ............................. [[32mPASS[0m in 0.58s]
[0m14:54:17.719625 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m14:54:17.720127 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m14:54:17.720622 [info ] [Thread-1 (]: 4 of 26 START test not_null_correlation_avg_humidity ........................... [RUN]
[0m14:54:17.721172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9, now test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d)
[0m14:54:17.721583 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m14:54:17.726996 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m14:54:17.727941 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m14:54:17.730858 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m14:54:17.731820 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m14:54:17.732170 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_humidity
from openweather.analytics.correlation
where avg_humidity is null



      
    ) dbt_internal_test
[0m14:54:17.732506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:18.227570 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.495 seconds
[0m14:54:18.230435 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d: Close
[0m14:54:18.365620 [info ] [Thread-1 (]: 4 of 26 PASS not_null_correlation_avg_humidity ................................. [[32mPASS[0m in 0.64s]
[0m14:54:18.366678 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m14:54:18.367340 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m14:54:18.367899 [info ] [Thread-1 (]: 5 of 26 START test not_null_correlation_avg_pressure ........................... [RUN]
[0m14:54:18.368370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d, now test.weather_dbt.not_null_correlation_avg_pressure.46419021da)
[0m14:54:18.368688 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m14:54:18.373830 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m14:54:18.374879 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m14:54:18.377280 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m14:54:18.378248 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m14:54:18.378794 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_pressure.46419021da: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_pressure
from openweather.analytics.correlation
where avg_pressure is null



      
    ) dbt_internal_test
[0m14:54:18.379243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:18.805645 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.426 seconds
[0m14:54:18.811350 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_pressure.46419021da: Close
[0m14:54:18.936784 [info ] [Thread-1 (]: 5 of 26 PASS not_null_correlation_avg_pressure ................................. [[32mPASS[0m in 0.57s]
[0m14:54:18.937647 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m14:54:18.938148 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m14:54:18.938671 [info ] [Thread-1 (]: 6 of 26 START test not_null_correlation_avg_temp ............................... [RUN]
[0m14:54:18.939265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_pressure.46419021da, now test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61)
[0m14:54:18.939697 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m14:54:18.944894 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m14:54:18.946052 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m14:54:18.948098 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m14:54:18.949088 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m14:54:18.949416 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp
from openweather.analytics.correlation
where avg_temp is null



      
    ) dbt_internal_test
[0m14:54:18.949711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:19.350754 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.401 seconds
[0m14:54:19.354875 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61: Close
[0m14:54:19.472916 [info ] [Thread-1 (]: 6 of 26 PASS not_null_correlation_avg_temp ..................................... [[32mPASS[0m in 0.53s]
[0m14:54:19.474006 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m14:54:19.474619 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m14:54:19.475254 [info ] [Thread-1 (]: 7 of 26 START test not_null_correlation_avg_wind_speed ......................... [RUN]
[0m14:54:19.475985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61, now test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9)
[0m14:54:19.476531 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m14:54:19.482025 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m14:54:19.482972 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m14:54:19.485095 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m14:54:19.486229 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m14:54:19.486632 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_wind_speed
from openweather.analytics.correlation
where avg_wind_speed is null



      
    ) dbt_internal_test
[0m14:54:19.486955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:19.863893 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.376 seconds
[0m14:54:19.869653 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9: Close
[0m14:54:20.001614 [info ] [Thread-1 (]: 7 of 26 PASS not_null_correlation_avg_wind_speed ............................... [[32mPASS[0m in 0.53s]
[0m14:54:20.002509 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m14:54:20.002960 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m14:54:20.003409 [info ] [Thread-1 (]: 8 of 26 START test not_null_correlation_city_name .............................. [RUN]
[0m14:54:20.003915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9, now test.weather_dbt.not_null_correlation_city_name.d4bb85e888)
[0m14:54:20.004281 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m14:54:20.009062 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m14:54:20.009961 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m14:54:20.011851 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m14:54:20.012637 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m14:54:20.012941 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_city_name.d4bb85e888: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.correlation
where city_name is null



      
    ) dbt_internal_test
[0m14:54:20.013225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:20.648800 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.635 seconds
[0m14:54:20.652886 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_city_name.d4bb85e888: Close
[0m14:54:20.768574 [info ] [Thread-1 (]: 8 of 26 PASS not_null_correlation_city_name .................................... [[32mPASS[0m in 0.76s]
[0m14:54:20.769607 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m14:54:20.770109 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m14:54:20.770633 [info ] [Thread-1 (]: 9 of 26 START test not_null_extreme_weather_events_city_id ..................... [RUN]
[0m14:54:20.771231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_city_name.d4bb85e888, now test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4)
[0m14:54:20.771660 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m14:54:20.777078 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m14:54:20.778100 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m14:54:20.780241 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m14:54:20.781302 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m14:54:20.781656 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_id
from openweather.analytics.extreme_weather_events
where city_id is null



      
    ) dbt_internal_test
[0m14:54:20.781960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:21.302819 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.521 seconds
[0m14:54:21.306200 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4: Close
[0m14:54:21.661212 [info ] [Thread-1 (]: 9 of 26 PASS not_null_extreme_weather_events_city_id ........................... [[32mPASS[0m in 0.89s]
[0m14:54:21.662351 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m14:54:21.662944 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m14:54:21.663552 [info ] [Thread-1 (]: 10 of 26 START test not_null_extreme_weather_events_city_name .................. [RUN]
[0m14:54:21.664151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4, now test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589)
[0m14:54:21.664588 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m14:54:21.670271 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m14:54:21.671315 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m14:54:21.673601 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m14:54:21.675138 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m14:54:21.675547 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.extreme_weather_events
where city_name is null



      
    ) dbt_internal_test
[0m14:54:21.675840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:22.090893 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.415 seconds
[0m14:54:22.094540 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589: Close
[0m14:54:22.223200 [info ] [Thread-1 (]: 10 of 26 PASS not_null_extreme_weather_events_city_name ........................ [[32mPASS[0m in 0.56s]
[0m14:54:22.224144 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m14:54:22.224750 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m14:54:22.225388 [info ] [Thread-1 (]: 11 of 26 START test not_null_extreme_weather_events_date_time .................. [RUN]
[0m14:54:22.226043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589, now test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853)
[0m14:54:22.226467 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m14:54:22.231988 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m14:54:22.233154 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m14:54:22.235525 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m14:54:22.237071 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m14:54:22.237521 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_time
from openweather.analytics.extreme_weather_events
where date_time is null



      
    ) dbt_internal_test
[0m14:54:22.237883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:22.705083 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.467 seconds
[0m14:54:22.708968 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853: Close
[0m14:54:22.830283 [info ] [Thread-1 (]: 11 of 26 PASS not_null_extreme_weather_events_date_time ........................ [[32mPASS[0m in 0.60s]
[0m14:54:22.831273 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m14:54:22.831869 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m14:54:22.832490 [info ] [Thread-1 (]: 12 of 26 START test not_null_extreme_weather_events_temp_fahrenheit ............ [RUN]
[0m14:54:22.833176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853, now test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d)
[0m14:54:22.833711 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m14:54:22.839312 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m14:54:22.840369 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m14:54:22.842591 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m14:54:22.843888 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m14:54:22.844381 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_fahrenheit
from openweather.analytics.extreme_weather_events
where temp_fahrenheit is null



      
    ) dbt_internal_test
[0m14:54:22.844789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:23.269704 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.424 seconds
[0m14:54:23.274630 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d: Close
[0m14:54:23.424139 [info ] [Thread-1 (]: 12 of 26 PASS not_null_extreme_weather_events_temp_fahrenheit .................. [[32mPASS[0m in 0.59s]
[0m14:54:23.424703 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m14:54:23.425009 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m14:54:23.425424 [info ] [Thread-1 (]: 13 of 26 START test not_null_extreme_weather_events_weather_alert .............. [RUN]
[0m14:54:23.425880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d, now test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb)
[0m14:54:23.426131 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m14:54:23.428920 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m14:54:23.429504 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m14:54:23.431108 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m14:54:23.431899 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m14:54:23.432145 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_alert
from openweather.analytics.extreme_weather_events
where weather_alert is null



      
    ) dbt_internal_test
[0m14:54:23.432370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:23.917520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.484 seconds
[0m14:54:23.921273 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb: Close
[0m14:54:24.070975 [info ] [Thread-1 (]: 13 of 26 PASS not_null_extreme_weather_events_weather_alert .................... [[32mPASS[0m in 0.64s]
[0m14:54:24.071949 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m14:54:24.072381 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m14:54:24.072829 [info ] [Thread-1 (]: 14 of 26 START test not_null_extreme_weather_events_wind_speed ................. [RUN]
[0m14:54:24.073333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb, now test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4)
[0m14:54:24.073707 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m14:54:24.078141 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m14:54:24.079261 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m14:54:24.081415 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m14:54:24.082294 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m14:54:24.082611 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select wind_speed
from openweather.analytics.extreme_weather_events
where wind_speed is null



      
    ) dbt_internal_test
[0m14:54:24.083123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:24.549072 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.465 seconds
[0m14:54:24.553097 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4: Close
[0m14:54:24.701524 [info ] [Thread-1 (]: 14 of 26 PASS not_null_extreme_weather_events_wind_speed ....................... [[32mPASS[0m in 0.63s]
[0m14:54:24.702452 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m14:54:24.703021 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m14:54:24.703632 [info ] [Thread-1 (]: 15 of 26 START test not_null_humidity_vs_temp_city_name ........................ [RUN]
[0m14:54:24.704307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4, now test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042)
[0m14:54:24.704811 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m14:54:24.710499 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m14:54:24.711635 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m14:54:24.713975 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m14:54:24.715516 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m14:54:24.716159 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.humidity_vs_temp
where city_name is null



      
    ) dbt_internal_test
[0m14:54:24.716527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:25.270066 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.553 seconds
[0m14:54:25.273886 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042: Close
[0m14:54:25.408518 [info ] [Thread-1 (]: 15 of 26 PASS not_null_humidity_vs_temp_city_name .............................. [[32mPASS[0m in 0.70s]
[0m14:54:25.409479 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m14:54:25.410060 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m14:54:25.410655 [info ] [Thread-1 (]: 16 of 26 START test not_null_humidity_vs_temp_humidity ......................... [RUN]
[0m14:54:25.411347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042, now test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573)
[0m14:54:25.411856 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m14:54:25.417283 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m14:54:25.418327 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m14:54:25.420381 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m14:54:25.421817 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m14:54:25.422238 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select humidity
from openweather.analytics.humidity_vs_temp
where humidity is null



      
    ) dbt_internal_test
[0m14:54:25.422563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:26.073761 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.651 seconds
[0m14:54:26.076369 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573: Close
[0m14:54:26.268081 [info ] [Thread-1 (]: 16 of 26 PASS not_null_humidity_vs_temp_humidity ............................... [[32mPASS[0m in 0.86s]
[0m14:54:26.269516 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m14:54:26.270082 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m14:54:26.270606 [info ] [Thread-1 (]: 17 of 26 START test not_null_humidity_vs_temp_temp_fahrenheit .................. [RUN]
[0m14:54:26.271179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573, now test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5)
[0m14:54:26.271593 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m14:54:26.276588 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m14:54:26.277638 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m14:54:26.279623 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m14:54:26.280583 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m14:54:26.281140 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_fahrenheit
from openweather.analytics.humidity_vs_temp
where temp_fahrenheit is null



      
    ) dbt_internal_test
[0m14:54:26.281445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:26.724460 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.442 seconds
[0m14:54:26.728616 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5: Close
[0m14:54:26.857886 [info ] [Thread-1 (]: 17 of 26 PASS not_null_humidity_vs_temp_temp_fahrenheit ........................ [[32mPASS[0m in 0.59s]
[0m14:54:26.858822 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m14:54:26.859414 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m14:54:26.860031 [info ] [Thread-1 (]: 18 of 26 START test not_null_temp_trends_by_city_avg_temp_fahrenheit ........... [RUN]
[0m14:54:26.860686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5, now test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae)
[0m14:54:26.861115 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m14:54:26.866413 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m14:54:26.867470 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m14:54:26.869582 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m14:54:26.871143 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m14:54:26.871684 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp_fahrenheit
from openweather.analytics.temp_trends_by_city
where avg_temp_fahrenheit is null



      
    ) dbt_internal_test
[0m14:54:26.872054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:27.317242 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.445 seconds
[0m14:54:27.321751 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae: Close
[0m14:54:27.498124 [info ] [Thread-1 (]: 18 of 26 PASS not_null_temp_trends_by_city_avg_temp_fahrenheit ................. [[32mPASS[0m in 0.64s]
[0m14:54:27.499287 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m14:54:27.499884 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m14:54:27.500504 [info ] [Thread-1 (]: 19 of 26 START test not_null_temp_trends_by_city_city_name ..................... [RUN]
[0m14:54:27.501137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae, now test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b)
[0m14:54:27.501576 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m14:54:27.507213 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m14:54:27.508268 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m14:54:27.510510 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m14:54:27.511877 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m14:54:27.512283 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.temp_trends_by_city
where city_name is null



      
    ) dbt_internal_test
[0m14:54:27.512617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:28.055086 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.542 seconds
[0m14:54:28.058044 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b: Close
[0m14:54:28.175994 [info ] [Thread-1 (]: 19 of 26 PASS not_null_temp_trends_by_city_city_name ........................... [[32mPASS[0m in 0.67s]
[0m14:54:28.176874 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m14:54:28.177297 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m14:54:28.177736 [info ] [Thread-1 (]: 20 of 26 START test not_null_temp_trends_by_city_day ........................... [RUN]
[0m14:54:28.178226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b, now test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019)
[0m14:54:28.178588 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m14:54:28.183002 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m14:54:28.184066 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m14:54:28.186278 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m14:54:28.187134 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m14:54:28.187449 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from openweather.analytics.temp_trends_by_city
where day is null



      
    ) dbt_internal_test
[0m14:54:28.187905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:28.666690 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.479 seconds
[0m14:54:28.670044 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019: Close
[0m14:54:28.835253 [info ] [Thread-1 (]: 20 of 26 PASS not_null_temp_trends_by_city_day ................................. [[32mPASS[0m in 0.66s]
[0m14:54:28.836158 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m14:54:28.836729 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m14:54:28.837359 [info ] [Thread-1 (]: 21 of 26 START test not_null_weather_cond_distribution_city_name ............... [RUN]
[0m14:54:28.838110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019, now test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec)
[0m14:54:28.838633 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m14:54:28.844551 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m14:54:28.845830 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m14:54:28.848444 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m14:54:28.849473 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m14:54:28.849849 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.weather_cond_distribution
where city_name is null



      
    ) dbt_internal_test
[0m14:54:28.850193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:29.305112 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.454 seconds
[0m14:54:29.308971 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec: Close
[0m14:54:29.422923 [info ] [Thread-1 (]: 21 of 26 PASS not_null_weather_cond_distribution_city_name ..................... [[32mPASS[0m in 0.58s]
[0m14:54:29.423968 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m14:54:29.424612 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m14:54:29.425265 [info ] [Thread-1 (]: 22 of 26 START test not_null_weather_cond_distribution_count ................... [RUN]
[0m14:54:29.425993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec, now test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4)
[0m14:54:29.426508 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m14:54:29.432297 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m14:54:29.433448 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m14:54:29.435904 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m14:54:29.437328 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m14:54:29.437958 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select count
from openweather.analytics.weather_cond_distribution
where count is null



      
    ) dbt_internal_test
[0m14:54:29.438384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:29.974133 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.535 seconds
[0m14:54:29.978254 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4: Close
[0m14:54:30.110950 [info ] [Thread-1 (]: 22 of 26 PASS not_null_weather_cond_distribution_count ......................... [[32mPASS[0m in 0.68s]
[0m14:54:30.111798 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m14:54:30.112240 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m14:54:30.112585 [info ] [Thread-1 (]: 23 of 26 START test not_null_weather_cond_distribution_weather_main ............ [RUN]
[0m14:54:30.112958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4, now test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6)
[0m14:54:30.113303 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m14:54:30.117407 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m14:54:30.118434 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m14:54:30.120385 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m14:54:30.121199 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m14:54:30.121489 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_main
from openweather.analytics.weather_cond_distribution
where weather_main is null



      
    ) dbt_internal_test
[0m14:54:30.121740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:30.603164 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.481 seconds
[0m14:54:30.608232 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6: Close
[0m14:54:30.768683 [info ] [Thread-1 (]: 23 of 26 PASS not_null_weather_cond_distribution_weather_main .................. [[32mPASS[0m in 0.66s]
[0m14:54:30.769734 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m14:54:30.770223 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:54:30.770732 [info ] [Thread-1 (]: 24 of 26 START test not_null_wind_speed_analysis_city_name ..................... [RUN]
[0m14:54:30.771301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6, now test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9)
[0m14:54:30.771714 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:54:30.777293 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m14:54:30.778395 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:54:30.780551 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m14:54:30.781942 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m14:54:30.782383 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.wind_speed_analysis
where city_name is null



      
    ) dbt_internal_test
[0m14:54:30.782719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:31.222325 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.439 seconds
[0m14:54:31.227095 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9: Close
[0m14:54:31.371294 [info ] [Thread-1 (]: 24 of 26 PASS not_null_wind_speed_analysis_city_name ........................... [[32mPASS[0m in 0.60s]
[0m14:54:31.371832 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:54:31.372094 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:54:31.372298 [info ] [Thread-1 (]: 25 of 26 START test not_null_wind_speed_analysis_wind_speed .................... [RUN]
[0m14:54:31.372624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9, now test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2)
[0m14:54:31.372945 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:54:31.375523 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m14:54:31.376105 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:54:31.377432 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m14:54:31.378000 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m14:54:31.378190 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select wind_speed
from openweather.analytics.wind_speed_analysis
where wind_speed is null



      
    ) dbt_internal_test
[0m14:54:31.378368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:31.898805 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.520 seconds
[0m14:54:31.904290 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2: Close
[0m14:54:32.038098 [info ] [Thread-1 (]: 25 of 26 PASS not_null_wind_speed_analysis_wind_speed .......................... [[32mPASS[0m in 0.67s]
[0m14:54:32.039286 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:54:32.039920 [debug] [Thread-1 (]: Began running node test.weather_dbt.valid_temp
[0m14:54:32.040476 [info ] [Thread-1 (]: 26 of 26 START test valid_temp ................................................. [RUN]
[0m14:54:32.041068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2, now test.weather_dbt.valid_temp)
[0m14:54:32.041483 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.valid_temp
[0m14:54:32.045221 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.valid_temp"
[0m14:54:32.047167 [debug] [Thread-1 (]: Began executing node test.weather_dbt.valid_temp
[0m14:54:32.049609 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.valid_temp"
[0m14:54:32.050942 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.valid_temp"
[0m14:54:32.051518 [debug] [Thread-1 (]: On test.weather_dbt.valid_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.valid_temp"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- checking valid temperature values for extreme_weather_events.sql
SELECT
    CITY_ID,
    DATE_TIME,
    TEMP_FAHRENHEIT
FROM openweather.analytics.extreme_weather_events
WHERE TEMP_FAHRENHEIT IS NULL
   OR TEMP_FAHRENHEIT < -100 OR TEMP_FAHRENHEIT > 150
      
    ) dbt_internal_test
[0m14:54:32.051887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:32.716473 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.664 seconds
[0m14:54:32.720544 [debug] [Thread-1 (]: On test.weather_dbt.valid_temp: Close
[0m14:54:32.834439 [info ] [Thread-1 (]: 26 of 26 PASS valid_temp ....................................................... [[32mPASS[0m in 0.79s]
[0m14:54:32.835368 [debug] [Thread-1 (]: Finished running node test.weather_dbt.valid_temp
[0m14:54:32.837248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:32.837661 [debug] [MainThread]: Connection 'test.weather_dbt.valid_temp' was properly closed.
[0m14:54:32.838101 [info ] [MainThread]: 
[0m14:54:32.838514 [info ] [MainThread]: Finished running 26 data tests in 0 hours 0 minutes and 18.85 seconds (18.85s).
[0m14:54:32.842821 [debug] [MainThread]: Command end result
[0m14:54:32.876166 [info ] [MainThread]: 
[0m14:54:32.876489 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:54:32.876684 [info ] [MainThread]: 
[0m14:54:32.876991 [info ] [MainThread]: Done. PASS=26 WARN=0 ERROR=0 SKIP=0 TOTAL=26
[0m14:54:32.878436 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 19.445562, "process_in_blocks": "0", "process_kernel_time": 0.361106, "process_mem_max_rss": "146325504", "process_out_blocks": "0", "process_user_time": 3.054638}
[0m14:54:32.878791 [debug] [MainThread]: Command `dbt test` succeeded at 14:54:32.878739 after 19.45 seconds
[0m14:54:32.879006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058cd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a578b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a55bd0>]}
[0m14:54:32.879223 [debug] [MainThread]: Flushing usage events
[0m14:55:19.446792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105298d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b13b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b13d90>]}


============================== 14:55:19.449582 | 88b65e4a-330a-413c-b374-a06d8be68204 ==============================
[0m14:55:19.449582 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:55:19.449900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:55:19.684572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88b65e4a-330a-413c-b374-a06d8be68204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c0ab10>]}
[0m14:55:19.707003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88b65e4a-330a-413c-b374-a06d8be68204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c0c050>]}
[0m14:55:19.707598 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:55:19.765149 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:55:19.850304 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:55:19.850639 [debug] [MainThread]: Partial parsing: added file: weather_dbt://tests/weather_alert_consistency.sql
[0m14:55:19.939073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88b65e4a-330a-413c-b374-a06d8be68204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118dc050>]}
[0m14:55:20.049354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88b65e4a-330a-413c-b374-a06d8be68204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11256ce60>]}
[0m14:55:20.049652 [info ] [MainThread]: Found 8 models, 27 data tests, 1 snapshot, 2 sources, 459 macros
[0m14:55:20.049826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88b65e4a-330a-413c-b374-a06d8be68204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b18910>]}
[0m14:55:20.051251 [info ] [MainThread]: 
[0m14:55:20.051537 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:55:20.053769 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_analytics'
[0m14:55:20.061710 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m14:55:20.061938 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m14:55:20.062073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:20.793867 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.732 seconds
[0m14:55:20.798103 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m14:55:20.956665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m14:55:20.961798 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m14:55:20.962195 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m14:55:20.962513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:21.463468 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.500 seconds
[0m14:55:21.467236 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m14:55:21.622390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88b65e4a-330a-413c-b374-a06d8be68204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112793d40>]}
[0m14:55:21.622973 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m14:55:21.623260 [info ] [MainThread]: 
[0m14:55:21.627327 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m14:55:21.627746 [info ] [Thread-1 (]: 1 of 27 START test not_null_cloud_coverage_over_time_avg_cloud_coverage ........ [RUN]
[0m14:55:21.628115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86)
[0m14:55:21.628743 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m14:55:21.641264 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m14:55:21.641841 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m14:55:21.654582 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m14:55:21.655224 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m14:55:21.655458 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_cloud_coverage
from openweather.analytics.cloud_coverage_over_time
where avg_cloud_coverage is null



      
    ) dbt_internal_test
[0m14:55:21.655662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:22.141137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.485 seconds
[0m14:55:22.154883 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86: Close
[0m14:55:22.411332 [info ] [Thread-1 (]: 1 of 27 PASS not_null_cloud_coverage_over_time_avg_cloud_coverage .............. [[32mPASS[0m in 0.78s]
[0m14:55:22.412829 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m14:55:22.413346 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m14:55:22.413858 [info ] [Thread-1 (]: 2 of 27 START test not_null_cloud_coverage_over_time_city_name ................. [RUN]
[0m14:55:22.414383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86, now test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f)
[0m14:55:22.414733 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m14:55:22.420108 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m14:55:22.420906 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m14:55:22.422758 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m14:55:22.423507 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m14:55:22.423931 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.cloud_coverage_over_time
where city_name is null



      
    ) dbt_internal_test
[0m14:55:22.424450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:22.902257 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.477 seconds
[0m14:55:22.906674 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f: Close
[0m14:55:23.027264 [info ] [Thread-1 (]: 2 of 27 PASS not_null_cloud_coverage_over_time_city_name ....................... [[32mPASS[0m in 0.61s]
[0m14:55:23.028308 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m14:55:23.028925 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m14:55:23.029594 [info ] [Thread-1 (]: 3 of 27 START test not_null_cloud_coverage_over_time_day ....................... [RUN]
[0m14:55:23.030307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f, now test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9)
[0m14:55:23.030849 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m14:55:23.036538 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m14:55:23.037483 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m14:55:23.041020 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m14:55:23.042186 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m14:55:23.042587 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from openweather.analytics.cloud_coverage_over_time
where day is null



      
    ) dbt_internal_test
[0m14:55:23.042933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:23.491069 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.447 seconds
[0m14:55:23.495333 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9: Close
[0m14:55:23.624681 [info ] [Thread-1 (]: 3 of 27 PASS not_null_cloud_coverage_over_time_day ............................. [[32mPASS[0m in 0.59s]
[0m14:55:23.626046 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m14:55:23.626744 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m14:55:23.627411 [info ] [Thread-1 (]: 4 of 27 START test not_null_correlation_avg_humidity ........................... [RUN]
[0m14:55:23.628203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9, now test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d)
[0m14:55:23.628721 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m14:55:23.633701 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m14:55:23.634690 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m14:55:23.637906 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m14:55:23.638872 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m14:55:23.639251 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_humidity
from openweather.analytics.correlation
where avg_humidity is null



      
    ) dbt_internal_test
[0m14:55:23.639568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:24.102200 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.462 seconds
[0m14:55:24.106172 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d: Close
[0m14:55:24.251064 [info ] [Thread-1 (]: 4 of 27 PASS not_null_correlation_avg_humidity ................................. [[32mPASS[0m in 0.62s]
[0m14:55:24.252156 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m14:55:24.252774 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m14:55:24.253274 [info ] [Thread-1 (]: 5 of 27 START test not_null_correlation_avg_pressure ........................... [RUN]
[0m14:55:24.253967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d, now test.weather_dbt.not_null_correlation_avg_pressure.46419021da)
[0m14:55:24.254614 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m14:55:24.260799 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m14:55:24.262054 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m14:55:24.264885 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m14:55:24.266539 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m14:55:24.267035 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_pressure.46419021da: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_pressure
from openweather.analytics.correlation
where avg_pressure is null



      
    ) dbt_internal_test
[0m14:55:24.267415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:24.695126 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.427 seconds
[0m14:55:24.699494 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_pressure.46419021da: Close
[0m14:55:24.853084 [info ] [Thread-1 (]: 5 of 27 PASS not_null_correlation_avg_pressure ................................. [[32mPASS[0m in 0.60s]
[0m14:55:24.853766 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m14:55:24.854148 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m14:55:24.854544 [info ] [Thread-1 (]: 6 of 27 START test not_null_correlation_avg_temp ............................... [RUN]
[0m14:55:24.855025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_pressure.46419021da, now test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61)
[0m14:55:24.855417 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m14:55:24.858977 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m14:55:24.859624 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m14:55:24.861388 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m14:55:24.862187 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m14:55:24.862526 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp
from openweather.analytics.correlation
where avg_temp is null



      
    ) dbt_internal_test
[0m14:55:24.862794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:25.260149 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.397 seconds
[0m14:55:25.262707 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61: Close
[0m14:55:25.410079 [info ] [Thread-1 (]: 6 of 27 PASS not_null_correlation_avg_temp ..................................... [[32mPASS[0m in 0.55s]
[0m14:55:25.410912 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m14:55:25.411415 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m14:55:25.411934 [info ] [Thread-1 (]: 7 of 27 START test not_null_correlation_avg_wind_speed ......................... [RUN]
[0m14:55:25.412519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61, now test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9)
[0m14:55:25.412956 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m14:55:25.418440 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m14:55:25.419494 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m14:55:25.421930 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m14:55:25.422803 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m14:55:25.423125 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_wind_speed
from openweather.analytics.correlation
where avg_wind_speed is null



      
    ) dbt_internal_test
[0m14:55:25.423412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:25.828103 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.404 seconds
[0m14:55:25.833214 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9: Close
[0m14:55:25.955623 [info ] [Thread-1 (]: 7 of 27 PASS not_null_correlation_avg_wind_speed ............................... [[32mPASS[0m in 0.54s]
[0m14:55:25.956099 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m14:55:25.956351 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m14:55:25.956619 [info ] [Thread-1 (]: 8 of 27 START test not_null_correlation_city_name .............................. [RUN]
[0m14:55:25.956925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9, now test.weather_dbt.not_null_correlation_city_name.d4bb85e888)
[0m14:55:25.957142 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m14:55:25.959857 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m14:55:25.960643 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m14:55:25.962988 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m14:55:25.963937 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m14:55:25.964257 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_city_name.d4bb85e888: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.correlation
where city_name is null



      
    ) dbt_internal_test
[0m14:55:25.964539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:26.351845 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.387 seconds
[0m14:55:26.355414 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_city_name.d4bb85e888: Close
[0m14:55:26.495414 [info ] [Thread-1 (]: 8 of 27 PASS not_null_correlation_city_name .................................... [[32mPASS[0m in 0.54s]
[0m14:55:26.496643 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m14:55:26.497316 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m14:55:26.497995 [info ] [Thread-1 (]: 9 of 27 START test not_null_extreme_weather_events_city_id ..................... [RUN]
[0m14:55:26.498780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_city_name.d4bb85e888, now test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4)
[0m14:55:26.499321 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m14:55:26.505138 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m14:55:26.506208 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m14:55:26.509070 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m14:55:26.510175 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m14:55:26.510573 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_id
from openweather.analytics.extreme_weather_events
where city_id is null



      
    ) dbt_internal_test
[0m14:55:26.510913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:26.941545 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.430 seconds
[0m14:55:26.944967 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4: Close
[0m14:55:27.067786 [info ] [Thread-1 (]: 9 of 27 PASS not_null_extreme_weather_events_city_id ........................... [[32mPASS[0m in 0.57s]
[0m14:55:27.068191 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m14:55:27.068408 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m14:55:27.068582 [info ] [Thread-1 (]: 10 of 27 START test not_null_extreme_weather_events_city_name .................. [RUN]
[0m14:55:27.068822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4, now test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589)
[0m14:55:27.069030 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m14:55:27.071068 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m14:55:27.071480 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m14:55:27.072505 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m14:55:27.072929 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m14:55:27.073105 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.extreme_weather_events
where city_name is null



      
    ) dbt_internal_test
[0m14:55:27.073274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:27.502166 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.428 seconds
[0m14:55:27.508603 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589: Close
[0m14:55:27.630638 [info ] [Thread-1 (]: 10 of 27 PASS not_null_extreme_weather_events_city_name ........................ [[32mPASS[0m in 0.56s]
[0m14:55:27.631612 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m14:55:27.632220 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m14:55:27.632869 [info ] [Thread-1 (]: 11 of 27 START test not_null_extreme_weather_events_date_time .................. [RUN]
[0m14:55:27.633611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589, now test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853)
[0m14:55:27.634081 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m14:55:27.639975 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m14:55:27.641086 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m14:55:27.643707 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m14:55:27.645276 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m14:55:27.645771 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_time
from openweather.analytics.extreme_weather_events
where date_time is null



      
    ) dbt_internal_test
[0m14:55:27.646309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:28.164979 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.518 seconds
[0m14:55:28.169649 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853: Close
[0m14:55:28.322770 [info ] [Thread-1 (]: 11 of 27 PASS not_null_extreme_weather_events_date_time ........................ [[32mPASS[0m in 0.69s]
[0m14:55:28.323923 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m14:55:28.324560 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m14:55:28.325237 [info ] [Thread-1 (]: 12 of 27 START test not_null_extreme_weather_events_temp_fahrenheit ............ [RUN]
[0m14:55:28.326006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853, now test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d)
[0m14:55:28.326495 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m14:55:28.332799 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m14:55:28.334114 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m14:55:28.336964 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m14:55:28.338399 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m14:55:28.338744 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_fahrenheit
from openweather.analytics.extreme_weather_events
where temp_fahrenheit is null



      
    ) dbt_internal_test
[0m14:55:28.339040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:28.782832 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.443 seconds
[0m14:55:28.786794 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d: Close
[0m14:55:28.895966 [info ] [Thread-1 (]: 12 of 27 PASS not_null_extreme_weather_events_temp_fahrenheit .................. [[32mPASS[0m in 0.57s]
[0m14:55:28.896958 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m14:55:28.897548 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m14:55:28.898179 [info ] [Thread-1 (]: 13 of 27 START test not_null_extreme_weather_events_weather_alert .............. [RUN]
[0m14:55:28.899014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d, now test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb)
[0m14:55:28.899633 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m14:55:28.905234 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m14:55:28.906440 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m14:55:28.909353 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m14:55:28.910721 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m14:55:28.911126 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_alert
from openweather.analytics.extreme_weather_events
where weather_alert is null



      
    ) dbt_internal_test
[0m14:55:28.911470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:29.381389 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.470 seconds
[0m14:55:29.382747 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb: Close
[0m14:55:29.520493 [info ] [Thread-1 (]: 13 of 27 PASS not_null_extreme_weather_events_weather_alert .................... [[32mPASS[0m in 0.62s]
[0m14:55:29.521509 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m14:55:29.522105 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m14:55:29.522608 [info ] [Thread-1 (]: 14 of 27 START test not_null_extreme_weather_events_wind_speed ................. [RUN]
[0m14:55:29.523131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb, now test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4)
[0m14:55:29.523546 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m14:55:29.528947 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m14:55:29.530055 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m14:55:29.532341 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m14:55:29.533759 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m14:55:29.534192 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select wind_speed
from openweather.analytics.extreme_weather_events
where wind_speed is null



      
    ) dbt_internal_test
[0m14:55:29.534492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:30.050604 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.516 seconds
[0m14:55:30.054145 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4: Close
[0m14:55:30.182446 [info ] [Thread-1 (]: 14 of 27 PASS not_null_extreme_weather_events_wind_speed ....................... [[32mPASS[0m in 0.66s]
[0m14:55:30.183503 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m14:55:30.184106 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m14:55:30.184767 [info ] [Thread-1 (]: 15 of 27 START test not_null_humidity_vs_temp_city_name ........................ [RUN]
[0m14:55:30.185460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4, now test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042)
[0m14:55:30.185909 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m14:55:30.191619 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m14:55:30.192686 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m14:55:30.195211 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m14:55:30.196527 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m14:55:30.196940 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.humidity_vs_temp
where city_name is null



      
    ) dbt_internal_test
[0m14:55:30.197250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:30.664008 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.466 seconds
[0m14:55:30.669883 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042: Close
[0m14:55:30.820446 [info ] [Thread-1 (]: 15 of 27 PASS not_null_humidity_vs_temp_city_name .............................. [[32mPASS[0m in 0.63s]
[0m14:55:30.821633 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m14:55:30.822252 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m14:55:30.822879 [info ] [Thread-1 (]: 16 of 27 START test not_null_humidity_vs_temp_humidity ......................... [RUN]
[0m14:55:30.823594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042, now test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573)
[0m14:55:30.824134 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m14:55:30.829909 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m14:55:30.831003 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m14:55:30.833558 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m14:55:30.834800 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m14:55:30.835270 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select humidity
from openweather.analytics.humidity_vs_temp
where humidity is null



      
    ) dbt_internal_test
[0m14:55:30.835632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:31.516881 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.681 seconds
[0m14:55:31.521399 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573: Close
[0m14:55:31.647954 [info ] [Thread-1 (]: 16 of 27 PASS not_null_humidity_vs_temp_humidity ............................... [[32mPASS[0m in 0.82s]
[0m14:55:31.648988 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m14:55:31.649590 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m14:55:31.650300 [info ] [Thread-1 (]: 17 of 27 START test not_null_humidity_vs_temp_temp_fahrenheit .................. [RUN]
[0m14:55:31.651029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573, now test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5)
[0m14:55:31.651498 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m14:55:31.657014 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m14:55:31.658152 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m14:55:31.660798 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m14:55:31.661821 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m14:55:31.662183 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_fahrenheit
from openweather.analytics.humidity_vs_temp
where temp_fahrenheit is null



      
    ) dbt_internal_test
[0m14:55:31.662510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:32.082887 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.420 seconds
[0m14:55:32.086936 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5: Close
[0m14:55:32.251572 [info ] [Thread-1 (]: 17 of 27 PASS not_null_humidity_vs_temp_temp_fahrenheit ........................ [[32mPASS[0m in 0.60s]
[0m14:55:32.252553 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m14:55:32.253159 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m14:55:32.253797 [info ] [Thread-1 (]: 18 of 27 START test not_null_temp_trends_by_city_avg_temp_fahrenheit ........... [RUN]
[0m14:55:32.254515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5, now test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae)
[0m14:55:32.255063 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m14:55:32.260721 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m14:55:32.261750 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m14:55:32.264257 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m14:55:32.265668 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m14:55:32.266251 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp_fahrenheit
from openweather.analytics.temp_trends_by_city
where avg_temp_fahrenheit is null



      
    ) dbt_internal_test
[0m14:55:32.266626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:32.700575 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.433 seconds
[0m14:55:32.705017 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae: Close
[0m14:55:32.840073 [info ] [Thread-1 (]: 18 of 27 PASS not_null_temp_trends_by_city_avg_temp_fahrenheit ................. [[32mPASS[0m in 0.59s]
[0m14:55:32.841148 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m14:55:32.841769 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m14:55:32.842442 [info ] [Thread-1 (]: 19 of 27 START test not_null_temp_trends_by_city_city_name ..................... [RUN]
[0m14:55:32.843184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae, now test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b)
[0m14:55:32.843718 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m14:55:32.849154 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m14:55:32.850258 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m14:55:32.852727 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m14:55:32.853720 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m14:55:32.854076 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.temp_trends_by_city
where city_name is null



      
    ) dbt_internal_test
[0m14:55:32.854403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:33.342246 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.488 seconds
[0m14:55:33.344051 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b: Close
[0m14:55:33.473714 [info ] [Thread-1 (]: 19 of 27 PASS not_null_temp_trends_by_city_city_name ........................... [[32mPASS[0m in 0.63s]
[0m14:55:33.474747 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m14:55:33.475381 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m14:55:33.476060 [info ] [Thread-1 (]: 20 of 27 START test not_null_temp_trends_by_city_day ........................... [RUN]
[0m14:55:33.476784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b, now test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019)
[0m14:55:33.477265 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m14:55:33.482937 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m14:55:33.483979 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m14:55:33.486511 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m14:55:33.487784 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m14:55:33.488200 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from openweather.analytics.temp_trends_by_city
where day is null



      
    ) dbt_internal_test
[0m14:55:33.488539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:34.077718 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.589 seconds
[0m14:55:34.082384 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019: Close
[0m14:55:34.205830 [info ] [Thread-1 (]: 20 of 27 PASS not_null_temp_trends_by_city_day ................................. [[32mPASS[0m in 0.73s]
[0m14:55:34.206852 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m14:55:34.207448 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m14:55:34.208085 [info ] [Thread-1 (]: 21 of 27 START test not_null_weather_cond_distribution_city_name ............... [RUN]
[0m14:55:34.208829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019, now test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec)
[0m14:55:34.209391 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m14:55:34.215158 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m14:55:34.216290 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m14:55:34.218847 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m14:55:34.220372 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m14:55:34.220810 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.weather_cond_distribution
where city_name is null



      
    ) dbt_internal_test
[0m14:55:34.221146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:34.683118 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.461 seconds
[0m14:55:34.687090 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec: Close
[0m14:55:34.830556 [info ] [Thread-1 (]: 21 of 27 PASS not_null_weather_cond_distribution_city_name ..................... [[32mPASS[0m in 0.62s]
[0m14:55:34.831476 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m14:55:34.832093 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m14:55:34.832722 [info ] [Thread-1 (]: 22 of 27 START test not_null_weather_cond_distribution_count ................... [RUN]
[0m14:55:34.833492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec, now test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4)
[0m14:55:34.834061 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m14:55:34.839865 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m14:55:34.840876 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m14:55:34.843332 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m14:55:34.844877 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m14:55:34.845342 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select count
from openweather.analytics.weather_cond_distribution
where count is null



      
    ) dbt_internal_test
[0m14:55:34.845701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:35.327771 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.482 seconds
[0m14:55:35.331747 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4: Close
[0m14:55:35.459529 [info ] [Thread-1 (]: 22 of 27 PASS not_null_weather_cond_distribution_count ......................... [[32mPASS[0m in 0.63s]
[0m14:55:35.460501 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m14:55:35.461009 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m14:55:35.461539 [info ] [Thread-1 (]: 23 of 27 START test not_null_weather_cond_distribution_weather_main ............ [RUN]
[0m14:55:35.462136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4, now test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6)
[0m14:55:35.462575 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m14:55:35.467912 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m14:55:35.468959 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m14:55:35.471118 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m14:55:35.472379 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m14:55:35.472708 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_main
from openweather.analytics.weather_cond_distribution
where weather_main is null



      
    ) dbt_internal_test
[0m14:55:35.472995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:35.960457 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.487 seconds
[0m14:55:35.963809 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6: Close
[0m14:55:36.216504 [info ] [Thread-1 (]: 23 of 27 PASS not_null_weather_cond_distribution_weather_main .................. [[32mPASS[0m in 0.75s]
[0m14:55:36.217576 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m14:55:36.218194 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:55:36.218829 [info ] [Thread-1 (]: 24 of 27 START test not_null_wind_speed_analysis_city_name ..................... [RUN]
[0m14:55:36.219485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6, now test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9)
[0m14:55:36.219927 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:55:36.225429 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m14:55:36.226533 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:55:36.228810 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m14:55:36.229889 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m14:55:36.230265 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.wind_speed_analysis
where city_name is null



      
    ) dbt_internal_test
[0m14:55:36.230602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:36.689226 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.458 seconds
[0m14:55:36.693096 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9: Close
[0m14:55:36.838911 [info ] [Thread-1 (]: 24 of 27 PASS not_null_wind_speed_analysis_city_name ........................... [[32mPASS[0m in 0.62s]
[0m14:55:36.840442 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m14:55:36.841147 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:55:36.841730 [info ] [Thread-1 (]: 25 of 27 START test not_null_wind_speed_analysis_wind_speed .................... [RUN]
[0m14:55:36.842336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9, now test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2)
[0m14:55:36.842749 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:55:36.848145 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m14:55:36.849236 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:55:36.851542 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m14:55:36.852640 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m14:55:36.853009 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select wind_speed
from openweather.analytics.wind_speed_analysis
where wind_speed is null



      
    ) dbt_internal_test
[0m14:55:36.853329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:37.456703 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.603 seconds
[0m14:55:37.458947 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2: Close
[0m14:55:37.599684 [info ] [Thread-1 (]: 25 of 27 PASS not_null_wind_speed_analysis_wind_speed .......................... [[32mPASS[0m in 0.76s]
[0m14:55:37.600680 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m14:55:37.601275 [debug] [Thread-1 (]: Began running node test.weather_dbt.valid_temp
[0m14:55:37.601883 [info ] [Thread-1 (]: 26 of 27 START test valid_temp ................................................. [RUN]
[0m14:55:37.602575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2, now test.weather_dbt.valid_temp)
[0m14:55:37.603089 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.valid_temp
[0m14:55:37.607097 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.valid_temp"
[0m14:55:37.608279 [debug] [Thread-1 (]: Began executing node test.weather_dbt.valid_temp
[0m14:55:37.610878 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.valid_temp"
[0m14:55:37.612107 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.valid_temp"
[0m14:55:37.612683 [debug] [Thread-1 (]: On test.weather_dbt.valid_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.valid_temp"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- checking valid temperature values for extreme_weather_events.sql
SELECT
    CITY_ID,
    DATE_TIME,
    TEMP_FAHRENHEIT
FROM openweather.analytics.extreme_weather_events
WHERE TEMP_FAHRENHEIT IS NULL
   OR TEMP_FAHRENHEIT < -100 OR TEMP_FAHRENHEIT > 150
      
    ) dbt_internal_test
[0m14:55:37.613037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:38.129456 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.516 seconds
[0m14:55:38.133266 [debug] [Thread-1 (]: On test.weather_dbt.valid_temp: Close
[0m14:55:38.266964 [info ] [Thread-1 (]: 26 of 27 PASS valid_temp ....................................................... [[32mPASS[0m in 0.66s]
[0m14:55:38.268045 [debug] [Thread-1 (]: Finished running node test.weather_dbt.valid_temp
[0m14:55:38.268646 [debug] [Thread-1 (]: Began running node test.weather_dbt.weather_alert_consistency
[0m14:55:38.269133 [info ] [Thread-1 (]: 27 of 27 START test weather_alert_consistency .................................. [RUN]
[0m14:55:38.269689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.valid_temp, now test.weather_dbt.weather_alert_consistency)
[0m14:55:38.270297 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.weather_alert_consistency
[0m14:55:38.274322 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.weather_alert_consistency"
[0m14:55:38.275681 [debug] [Thread-1 (]: Began executing node test.weather_dbt.weather_alert_consistency
[0m14:55:38.278149 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.weather_alert_consistency"
[0m14:55:38.279464 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.weather_alert_consistency"
[0m14:55:38.279844 [debug] [Thread-1 (]: On test.weather_dbt.weather_alert_consistency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.weather_alert_consistency"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- This test checks for consistency in the weather alerts generated in the extreme_weather_events table.
SELECT
    CITY_ID,
    DATE_TIME,
    WEATHER_ALERT,
    TEMP_FAHRENHEIT,
    WIND_SPEED
FROM openweather.analytics.extreme_weather_events
WHERE 
    (WEATHER_ALERT = 'Extreme Heat' AND TEMP_FAHRENHEIT <= 100)
    OR (WEATHER_ALERT = 'Extreme Cold' AND TEMP_FAHRENHEIT >= 32)
    OR (WEATHER_ALERT = 'High Winds' AND WIND_SPEED <= 20)
      
    ) dbt_internal_test
[0m14:55:38.280200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:38.805844 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.525 seconds
[0m14:55:38.810892 [debug] [Thread-1 (]: On test.weather_dbt.weather_alert_consistency: Close
[0m14:55:38.927263 [info ] [Thread-1 (]: 27 of 27 PASS weather_alert_consistency ........................................ [[32mPASS[0m in 0.66s]
[0m14:55:38.928173 [debug] [Thread-1 (]: Finished running node test.weather_dbt.weather_alert_consistency
[0m14:55:38.929807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:38.930158 [debug] [MainThread]: Connection 'test.weather_dbt.weather_alert_consistency' was properly closed.
[0m14:55:38.930531 [info ] [MainThread]: 
[0m14:55:38.930873 [info ] [MainThread]: Finished running 27 data tests in 0 hours 0 minutes and 18.88 seconds (18.88s).
[0m14:55:38.935301 [debug] [MainThread]: Command end result
[0m14:55:38.968447 [info ] [MainThread]: 
[0m14:55:38.968789 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:55:38.968985 [info ] [MainThread]: 
[0m14:55:38.969188 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=0 SKIP=0 TOTAL=27
[0m14:55:38.970675 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 19.557909, "process_in_blocks": "0", "process_kernel_time": 0.437373, "process_mem_max_rss": "142131200", "process_out_blocks": "0", "process_user_time": 3.180322}
[0m14:55:38.971053 [debug] [MainThread]: Command `dbt test` succeeded at 14:55:38.970991 after 19.56 seconds
[0m14:55:38.971288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a09910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11695bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116959a70>]}
[0m14:55:38.971503 [debug] [MainThread]: Flushing usage events
[0m15:22:06.880899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10274cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104053b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104053d90>]}


============================== 15:22:06.883780 | dfb337a1-c837-439a-9b8b-b0c92cd8d8ac ==============================
[0m15:22:06.883780 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:22:06.884106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m15:22:06.937348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfb337a1-c837-439a-9b8b-b0c92cd8d8ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ebb360>]}
[0m15:22:06.952134 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.10698983, "process_in_blocks": "0", "process_kernel_time": 0.125187, "process_mem_max_rss": "99516416", "process_out_blocks": "0", "process_user_time": 0.622195}
[0m15:22:06.952686 [debug] [MainThread]: Command `dbt clean` succeeded at 15:22:06.952593 after 0.11 seconds
[0m15:22:06.952913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10417a580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10417a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103de2950>]}
[0m15:22:06.953088 [debug] [MainThread]: Flushing usage events
[0m15:22:14.454550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103100d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a03b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a03d90>]}


============================== 15:22:14.456837 | 35d9c07b-ea0c-43eb-bcfd-74f6335a436e ==============================
[0m15:22:14.456837 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:22:14.457159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:14.679694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35d9c07b-ea0c-43eb-bcfd-74f6335a436e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10564eb10>]}
[0m15:22:14.702707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35d9c07b-ea0c-43eb-bcfd-74f6335a436e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105650050>]}
[0m15:22:14.704037 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:22:14.764673 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:22:14.765268 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:22:14.765463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '35d9c07b-ea0c-43eb-bcfd-74f6335a436e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054d4a50>]}
[0m15:22:15.304287 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: A snapshot configured with the check strategy must specify a check_cols configuration.
[0m15:22:15.306854 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.88438535, "process_in_blocks": "0", "process_kernel_time": 0.186665, "process_mem_max_rss": "127385600", "process_out_blocks": "0", "process_user_time": 1.251005}
[0m15:22:15.307251 [debug] [MainThread]: Command `dbt run` failed at 15:22:15.307197 after 0.88 seconds
[0m15:22:15.307468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105875a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058cc500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a0be70>]}
[0m15:22:15.307649 [debug] [MainThread]: Flushing usage events
[0m15:23:55.956984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106754d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108083b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108083d90>]}


============================== 15:23:55.959369 | 5cec4b1e-35f0-4ba5-99a4-269a7092c50b ==============================
[0m15:23:55.959369 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:23:55.959693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:23:56.160703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cec4b1e-35f0-4ba5-99a4-269a7092c50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ccab10>]}
[0m15:23:56.183335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5cec4b1e-35f0-4ba5-99a4-269a7092c50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ccc050>]}
[0m15:23:56.184664 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:23:56.242237 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:23:56.242765 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:23:56.242955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5cec4b1e-35f0-4ba5-99a4-269a7092c50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b50a50>]}
[0m15:23:56.855881 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:23:56.856188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5cec4b1e-35f0-4ba5-99a4-269a7092c50b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f4b7a0>]}
[0m15:23:57.001782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cec4b1e-35f0-4ba5-99a4-269a7092c50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fc9010>]}
[0m15:23:57.071067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cec4b1e-35f0-4ba5-99a4-269a7092c50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093e6c30>]}
[0m15:23:57.071375 [info ] [MainThread]: Found 8 models, 7 snapshots, 27 data tests, 2 sources, 459 macros
[0m15:23:57.071551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cec4b1e-35f0-4ba5-99a4-269a7092c50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10949a5d0>]}
[0m15:23:57.072770 [info ] [MainThread]: 
[0m15:23:57.073053 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:23:57.075231 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m15:23:57.081930 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m15:23:57.082171 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m15:23:57.082311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:57.726340 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.644 seconds
[0m15:23:57.728530 [debug] [ThreadPool]: On list_openweather: Close
[0m15:23:57.849188 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_snapshot)
[0m15:23:57.859282 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m15:23:57.859656 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m15:23:57.859927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:58.333788 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.474 seconds
[0m15:23:58.337187 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m15:23:58.465252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m15:23:58.469723 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m15:23:58.470334 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m15:23:58.470668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:59.005803 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.535 seconds
[0m15:23:59.008460 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m15:23:59.137161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cec4b1e-35f0-4ba5-99a4-269a7092c50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094355a0>]}
[0m15:23:59.137945 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m15:23:59.138270 [info ] [MainThread]: 
[0m15:23:59.141582 [debug] [Thread-1 (]: Began running node model.weather_dbt.cloud_coverage_over_time
[0m15:23:59.142151 [info ] [Thread-1 (]: 1 of 8 START sql table model analytics.cloud_coverage_over_time ................ [RUN]
[0m15:23:59.142562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.cloud_coverage_over_time)
[0m15:23:59.142871 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.cloud_coverage_over_time
[0m15:23:59.150230 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.cloud_coverage_over_time"
[0m15:23:59.151599 [debug] [Thread-1 (]: Began executing node model.weather_dbt.cloud_coverage_over_time
[0m15:23:59.172551 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.cloud_coverage_over_time"
[0m15:23:59.173841 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.cloud_coverage_over_time"
[0m15:23:59.174103 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.cloud_coverage_over_time"} */
create or replace transient table openweather.analytics.cloud_coverage_over_time
         as
        (WITH CloudCoverage AS (
    SELECT 
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY
        );
[0m15:23:59.174328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:00.382355 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.207 seconds
[0m15:24:00.407919 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: Close
[0m15:24:00.524699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cec4b1e-35f0-4ba5-99a4-269a7092c50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107643a70>]}
[0m15:24:00.525920 [info ] [Thread-1 (]: 1 of 8 OK created sql table model analytics.cloud_coverage_over_time ........... [[32mSUCCESS 1[0m in 1.38s]
[0m15:24:00.526699 [debug] [Thread-1 (]: Finished running node model.weather_dbt.cloud_coverage_over_time
[0m15:24:00.527202 [debug] [Thread-1 (]: Began running node model.weather_dbt.correlation
[0m15:24:00.527846 [info ] [Thread-1 (]: 2 of 8 START sql table model analytics.correlation ............................. [RUN]
[0m15:24:00.528478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.cloud_coverage_over_time, now model.weather_dbt.correlation)
[0m15:24:00.528917 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.correlation
[0m15:24:00.532793 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.correlation"
[0m15:24:00.534195 [debug] [Thread-1 (]: Began executing node model.weather_dbt.correlation
[0m15:24:00.543119 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.correlation"
[0m15:24:00.544538 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.correlation"
[0m15:24:00.544896 [debug] [Thread-1 (]: On model.weather_dbt.correlation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.correlation"} */
create or replace transient table openweather.analytics.correlation
         as
        (WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData
        );
[0m15:24:00.545217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:01.595662 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.050 seconds
[0m15:24:01.599525 [debug] [Thread-1 (]: On model.weather_dbt.correlation: Close
[0m15:24:01.722475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cec4b1e-35f0-4ba5-99a4-269a7092c50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2b0350>]}
[0m15:24:01.723284 [info ] [Thread-1 (]: 2 of 8 OK created sql table model analytics.correlation ........................ [[32mSUCCESS 1[0m in 1.19s]
[0m15:24:01.723915 [debug] [Thread-1 (]: Finished running node model.weather_dbt.correlation
[0m15:24:01.724339 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m15:24:01.724918 [info ] [Thread-1 (]: 3 of 8 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m15:24:01.725434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.correlation, now model.weather_dbt.extreme_weather_events)
[0m15:24:01.725821 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m15:24:01.729215 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m15:24:01.730307 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m15:24:01.733534 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m15:24:01.735420 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m15:24:01.735853 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME
        );
[0m15:24:01.736149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:03.228666 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.492 seconds
[0m15:24:03.231496 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m15:24:03.355329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cec4b1e-35f0-4ba5-99a4-269a7092c50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b88a0>]}
[0m15:24:03.356680 [info ] [Thread-1 (]: 3 of 8 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.63s]
[0m15:24:03.357403 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m15:24:03.357935 [debug] [Thread-1 (]: Began running node model.weather_dbt.humidity_vs_temp
[0m15:24:03.358802 [info ] [Thread-1 (]: 4 of 8 START sql table model analytics.humidity_vs_temp ........................ [RUN]
[0m15:24:03.359448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.humidity_vs_temp)
[0m15:24:03.359887 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.humidity_vs_temp
[0m15:24:03.363871 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.humidity_vs_temp"
[0m15:24:03.364972 [debug] [Thread-1 (]: Began executing node model.weather_dbt.humidity_vs_temp
[0m15:24:03.368084 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.humidity_vs_temp"
[0m15:24:03.369853 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.humidity_vs_temp"
[0m15:24:03.370230 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.humidity_vs_temp"} */
create or replace transient table openweather.analytics.humidity_vs_temp
         as
        (WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT *
FROM HumidityTemp
        );
[0m15:24:03.370542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:04.462736 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.092 seconds
[0m15:24:04.467837 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: Close
[0m15:24:04.607757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cec4b1e-35f0-4ba5-99a4-269a7092c50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091f7e90>]}
[0m15:24:04.609353 [info ] [Thread-1 (]: 4 of 8 OK created sql table model analytics.humidity_vs_temp ................... [[32mSUCCESS 1[0m in 1.25s]
[0m15:24:04.610359 [debug] [Thread-1 (]: Finished running node model.weather_dbt.humidity_vs_temp
[0m15:24:04.610927 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m15:24:04.611718 [info ] [Thread-1 (]: 5 of 8 START sql view model analytics.openweather_join ......................... [RUN]
[0m15:24:04.612403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.humidity_vs_temp, now model.weather_dbt.openweather_join)
[0m15:24:04.612866 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m15:24:04.617438 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m15:24:04.618647 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m15:24:04.638627 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m15:24:04.639897 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m15:24:04.640185 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    c."Latitude" AS CITY_LATITUDE,
    c."Longitude" AS CITY_LONGITUDE,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m15:24:04.640435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:05.382985 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.742 seconds
[0m15:24:05.385970 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m15:24:05.510801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cec4b1e-35f0-4ba5-99a4-269a7092c50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575ac90>]}
[0m15:24:05.511219 [info ] [Thread-1 (]: 5 of 8 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.90s]
[0m15:24:05.511528 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m15:24:05.511743 [debug] [Thread-1 (]: Began running node model.weather_dbt.temp_trends_by_city
[0m15:24:05.512012 [info ] [Thread-1 (]: 6 of 8 START sql table model analytics.temp_trends_by_city ..................... [RUN]
[0m15:24:05.512283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.temp_trends_by_city)
[0m15:24:05.512473 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.temp_trends_by_city
[0m15:24:05.514027 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.temp_trends_by_city"
[0m15:24:05.514502 [debug] [Thread-1 (]: Began executing node model.weather_dbt.temp_trends_by_city
[0m15:24:05.515642 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.temp_trends_by_city"
[0m15:24:05.516361 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.temp_trends_by_city"
[0m15:24:05.516560 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.temp_trends_by_city"} */
create or replace transient table openweather.analytics.temp_trends_by_city
         as
        (WITH TempTrends AS (
    SELECT 
        "Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY
        );
[0m15:24:05.516742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:06.712025 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.195 seconds
[0m15:24:06.715385 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: Close
[0m15:24:06.856680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cec4b1e-35f0-4ba5-99a4-269a7092c50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575b590>]}
[0m15:24:06.858452 [info ] [Thread-1 (]: 6 of 8 OK created sql table model analytics.temp_trends_by_city ................ [[32mSUCCESS 1[0m in 1.34s]
[0m15:24:06.859573 [debug] [Thread-1 (]: Finished running node model.weather_dbt.temp_trends_by_city
[0m15:24:06.860174 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_cond_distribution
[0m15:24:06.860862 [info ] [Thread-1 (]: 7 of 8 START sql table model analytics.weather_cond_distribution ............... [RUN]
[0m15:24:06.861523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.temp_trends_by_city, now model.weather_dbt.weather_cond_distribution)
[0m15:24:06.861974 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_cond_distribution
[0m15:24:06.866078 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_cond_distribution"
[0m15:24:06.867369 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_cond_distribution
[0m15:24:06.869864 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_cond_distribution"
[0m15:24:06.871276 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_cond_distribution"
[0m15:24:06.871917 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_cond_distribution"} */
create or replace transient table openweather.analytics.weather_cond_distribution
         as
        (WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, 3
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC
        );
[0m15:24:06.872326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:08.046276 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.173 seconds
[0m15:24:08.051071 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: Close
[0m15:24:08.158802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cec4b1e-35f0-4ba5-99a4-269a7092c50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575be90>]}
[0m15:24:08.159752 [info ] [Thread-1 (]: 7 of 8 OK created sql table model analytics.weather_cond_distribution .......... [[32mSUCCESS 1[0m in 1.30s]
[0m15:24:08.160310 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_cond_distribution
[0m15:24:08.160701 [debug] [Thread-1 (]: Began running node model.weather_dbt.wind_speed_analysis
[0m15:24:08.161170 [info ] [Thread-1 (]: 8 of 8 START sql table model analytics.wind_speed_analysis ..................... [RUN]
[0m15:24:08.161613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.weather_cond_distribution, now model.weather_dbt.wind_speed_analysis)
[0m15:24:08.161939 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.wind_speed_analysis
[0m15:24:08.165223 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.wind_speed_analysis"
[0m15:24:08.166366 [debug] [Thread-1 (]: Began executing node model.weather_dbt.wind_speed_analysis
[0m15:24:08.169441 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.wind_speed_analysis"
[0m15:24:08.171088 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.wind_speed_analysis"
[0m15:24:08.171677 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.wind_speed_analysis"} */
create or replace transient table openweather.analytics.wind_speed_analysis
         as
        (WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL 
)
SELECT *
FROM WindSpeedData
        );
[0m15:24:08.172037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:09.557063 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.384 seconds
[0m15:24:09.561407 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: Close
[0m15:24:09.680364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cec4b1e-35f0-4ba5-99a4-269a7092c50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bd4710>]}
[0m15:24:09.681456 [info ] [Thread-1 (]: 8 of 8 OK created sql table model analytics.wind_speed_analysis ................ [[32mSUCCESS 1[0m in 1.52s]
[0m15:24:09.682295 [debug] [Thread-1 (]: Finished running node model.weather_dbt.wind_speed_analysis
[0m15:24:09.684198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:24:09.684618 [debug] [MainThread]: Connection 'model.weather_dbt.wind_speed_analysis' was properly closed.
[0m15:24:09.685083 [info ] [MainThread]: 
[0m15:24:09.685475 [info ] [MainThread]: Finished running 7 table models, 1 view model in 0 hours 0 minutes and 12.61 seconds (12.61s).
[0m15:24:09.687181 [debug] [MainThread]: Command end result
[0m15:24:09.717481 [info ] [MainThread]: 
[0m15:24:09.717793 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:24:09.717975 [info ] [MainThread]: 
[0m15:24:09.718169 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m15:24:09.719656 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.7953005, "process_in_blocks": "0", "process_kernel_time": 0.262382, "process_mem_max_rss": "147144704", "process_out_blocks": "0", "process_user_time": 2.383806}
[0m15:24:09.720127 [debug] [MainThread]: Command `dbt run` succeeded at 15:24:09.720061 after 13.80 seconds
[0m15:24:09.720381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af1c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4c7ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4c79b0>]}
[0m15:24:09.720607 [debug] [MainThread]: Flushing usage events
[0m15:24:18.709226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b98d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c13b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c13d90>]}


============================== 15:24:18.711536 | 8cb94dc7-3c80-4f77-a34a-0a53af238870 ==============================
[0m15:24:18.711536 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:24:18.711849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m15:24:18.902203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cb94dc7-3c80-4f77-a34a-0a53af238870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10837ab10>]}
[0m15:24:18.924858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cb94dc7-3c80-4f77-a34a-0a53af238870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10837c050>]}
[0m15:24:18.926258 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:24:18.983161 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:24:19.065602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:24:19.065844 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:24:19.094601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cb94dc7-3c80-4f77-a34a-0a53af238870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108271450>]}
[0m15:24:19.168815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cb94dc7-3c80-4f77-a34a-0a53af238870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aaf7a0>]}
[0m15:24:19.169124 [info ] [MainThread]: Found 8 models, 7 snapshots, 27 data tests, 2 sources, 459 macros
[0m15:24:19.169302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cb94dc7-3c80-4f77-a34a-0a53af238870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a9b690>]}
[0m15:24:19.170780 [info ] [MainThread]: 
[0m15:24:19.171094 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:24:19.173446 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_analytics'
[0m15:24:19.183481 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m15:24:19.183726 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m15:24:19.183864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:19.757709 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.573 seconds
[0m15:24:19.764430 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m15:24:19.888893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m15:24:19.891995 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m15:24:19.892284 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m15:24:19.892500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:24:20.384247 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.491 seconds
[0m15:24:20.387497 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m15:24:20.517070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cb94dc7-3c80-4f77-a34a-0a53af238870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bf6820>]}
[0m15:24:20.517494 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m15:24:20.517663 [info ] [MainThread]: 
[0m15:24:20.519289 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m15:24:20.519485 [info ] [Thread-1 (]: 1 of 27 START test not_null_cloud_coverage_over_time_avg_cloud_coverage ........ [RUN]
[0m15:24:20.519685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86)
[0m15:24:20.519840 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m15:24:20.528694 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m15:24:20.529433 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m15:24:20.539968 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m15:24:20.540875 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m15:24:20.541110 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_cloud_coverage
from openweather.analytics.cloud_coverage_over_time
where avg_cloud_coverage is null



      
    ) dbt_internal_test
[0m15:24:20.541406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:20.968814 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.427 seconds
[0m15:24:20.975451 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86: Close
[0m15:24:21.103458 [info ] [Thread-1 (]: 1 of 27 PASS not_null_cloud_coverage_over_time_avg_cloud_coverage .............. [[32mPASS[0m in 0.58s]
[0m15:24:21.104571 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m15:24:21.105251 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m15:24:21.105860 [info ] [Thread-1 (]: 2 of 27 START test not_null_cloud_coverage_over_time_city_name ................. [RUN]
[0m15:24:21.106474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86, now test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f)
[0m15:24:21.106960 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m15:24:21.111782 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m15:24:21.112840 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m15:24:21.115275 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m15:24:21.116554 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m15:24:21.116937 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.cloud_coverage_over_time
where city_name is null



      
    ) dbt_internal_test
[0m15:24:21.117272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:21.662638 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.545 seconds
[0m15:24:21.666336 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f: Close
[0m15:24:21.790686 [info ] [Thread-1 (]: 2 of 27 PASS not_null_cloud_coverage_over_time_city_name ....................... [[32mPASS[0m in 0.68s]
[0m15:24:21.791375 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m15:24:21.791811 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m15:24:21.792283 [info ] [Thread-1 (]: 3 of 27 START test not_null_cloud_coverage_over_time_day ....................... [RUN]
[0m15:24:21.792784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f, now test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9)
[0m15:24:21.793149 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m15:24:21.797532 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m15:24:21.798657 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m15:24:21.800796 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m15:24:21.801745 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m15:24:21.802075 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from openweather.analytics.cloud_coverage_over_time
where day is null



      
    ) dbt_internal_test
[0m15:24:21.802367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:22.317279 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.515 seconds
[0m15:24:22.319524 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9: Close
[0m15:24:22.446572 [info ] [Thread-1 (]: 3 of 27 PASS not_null_cloud_coverage_over_time_day ............................. [[32mPASS[0m in 0.65s]
[0m15:24:22.447290 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m15:24:22.447531 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m15:24:22.447779 [info ] [Thread-1 (]: 4 of 27 START test not_null_correlation_avg_humidity ........................... [RUN]
[0m15:24:22.448055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9, now test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d)
[0m15:24:22.448256 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m15:24:22.451212 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m15:24:22.451953 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m15:24:22.453073 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m15:24:22.454294 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m15:24:22.454703 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_humidity
from openweather.analytics.correlation
where avg_humidity is null



      
    ) dbt_internal_test
[0m15:24:22.455034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:22.896308 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.441 seconds
[0m15:24:22.900594 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d: Close
[0m15:24:23.027894 [info ] [Thread-1 (]: 4 of 27 PASS not_null_correlation_avg_humidity ................................. [[32mPASS[0m in 0.58s]
[0m15:24:23.029098 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m15:24:23.029705 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m15:24:23.030346 [info ] [Thread-1 (]: 5 of 27 START test not_null_correlation_avg_pressure ........................... [RUN]
[0m15:24:23.031068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d, now test.weather_dbt.not_null_correlation_avg_pressure.46419021da)
[0m15:24:23.031561 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m15:24:23.036993 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m15:24:23.038330 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m15:24:23.040760 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m15:24:23.041903 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m15:24:23.042281 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_pressure.46419021da: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_pressure
from openweather.analytics.correlation
where avg_pressure is null



      
    ) dbt_internal_test
[0m15:24:23.042634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:23.550088 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.507 seconds
[0m15:24:23.552259 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_pressure.46419021da: Close
[0m15:24:23.723756 [info ] [Thread-1 (]: 5 of 27 PASS not_null_correlation_avg_pressure ................................. [[32mPASS[0m in 0.69s]
[0m15:24:23.724643 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m15:24:23.725022 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m15:24:23.725410 [info ] [Thread-1 (]: 6 of 27 START test not_null_correlation_avg_temp ............................... [RUN]
[0m15:24:23.725863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_pressure.46419021da, now test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61)
[0m15:24:23.726163 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m15:24:23.730173 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m15:24:23.731112 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m15:24:23.732741 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m15:24:23.733446 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m15:24:23.733697 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp
from openweather.analytics.correlation
where avg_temp is null



      
    ) dbt_internal_test
[0m15:24:23.733924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:24.231011 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.496 seconds
[0m15:24:24.235855 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61: Close
[0m15:24:24.356561 [info ] [Thread-1 (]: 6 of 27 PASS not_null_correlation_avg_temp ..................................... [[32mPASS[0m in 0.63s]
[0m15:24:24.357309 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m15:24:24.357722 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m15:24:24.358167 [info ] [Thread-1 (]: 7 of 27 START test not_null_correlation_avg_wind_speed ......................... [RUN]
[0m15:24:24.358634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61, now test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9)
[0m15:24:24.358983 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m15:24:24.363403 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m15:24:24.364599 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m15:24:24.366737 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m15:24:24.367680 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m15:24:24.367995 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_wind_speed
from openweather.analytics.correlation
where avg_wind_speed is null



      
    ) dbt_internal_test
[0m15:24:24.368595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:24.914087 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.545 seconds
[0m15:24:24.920305 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9: Close
[0m15:24:25.046088 [info ] [Thread-1 (]: 7 of 27 PASS not_null_correlation_avg_wind_speed ............................... [[32mPASS[0m in 0.69s]
[0m15:24:25.047360 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m15:24:25.048035 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m15:24:25.048673 [info ] [Thread-1 (]: 8 of 27 START test not_null_correlation_city_name .............................. [RUN]
[0m15:24:25.049348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9, now test.weather_dbt.not_null_correlation_city_name.d4bb85e888)
[0m15:24:25.049797 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m15:24:25.055430 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m15:24:25.056388 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m15:24:25.058422 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m15:24:25.059794 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m15:24:25.060185 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_city_name.d4bb85e888: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.correlation
where city_name is null



      
    ) dbt_internal_test
[0m15:24:25.060469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:25.527326 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.466 seconds
[0m15:24:25.530990 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_city_name.d4bb85e888: Close
[0m15:24:25.692787 [info ] [Thread-1 (]: 8 of 27 PASS not_null_correlation_city_name .................................... [[32mPASS[0m in 0.64s]
[0m15:24:25.694006 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m15:24:25.694614 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m15:24:25.695248 [info ] [Thread-1 (]: 9 of 27 START test not_null_extreme_weather_events_city_id ..................... [RUN]
[0m15:24:25.695848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_city_name.d4bb85e888, now test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4)
[0m15:24:25.696274 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m15:24:25.701795 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m15:24:25.702886 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m15:24:25.705000 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m15:24:25.706922 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m15:24:25.707528 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_id
from openweather.analytics.extreme_weather_events
where city_id is null



      
    ) dbt_internal_test
[0m15:24:25.707834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:26.215415 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.507 seconds
[0m15:24:26.219734 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4: Close
[0m15:24:26.383783 [info ] [Thread-1 (]: 9 of 27 PASS not_null_extreme_weather_events_city_id ........................... [[32mPASS[0m in 0.69s]
[0m15:24:26.384762 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m15:24:26.385363 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m15:24:26.385894 [info ] [Thread-1 (]: 10 of 27 START test not_null_extreme_weather_events_city_name .................. [RUN]
[0m15:24:26.386485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4, now test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589)
[0m15:24:26.386919 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m15:24:26.392499 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m15:24:26.393615 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m15:24:26.395849 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m15:24:26.397132 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m15:24:26.397489 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.extreme_weather_events
where city_name is null



      
    ) dbt_internal_test
[0m15:24:26.397777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:26.837562 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.439 seconds
[0m15:24:26.841312 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589: Close
[0m15:24:26.972110 [info ] [Thread-1 (]: 10 of 27 PASS not_null_extreme_weather_events_city_name ........................ [[32mPASS[0m in 0.59s]
[0m15:24:26.972844 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m15:24:26.973280 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m15:24:26.973731 [info ] [Thread-1 (]: 11 of 27 START test not_null_extreme_weather_events_date_time .................. [RUN]
[0m15:24:26.974234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589, now test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853)
[0m15:24:26.974604 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m15:24:26.979573 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m15:24:26.980640 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m15:24:26.982567 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m15:24:26.983466 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m15:24:26.984044 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_time
from openweather.analytics.extreme_weather_events
where date_time is null



      
    ) dbt_internal_test
[0m15:24:26.984399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:27.478812 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.494 seconds
[0m15:24:27.485057 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853: Close
[0m15:24:27.599706 [info ] [Thread-1 (]: 11 of 27 PASS not_null_extreme_weather_events_date_time ........................ [[32mPASS[0m in 0.63s]
[0m15:24:27.600520 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m15:24:27.600921 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m15:24:27.601231 [info ] [Thread-1 (]: 12 of 27 START test not_null_extreme_weather_events_temp_fahrenheit ............ [RUN]
[0m15:24:27.601596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853, now test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d)
[0m15:24:27.601899 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m15:24:27.605376 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m15:24:27.606102 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m15:24:27.607935 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m15:24:27.608871 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m15:24:27.609220 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_fahrenheit
from openweather.analytics.extreme_weather_events
where temp_fahrenheit is null



      
    ) dbt_internal_test
[0m15:24:27.609502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:27.992994 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.383 seconds
[0m15:24:27.997079 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d: Close
[0m15:24:28.118971 [info ] [Thread-1 (]: 12 of 27 PASS not_null_extreme_weather_events_temp_fahrenheit .................. [[32mPASS[0m in 0.52s]
[0m15:24:28.119710 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m15:24:28.120163 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m15:24:28.120622 [info ] [Thread-1 (]: 13 of 27 START test not_null_extreme_weather_events_weather_alert .............. [RUN]
[0m15:24:28.121150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d, now test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb)
[0m15:24:28.121507 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m15:24:28.126648 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m15:24:28.127771 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m15:24:28.129722 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m15:24:28.130792 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m15:24:28.131180 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_alert
from openweather.analytics.extreme_weather_events
where weather_alert is null



      
    ) dbt_internal_test
[0m15:24:28.131492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:28.612835 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.481 seconds
[0m15:24:28.616559 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb: Close
[0m15:24:28.747649 [info ] [Thread-1 (]: 13 of 27 PASS not_null_extreme_weather_events_weather_alert .................... [[32mPASS[0m in 0.63s]
[0m15:24:28.749318 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m15:24:28.750020 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m15:24:28.750593 [info ] [Thread-1 (]: 14 of 27 START test not_null_extreme_weather_events_wind_speed ................. [RUN]
[0m15:24:28.751268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb, now test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4)
[0m15:24:28.751725 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m15:24:28.757042 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m15:24:28.758274 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m15:24:28.760586 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m15:24:28.761846 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m15:24:28.762232 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select wind_speed
from openweather.analytics.extreme_weather_events
where wind_speed is null



      
    ) dbt_internal_test
[0m15:24:28.762555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:29.284557 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.522 seconds
[0m15:24:29.288034 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4: Close
[0m15:24:29.407374 [info ] [Thread-1 (]: 14 of 27 PASS not_null_extreme_weather_events_wind_speed ....................... [[32mPASS[0m in 0.66s]
[0m15:24:29.408262 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m15:24:29.408733 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m15:24:29.409240 [info ] [Thread-1 (]: 15 of 27 START test not_null_humidity_vs_temp_city_name ........................ [RUN]
[0m15:24:29.409822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4, now test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042)
[0m15:24:29.410253 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m15:24:29.414568 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m15:24:29.415649 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m15:24:29.417828 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m15:24:29.418772 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m15:24:29.419215 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.humidity_vs_temp
where city_name is null



      
    ) dbt_internal_test
[0m15:24:29.419643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:29.963528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.543 seconds
[0m15:24:29.970501 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042: Close
[0m15:24:30.095784 [info ] [Thread-1 (]: 15 of 27 PASS not_null_humidity_vs_temp_city_name .............................. [[32mPASS[0m in 0.69s]
[0m15:24:30.096863 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m15:24:30.097417 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m15:24:30.097927 [info ] [Thread-1 (]: 16 of 27 START test not_null_humidity_vs_temp_humidity ......................... [RUN]
[0m15:24:30.098499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042, now test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573)
[0m15:24:30.098929 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m15:24:30.104440 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m15:24:30.105635 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m15:24:30.107835 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m15:24:30.109231 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m15:24:30.109885 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select humidity
from openweather.analytics.humidity_vs_temp
where humidity is null



      
    ) dbt_internal_test
[0m15:24:30.110217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:30.551651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.441 seconds
[0m15:24:30.554743 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573: Close
[0m15:24:30.684833 [info ] [Thread-1 (]: 16 of 27 PASS not_null_humidity_vs_temp_humidity ............................... [[32mPASS[0m in 0.59s]
[0m15:24:30.685891 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m15:24:30.686400 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m15:24:30.686954 [info ] [Thread-1 (]: 17 of 27 START test not_null_humidity_vs_temp_temp_fahrenheit .................. [RUN]
[0m15:24:30.687557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573, now test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5)
[0m15:24:30.687989 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m15:24:30.693337 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m15:24:30.694525 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m15:24:30.696646 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m15:24:30.698124 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m15:24:30.698574 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_fahrenheit
from openweather.analytics.humidity_vs_temp
where temp_fahrenheit is null



      
    ) dbt_internal_test
[0m15:24:30.698890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:31.135167 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.436 seconds
[0m15:24:31.139350 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5: Close
[0m15:24:31.276085 [info ] [Thread-1 (]: 17 of 27 PASS not_null_humidity_vs_temp_temp_fahrenheit ........................ [[32mPASS[0m in 0.59s]
[0m15:24:31.276879 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m15:24:31.277317 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m15:24:31.277778 [info ] [Thread-1 (]: 18 of 27 START test not_null_temp_trends_by_city_avg_temp_fahrenheit ........... [RUN]
[0m15:24:31.278235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5, now test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae)
[0m15:24:31.278560 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m15:24:31.283029 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m15:24:31.284292 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m15:24:31.286254 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m15:24:31.287091 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m15:24:31.287379 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp_fahrenheit
from openweather.analytics.temp_trends_by_city
where avg_temp_fahrenheit is null



      
    ) dbt_internal_test
[0m15:24:31.287755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:31.764175 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.476 seconds
[0m15:24:31.767168 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae: Close
[0m15:24:31.898549 [info ] [Thread-1 (]: 18 of 27 PASS not_null_temp_trends_by_city_avg_temp_fahrenheit ................. [[32mPASS[0m in 0.62s]
[0m15:24:31.899712 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m15:24:31.900314 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m15:24:31.900956 [info ] [Thread-1 (]: 19 of 27 START test not_null_temp_trends_by_city_city_name ..................... [RUN]
[0m15:24:31.901700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae, now test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b)
[0m15:24:31.902212 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m15:24:31.907870 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m15:24:31.908998 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m15:24:31.911505 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m15:24:31.912660 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m15:24:31.913058 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.temp_trends_by_city
where city_name is null



      
    ) dbt_internal_test
[0m15:24:31.913388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:32.294548 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.380 seconds
[0m15:24:32.298151 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b: Close
[0m15:24:32.430176 [info ] [Thread-1 (]: 19 of 27 PASS not_null_temp_trends_by_city_city_name ........................... [[32mPASS[0m in 0.53s]
[0m15:24:32.431521 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m15:24:32.432113 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m15:24:32.432601 [info ] [Thread-1 (]: 20 of 27 START test not_null_temp_trends_by_city_day ........................... [RUN]
[0m15:24:32.433521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b, now test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019)
[0m15:24:32.434109 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m15:24:32.439998 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m15:24:32.441277 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m15:24:32.443533 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m15:24:32.444896 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m15:24:32.445365 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from openweather.analytics.temp_trends_by_city
where day is null



      
    ) dbt_internal_test
[0m15:24:32.445719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:32.984376 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.538 seconds
[0m15:24:32.989513 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019: Close
[0m15:24:33.123835 [info ] [Thread-1 (]: 20 of 27 PASS not_null_temp_trends_by_city_day ................................. [[32mPASS[0m in 0.69s]
[0m15:24:33.124933 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m15:24:33.125450 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m15:24:33.125991 [info ] [Thread-1 (]: 21 of 27 START test not_null_weather_cond_distribution_city_name ............... [RUN]
[0m15:24:33.126585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019, now test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec)
[0m15:24:33.127028 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m15:24:33.132603 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m15:24:33.133811 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m15:24:33.136103 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m15:24:33.137458 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m15:24:33.137941 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.weather_cond_distribution
where city_name is null



      
    ) dbt_internal_test
[0m15:24:33.138291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:33.605207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.466 seconds
[0m15:24:33.609099 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec: Close
[0m15:24:33.723288 [info ] [Thread-1 (]: 21 of 27 PASS not_null_weather_cond_distribution_city_name ..................... [[32mPASS[0m in 0.60s]
[0m15:24:33.723834 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m15:24:33.724136 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m15:24:33.724455 [info ] [Thread-1 (]: 22 of 27 START test not_null_weather_cond_distribution_count ................... [RUN]
[0m15:24:33.724830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec, now test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4)
[0m15:24:33.725111 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m15:24:33.728143 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m15:24:33.728856 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m15:24:33.730477 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m15:24:33.731277 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m15:24:33.731537 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select count
from openweather.analytics.weather_cond_distribution
where count is null



      
    ) dbt_internal_test
[0m15:24:33.731762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:34.263121 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.531 seconds
[0m15:24:34.266734 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4: Close
[0m15:24:34.445198 [info ] [Thread-1 (]: 22 of 27 PASS not_null_weather_cond_distribution_count ......................... [[32mPASS[0m in 0.72s]
[0m15:24:34.446321 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m15:24:34.446869 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m15:24:34.447394 [info ] [Thread-1 (]: 23 of 27 START test not_null_weather_cond_distribution_weather_main ............ [RUN]
[0m15:24:34.448016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4, now test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6)
[0m15:24:34.448439 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m15:24:34.453792 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m15:24:34.454732 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m15:24:34.456800 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m15:24:34.458238 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m15:24:34.459010 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_main
from openweather.analytics.weather_cond_distribution
where weather_main is null



      
    ) dbt_internal_test
[0m15:24:34.459434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:34.979490 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.519 seconds
[0m15:24:34.986219 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6: Close
[0m15:24:35.113253 [info ] [Thread-1 (]: 23 of 27 PASS not_null_weather_cond_distribution_weather_main .................. [[32mPASS[0m in 0.67s]
[0m15:24:35.114326 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m15:24:35.114847 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m15:24:35.115368 [info ] [Thread-1 (]: 24 of 27 START test not_null_wind_speed_analysis_city_name ..................... [RUN]
[0m15:24:35.115962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6, now test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9)
[0m15:24:35.116406 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m15:24:35.122048 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m15:24:35.123196 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m15:24:35.125450 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m15:24:35.127008 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m15:24:35.127493 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.wind_speed_analysis
where city_name is null



      
    ) dbt_internal_test
[0m15:24:35.127825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:35.647097 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.518 seconds
[0m15:24:35.651360 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9: Close
[0m15:24:35.774984 [info ] [Thread-1 (]: 24 of 27 PASS not_null_wind_speed_analysis_city_name ........................... [[32mPASS[0m in 0.66s]
[0m15:24:35.775812 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m15:24:35.776177 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m15:24:35.776552 [info ] [Thread-1 (]: 25 of 27 START test not_null_wind_speed_analysis_wind_speed .................... [RUN]
[0m15:24:35.776957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9, now test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2)
[0m15:24:35.777257 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m15:24:35.781038 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m15:24:35.782107 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m15:24:35.783950 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m15:24:35.784814 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m15:24:35.785073 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select wind_speed
from openweather.analytics.wind_speed_analysis
where wind_speed is null



      
    ) dbt_internal_test
[0m15:24:35.785312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:36.325196 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.539 seconds
[0m15:24:36.331253 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2: Close
[0m15:24:36.482035 [info ] [Thread-1 (]: 25 of 27 PASS not_null_wind_speed_analysis_wind_speed .......................... [[32mPASS[0m in 0.70s]
[0m15:24:36.483081 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m15:24:36.483628 [debug] [Thread-1 (]: Began running node test.weather_dbt.valid_temp
[0m15:24:36.484196 [info ] [Thread-1 (]: 26 of 27 START test valid_temp ................................................. [RUN]
[0m15:24:36.484865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2, now test.weather_dbt.valid_temp)
[0m15:24:36.485296 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.valid_temp
[0m15:24:36.488924 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.valid_temp"
[0m15:24:36.489951 [debug] [Thread-1 (]: Began executing node test.weather_dbt.valid_temp
[0m15:24:36.492123 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.valid_temp"
[0m15:24:36.493280 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.valid_temp"
[0m15:24:36.493630 [debug] [Thread-1 (]: On test.weather_dbt.valid_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.valid_temp"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- checking valid temperature values for extreme_weather_events.sql
SELECT
    CITY_ID,
    DATE_TIME,
    TEMP_FAHRENHEIT
FROM openweather.analytics.extreme_weather_events
WHERE TEMP_FAHRENHEIT IS NULL
   OR TEMP_FAHRENHEIT < -100 OR TEMP_FAHRENHEIT > 150
      
    ) dbt_internal_test
[0m15:24:36.493932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:36.944097 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.449 seconds
[0m15:24:36.948670 [debug] [Thread-1 (]: On test.weather_dbt.valid_temp: Close
[0m15:24:37.112336 [info ] [Thread-1 (]: 26 of 27 PASS valid_temp ....................................................... [[32mPASS[0m in 0.63s]
[0m15:24:37.113353 [debug] [Thread-1 (]: Finished running node test.weather_dbt.valid_temp
[0m15:24:37.113928 [debug] [Thread-1 (]: Began running node test.weather_dbt.weather_alert_consistency
[0m15:24:37.114384 [info ] [Thread-1 (]: 27 of 27 START test weather_alert_consistency .................................. [RUN]
[0m15:24:37.114925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.valid_temp, now test.weather_dbt.weather_alert_consistency)
[0m15:24:37.115411 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.weather_alert_consistency
[0m15:24:37.119047 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.weather_alert_consistency"
[0m15:24:37.120494 [debug] [Thread-1 (]: Began executing node test.weather_dbt.weather_alert_consistency
[0m15:24:37.122938 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.weather_alert_consistency"
[0m15:24:37.124371 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.weather_alert_consistency"
[0m15:24:37.124816 [debug] [Thread-1 (]: On test.weather_dbt.weather_alert_consistency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.weather_alert_consistency"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- This test checks for consistency in the weather alerts generated in the extreme_weather_events table.
SELECT
    CITY_ID,
    DATE_TIME,
    WEATHER_ALERT,
    TEMP_FAHRENHEIT,
    WIND_SPEED
FROM openweather.analytics.extreme_weather_events
WHERE 
    (WEATHER_ALERT = 'Extreme Heat' AND TEMP_FAHRENHEIT <= 100)
    OR (WEATHER_ALERT = 'Extreme Cold' AND TEMP_FAHRENHEIT >= 32)
    OR (WEATHER_ALERT = 'High Winds' AND WIND_SPEED <= 20)
      
    ) dbt_internal_test
[0m15:24:37.125604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:37.546216 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.420 seconds
[0m15:24:37.551733 [debug] [Thread-1 (]: On test.weather_dbt.weather_alert_consistency: Close
[0m15:24:37.738311 [info ] [Thread-1 (]: 27 of 27 PASS weather_alert_consistency ........................................ [[32mPASS[0m in 0.62s]
[0m15:24:37.739288 [debug] [Thread-1 (]: Finished running node test.weather_dbt.weather_alert_consistency
[0m15:24:37.740852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:24:37.741151 [debug] [MainThread]: Connection 'test.weather_dbt.weather_alert_consistency' was properly closed.
[0m15:24:37.741484 [info ] [MainThread]: 
[0m15:24:37.741802 [info ] [MainThread]: Finished running 27 data tests in 0 hours 0 minutes and 18.57 seconds (18.57s).
[0m15:24:37.745600 [debug] [MainThread]: Command end result
[0m15:24:37.775995 [info ] [MainThread]: 
[0m15:24:37.776331 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:24:37.776585 [info ] [MainThread]: 
[0m15:24:37.776827 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=0 SKIP=0 TOTAL=27
[0m15:24:37.777939 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 19.103388, "process_in_blocks": "0", "process_kernel_time": 0.360758, "process_mem_max_rss": "144588800", "process_out_blocks": "0", "process_user_time": 2.996529}
[0m15:24:37.778277 [debug] [MainThread]: Command `dbt test` succeeded at 15:24:37.778220 after 19.10 seconds
[0m15:24:37.778485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b05910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9d73e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9d7c20>]}
[0m15:24:37.778680 [debug] [MainThread]: Flushing usage events
[0m15:24:43.633859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108acbb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108acbd90>]}


============================== 15:24:43.636162 | 0e4e3ece-b11c-4957-881a-0b5f209e5747 ==============================
[0m15:24:43.636162 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:24:43.636486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:24:43.801509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e4e3ece-b11c-4957-881a-0b5f209e5747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab7ab10>]}
[0m15:24:43.825449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e4e3ece-b11c-4957-881a-0b5f209e5747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab7c050>]}
[0m15:24:43.825936 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:24:43.882299 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:24:43.956977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:24:43.957206 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:24:43.983995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e4e3ece-b11c-4957-881a-0b5f209e5747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa6d450>]}
[0m15:24:44.050918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e4e3ece-b11c-4957-881a-0b5f209e5747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa41400>]}
[0m15:24:44.051250 [info ] [MainThread]: Found 8 models, 7 snapshots, 27 data tests, 2 sources, 459 macros
[0m15:24:44.051431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e4e3ece-b11c-4957-881a-0b5f209e5747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afda7b0>]}
[0m15:24:44.052701 [info ] [MainThread]: 
[0m15:24:44.053010 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:24:44.055239 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m15:24:44.062843 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m15:24:44.063064 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m15:24:44.063210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:44.568374 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.505 seconds
[0m15:24:44.573264 [debug] [ThreadPool]: On list_openweather: Close
[0m15:24:44.704487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_snapshot)
[0m15:24:44.714411 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m15:24:44.714762 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m15:24:44.715035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:24:45.180751 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.465 seconds
[0m15:24:45.186299 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m15:24:45.313477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m15:24:45.317403 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m15:24:45.317977 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m15:24:45.318322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:24:45.842732 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.524 seconds
[0m15:24:45.846492 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m15:24:45.960107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e4e3ece-b11c-4957-881a-0b5f209e5747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aff9bf0>]}
[0m15:24:45.960847 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m15:24:45.961135 [info ] [MainThread]: 
[0m15:24:45.963549 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_cloud_coverage
[0m15:24:45.964086 [info ] [Thread-1 (]: 1 of 7 START snapshot snapshot.snapshot_cloud_coverage ......................... [RUN]
[0m15:24:45.964464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now snapshot.weather_dbt.snapshot_cloud_coverage)
[0m15:24:45.964731 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_cloud_coverage
[0m15:24:45.971434 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_cloud_coverage
[0m15:24:46.014688 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m15:24:46.015024 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_NAME_DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id,
        DAY as dbt_updated_at,
        DAY as dbt_valid_from,
        
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
from (
        



WITH CloudCoverage AS (
    SELECT 
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m15:24:46.015237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:46.499058 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b47c-0004-3867-0002-594300045646
[0m15:24:46.499798 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 26
invalid identifier 'CITY_NAME_DAY'
[0m15:24:46.500429 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: Close
[0m15:24:46.645242 [debug] [Thread-1 (]: Database Error in snapshot snapshot_cloud_coverage (snapshots/cloud_coverage_over_time_snapshot.sql)
  000904 (42000): SQL compilation error: error line 6 at position 26
  invalid identifier 'CITY_NAME_DAY'
[0m15:24:46.646275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e4e3ece-b11c-4957-881a-0b5f209e5747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd14410>]}
[0m15:24:46.646833 [error] [Thread-1 (]: 1 of 7 ERROR snapshotting snapshot.snapshot_cloud_coverage ..................... [[31mERROR[0m in 0.68s]
[0m15:24:46.647219 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_cloud_coverage
[0m15:24:46.647478 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_correlation_data
[0m15:24:46.648284 [info ] [Thread-1 (]: 2 of 7 START snapshot snapshot.snapshot_correlation_data ....................... [RUN]
[0m15:24:46.648691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_cloud_coverage, now snapshot.weather_dbt.snapshot_correlation_data)
[0m15:24:46.648924 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_correlation_data
[0m15:24:46.651011 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_correlation_data
[0m15:24:46.662847 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m15:24:46.663154 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m15:24:46.663352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:47.100472 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.436 seconds
[0m15:24:47.107721 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m15:24:47.108305 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m15:24:47.185129 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.076 seconds
[0m15:24:47.187043 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_correlation_data"
[0m15:24:47.191051 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m15:24:47.191810 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
create or replace transient table openweather.snapshot.snapshot_correlation_data
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData

    ) sbq



        );
[0m15:24:47.962233 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.770 seconds
[0m15:24:47.983877 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: Close
[0m15:24:48.089675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e4e3ece-b11c-4957-881a-0b5f209e5747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdcf490>]}
[0m15:24:48.090695 [info ] [Thread-1 (]: 2 of 7 OK snapshotted snapshot.snapshot_correlation_data ....................... [[32mSUCCESS 1[0m in 1.44s]
[0m15:24:48.091395 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_correlation_data
[0m15:24:48.091868 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m15:24:48.092546 [info ] [Thread-1 (]: 3 of 7 START snapshot snapshot.snapshot_extreme_weather_events ................. [RUN]
[0m15:24:48.093125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_correlation_data, now snapshot.weather_dbt.snapshot_extreme_weather_events)
[0m15:24:48.093545 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m15:24:48.097437 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m15:24:48.101990 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m15:24:48.102566 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m15:24:48.103105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:48.596239 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.492 seconds
[0m15:24:48.599822 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m15:24:48.600564 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m15:24:48.720992 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.120 seconds
[0m15:24:48.722400 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m15:24:48.724731 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m15:24:48.725132 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
create or replace transient table openweather.snapshot.snapshot_extreme_weather_events
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME

    ) sbq



        );
[0m15:24:49.618997 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.893 seconds
[0m15:24:49.623512 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: Close
[0m15:24:49.745505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e4e3ece-b11c-4957-881a-0b5f209e5747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118944cd0>]}
[0m15:24:49.746611 [info ] [Thread-1 (]: 3 of 7 OK snapshotted snapshot.snapshot_extreme_weather_events ................. [[32mSUCCESS 1[0m in 1.65s]
[0m15:24:49.747252 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m15:24:49.747685 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_humidity_temp
[0m15:24:49.748221 [info ] [Thread-1 (]: 4 of 7 START snapshot snapshot.snapshot_humidity_temp .......................... [RUN]
[0m15:24:49.749025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_extreme_weather_events, now snapshot.weather_dbt.snapshot_humidity_temp)
[0m15:24:49.749500 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_humidity_temp
[0m15:24:49.753445 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_humidity_temp
[0m15:24:49.759268 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temp"
[0m15:24:49.759779 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temp"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temp"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT *
FROM HumidityTemp

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m15:24:49.760202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:50.251829 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.491 seconds
[0m15:24:50.255315 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temp"
[0m15:24:50.256146 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temp"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temp"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m15:24:50.357175 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.100 seconds
[0m15:24:50.358949 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_humidity_temp"
[0m15:24:50.362452 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temp"
[0m15:24:50.363181 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temp"} */
create or replace transient table openweather.snapshot.snapshot_humidity_temp
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT *
FROM HumidityTemp

    ) sbq



        );
[0m15:24:51.462828 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.098 seconds
[0m15:24:51.468909 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temp: Close
[0m15:24:51.604225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e4e3ece-b11c-4957-881a-0b5f209e5747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10808d2d0>]}
[0m15:24:51.605666 [info ] [Thread-1 (]: 4 of 7 OK snapshotted snapshot.snapshot_humidity_temp .......................... [[32mSUCCESS 1[0m in 1.86s]
[0m15:24:51.606538 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_humidity_temp
[0m15:24:51.607119 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_temp_trends
[0m15:24:51.607801 [info ] [Thread-1 (]: 5 of 7 START snapshot snapshot.snapshot_temp_trends ............................ [RUN]
[0m15:24:51.608424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_humidity_temp, now snapshot.weather_dbt.snapshot_temp_trends)
[0m15:24:51.608872 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_temp_trends
[0m15:24:51.613586 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_temp_trends
[0m15:24:51.619148 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m15:24:51.619633 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id,
        DAY as dbt_updated_at,
        DAY as dbt_valid_from,
        
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
from (
        



WITH TempTrends AS (
    SELECT 
        "Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m15:24:51.620010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:52.153441 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.533 seconds
[0m15:24:52.155714 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m15:24:52.156279 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m15:24:52.239718 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.083 seconds
[0m15:24:52.241144 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_temp_trends"
[0m15:24:52.243921 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m15:24:52.244515 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
create or replace transient table openweather.snapshot.snapshot_temp_trends
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id,
        DAY as dbt_updated_at,
        DAY as dbt_valid_from,
        
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
from (
        



WITH TempTrends AS (
    SELECT 
        "Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY

    ) sbq



        );
[0m15:24:53.051724 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.806 seconds
[0m15:24:53.055573 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: Close
[0m15:24:53.170416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e4e3ece-b11c-4957-881a-0b5f209e5747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be2e5f0>]}
[0m15:24:53.171771 [info ] [Thread-1 (]: 5 of 7 OK snapshotted snapshot.snapshot_temp_trends ............................ [[32mSUCCESS 1[0m in 1.56s]
[0m15:24:53.172522 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_temp_trends
[0m15:24:53.173034 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_weather_distribution
[0m15:24:53.173680 [info ] [Thread-1 (]: 6 of 7 START snapshot snapshot.snapshot_weather_distribution ................... [RUN]
[0m15:24:53.174298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_temp_trends, now snapshot.weather_dbt.snapshot_weather_distribution)
[0m15:24:53.174736 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_weather_distribution
[0m15:24:53.179091 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_weather_distribution
[0m15:24:53.185098 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m15:24:53.185555 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, 3
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m15:24:53.185912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:53.855234 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.669 seconds
[0m15:24:53.856165 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m15:24:53.856422 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m15:24:53.950623 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.094 seconds
[0m15:24:53.951202 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_weather_distribution"
[0m15:24:53.952755 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m15:24:53.953090 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
create or replace transient table openweather.snapshot.snapshot_weather_distribution
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, 3
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC

    ) sbq



        );
[0m15:24:54.740157 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.786 seconds
[0m15:24:54.745239 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: Close
[0m15:24:54.893916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e4e3ece-b11c-4957-881a-0b5f209e5747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10661c530>]}
[0m15:24:54.895104 [info ] [Thread-1 (]: 6 of 7 OK snapshotted snapshot.snapshot_weather_distribution ................... [[32mSUCCESS 1[0m in 1.72s]
[0m15:24:54.895842 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_weather_distribution
[0m15:24:54.896347 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_wind_speed_data
[0m15:24:54.896974 [info ] [Thread-1 (]: 7 of 7 START snapshot snapshot.snapshot_wind_speed_data ........................ [RUN]
[0m15:24:54.897575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_weather_distribution, now snapshot.weather_dbt.snapshot_wind_speed_data)
[0m15:24:54.898013 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_wind_speed_data
[0m15:24:54.902475 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_wind_speed_data
[0m15:24:54.912113 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed_data"
[0m15:24:54.912644 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed_data"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed_data"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL 
)
SELECT *
FROM WindSpeedData

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m15:24:54.912985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:55.289459 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.376 seconds
[0m15:24:55.293975 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed_data"
[0m15:24:55.295034 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed_data"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed_data"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m15:24:55.389381 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.093 seconds
[0m15:24:55.391307 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_wind_speed_data"
[0m15:24:55.394764 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed_data"
[0m15:24:55.395445 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed_data"} */
create or replace transient table openweather.snapshot.snapshot_wind_speed_data
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL 
)
SELECT *
FROM WindSpeedData

    ) sbq



        );
[0m15:24:56.479825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.084 seconds
[0m15:24:56.482392 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed_data: Close
[0m15:24:56.616384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e4e3ece-b11c-4957-881a-0b5f209e5747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd7e330>]}
[0m15:24:56.616918 [info ] [Thread-1 (]: 7 of 7 OK snapshotted snapshot.snapshot_wind_speed_data ........................ [[32mSUCCESS 1[0m in 1.72s]
[0m15:24:56.617662 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_wind_speed_data
[0m15:24:56.619396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:24:56.619828 [debug] [MainThread]: Connection 'snapshot.weather_dbt.snapshot_wind_speed_data' was properly closed.
[0m15:24:56.620241 [info ] [MainThread]: 
[0m15:24:56.620637 [info ] [MainThread]: Finished running 7 snapshots in 0 hours 0 minutes and 12.57 seconds (12.57s).
[0m15:24:56.622305 [debug] [MainThread]: Command end result
[0m15:24:56.644978 [info ] [MainThread]: 
[0m15:24:56.645284 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:24:56.645746 [info ] [MainThread]: 
[0m15:24:56.646009 [error] [MainThread]:   Database Error in snapshot snapshot_cloud_coverage (snapshots/cloud_coverage_over_time_snapshot.sql)
  000904 (42000): SQL compilation error: error line 6 at position 26
  invalid identifier 'CITY_NAME_DAY'
[0m15:24:56.646176 [info ] [MainThread]: 
[0m15:24:56.646330 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m15:24:56.647273 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 13.045762, "process_in_blocks": "0", "process_kernel_time": 0.251353, "process_mem_max_rss": "141312000", "process_out_blocks": "0", "process_user_time": 1.843496}
[0m15:24:56.647542 [debug] [MainThread]: Command `dbt snapshot` failed at 15:24:56.647497 after 13.05 seconds
[0m15:24:56.647735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10661c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107539c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11897aed0>]}
[0m15:24:56.647907 [debug] [MainThread]: Flushing usage events
[0m15:25:25.778110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e70d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104777b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104777d90>]}


============================== 15:25:25.780385 | ce930733-41d5-40d8-aac4-15cb0405dea8 ==============================
[0m15:25:25.780385 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:25:25.780716 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:25:25.945001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce930733-41d5-40d8-aac4-15cb0405dea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053beb10>]}
[0m15:25:25.967628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce930733-41d5-40d8-aac4-15cb0405dea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c0050>]}
[0m15:25:25.968082 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:25:26.022745 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:25:26.096047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:25:26.096415 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/cloud_coverage_over_time_snapshot.sql
[0m15:25:26.215582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce930733-41d5-40d8-aac4-15cb0405dea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105741950>]}
[0m15:25:26.311941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce930733-41d5-40d8-aac4-15cb0405dea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105215400>]}
[0m15:25:26.312229 [info ] [MainThread]: Found 8 models, 7 snapshots, 27 data tests, 2 sources, 459 macros
[0m15:25:26.312405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce930733-41d5-40d8-aac4-15cb0405dea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d04b0>]}
[0m15:25:26.313634 [info ] [MainThread]: 
[0m15:25:26.313921 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:25:26.316091 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m15:25:26.322335 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m15:25:26.322547 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m15:25:26.322680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:26.841001 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.518 seconds
[0m15:25:26.842207 [debug] [ThreadPool]: On list_openweather: Close
[0m15:25:26.997242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m15:25:27.007811 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m15:25:27.008210 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m15:25:27.008496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:27.413341 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.404 seconds
[0m15:25:27.417287 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m15:25:27.544131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m15:25:27.548261 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m15:25:27.548633 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m15:25:27.548948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:28.021533 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.472 seconds
[0m15:25:28.025428 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m15:25:28.138768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce930733-41d5-40d8-aac4-15cb0405dea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057cd570>]}
[0m15:25:28.139641 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m15:25:28.140053 [info ] [MainThread]: 
[0m15:25:28.142835 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_cloud_coverage
[0m15:25:28.143499 [info ] [Thread-1 (]: 1 of 7 START snapshot snapshot.snapshot_cloud_coverage ......................... [RUN]
[0m15:25:28.144034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now snapshot.weather_dbt.snapshot_cloud_coverage)
[0m15:25:28.144442 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_cloud_coverage
[0m15:25:28.159515 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_cloud_coverage
[0m15:25:28.205455 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m15:25:28.205803 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id,
        DAY as dbt_updated_at,
        DAY as dbt_valid_from,
        
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
from (
        



WITH CloudCoverage AS (
    SELECT 
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m15:25:28.206020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:28.678783 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.472 seconds
[0m15:25:28.689289 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m15:25:28.689931 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m15:25:28.773684 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.083 seconds
[0m15:25:28.774240 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m15:25:28.775614 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m15:25:28.775931 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
create or replace transient table openweather.snapshot.snapshot_cloud_coverage
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id,
        DAY as dbt_updated_at,
        DAY as dbt_valid_from,
        
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
from (
        



WITH CloudCoverage AS (
    SELECT 
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY

    ) sbq



        );
[0m15:25:29.736552 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.960 seconds
[0m15:25:29.763129 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: Close
[0m15:25:29.887305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce930733-41d5-40d8-aac4-15cb0405dea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a0abd0>]}
[0m15:25:29.888862 [info ] [Thread-1 (]: 1 of 7 OK snapshotted snapshot.snapshot_cloud_coverage ......................... [[32mSUCCESS 1[0m in 1.74s]
[0m15:25:29.889723 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_cloud_coverage
[0m15:25:29.890249 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_correlation_data
[0m15:25:29.890910 [info ] [Thread-1 (]: 2 of 7 START snapshot snapshot.snapshot_correlation_data ....................... [RUN]
[0m15:25:29.891531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_cloud_coverage, now snapshot.weather_dbt.snapshot_correlation_data)
[0m15:25:29.891968 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_correlation_data
[0m15:25:29.896387 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_correlation_data
[0m15:25:29.917426 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m15:25:29.917831 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
select * from (
        



WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData

    ) as __dbt_sbq
    where false
    limit 0
[0m15:25:29.918131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:30.421120 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.502 seconds
[0m15:25:30.434819 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m15:25:30.435554 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA"
[0m15:25:30.542662 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.106 seconds
[0m15:25:30.547659 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m15:25:30.548061 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA"
[0m15:25:30.631359 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.083 seconds
[0m15:25:30.668638 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m15:25:30.669272 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData


    ),

    snapshotted_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CITY_NAME" != source_data."CITY_NAME"
        or
        (
            ((snapshotted_data."CITY_NAME" is null) and not (source_data."CITY_NAME" is null))
            or
            ((not snapshotted_data."CITY_NAME" is null) and (source_data."CITY_NAME" is null))
        ) or snapshotted_data."AVG_TEMP" != source_data."AVG_TEMP"
        or
        (
            ((snapshotted_data."AVG_TEMP" is null) and not (source_data."AVG_TEMP" is null))
            or
            ((not snapshotted_data."AVG_TEMP" is null) and (source_data."AVG_TEMP" is null))
        ) or snapshotted_data."AVG_HUMIDITY" != source_data."AVG_HUMIDITY"
        or
        (
            ((snapshotted_data."AVG_HUMIDITY" is null) and not (source_data."AVG_HUMIDITY" is null))
            or
            ((not snapshotted_data."AVG_HUMIDITY" is null) and (source_data."AVG_HUMIDITY" is null))
        ) or snapshotted_data."AVG_PRESSURE" != source_data."AVG_PRESSURE"
        or
        (
            ((snapshotted_data."AVG_PRESSURE" is null) and not (source_data."AVG_PRESSURE" is null))
            or
            ((not snapshotted_data."AVG_PRESSURE" is null) and (source_data."AVG_PRESSURE" is null))
        ) or snapshotted_data."AVG_WIND_SPEED" != source_data."AVG_WIND_SPEED"
        or
        (
            ((snapshotted_data."AVG_WIND_SPEED" is null) and not (source_data."AVG_WIND_SPEED" is null))
            or
            ((not snapshotted_data."AVG_WIND_SPEED" is null) and (source_data."AVG_WIND_SPEED" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CITY_NAME" != source_data."CITY_NAME"
        or
        (
            ((snapshotted_data."CITY_NAME" is null) and not (source_data."CITY_NAME" is null))
            or
            ((not snapshotted_data."CITY_NAME" is null) and (source_data."CITY_NAME" is null))
        ) or snapshotted_data."AVG_TEMP" != source_data."AVG_TEMP"
        or
        (
            ((snapshotted_data."AVG_TEMP" is null) and not (source_data."AVG_TEMP" is null))
            or
            ((not snapshotted_data."AVG_TEMP" is null) and (source_data."AVG_TEMP" is null))
        ) or snapshotted_data."AVG_HUMIDITY" != source_data."AVG_HUMIDITY"
        or
        (
            ((snapshotted_data."AVG_HUMIDITY" is null) and not (source_data."AVG_HUMIDITY" is null))
            or
            ((not snapshotted_data."AVG_HUMIDITY" is null) and (source_data."AVG_HUMIDITY" is null))
        ) or snapshotted_data."AVG_PRESSURE" != source_data."AVG_PRESSURE"
        or
        (
            ((snapshotted_data."AVG_PRESSURE" is null) and not (source_data."AVG_PRESSURE" is null))
            or
            ((not snapshotted_data."AVG_PRESSURE" is null) and (source_data."AVG_PRESSURE" is null))
        ) or snapshotted_data."AVG_WIND_SPEED" != source_data."AVG_WIND_SPEED"
        or
        (
            ((snapshotted_data."AVG_WIND_SPEED" is null) and not (source_data."AVG_WIND_SPEED" is null))
            or
            ((not snapshotted_data."AVG_WIND_SPEED" is null) and (source_data."AVG_WIND_SPEED" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m15:25:31.502575 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.832 seconds
[0m15:25:31.507928 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m15:25:31.508524 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA__dbt_tmp"
[0m15:25:31.600468 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.091 seconds
[0m15:25:31.605784 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m15:25:31.606254 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA"
[0m15:25:31.717358 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.111 seconds
[0m15:25:31.722722 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m15:25:31.723373 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA__dbt_tmp"
[0m15:25:31.797498 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.074 seconds
[0m15:25:31.800137 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m15:25:31.800394 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA"
[0m15:25:31.906037 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.105 seconds
[0m15:25:31.911346 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m15:25:31.911623 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA__dbt_tmp"
[0m15:25:31.996746 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.085 seconds
[0m15:25:32.011239 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m15:25:32.011998 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
select * from (
        

    with snapshot_query as (

        



WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData


    ),

    snapshotted_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CITY_NAME" != source_data."CITY_NAME"
        or
        (
            ((snapshotted_data."CITY_NAME" is null) and not (source_data."CITY_NAME" is null))
            or
            ((not snapshotted_data."CITY_NAME" is null) and (source_data."CITY_NAME" is null))
        ) or snapshotted_data."AVG_TEMP" != source_data."AVG_TEMP"
        or
        (
            ((snapshotted_data."AVG_TEMP" is null) and not (source_data."AVG_TEMP" is null))
            or
            ((not snapshotted_data."AVG_TEMP" is null) and (source_data."AVG_TEMP" is null))
        ) or snapshotted_data."AVG_HUMIDITY" != source_data."AVG_HUMIDITY"
        or
        (
            ((snapshotted_data."AVG_HUMIDITY" is null) and not (source_data."AVG_HUMIDITY" is null))
            or
            ((not snapshotted_data."AVG_HUMIDITY" is null) and (source_data."AVG_HUMIDITY" is null))
        ) or snapshotted_data."AVG_PRESSURE" != source_data."AVG_PRESSURE"
        or
        (
            ((snapshotted_data."AVG_PRESSURE" is null) and not (source_data."AVG_PRESSURE" is null))
            or
            ((not snapshotted_data."AVG_PRESSURE" is null) and (source_data."AVG_PRESSURE" is null))
        ) or snapshotted_data."AVG_WIND_SPEED" != source_data."AVG_WIND_SPEED"
        or
        (
            ((snapshotted_data."AVG_WIND_SPEED" is null) and not (source_data."AVG_WIND_SPEED" is null))
            or
            ((not snapshotted_data."AVG_WIND_SPEED" is null) and (source_data."AVG_WIND_SPEED" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CITY_NAME" != source_data."CITY_NAME"
        or
        (
            ((snapshotted_data."CITY_NAME" is null) and not (source_data."CITY_NAME" is null))
            or
            ((not snapshotted_data."CITY_NAME" is null) and (source_data."CITY_NAME" is null))
        ) or snapshotted_data."AVG_TEMP" != source_data."AVG_TEMP"
        or
        (
            ((snapshotted_data."AVG_TEMP" is null) and not (source_data."AVG_TEMP" is null))
            or
            ((not snapshotted_data."AVG_TEMP" is null) and (source_data."AVG_TEMP" is null))
        ) or snapshotted_data."AVG_HUMIDITY" != source_data."AVG_HUMIDITY"
        or
        (
            ((snapshotted_data."AVG_HUMIDITY" is null) and not (source_data."AVG_HUMIDITY" is null))
            or
            ((not snapshotted_data."AVG_HUMIDITY" is null) and (source_data."AVG_HUMIDITY" is null))
        ) or snapshotted_data."AVG_PRESSURE" != source_data."AVG_PRESSURE"
        or
        (
            ((snapshotted_data."AVG_PRESSURE" is null) and not (source_data."AVG_PRESSURE" is null))
            or
            ((not snapshotted_data."AVG_PRESSURE" is null) and (source_data."AVG_PRESSURE" is null))
        ) or snapshotted_data."AVG_WIND_SPEED" != source_data."AVG_WIND_SPEED"
        or
        (
            ((snapshotted_data."AVG_WIND_SPEED" is null) and not (source_data."AVG_WIND_SPEED" is null))
            or
            ((not snapshotted_data."AVG_WIND_SPEED" is null) and (source_data."AVG_WIND_SPEED" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m15:25:32.260492 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.248 seconds
[0m15:25:32.262450 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m15:25:32.262833 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m15:25:32.344810 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.082 seconds
[0m15:25:32.345835 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_correlation_data"
[0m15:25:32.347403 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m15:25:32.347715 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
BEGIN
[0m15:25:32.487420 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.139 seconds
[0m15:25:32.488375 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m15:25:32.489123 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
merge into "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_NAME", "AVG_TEMP", "AVG_HUMIDITY", "AVG_PRESSURE", "AVG_WIND_SPEED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_NAME", "AVG_TEMP", "AVG_HUMIDITY", "AVG_PRESSURE", "AVG_WIND_SPEED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m15:25:33.036519 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.546 seconds
[0m15:25:33.037886 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m15:25:33.038464 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
COMMIT
[0m15:25:33.448857 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.409 seconds
[0m15:25:33.457349 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: Close
[0m15:25:33.571346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce930733-41d5-40d8-aac4-15cb0405dea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105af5860>]}
[0m15:25:33.572449 [info ] [Thread-1 (]: 2 of 7 OK snapshotted snapshot.snapshot_correlation_data ....................... [[32mSUCCESS 0[0m in 3.68s]
[0m15:25:33.573176 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_correlation_data
[0m15:25:33.573691 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m15:25:33.574340 [info ] [Thread-1 (]: 3 of 7 START snapshot snapshot.snapshot_extreme_weather_events ................. [RUN]
[0m15:25:33.574933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_correlation_data, now snapshot.weather_dbt.snapshot_extreme_weather_events)
[0m15:25:33.575365 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m15:25:33.580593 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m15:25:33.584865 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m15:25:33.585308 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS"
[0m15:25:33.585897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:34.183620 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.598 seconds
[0m15:25:34.188880 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m15:25:34.189273 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME


    ),

    snapshotted_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            DATE_TIME as dbt_updated_at,
            DATE_TIME as dbt_valid_from,
            
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            DATE_TIME as dbt_updated_at,
            DATE_TIME as dbt_valid_from,
            DATE_TIME as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DATE_TIME))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DATE_TIME)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m15:25:35.365265 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.175 seconds
[0m15:25:35.372133 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m15:25:35.372599 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS__dbt_tmp"
[0m15:25:35.489604 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.116 seconds
[0m15:25:35.498118 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m15:25:35.498646 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS"
[0m15:25:35.581456 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.082 seconds
[0m15:25:35.587216 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m15:25:35.587870 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS__dbt_tmp"
[0m15:25:35.686077 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.097 seconds
[0m15:25:35.692186 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m15:25:35.692837 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS"
[0m15:25:35.774355 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.081 seconds
[0m15:25:35.781883 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m15:25:35.782326 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS__dbt_tmp"
[0m15:25:35.862213 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.079 seconds
[0m15:25:35.870645 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m15:25:35.871441 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
select * from (
        

    with snapshot_query as (

        



WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME


    ),

    snapshotted_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            DATE_TIME as dbt_updated_at,
            DATE_TIME as dbt_valid_from,
            
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            DATE_TIME as dbt_updated_at,
            DATE_TIME as dbt_valid_from,
            DATE_TIME as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DATE_TIME))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DATE_TIME)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m15:25:36.109939 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.237 seconds
[0m15:25:36.112811 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m15:25:36.113372 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m15:25:36.191897 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.077 seconds
[0m15:25:36.193326 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m15:25:36.196043 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m15:25:36.196752 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
BEGIN
[0m15:25:36.323210 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.126 seconds
[0m15:25:36.325249 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m15:25:36.325887 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
merge into "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_ID", "CITY_NAME", "DATE_TIME", "TEMP_FAHRENHEIT", "WIND_SPEED", "WEATHER_ALERT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_ID", "CITY_NAME", "DATE_TIME", "TEMP_FAHRENHEIT", "WIND_SPEED", "WEATHER_ALERT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m15:25:37.031980 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b47d-0004-3865-0002-59430003f732
[0m15:25:37.032697 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m15:25:37.033280 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: Close
[0m15:25:37.153687 [debug] [Thread-1 (]: Database Error in snapshot snapshot_extreme_weather_events (snapshots/extreme_weather_events_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/extreme_weather_events_snapshot.sql
[0m15:25:37.154489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce930733-41d5-40d8-aac4-15cb0405dea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd3890>]}
[0m15:25:37.155408 [error] [Thread-1 (]: 3 of 7 ERROR snapshotting snapshot.snapshot_extreme_weather_events ............. [[31mERROR[0m in 3.58s]
[0m15:25:37.156048 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m15:25:37.156474 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_humidity_temp
[0m15:25:37.157730 [info ] [Thread-1 (]: 4 of 7 START snapshot snapshot.snapshot_humidity_temp .......................... [RUN]
[0m15:25:37.158256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_extreme_weather_events, now snapshot.weather_dbt.snapshot_humidity_temp)
[0m15:25:37.158629 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_humidity_temp
[0m15:25:37.162605 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_humidity_temp
[0m15:25:37.170606 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temp"
[0m15:25:37.171008 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temp"} */
select * from (
        



WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT *
FROM HumidityTemp

    ) as __dbt_sbq
    where false
    limit 0
[0m15:25:37.171320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:37.642765 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.471 seconds
[0m15:25:37.647181 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temp"
[0m15:25:37.647783 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temp"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMP"
[0m15:25:37.749175 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.101 seconds
[0m15:25:37.756558 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temp"
[0m15:25:37.757293 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temp"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMP"
[0m15:25:37.863806 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.106 seconds
[0m15:25:37.877218 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temp"
[0m15:25:37.878219 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temp"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMP__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT *
FROM HumidityTemp


    ),

    snapshotted_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMP"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."TEMP_FAHRENHEIT" != source_data."TEMP_FAHRENHEIT"
        or
        (
            ((snapshotted_data."TEMP_FAHRENHEIT" is null) and not (source_data."TEMP_FAHRENHEIT" is null))
            or
            ((not snapshotted_data."TEMP_FAHRENHEIT" is null) and (source_data."TEMP_FAHRENHEIT" is null))
        ) or snapshotted_data."HUMIDITY" != source_data."HUMIDITY"
        or
        (
            ((snapshotted_data."HUMIDITY" is null) and not (source_data."HUMIDITY" is null))
            or
            ((not snapshotted_data."HUMIDITY" is null) and (source_data."HUMIDITY" is null))
        ) or snapshotted_data."CITY_NAME" != source_data."CITY_NAME"
        or
        (
            ((snapshotted_data."CITY_NAME" is null) and not (source_data."CITY_NAME" is null))
            or
            ((not snapshotted_data."CITY_NAME" is null) and (source_data."CITY_NAME" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."TEMP_FAHRENHEIT" != source_data."TEMP_FAHRENHEIT"
        or
        (
            ((snapshotted_data."TEMP_FAHRENHEIT" is null) and not (source_data."TEMP_FAHRENHEIT" is null))
            or
            ((not snapshotted_data."TEMP_FAHRENHEIT" is null) and (source_data."TEMP_FAHRENHEIT" is null))
        ) or snapshotted_data."HUMIDITY" != source_data."HUMIDITY"
        or
        (
            ((snapshotted_data."HUMIDITY" is null) and not (source_data."HUMIDITY" is null))
            or
            ((not snapshotted_data."HUMIDITY" is null) and (source_data."HUMIDITY" is null))
        ) or snapshotted_data."CITY_NAME" != source_data."CITY_NAME"
        or
        (
            ((snapshotted_data."CITY_NAME" is null) and not (source_data."CITY_NAME" is null))
            or
            ((not snapshotted_data."CITY_NAME" is null) and (source_data."CITY_NAME" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m15:26:29.045203 [debug] [MainThread]: Snowflake adapter: Cancelling query 'snapshot.weather_dbt.snapshot_humidity_temp' (661094251405802)
[0m15:26:29.046573 [debug] [MainThread]: Using snowflake connection "master"
[0m15:26:29.047138 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "master"} */
select system$cancel_all_queries(661094251405802)
[0m15:26:29.047500 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:26:29.677254 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.629 seconds
[0m15:26:29.679542 [debug] [MainThread]: Snowflake adapter: Cancel query 'snapshot.weather_dbt.snapshot_humidity_temp': ('1 cancelled. ',)
[0m15:26:29.680430 [error] [MainThread]: CANCEL query snapshot.weather_dbt.snapshot_humidity_temp ....................... [[31mCANCEL[0m]
[0m15:26:29.681027 [debug] [MainThread]: On master: Close
[0m15:26:29.870025 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: None
[0m15:26:29.871407 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000604 (57014): SQL execution canceled
[0m15:26:29.872183 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temp: Close
[0m15:26:29.991273 [debug] [Thread-1 (]: Database Error in snapshot snapshot_humidity_temp (snapshots/humidity_vs_temp_snapshot.sql)
  000604 (57014): SQL execution canceled
[0m15:26:29.991776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce930733-41d5-40d8-aac4-15cb0405dea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e7850>]}
[0m15:26:29.992453 [error] [Thread-1 (]: 4 of 7 ERROR snapshotting snapshot.snapshot_humidity_temp ...................... [[31mERROR[0m in 52.83s]
[0m15:26:29.992946 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_humidity_temp
[0m15:26:29.993317 [info ] [MainThread]: 
[0m15:26:29.993667 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m15:26:29.993894 [info ] [MainThread]: 
[0m15:26:29.994170 [error] [MainThread]:   Database Error in snapshot snapshot_extreme_weather_events (snapshots/extreme_weather_events_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/extreme_weather_events_snapshot.sql
[0m15:26:29.994393 [info ] [MainThread]: 
[0m15:26:29.994611 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m15:26:29.994821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:29.995000 [debug] [MainThread]: Connection 'snapshot.weather_dbt.snapshot_humidity_temp' was properly closed.
[0m15:26:29.995198 [info ] [MainThread]: 
[0m15:26:29.995402 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 1 minutes and 3.68 seconds (63.68s).
[0m15:26:29.995703 [error] [MainThread]: Encountered an error:

[0m15:26:29.998755 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/myenv/lib/python3.13/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/myenv/lib/python3.13/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/myenv/lib/python3.13/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/myenv/lib/python3.13/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/myenv/lib/python3.13/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/myenv/lib/python3.13/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/myenv/lib/python3.13/site-packages/dbt/cli/main.py", line 734, in snapshot
    results = task.run()
  File "/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/myenv/lib/python3.13/site-packages/dbt/task/runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/myenv/lib/python3.13/site-packages/dbt/task/runnable.py", line 487, in execute_with_hooks
    res = self.execute_nodes()
  File "/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/myenv/lib/python3.13/site-packages/dbt/task/runnable.py", line 397, in execute_nodes
    self.run_queue(pool)
    ~~~~~~~~~~~~~~^^^^^^
  File "/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/myenv/lib/python3.13/site-packages/dbt/task/runnable.py", line 315, in run_queue
    self.job_queue.join()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/myenv/lib/python3.13/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/queue.py", line 108, in join
    self.all_tasks_done.wait()
    ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/threading.py", line 359, in wait
    waiter.acquire()
    ~~~~~~~~~~~~~~^^
KeyboardInterrupt

[0m15:26:30.000976 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 64.25512, "process_in_blocks": "0", "process_kernel_time": 0.242289, "process_mem_max_rss": "140034048", "process_out_blocks": "0", "process_user_time": 2.02313}
[0m15:26:30.001416 [debug] [MainThread]: Command `dbt snapshot` failed at 15:26:30.001347 after 64.26 seconds
[0m15:26:30.001682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10478ac80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100addd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a936b0>]}
[0m15:26:30.001922 [debug] [MainThread]: Flushing usage events
[0m15:26:48.456653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ec0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106613b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106613d90>]}


============================== 15:26:48.459433 | a9240fcf-4c0e-4776-a01b-2491be410a60 ==============================
[0m15:26:48.459433 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:26:48.459750 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:26:48.679998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9240fcf-4c0e-4776-a01b-2491be410a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11867ab10>]}
[0m15:26:48.702733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9240fcf-4c0e-4776-a01b-2491be410a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11867c050>]}
[0m15:26:48.704017 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:26:48.764439 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:26:48.845817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:26:48.846033 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:26:48.872684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9240fcf-4c0e-4776-a01b-2491be410a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11856d450>]}
[0m15:26:48.941161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9240fcf-4c0e-4776-a01b-2491be410a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118541400>]}
[0m15:26:48.941437 [info ] [MainThread]: Found 8 models, 7 snapshots, 27 data tests, 2 sources, 459 macros
[0m15:26:48.941612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9240fcf-4c0e-4776-a01b-2491be410a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c567b0>]}
[0m15:26:48.942840 [info ] [MainThread]: 
[0m15:26:48.943128 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:26:48.945224 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m15:26:48.952569 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m15:26:48.952784 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m15:26:48.952920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:49.547454 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.594 seconds
[0m15:26:49.551517 [debug] [ThreadPool]: On list_openweather: Close
[0m15:26:49.695920 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now create_openweather_snapshot)
[0m15:26:49.696831 [debug] [ThreadPool]: Creating schema "database: "openweather"
schema: "snapshot"
"
[0m15:26:49.702916 [debug] [ThreadPool]: Using snowflake connection "create_openweather_snapshot"
[0m15:26:49.703326 [debug] [ThreadPool]: On create_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "create_openweather_snapshot"} */
create schema if not exists openweather.snapshot
[0m15:26:49.703660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:50.282627 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.579 seconds
[0m15:26:50.284039 [debug] [ThreadPool]: On create_openweather_snapshot: Close
[0m15:26:50.431618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_openweather_snapshot, now list_openweather_snapshot)
[0m15:26:50.442025 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m15:26:50.442417 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m15:26:50.442704 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:50.885894 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.443 seconds
[0m15:26:50.891232 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m15:26:51.020713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m15:26:51.023456 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m15:26:51.023845 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m15:26:51.024155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:51.564249 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.540 seconds
[0m15:26:51.567806 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m15:26:51.703843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9240fcf-4c0e-4776-a01b-2491be410a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c2da50>]}
[0m15:26:51.704729 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m15:26:51.705201 [info ] [MainThread]: 
[0m15:26:51.708545 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_cloud_coverage
[0m15:26:51.709196 [info ] [Thread-1 (]: 1 of 7 START snapshot snapshot.snapshot_cloud_coverage ......................... [RUN]
[0m15:26:51.709691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now snapshot.weather_dbt.snapshot_cloud_coverage)
[0m15:26:51.710240 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_cloud_coverage
[0m15:26:51.721224 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_cloud_coverage
[0m15:26:51.770295 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m15:26:51.770629 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id,
        DAY as dbt_updated_at,
        DAY as dbt_valid_from,
        
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
from (
        



WITH CloudCoverage AS (
    SELECT 
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m15:26:51.770836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:52.220345 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.449 seconds
[0m15:26:52.231011 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m15:26:52.231661 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m15:26:52.330329 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.098 seconds
[0m15:26:52.331135 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m15:26:52.333047 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m15:26:52.333461 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
create or replace transient table openweather.snapshot.snapshot_cloud_coverage
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id,
        DAY as dbt_updated_at,
        DAY as dbt_valid_from,
        
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
from (
        



WITH CloudCoverage AS (
    SELECT 
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY

    ) sbq



        );
[0m15:26:53.430350 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.096 seconds
[0m15:26:53.452609 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: Close
[0m15:26:53.602634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9240fcf-4c0e-4776-a01b-2491be410a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f3db50>]}
[0m15:26:53.604288 [info ] [Thread-1 (]: 1 of 7 OK snapshotted snapshot.snapshot_cloud_coverage ......................... [[32mSUCCESS 1[0m in 1.89s]
[0m15:26:53.605565 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_cloud_coverage
[0m15:26:53.606250 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_correlation_data
[0m15:26:53.606979 [info ] [Thread-1 (]: 2 of 7 START snapshot snapshot.snapshot_correlation_data ....................... [RUN]
[0m15:26:53.607627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_cloud_coverage, now snapshot.weather_dbt.snapshot_correlation_data)
[0m15:26:53.608071 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_correlation_data
[0m15:26:53.612532 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_correlation_data
[0m15:26:53.631303 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m15:26:53.631799 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m15:26:53.632023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:54.045790 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.413 seconds
[0m15:26:54.047816 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m15:26:54.048279 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m15:26:54.121905 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.073 seconds
[0m15:26:54.123337 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_correlation_data"
[0m15:26:54.126840 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m15:26:54.127549 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
create or replace transient table openweather.snapshot.snapshot_correlation_data
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData

    ) sbq



        );
[0m15:26:54.857520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.729 seconds
[0m15:26:54.862936 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: Close
[0m15:26:55.010581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9240fcf-4c0e-4776-a01b-2491be410a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118ff3c20>]}
[0m15:26:55.011484 [info ] [Thread-1 (]: 2 of 7 OK snapshotted snapshot.snapshot_correlation_data ....................... [[32mSUCCESS 1[0m in 1.40s]
[0m15:26:55.012302 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_correlation_data
[0m15:26:55.013065 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m15:26:55.013595 [info ] [Thread-1 (]: 3 of 7 START snapshot snapshot.snapshot_extreme_weather_events ................. [RUN]
[0m15:26:55.013893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_correlation_data, now snapshot.weather_dbt.snapshot_extreme_weather_events)
[0m15:26:55.014082 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m15:26:55.018652 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m15:26:55.023224 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m15:26:55.023923 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m15:26:55.024602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:55.473926 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.449 seconds
[0m15:26:55.477677 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m15:26:55.478317 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m15:26:55.554922 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.076 seconds
[0m15:26:55.557063 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m15:26:55.559996 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m15:26:55.560613 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
create or replace transient table openweather.snapshot.snapshot_extreme_weather_events
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME

    ) sbq



        );
[0m15:26:56.389542 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.828 seconds
[0m15:26:56.392934 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: Close
[0m15:26:56.501658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9240fcf-4c0e-4776-a01b-2491be410a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10052f610>]}
[0m15:26:56.502997 [info ] [Thread-1 (]: 3 of 7 OK snapshotted snapshot.snapshot_extreme_weather_events ................. [[32mSUCCESS 1[0m in 1.49s]
[0m15:26:56.503711 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m15:26:56.504191 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_humidity_temp
[0m15:26:56.504775 [info ] [Thread-1 (]: 4 of 7 START snapshot snapshot.snapshot_humidity_temp .......................... [RUN]
[0m15:26:56.505322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_extreme_weather_events, now snapshot.weather_dbt.snapshot_humidity_temp)
[0m15:26:56.505724 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_humidity_temp
[0m15:26:56.509895 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_humidity_temp
[0m15:26:56.515127 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temp"
[0m15:26:56.515635 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temp"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temp"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT *
FROM HumidityTemp

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m15:26:56.516002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:56.975078 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.459 seconds
[0m15:26:56.977135 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temp"
[0m15:26:56.977625 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temp"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temp"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m15:26:57.096587 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.118 seconds
[0m15:26:57.097692 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_humidity_temp"
[0m15:26:57.100488 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temp"
[0m15:26:57.101268 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temp"} */
create or replace transient table openweather.snapshot.snapshot_humidity_temp
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT *
FROM HumidityTemp

    ) sbq



        );
[0m15:26:58.285532 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.183 seconds
[0m15:26:58.292352 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temp: Close
[0m15:26:58.434243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9240fcf-4c0e-4776-a01b-2491be410a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1186fda50>]}
[0m15:26:58.435374 [info ] [Thread-1 (]: 4 of 7 OK snapshotted snapshot.snapshot_humidity_temp .......................... [[32mSUCCESS 1[0m in 1.93s]
[0m15:26:58.436004 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_humidity_temp
[0m15:26:58.436433 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_temp_trends
[0m15:26:58.436854 [info ] [Thread-1 (]: 5 of 7 START snapshot snapshot.snapshot_temp_trends ............................ [RUN]
[0m15:26:58.437279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_humidity_temp, now snapshot.weather_dbt.snapshot_temp_trends)
[0m15:26:58.437612 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_temp_trends
[0m15:26:58.441212 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_temp_trends
[0m15:26:58.445735 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m15:26:58.446199 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id,
        DAY as dbt_updated_at,
        DAY as dbt_valid_from,
        
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
from (
        



WITH TempTrends AS (
    SELECT 
        "Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m15:26:58.446654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:58.907560 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.460 seconds
[0m15:26:58.909876 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m15:26:58.910438 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m15:26:58.992167 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.081 seconds
[0m15:26:58.994182 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_temp_trends"
[0m15:26:58.997010 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m15:26:58.997665 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
create or replace transient table openweather.snapshot.snapshot_temp_trends
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id,
        DAY as dbt_updated_at,
        DAY as dbt_valid_from,
        
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
from (
        



WITH TempTrends AS (
    SELECT 
        "Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY

    ) sbq



        );
[0m15:26:59.773051 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.775 seconds
[0m15:26:59.776736 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: Close
[0m15:26:59.905663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9240fcf-4c0e-4776-a01b-2491be410a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dfc8a0>]}
[0m15:26:59.906886 [info ] [Thread-1 (]: 5 of 7 OK snapshotted snapshot.snapshot_temp_trends ............................ [[32mSUCCESS 1[0m in 1.47s]
[0m15:26:59.907561 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_temp_trends
[0m15:26:59.908000 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_weather_distribution
[0m15:26:59.908415 [info ] [Thread-1 (]: 6 of 7 START snapshot snapshot.snapshot_weather_distribution ................... [RUN]
[0m15:26:59.908969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_temp_trends, now snapshot.weather_dbt.snapshot_weather_distribution)
[0m15:26:59.909411 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_weather_distribution
[0m15:26:59.913628 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_weather_distribution
[0m15:26:59.923928 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m15:26:59.924449 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, 3
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m15:26:59.924818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:00.427724 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.502 seconds
[0m15:27:00.432257 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m15:27:00.433299 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m15:27:00.532955 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.099 seconds
[0m15:27:00.533822 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_weather_distribution"
[0m15:27:00.535757 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m15:27:00.536098 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
create or replace transient table openweather.snapshot.snapshot_weather_distribution
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, 3
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC

    ) sbq



        );
[0m15:27:01.322509 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.785 seconds
[0m15:27:01.326536 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: Close
[0m15:27:01.449289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9240fcf-4c0e-4776-a01b-2491be410a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f6fd70>]}
[0m15:27:01.450810 [info ] [Thread-1 (]: 6 of 7 OK snapshotted snapshot.snapshot_weather_distribution ................... [[32mSUCCESS 1[0m in 1.54s]
[0m15:27:01.451751 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_weather_distribution
[0m15:27:01.452259 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_wind_speed_data
[0m15:27:01.452886 [info ] [Thread-1 (]: 7 of 7 START snapshot snapshot.snapshot_wind_speed_data ........................ [RUN]
[0m15:27:01.453536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_weather_distribution, now snapshot.weather_dbt.snapshot_wind_speed_data)
[0m15:27:01.453980 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_wind_speed_data
[0m15:27:01.458584 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_wind_speed_data
[0m15:27:01.464687 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed_data"
[0m15:27:01.465139 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed_data"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed_data"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL 
)
SELECT *
FROM WindSpeedData

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m15:27:01.465507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:01.964482 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.498 seconds
[0m15:27:01.968102 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed_data"
[0m15:27:01.968724 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed_data"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed_data"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m15:27:02.088846 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.119 seconds
[0m15:27:02.090590 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_wind_speed_data"
[0m15:27:02.092532 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed_data"
[0m15:27:02.092830 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed_data"} */
create or replace transient table openweather.snapshot.snapshot_wind_speed_data
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL 
)
SELECT *
FROM WindSpeedData

    ) sbq



        );
[0m15:27:03.149447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.056 seconds
[0m15:27:03.152613 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed_data: Close
[0m15:27:03.272434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9240fcf-4c0e-4776-a01b-2491be410a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118fe6ff0>]}
[0m15:27:03.273495 [info ] [Thread-1 (]: 7 of 7 OK snapshotted snapshot.snapshot_wind_speed_data ........................ [[32mSUCCESS 1[0m in 1.82s]
[0m15:27:03.274226 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_wind_speed_data
[0m15:27:03.275760 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:27:03.276090 [debug] [MainThread]: Connection 'snapshot.weather_dbt.snapshot_wind_speed_data' was properly closed.
[0m15:27:03.276439 [info ] [MainThread]: 
[0m15:27:03.276775 [info ] [MainThread]: Finished running 7 snapshots in 0 hours 0 minutes and 14.33 seconds (14.33s).
[0m15:27:03.278156 [debug] [MainThread]: Command end result
[0m15:27:03.308193 [info ] [MainThread]: 
[0m15:27:03.308554 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:27:03.308766 [info ] [MainThread]: 
[0m15:27:03.308969 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m15:27:03.310621 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 14.887511, "process_in_blocks": "0", "process_kernel_time": 0.294788, "process_mem_max_rss": "138395648", "process_out_blocks": "0", "process_user_time": 1.954119}
[0m15:27:03.311056 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:27:03.310989 after 14.89 seconds
[0m15:27:03.311297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105304170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f6fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f6f290>]}
[0m15:27:03.311528 [debug] [MainThread]: Flushing usage events
[0m15:27:10.394046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102618d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f1bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f1bd90>]}


============================== 15:27:10.396313 | 7b0c7a02-aae0-4adf-8875-d2bf74691276 ==============================
[0m15:27:10.396313 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:27:10.396642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m15:27:10.562072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b0c7a02-aae0-4adf-8875-d2bf74691276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b66d70>]}
[0m15:27:10.584764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b0c7a02-aae0-4adf-8875-d2bf74691276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b68050>]}
[0m15:27:10.585169 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:27:10.639694 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:27:10.714858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:27:10.715088 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:27:10.741991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b0c7a02-aae0-4adf-8875-d2bf74691276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e9450>]}
[0m15:27:10.751986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b0c7a02-aae0-4adf-8875-d2bf74691276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f17020>]}
[0m15:27:10.752277 [info ] [MainThread]: Found 8 models, 7 snapshots, 27 data tests, 2 sources, 459 macros
[0m15:27:10.752478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b0c7a02-aae0-4adf-8875-d2bf74691276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104deab30>]}
[0m15:27:10.754089 [info ] [MainThread]: 
[0m15:27:10.754396 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:27:10.756797 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_snapshot'
[0m15:27:10.766955 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m15:27:10.767294 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m15:27:10.767455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:11.282548 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.515 seconds
[0m15:27:11.286183 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m15:27:11.407054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m15:27:11.411792 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m15:27:11.412174 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m15:27:11.412487 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:11.928363 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.515 seconds
[0m15:27:11.932067 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m15:27:12.051721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b0c7a02-aae0-4adf-8875-d2bf74691276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104face20>]}
[0m15:27:12.052396 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m15:27:12.052713 [info ] [MainThread]: 
[0m15:27:12.055936 [debug] [Thread-1 (]: Began running node model.weather_dbt.cloud_coverage_over_time
[0m15:27:12.056458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.cloud_coverage_over_time)
[0m15:27:12.056846 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.cloud_coverage_over_time
[0m15:27:12.072451 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.cloud_coverage_over_time"
[0m15:27:12.073843 [debug] [Thread-1 (]: Began executing node model.weather_dbt.cloud_coverage_over_time
[0m15:27:12.074598 [debug] [Thread-1 (]: Finished running node model.weather_dbt.cloud_coverage_over_time
[0m15:27:12.074953 [debug] [Thread-1 (]: Began running node model.weather_dbt.correlation
[0m15:27:12.075521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.cloud_coverage_over_time, now model.weather_dbt.correlation)
[0m15:27:12.076016 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.correlation
[0m15:27:12.078629 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.correlation"
[0m15:27:12.079252 [debug] [Thread-1 (]: Began executing node model.weather_dbt.correlation
[0m15:27:12.079768 [debug] [Thread-1 (]: Finished running node model.weather_dbt.correlation
[0m15:27:12.080063 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m15:27:12.080630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.correlation, now model.weather_dbt.extreme_weather_events)
[0m15:27:12.081083 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m15:27:12.083153 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m15:27:12.083668 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m15:27:12.084118 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m15:27:12.084365 [debug] [Thread-1 (]: Began running node model.weather_dbt.humidity_vs_temp
[0m15:27:12.084697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.humidity_vs_temp)
[0m15:27:12.128983 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.humidity_vs_temp
[0m15:27:12.130692 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.humidity_vs_temp"
[0m15:27:12.131267 [debug] [Thread-1 (]: Began executing node model.weather_dbt.humidity_vs_temp
[0m15:27:12.131674 [debug] [Thread-1 (]: Finished running node model.weather_dbt.humidity_vs_temp
[0m15:27:12.131866 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m15:27:12.132161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.humidity_vs_temp, now model.weather_dbt.openweather_join)
[0m15:27:12.132389 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m15:27:12.133800 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m15:27:12.134268 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m15:27:12.134621 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m15:27:12.134802 [debug] [Thread-1 (]: Began running node model.weather_dbt.temp_trends_by_city
[0m15:27:12.135017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.temp_trends_by_city)
[0m15:27:12.135214 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.temp_trends_by_city
[0m15:27:12.136723 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.temp_trends_by_city"
[0m15:27:12.137043 [debug] [Thread-1 (]: Began executing node model.weather_dbt.temp_trends_by_city
[0m15:27:12.137352 [debug] [Thread-1 (]: Finished running node model.weather_dbt.temp_trends_by_city
[0m15:27:12.137540 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_cond_distribution
[0m15:27:12.137725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.temp_trends_by_city, now model.weather_dbt.weather_cond_distribution)
[0m15:27:12.137901 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_cond_distribution
[0m15:27:12.139070 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_cond_distribution"
[0m15:27:12.139342 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_cond_distribution
[0m15:27:12.139610 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_cond_distribution
[0m15:27:12.139771 [debug] [Thread-1 (]: Began running node model.weather_dbt.wind_speed_analysis
[0m15:27:12.139936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.weather_cond_distribution, now model.weather_dbt.wind_speed_analysis)
[0m15:27:12.140098 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.wind_speed_analysis
[0m15:27:12.141272 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.wind_speed_analysis"
[0m15:27:12.141535 [debug] [Thread-1 (]: Began executing node model.weather_dbt.wind_speed_analysis
[0m15:27:12.141798 [debug] [Thread-1 (]: Finished running node model.weather_dbt.wind_speed_analysis
[0m15:27:12.141967 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_cloud_coverage
[0m15:27:12.142134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.wind_speed_analysis, now snapshot.weather_dbt.snapshot_cloud_coverage)
[0m15:27:12.142291 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_cloud_coverage
[0m15:27:12.144302 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_cloud_coverage
[0m15:27:12.144680 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_cloud_coverage
[0m15:27:12.144862 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_correlation_data
[0m15:27:12.145108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_cloud_coverage, now snapshot.weather_dbt.snapshot_correlation_data)
[0m15:27:12.145369 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_correlation_data
[0m15:27:12.147188 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_correlation_data
[0m15:27:12.147573 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_correlation_data
[0m15:27:12.147775 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m15:27:12.147968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_correlation_data, now snapshot.weather_dbt.snapshot_extreme_weather_events)
[0m15:27:12.148128 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m15:27:12.149852 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m15:27:12.150236 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m15:27:12.150437 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_humidity_temp
[0m15:27:12.150625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_extreme_weather_events, now snapshot.weather_dbt.snapshot_humidity_temp)
[0m15:27:12.150864 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_humidity_temp
[0m15:27:12.153029 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_humidity_temp
[0m15:27:12.153422 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_humidity_temp
[0m15:27:12.153614 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_temp_trends
[0m15:27:12.153875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_humidity_temp, now snapshot.weather_dbt.snapshot_temp_trends)
[0m15:27:12.154101 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_temp_trends
[0m15:27:12.155700 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_temp_trends
[0m15:27:12.156005 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_temp_trends
[0m15:27:12.156185 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_weather_distribution
[0m15:27:12.156412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_temp_trends, now snapshot.weather_dbt.snapshot_weather_distribution)
[0m15:27:12.156591 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_weather_distribution
[0m15:27:12.158066 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_weather_distribution
[0m15:27:12.158406 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_weather_distribution
[0m15:27:12.158594 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_wind_speed_data
[0m15:27:12.158758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_weather_distribution, now snapshot.weather_dbt.snapshot_wind_speed_data)
[0m15:27:12.158912 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_wind_speed_data
[0m15:27:12.160621 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_wind_speed_data
[0m15:27:12.160925 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_wind_speed_data
[0m15:27:12.161109 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m15:27:12.161298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_wind_speed_data, now test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86)
[0m15:27:12.161461 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m15:27:12.167350 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m15:27:12.167868 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m15:27:12.168204 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m15:27:12.168419 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m15:27:12.168585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86, now test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f)
[0m15:27:12.168744 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m15:27:12.170764 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m15:27:12.171221 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m15:27:12.171621 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m15:27:12.171810 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m15:27:12.172004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f, now test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9)
[0m15:27:12.172179 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m15:27:12.174037 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m15:27:12.174380 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m15:27:12.174674 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m15:27:12.174850 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m15:27:12.175035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9, now test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d)
[0m15:27:12.175208 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m15:27:12.176896 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m15:27:12.177215 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m15:27:12.177502 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m15:27:12.177675 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m15:27:12.177847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d, now test.weather_dbt.not_null_correlation_avg_pressure.46419021da)
[0m15:27:12.177994 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m15:27:12.179990 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m15:27:12.180561 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m15:27:12.180892 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m15:27:12.181079 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m15:27:12.181250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_pressure.46419021da, now test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61)
[0m15:27:12.181443 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m15:27:12.183248 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m15:27:12.183627 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m15:27:12.183938 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m15:27:12.184121 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m15:27:12.184288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61, now test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9)
[0m15:27:12.184461 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m15:27:12.186384 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m15:27:12.186700 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m15:27:12.186996 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m15:27:12.187167 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m15:27:12.187339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9, now test.weather_dbt.not_null_correlation_city_name.d4bb85e888)
[0m15:27:12.187490 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m15:27:12.189110 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m15:27:12.189402 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m15:27:12.189677 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m15:27:12.189847 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m15:27:12.190014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_city_name.d4bb85e888, now test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4)
[0m15:27:12.190158 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m15:27:12.191773 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m15:27:12.192113 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m15:27:12.192416 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m15:27:12.192598 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m15:27:12.192781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4, now test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589)
[0m15:27:12.192939 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m15:27:12.194947 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m15:27:12.195291 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m15:27:12.195584 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m15:27:12.195754 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m15:27:12.195927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589, now test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853)
[0m15:27:12.196079 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m15:27:12.197685 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m15:27:12.197962 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m15:27:12.198241 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m15:27:12.198409 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m15:27:12.198576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853, now test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d)
[0m15:27:12.198725 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m15:27:12.200583 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m15:27:12.200881 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m15:27:12.201162 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m15:27:12.201339 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m15:27:12.201517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d, now test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb)
[0m15:27:12.201669 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m15:27:12.203318 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m15:27:12.203662 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m15:27:12.203969 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m15:27:12.204145 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m15:27:12.204334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb, now test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4)
[0m15:27:12.204492 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m15:27:12.206220 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m15:27:12.206547 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m15:27:12.206831 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m15:27:12.206998 [debug] [Thread-1 (]: Began running node test.weather_dbt.valid_temp
[0m15:27:12.207178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4, now test.weather_dbt.valid_temp)
[0m15:27:12.207344 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.valid_temp
[0m15:27:12.208680 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.valid_temp"
[0m15:27:12.208985 [debug] [Thread-1 (]: Began executing node test.weather_dbt.valid_temp
[0m15:27:12.209267 [debug] [Thread-1 (]: Finished running node test.weather_dbt.valid_temp
[0m15:27:12.209432 [debug] [Thread-1 (]: Began running node test.weather_dbt.weather_alert_consistency
[0m15:27:12.209597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.valid_temp, now test.weather_dbt.weather_alert_consistency)
[0m15:27:12.209738 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.weather_alert_consistency
[0m15:27:12.210760 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.weather_alert_consistency"
[0m15:27:12.211035 [debug] [Thread-1 (]: Began executing node test.weather_dbt.weather_alert_consistency
[0m15:27:12.211312 [debug] [Thread-1 (]: Finished running node test.weather_dbt.weather_alert_consistency
[0m15:27:12.211481 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m15:27:12.211648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.weather_alert_consistency, now test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042)
[0m15:27:12.211794 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m15:27:12.213431 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m15:27:12.213702 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m15:27:12.213970 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m15:27:12.214134 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m15:27:12.214304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042, now test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573)
[0m15:27:12.214447 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m15:27:12.216442 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m15:27:12.216790 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m15:27:12.217079 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m15:27:12.217259 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m15:27:12.217501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573, now test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5)
[0m15:27:12.217679 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m15:27:12.219367 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m15:27:12.219671 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m15:27:12.219948 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m15:27:12.220119 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m15:27:12.220291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5, now test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae)
[0m15:27:12.220441 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m15:27:12.223430 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m15:27:12.223741 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m15:27:12.224032 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m15:27:12.224200 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m15:27:12.224367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae, now test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b)
[0m15:27:12.224515 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m15:27:12.226143 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m15:27:12.226436 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m15:27:12.226708 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m15:27:12.226869 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m15:27:12.227033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b, now test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019)
[0m15:27:12.227179 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m15:27:12.228898 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m15:27:12.229209 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m15:27:12.229500 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m15:27:12.229684 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m15:27:12.229863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019, now test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec)
[0m15:27:12.230024 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m15:27:12.232042 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m15:27:12.232380 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m15:27:12.232673 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m15:27:12.232841 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m15:27:12.233008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec, now test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4)
[0m15:27:12.233159 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m15:27:12.234773 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m15:27:12.235057 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m15:27:12.235350 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m15:27:12.235530 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m15:27:12.235696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4, now test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6)
[0m15:27:12.235846 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m15:27:12.237455 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m15:27:12.237744 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m15:27:12.238018 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m15:27:12.238188 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m15:27:12.238358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6, now test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9)
[0m15:27:12.238518 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m15:27:12.240423 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m15:27:12.240838 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m15:27:12.241305 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m15:27:12.241547 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m15:27:12.241759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9, now test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2)
[0m15:27:12.241926 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m15:27:12.243701 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m15:27:12.244021 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m15:27:12.244326 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m15:27:12.244824 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:27:12.244994 [debug] [MainThread]: Connection 'test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2' was properly closed.
[0m15:27:12.247364 [debug] [MainThread]: Command end result
[0m15:27:12.309673 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m15:27:12.309898 [info ] [MainThread]: Building catalog
[0m15:27:12.315180 [debug] [ThreadPool]: Acquiring new snowflake connection 'openweather.information_schema'
[0m15:27:12.324786 [debug] [ThreadPool]: Using snowflake connection "openweather.information_schema"
[0m15:27:12.325323 [debug] [ThreadPool]: On openweather.information_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "openweather.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from openweather.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_correlation_data' and upper("table_name") = upper('snapshot_correlation_data')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'humidity_vs_temp' and upper("table_name") = upper('humidity_vs_temp')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'extreme_weather_events' and upper("table_name") = upper('extreme_weather_events')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'weather_cond_distribution' and upper("table_name") = upper('weather_cond_distribution')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_temp_trends' and upper("table_name") = upper('snapshot_temp_trends')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'cloud_coverage_over_time' and upper("table_name") = upper('cloud_coverage_over_time')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'correlation' and upper("table_name") = upper('correlation')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_wind_speed_data' and upper("table_name") = upper('snapshot_wind_speed_data')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'wind_speed_analysis' and upper("table_name") = upper('wind_speed_analysis')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'openweather_join' and upper("table_name") = upper('openweather_join')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_weather_distribution' and upper("table_name") = upper('snapshot_weather_distribution')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'temp_trends_by_city' and upper("table_name") = upper('temp_trends_by_city')

                )
             or 
                (
                    
    "table_schema" ilike 'raw_data' and upper("table_schema") = upper('raw_data')

                    and 
    "table_name" ilike 'CITY_DIMENSION_TABLE' and upper("table_name") = upper('CITY_DIMENSION_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_cloud_coverage' and upper("table_name") = upper('snapshot_cloud_coverage')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_extreme_weather_events' and upper("table_name") = upper('snapshot_extreme_weather_events')

                )
             or 
                (
                    
    "table_schema" ilike 'raw_data' and upper("table_schema") = upper('raw_data')

                    and 
    "table_name" ilike 'WEATHER_FACT_TABLE' and upper("table_name") = upper('WEATHER_FACT_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_humidity_temp' and upper("table_name") = upper('snapshot_humidity_temp')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from openweather.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_correlation_data' and upper("table_name") = upper('snapshot_correlation_data')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'humidity_vs_temp' and upper("table_name") = upper('humidity_vs_temp')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'extreme_weather_events' and upper("table_name") = upper('extreme_weather_events')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'weather_cond_distribution' and upper("table_name") = upper('weather_cond_distribution')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_temp_trends' and upper("table_name") = upper('snapshot_temp_trends')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'cloud_coverage_over_time' and upper("table_name") = upper('cloud_coverage_over_time')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'correlation' and upper("table_name") = upper('correlation')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_wind_speed_data' and upper("table_name") = upper('snapshot_wind_speed_data')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'wind_speed_analysis' and upper("table_name") = upper('wind_speed_analysis')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'openweather_join' and upper("table_name") = upper('openweather_join')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_weather_distribution' and upper("table_name") = upper('snapshot_weather_distribution')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'temp_trends_by_city' and upper("table_name") = upper('temp_trends_by_city')

                )
             or 
                (
                    
    "table_schema" ilike 'raw_data' and upper("table_schema") = upper('raw_data')

                    and 
    "table_name" ilike 'CITY_DIMENSION_TABLE' and upper("table_name") = upper('CITY_DIMENSION_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_cloud_coverage' and upper("table_name") = upper('snapshot_cloud_coverage')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_extreme_weather_events' and upper("table_name") = upper('snapshot_extreme_weather_events')

                )
             or 
                (
                    
    "table_schema" ilike 'raw_data' and upper("table_schema") = upper('raw_data')

                    and 
    "table_name" ilike 'WEATHER_FACT_TABLE' and upper("table_name") = upper('WEATHER_FACT_TABLE')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_humidity_temp' and upper("table_name") = upper('snapshot_humidity_temp')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m15:27:12.325976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:17.933980 [debug] [ThreadPool]: SQL status: SUCCESS 105 in 5.608 seconds
[0m15:27:17.956196 [debug] [ThreadPool]: On openweather.information_schema: Close
[0m15:27:18.120994 [info ] [MainThread]: Catalog written to /Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/target/catalog.json
[0m15:27:18.122886 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 7.7607985, "process_in_blocks": "0", "process_kernel_time": 0.201735, "process_mem_max_rss": "140607488", "process_out_blocks": "0", "process_user_time": 1.351145}
[0m15:27:18.123237 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:27:18.123181 after 7.76 seconds
[0m15:27:18.123410 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:27:18.123532 [debug] [MainThread]: Connection 'openweather.information_schema' was properly closed.
[0m15:27:18.123699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cd5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051f7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051f7750>]}
[0m15:27:18.123872 [debug] [MainThread]: Flushing usage events
[0m15:27:26.072098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b30d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108433b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108433d90>]}


============================== 15:27:26.074398 | 9b4920fd-0b28-42e4-9825-5e3209f0d3b0 ==============================
[0m15:27:26.074398 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:27:26.074726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:27:26.129320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b4920fd-0b28-42e4-9825-5e3209f0d3b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10729f360>]}
[0m15:27:26.140957 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.102345586, "process_in_blocks": "0", "process_kernel_time": 0.10432, "process_mem_max_rss": "99090432", "process_out_blocks": "0", "process_user_time": 0.612658}
[0m15:27:26.141326 [debug] [MainThread]: Command `dbt clean` succeeded at 15:27:26.141268 after 0.10 seconds
[0m15:27:26.141518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10855e580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10855e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081c6950>]}
[0m15:27:26.141688 [debug] [MainThread]: Flushing usage events
[0m17:38:22.828260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104850d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10617bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10617bd90>]}


============================== 17:38:22.831092 | 6400f081-b320-4d5e-8c0a-4d47fdfbad32 ==============================
[0m17:38:22.831092 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:38:22.831407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:38:23.063711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6400f081-b320-4d5e-8c0a-4d47fdfbad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc6b10>]}
[0m17:38:23.088164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6400f081-b320-4d5e-8c0a-4d47fdfbad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc8050>]}
[0m17:38:23.088853 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:38:23.149069 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:38:23.149622 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:38:23.149815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6400f081-b320-4d5e-8c0a-4d47fdfbad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c4ca50>]}
[0m17:38:23.739311 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:38:23.739629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6400f081-b320-4d5e-8c0a-4d47fdfbad32', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070477a0>]}
[0m17:38:23.883281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6400f081-b320-4d5e-8c0a-4d47fdfbad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107095010>]}
[0m17:38:23.952649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6400f081-b320-4d5e-8c0a-4d47fdfbad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a6c30>]}
[0m17:38:23.952930 [info ] [MainThread]: Found 8 models, 7 snapshots, 27 data tests, 2 sources, 459 macros
[0m17:38:23.953102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6400f081-b320-4d5e-8c0a-4d47fdfbad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10751a5d0>]}
[0m17:38:23.954300 [info ] [MainThread]: 
[0m17:38:23.954584 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:38:23.956706 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m17:38:23.963552 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m17:38:23.963786 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m17:38:23.963928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:24.692501 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.728 seconds
[0m17:38:24.695845 [debug] [ThreadPool]: On list_openweather: Close
[0m17:38:24.823095 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_snapshot)
[0m17:38:24.833641 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m17:38:24.834036 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m17:38:24.834341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:25.398067 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.564 seconds
[0m17:38:25.401671 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m17:38:25.543942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m17:38:25.548187 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m17:38:25.548557 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m17:38:25.548867 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:26.107822 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.559 seconds
[0m17:38:26.111456 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m17:38:26.249628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6400f081-b320-4d5e-8c0a-4d47fdfbad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075315a0>]}
[0m17:38:26.250437 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m17:38:26.250852 [info ] [MainThread]: 
[0m17:38:26.255487 [debug] [Thread-1 (]: Began running node model.weather_dbt.cloud_coverage_over_time
[0m17:38:26.256090 [info ] [Thread-1 (]: 1 of 8 START sql table model analytics.cloud_coverage_over_time ................ [RUN]
[0m17:38:26.256544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now model.weather_dbt.cloud_coverage_over_time)
[0m17:38:26.257353 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.cloud_coverage_over_time
[0m17:38:26.265172 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.cloud_coverage_over_time"
[0m17:38:26.267108 [debug] [Thread-1 (]: Began executing node model.weather_dbt.cloud_coverage_over_time
[0m17:38:26.289648 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.cloud_coverage_over_time"
[0m17:38:26.291049 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.cloud_coverage_over_time"
[0m17:38:26.291313 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.cloud_coverage_over_time"} */
create or replace transient table openweather.analytics.cloud_coverage_over_time
         as
        (WITH CloudCoverage AS (
    SELECT 
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY
        );
[0m17:38:26.291540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:27.410910 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.119 seconds
[0m17:38:27.424894 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: Close
[0m17:38:27.550938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6400f081-b320-4d5e-8c0a-4d47fdfbad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10573fa70>]}
[0m17:38:27.551698 [info ] [Thread-1 (]: 1 of 8 OK created sql table model analytics.cloud_coverage_over_time ........... [[32mSUCCESS 1[0m in 1.29s]
[0m17:38:27.552397 [debug] [Thread-1 (]: Finished running node model.weather_dbt.cloud_coverage_over_time
[0m17:38:27.552906 [debug] [Thread-1 (]: Began running node model.weather_dbt.correlation
[0m17:38:27.553565 [info ] [Thread-1 (]: 2 of 8 START sql table model analytics.correlation ............................. [RUN]
[0m17:38:27.554123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.cloud_coverage_over_time, now model.weather_dbt.correlation)
[0m17:38:27.554488 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.correlation
[0m17:38:27.557471 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.correlation"
[0m17:38:27.558537 [debug] [Thread-1 (]: Began executing node model.weather_dbt.correlation
[0m17:38:27.565568 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.correlation"
[0m17:38:27.566983 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.correlation"
[0m17:38:27.567296 [debug] [Thread-1 (]: On model.weather_dbt.correlation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.correlation"} */
create or replace transient table openweather.analytics.correlation
         as
        (WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData
        );
[0m17:38:27.567573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:28.806881 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.239 seconds
[0m17:38:28.811175 [debug] [Thread-1 (]: On model.weather_dbt.correlation: Close
[0m17:38:28.971814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6400f081-b320-4d5e-8c0a-4d47fdfbad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10776c5d0>]}
[0m17:38:28.972247 [info ] [Thread-1 (]: 2 of 8 OK created sql table model analytics.correlation ........................ [[32mSUCCESS 1[0m in 1.42s]
[0m17:38:28.972540 [debug] [Thread-1 (]: Finished running node model.weather_dbt.correlation
[0m17:38:28.972752 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m17:38:28.973052 [info ] [Thread-1 (]: 3 of 8 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m17:38:28.973310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.correlation, now model.weather_dbt.extreme_weather_events)
[0m17:38:28.973502 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m17:38:28.975115 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m17:38:28.975650 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m17:38:28.977164 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m17:38:28.977977 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m17:38:28.978191 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT *
FROM Extreme_Weather_Events
ORDER BY DATE_TIME, CITY_NAME
        );
[0m17:38:28.978385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:30.350278 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.371 seconds
[0m17:38:30.355330 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m17:38:30.496201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6400f081-b320-4d5e-8c0a-4d47fdfbad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047b48a0>]}
[0m17:38:30.497173 [info ] [Thread-1 (]: 3 of 8 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.52s]
[0m17:38:30.497871 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m17:38:30.498351 [debug] [Thread-1 (]: Began running node model.weather_dbt.humidity_vs_temp
[0m17:38:30.498795 [info ] [Thread-1 (]: 4 of 8 START sql table model analytics.humidity_vs_temp ........................ [RUN]
[0m17:38:30.499292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.humidity_vs_temp)
[0m17:38:30.499770 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.humidity_vs_temp
[0m17:38:30.503199 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.humidity_vs_temp"
[0m17:38:30.504616 [debug] [Thread-1 (]: Began executing node model.weather_dbt.humidity_vs_temp
[0m17:38:30.507707 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.humidity_vs_temp"
[0m17:38:30.508896 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.humidity_vs_temp"
[0m17:38:30.509238 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.humidity_vs_temp"} */
create or replace transient table openweather.analytics.humidity_vs_temp
         as
        (WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME,
        w.DATE_TIME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT *
FROM HumidityTemp
        );
[0m17:38:30.509544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:32.618609 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.108 seconds
[0m17:38:32.622117 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: Close
[0m17:38:32.818563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6400f081-b320-4d5e-8c0a-4d47fdfbad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10753a150>]}
[0m17:38:32.819643 [info ] [Thread-1 (]: 4 of 8 OK created sql table model analytics.humidity_vs_temp ................... [[32mSUCCESS 1[0m in 2.32s]
[0m17:38:32.820487 [debug] [Thread-1 (]: Finished running node model.weather_dbt.humidity_vs_temp
[0m17:38:32.821069 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m17:38:32.821810 [info ] [Thread-1 (]: 5 of 8 START sql view model analytics.openweather_join ......................... [RUN]
[0m17:38:32.822549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.humidity_vs_temp, now model.weather_dbt.openweather_join)
[0m17:38:32.823072 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m17:38:32.827118 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m17:38:32.828653 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m17:38:32.848657 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m17:38:32.850054 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m17:38:32.850358 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    c."Latitude" AS CITY_LATITUDE,
    c."Longitude" AS CITY_LONGITUDE,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m17:38:32.850628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:34.114613 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.263 seconds
[0m17:38:34.119325 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m17:38:34.293172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6400f081-b320-4d5e-8c0a-4d47fdfbad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103856c90>]}
[0m17:38:34.294470 [info ] [Thread-1 (]: 5 of 8 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 1.47s]
[0m17:38:34.295362 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m17:38:34.295983 [debug] [Thread-1 (]: Began running node model.weather_dbt.temp_trends_by_city
[0m17:38:34.296725 [info ] [Thread-1 (]: 6 of 8 START sql table model analytics.temp_trends_by_city ..................... [RUN]
[0m17:38:34.297373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.temp_trends_by_city)
[0m17:38:34.297808 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.temp_trends_by_city
[0m17:38:34.301853 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.temp_trends_by_city"
[0m17:38:34.303011 [debug] [Thread-1 (]: Began executing node model.weather_dbt.temp_trends_by_city
[0m17:38:34.305515 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.temp_trends_by_city"
[0m17:38:34.307018 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.temp_trends_by_city"
[0m17:38:34.307685 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.temp_trends_by_city"} */
create or replace transient table openweather.analytics.temp_trends_by_city
         as
        (WITH TempTrends AS (
    SELECT 
        "Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY
        );
[0m17:38:34.308282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:35.964233 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.655 seconds
[0m17:38:35.970254 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: Close
[0m17:38:36.145908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6400f081-b320-4d5e-8c0a-4d47fdfbad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103857650>]}
[0m17:38:36.147200 [info ] [Thread-1 (]: 6 of 8 OK created sql table model analytics.temp_trends_by_city ................ [[32mSUCCESS 1[0m in 1.85s]
[0m17:38:36.147965 [debug] [Thread-1 (]: Finished running node model.weather_dbt.temp_trends_by_city
[0m17:38:36.148460 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_cond_distribution
[0m17:38:36.149064 [info ] [Thread-1 (]: 7 of 8 START sql table model analytics.weather_cond_distribution ............... [RUN]
[0m17:38:36.149642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.temp_trends_by_city, now model.weather_dbt.weather_cond_distribution)
[0m17:38:36.150067 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_cond_distribution
[0m17:38:36.153915 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_cond_distribution"
[0m17:38:36.155282 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_cond_distribution
[0m17:38:36.158022 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_cond_distribution"
[0m17:38:36.159523 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_cond_distribution"
[0m17:38:36.159925 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_cond_distribution"} */
create or replace transient table openweather.analytics.weather_cond_distribution
         as
        (WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, 3
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC
        );
[0m17:38:36.160274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:37.515800 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.355 seconds
[0m17:38:37.518803 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: Close
[0m17:38:37.791963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6400f081-b320-4d5e-8c0a-4d47fdfbad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103857e90>]}
[0m17:38:37.793206 [info ] [Thread-1 (]: 7 of 8 OK created sql table model analytics.weather_cond_distribution .......... [[32mSUCCESS 1[0m in 1.64s]
[0m17:38:37.793866 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_cond_distribution
[0m17:38:37.794291 [debug] [Thread-1 (]: Began running node model.weather_dbt.wind_speed_analysis
[0m17:38:37.794831 [info ] [Thread-1 (]: 8 of 8 START sql table model analytics.wind_speed_analysis ..................... [RUN]
[0m17:38:37.795343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.weather_cond_distribution, now model.weather_dbt.wind_speed_analysis)
[0m17:38:37.795723 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.wind_speed_analysis
[0m17:38:37.799381 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.wind_speed_analysis"
[0m17:38:37.800783 [debug] [Thread-1 (]: Began executing node model.weather_dbt.wind_speed_analysis
[0m17:38:37.803560 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.wind_speed_analysis"
[0m17:38:37.804901 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.wind_speed_analysis"
[0m17:38:37.805467 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.wind_speed_analysis"} */
create or replace transient table openweather.analytics.wind_speed_analysis
         as
        (WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c."Name" AS CITY_NAME,
        w.DATE_TIME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL
)
SELECT *
FROM WindSpeedData
        );
[0m17:38:37.805849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:39.146536 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.341 seconds
[0m17:38:39.149027 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: Close
[0m17:38:39.288162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6400f081-b320-4d5e-8c0a-4d47fdfbad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cd0770>]}
[0m17:38:39.289491 [info ] [Thread-1 (]: 8 of 8 OK created sql table model analytics.wind_speed_analysis ................ [[32mSUCCESS 1[0m in 1.49s]
[0m17:38:39.290369 [debug] [Thread-1 (]: Finished running node model.weather_dbt.wind_speed_analysis
[0m17:38:39.292254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:39.292671 [debug] [MainThread]: Connection 'model.weather_dbt.wind_speed_analysis' was properly closed.
[0m17:38:39.293137 [info ] [MainThread]: 
[0m17:38:39.293507 [info ] [MainThread]: Finished running 7 table models, 1 view model in 0 hours 0 minutes and 15.34 seconds (15.34s).
[0m17:38:39.295183 [debug] [MainThread]: Command end result
[0m17:38:39.327078 [info ] [MainThread]: 
[0m17:38:39.327443 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:38:39.327653 [info ] [MainThread]: 
[0m17:38:39.327870 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m17:38:39.329453 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.538313, "process_in_blocks": "0", "process_kernel_time": 0.299161, "process_mem_max_rss": "147095552", "process_out_blocks": "0", "process_user_time": 2.452811}
[0m17:38:39.329944 [debug] [MainThread]: Command `dbt run` succeeded at 17:38:39.329875 after 16.54 seconds
[0m17:38:39.330218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108360f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c12090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083c3e90>]}
[0m17:38:39.330456 [debug] [MainThread]: Flushing usage events
[0m17:42:20.719405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110513b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110513d90>]}


============================== 17:42:20.722182 | 075b0b9c-3c30-4acd-baa2-d5717a0535f1 ==============================
[0m17:42:20.722182 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:42:20.722506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:42:20.954829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '075b0b9c-3c30-4acd-baa2-d5717a0535f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111406b10>]}
[0m17:42:20.977402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '075b0b9c-3c30-4acd-baa2-d5717a0535f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11140c050>]}
[0m17:42:20.977969 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:42:21.037210 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:42:21.126397 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:42:21.126819 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/wind_speed_analysis.sql
[0m17:42:21.223443 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:42:21.223771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '075b0b9c-3c30-4acd-baa2-d5717a0535f1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117b5850>]}
[0m17:42:21.344356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '075b0b9c-3c30-4acd-baa2-d5717a0535f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111767f20>]}
[0m17:42:21.409187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '075b0b9c-3c30-4acd-baa2-d5717a0535f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114b1390>]}
[0m17:42:21.409448 [info ] [MainThread]: Found 8 models, 7 snapshots, 27 data tests, 2 sources, 459 macros
[0m17:42:21.409608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '075b0b9c-3c30-4acd-baa2-d5717a0535f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111910fc0>]}
[0m17:42:21.410782 [info ] [MainThread]: 
[0m17:42:21.411056 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:42:21.413173 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m17:42:21.419846 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m17:42:21.420071 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m17:42:21.420210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:22.060572 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.640 seconds
[0m17:42:22.065490 [debug] [ThreadPool]: On list_openweather: Close
[0m17:42:22.177657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m17:42:22.186006 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m17:42:22.186414 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m17:42:22.186646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:42:22.636728 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.450 seconds
[0m17:42:22.640267 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m17:42:22.759720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m17:42:22.764325 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m17:42:22.764758 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m17:42:22.765067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:42:23.217244 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.452 seconds
[0m17:42:23.222322 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m17:42:23.336525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '075b0b9c-3c30-4acd-baa2-d5717a0535f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111af9010>]}
[0m17:42:23.337497 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m17:42:23.337974 [info ] [MainThread]: 
[0m17:42:23.342818 [debug] [Thread-1 (]: Began running node model.weather_dbt.cloud_coverage_over_time
[0m17:42:23.343474 [info ] [Thread-1 (]: 1 of 8 START sql table model analytics.cloud_coverage_over_time ................ [RUN]
[0m17:42:23.343974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now model.weather_dbt.cloud_coverage_over_time)
[0m17:42:23.344859 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.cloud_coverage_over_time
[0m17:42:23.354228 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.cloud_coverage_over_time"
[0m17:42:23.355826 [debug] [Thread-1 (]: Began executing node model.weather_dbt.cloud_coverage_over_time
[0m17:42:23.377855 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.cloud_coverage_over_time"
[0m17:42:23.378807 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.cloud_coverage_over_time"
[0m17:42:23.379069 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.cloud_coverage_over_time"} */
create or replace transient table openweather.analytics.cloud_coverage_over_time
         as
        (WITH CloudCoverage AS (
    SELECT 
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY
        );
[0m17:42:23.379294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:24.738419 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.358 seconds
[0m17:42:24.763542 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: Close
[0m17:42:24.876009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '075b0b9c-3c30-4acd-baa2-d5717a0535f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104e5f40>]}
[0m17:42:24.876459 [info ] [Thread-1 (]: 1 of 8 OK created sql table model analytics.cloud_coverage_over_time ........... [[32mSUCCESS 1[0m in 1.53s]
[0m17:42:24.876774 [debug] [Thread-1 (]: Finished running node model.weather_dbt.cloud_coverage_over_time
[0m17:42:24.876994 [debug] [Thread-1 (]: Began running node model.weather_dbt.correlation
[0m17:42:24.877218 [info ] [Thread-1 (]: 2 of 8 START sql table model analytics.correlation ............................. [RUN]
[0m17:42:24.877481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.cloud_coverage_over_time, now model.weather_dbt.correlation)
[0m17:42:24.877696 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.correlation
[0m17:42:24.879259 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.correlation"
[0m17:42:24.880904 [debug] [Thread-1 (]: Began executing node model.weather_dbt.correlation
[0m17:42:24.882394 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.correlation"
[0m17:42:24.883205 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.correlation"
[0m17:42:24.883465 [debug] [Thread-1 (]: On model.weather_dbt.correlation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.correlation"} */
create or replace transient table openweather.analytics.correlation
         as
        (WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData
        );
[0m17:42:24.883649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:26.169622 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.285 seconds
[0m17:42:26.175678 [debug] [Thread-1 (]: On model.weather_dbt.correlation: Close
[0m17:42:26.299099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '075b0b9c-3c30-4acd-baa2-d5717a0535f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105779770>]}
[0m17:42:26.300107 [info ] [Thread-1 (]: 2 of 8 OK created sql table model analytics.correlation ........................ [[32mSUCCESS 1[0m in 1.42s]
[0m17:42:26.300949 [debug] [Thread-1 (]: Finished running node model.weather_dbt.correlation
[0m17:42:26.301551 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m17:42:26.302341 [info ] [Thread-1 (]: 3 of 8 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m17:42:26.303050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.correlation, now model.weather_dbt.extreme_weather_events)
[0m17:42:26.303550 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m17:42:26.307829 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m17:42:26.309003 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m17:42:26.311972 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m17:42:26.314208 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m17:42:26.314810 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT *
FROM Extreme_Weather_Events
ORDER BY DATE_TIME, CITY_NAME
        );
[0m17:42:26.315211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:27.501840 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.186 seconds
[0m17:42:27.507639 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m17:42:27.627904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '075b0b9c-3c30-4acd-baa2-d5717a0535f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111485ed0>]}
[0m17:42:27.629322 [info ] [Thread-1 (]: 3 of 8 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.32s]
[0m17:42:27.630222 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m17:42:27.630832 [debug] [Thread-1 (]: Began running node model.weather_dbt.humidity_vs_temp
[0m17:42:27.631496 [info ] [Thread-1 (]: 4 of 8 START sql table model analytics.humidity_vs_temp ........................ [RUN]
[0m17:42:27.632100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.humidity_vs_temp)
[0m17:42:27.632524 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.humidity_vs_temp
[0m17:42:27.636515 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.humidity_vs_temp"
[0m17:42:27.637757 [debug] [Thread-1 (]: Began executing node model.weather_dbt.humidity_vs_temp
[0m17:42:27.640410 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.humidity_vs_temp"
[0m17:42:27.641833 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.humidity_vs_temp"
[0m17:42:27.642446 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.humidity_vs_temp"} */
create or replace transient table openweather.analytics.humidity_vs_temp
         as
        (WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME,
        w.DATE_TIME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT *
FROM HumidityTemp
        );
[0m17:42:27.643110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:28.730972 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.088 seconds
[0m17:42:28.734621 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: Close
[0m17:42:28.889717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '075b0b9c-3c30-4acd-baa2-d5717a0535f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052fc8a0>]}
[0m17:42:28.891328 [info ] [Thread-1 (]: 4 of 8 OK created sql table model analytics.humidity_vs_temp ................... [[32mSUCCESS 1[0m in 1.26s]
[0m17:42:28.892031 [debug] [Thread-1 (]: Finished running node model.weather_dbt.humidity_vs_temp
[0m17:42:28.892450 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m17:42:28.892942 [info ] [Thread-1 (]: 5 of 8 START sql view model analytics.openweather_join ......................... [RUN]
[0m17:42:28.893381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.humidity_vs_temp, now model.weather_dbt.openweather_join)
[0m17:42:28.893687 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m17:42:28.896738 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m17:42:28.897760 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m17:42:28.915050 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m17:42:28.916044 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m17:42:28.916289 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    c."Latitude" AS CITY_LATITUDE,
    c."Longitude" AS CITY_LONGITUDE,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m17:42:28.916508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:29.750798 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.834 seconds
[0m17:42:29.752989 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m17:42:30.000680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '075b0b9c-3c30-4acd-baa2-d5717a0535f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1174034d0>]}
[0m17:42:30.001599 [info ] [Thread-1 (]: 5 of 8 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 1.11s]
[0m17:42:30.002120 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m17:42:30.002480 [debug] [Thread-1 (]: Began running node model.weather_dbt.temp_trends_by_city
[0m17:42:30.002923 [info ] [Thread-1 (]: 6 of 8 START sql table model analytics.temp_trends_by_city ..................... [RUN]
[0m17:42:30.003351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.temp_trends_by_city)
[0m17:42:30.003661 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.temp_trends_by_city
[0m17:42:30.006473 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.temp_trends_by_city"
[0m17:42:30.007606 [debug] [Thread-1 (]: Began executing node model.weather_dbt.temp_trends_by_city
[0m17:42:30.009953 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.temp_trends_by_city"
[0m17:42:30.011076 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.temp_trends_by_city"
[0m17:42:30.011376 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.temp_trends_by_city"} */
create or replace transient table openweather.analytics.temp_trends_by_city
         as
        (WITH TempTrends AS (
    SELECT 
        "Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY
        );
[0m17:42:30.011642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:31.090148 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.078 seconds
[0m17:42:31.093421 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: Close
[0m17:42:31.214426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '075b0b9c-3c30-4acd-baa2-d5717a0535f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10414b530>]}
[0m17:42:31.215549 [info ] [Thread-1 (]: 6 of 8 OK created sql table model analytics.temp_trends_by_city ................ [[32mSUCCESS 1[0m in 1.21s]
[0m17:42:31.216384 [debug] [Thread-1 (]: Finished running node model.weather_dbt.temp_trends_by_city
[0m17:42:31.216957 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_cond_distribution
[0m17:42:31.217598 [info ] [Thread-1 (]: 7 of 8 START sql table model analytics.weather_cond_distribution ............... [RUN]
[0m17:42:31.218170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.temp_trends_by_city, now model.weather_dbt.weather_cond_distribution)
[0m17:42:31.218592 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_cond_distribution
[0m17:42:31.222594 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_cond_distribution"
[0m17:42:31.223820 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_cond_distribution
[0m17:42:31.226421 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_cond_distribution"
[0m17:42:31.227835 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_cond_distribution"
[0m17:42:31.228638 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_cond_distribution"} */
create or replace transient table openweather.analytics.weather_cond_distribution
         as
        (WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, 3
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC
        );
[0m17:42:31.229158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:32.181153 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.951 seconds
[0m17:42:32.186551 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: Close
[0m17:42:32.315920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '075b0b9c-3c30-4acd-baa2-d5717a0535f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10414be30>]}
[0m17:42:32.317334 [info ] [Thread-1 (]: 7 of 8 OK created sql table model analytics.weather_cond_distribution .......... [[32mSUCCESS 1[0m in 1.10s]
[0m17:42:32.317854 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_cond_distribution
[0m17:42:32.318192 [debug] [Thread-1 (]: Began running node model.weather_dbt.wind_speed_analysis
[0m17:42:32.318637 [info ] [Thread-1 (]: 8 of 8 START sql table model analytics.wind_speed_analysis ..................... [RUN]
[0m17:42:32.319059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.weather_cond_distribution, now model.weather_dbt.wind_speed_analysis)
[0m17:42:32.319389 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.wind_speed_analysis
[0m17:42:32.322001 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.wind_speed_analysis"
[0m17:42:32.323311 [debug] [Thread-1 (]: Began executing node model.weather_dbt.wind_speed_analysis
[0m17:42:32.325461 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.wind_speed_analysis"
[0m17:42:32.327041 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.wind_speed_analysis"
[0m17:42:32.327496 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.wind_speed_analysis"} */
create or replace transient table openweather.analytics.wind_speed_analysis
         as
        (WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(WIND_SPEED) AS AVG_WIND_SPEED
FROM WindSpeedData
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY;
[0m17:42:32.327954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:32.802691 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b506-0004-3869-0002-594300042b5e
[0m17:42:32.803474 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 28 at position 7 unexpected ';'.
[0m17:42:32.804068 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: Close
[0m17:42:32.954826 [debug] [Thread-1 (]: Database Error in model wind_speed_analysis (models/output/wind_speed_analysis.sql)
  001003 (42000): SQL compilation error:
  syntax error line 28 at position 7 unexpected ';'.
  compiled code at target/run/weather_dbt/models/output/wind_speed_analysis.sql
[0m17:42:32.955347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '075b0b9c-3c30-4acd-baa2-d5717a0535f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117419af0>]}
[0m17:42:32.955950 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model analytics.wind_speed_analysis ............ [[31mERROR[0m in 0.64s]
[0m17:42:32.956431 [debug] [Thread-1 (]: Finished running node model.weather_dbt.wind_speed_analysis
[0m17:42:32.958256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:42:32.958499 [debug] [MainThread]: Connection 'model.weather_dbt.wind_speed_analysis' was properly closed.
[0m17:42:32.958800 [info ] [MainThread]: 
[0m17:42:32.959037 [info ] [MainThread]: Finished running 7 table models, 1 view model in 0 hours 0 minutes and 11.55 seconds (11.55s).
[0m17:42:32.960167 [debug] [MainThread]: Command end result
[0m17:42:32.983832 [info ] [MainThread]: 
[0m17:42:32.984123 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:42:32.984291 [info ] [MainThread]: 
[0m17:42:32.984494 [error] [MainThread]:   Database Error in model wind_speed_analysis (models/output/wind_speed_analysis.sql)
  001003 (42000): SQL compilation error:
  syntax error line 28 at position 7 unexpected ';'.
  compiled code at target/run/weather_dbt/models/output/wind_speed_analysis.sql
[0m17:42:32.984657 [info ] [MainThread]: 
[0m17:42:32.984824 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m17:42:32.986203 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.302876, "process_in_blocks": "0", "process_kernel_time": 0.292587, "process_mem_max_rss": "144457728", "process_out_blocks": "0", "process_user_time": 1.961594}
[0m17:42:32.986609 [debug] [MainThread]: Command `dbt run` failed at 17:42:32.986549 after 12.30 seconds
[0m17:42:32.986835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11170d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102cbfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1174bfbf0>]}
[0m17:42:32.987038 [debug] [MainThread]: Flushing usage events
[0m17:42:55.605093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102708d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104033b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104033d90>]}


============================== 17:42:55.607535 | 22d6eaeb-1d76-4c20-9dca-d1a3e2405b6f ==============================
[0m17:42:55.607535 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:42:55.607871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:42:55.773406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22d6eaeb-1d76-4c20-9dca-d1a3e2405b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104feab10>]}
[0m17:42:55.796122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22d6eaeb-1d76-4c20-9dca-d1a3e2405b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef0050>]}
[0m17:42:55.796537 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:42:55.853693 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:42:55.939473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:42:55.939725 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:42:55.967882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22d6eaeb-1d76-4c20-9dca-d1a3e2405b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e71450>]}
[0m17:42:56.036284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22d6eaeb-1d76-4c20-9dca-d1a3e2405b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105584f50>]}
[0m17:42:56.036589 [info ] [MainThread]: Found 8 models, 7 snapshots, 27 data tests, 2 sources, 459 macros
[0m17:42:56.036753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22d6eaeb-1d76-4c20-9dca-d1a3e2405b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575a510>]}
[0m17:42:56.037999 [info ] [MainThread]: 
[0m17:42:56.038305 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:42:56.040489 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m17:42:56.048420 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m17:42:56.048630 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m17:42:56.048770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:56.602453 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.553 seconds
[0m17:42:56.606684 [debug] [ThreadPool]: On list_openweather: Close
[0m17:42:56.767031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m17:42:56.778434 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m17:42:56.778870 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m17:42:56.779157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:42:57.272525 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.493 seconds
[0m17:42:57.278572 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m17:42:57.403804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m17:42:57.408283 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m17:42:57.408671 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m17:42:57.408982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:42:57.922460 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.513 seconds
[0m17:42:57.925437 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m17:42:58.071061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22d6eaeb-1d76-4c20-9dca-d1a3e2405b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105732a90>]}
[0m17:42:58.071961 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m17:42:58.072423 [info ] [MainThread]: 
[0m17:42:58.076542 [debug] [Thread-1 (]: Began running node model.weather_dbt.cloud_coverage_over_time
[0m17:42:58.077219 [info ] [Thread-1 (]: 1 of 8 START sql table model analytics.cloud_coverage_over_time ................ [RUN]
[0m17:42:58.077734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now model.weather_dbt.cloud_coverage_over_time)
[0m17:42:58.078574 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.cloud_coverage_over_time
[0m17:42:58.087674 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.cloud_coverage_over_time"
[0m17:42:58.088912 [debug] [Thread-1 (]: Began executing node model.weather_dbt.cloud_coverage_over_time
[0m17:42:58.112259 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.cloud_coverage_over_time"
[0m17:42:58.113235 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.cloud_coverage_over_time"
[0m17:42:58.113493 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.cloud_coverage_over_time"} */
create or replace transient table openweather.analytics.cloud_coverage_over_time
         as
        (WITH CloudCoverage AS (
    SELECT 
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY
        );
[0m17:42:58.113716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:59.336656 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.222 seconds
[0m17:42:59.362265 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: Close
[0m17:42:59.514783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22d6eaeb-1d76-4c20-9dca-d1a3e2405b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106384110>]}
[0m17:42:59.515932 [info ] [Thread-1 (]: 1 of 8 OK created sql table model analytics.cloud_coverage_over_time ........... [[32mSUCCESS 1[0m in 1.44s]
[0m17:42:59.516804 [debug] [Thread-1 (]: Finished running node model.weather_dbt.cloud_coverage_over_time
[0m17:42:59.517362 [debug] [Thread-1 (]: Began running node model.weather_dbt.correlation
[0m17:42:59.518023 [info ] [Thread-1 (]: 2 of 8 START sql table model analytics.correlation ............................. [RUN]
[0m17:42:59.518641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.cloud_coverage_over_time, now model.weather_dbt.correlation)
[0m17:42:59.519060 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.correlation
[0m17:42:59.523619 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.correlation"
[0m17:42:59.524776 [debug] [Thread-1 (]: Began executing node model.weather_dbt.correlation
[0m17:42:59.527199 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.correlation"
[0m17:42:59.528968 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.correlation"
[0m17:42:59.529344 [debug] [Thread-1 (]: On model.weather_dbt.correlation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.correlation"} */
create or replace transient table openweather.analytics.correlation
         as
        (WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData
        );
[0m17:42:59.529650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:00.892635 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.363 seconds
[0m17:43:00.896973 [debug] [Thread-1 (]: On model.weather_dbt.correlation: Close
[0m17:43:01.111216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22d6eaeb-1d76-4c20-9dca-d1a3e2405b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104005ff0>]}
[0m17:43:01.112579 [info ] [Thread-1 (]: 2 of 8 OK created sql table model analytics.correlation ........................ [[32mSUCCESS 1[0m in 1.59s]
[0m17:43:01.113435 [debug] [Thread-1 (]: Finished running node model.weather_dbt.correlation
[0m17:43:01.114010 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m17:43:01.114786 [info ] [Thread-1 (]: 3 of 8 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m17:43:01.115514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.correlation, now model.weather_dbt.extreme_weather_events)
[0m17:43:01.115960 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m17:43:01.120184 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m17:43:01.121408 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m17:43:01.123900 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m17:43:01.125704 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m17:43:01.126642 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT *
FROM Extreme_Weather_Events
ORDER BY DATE_TIME, CITY_NAME
        );
[0m17:43:01.127073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:02.416623 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.289 seconds
[0m17:43:02.419555 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m17:43:02.559780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22d6eaeb-1d76-4c20-9dca-d1a3e2405b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102995770>]}
[0m17:43:02.560739 [info ] [Thread-1 (]: 3 of 8 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.44s]
[0m17:43:02.561551 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m17:43:02.562120 [debug] [Thread-1 (]: Began running node model.weather_dbt.humidity_vs_temp
[0m17:43:02.562882 [info ] [Thread-1 (]: 4 of 8 START sql table model analytics.humidity_vs_temp ........................ [RUN]
[0m17:43:02.563619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.humidity_vs_temp)
[0m17:43:02.564043 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.humidity_vs_temp
[0m17:43:02.568267 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.humidity_vs_temp"
[0m17:43:02.569480 [debug] [Thread-1 (]: Began executing node model.weather_dbt.humidity_vs_temp
[0m17:43:02.571947 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.humidity_vs_temp"
[0m17:43:02.573357 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.humidity_vs_temp"
[0m17:43:02.574099 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.humidity_vs_temp"} */
create or replace transient table openweather.analytics.humidity_vs_temp
         as
        (WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME,
        w.DATE_TIME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT *
FROM HumidityTemp
        );
[0m17:43:02.574572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:03.732489 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.157 seconds
[0m17:43:03.736403 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: Close
[0m17:43:03.854545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22d6eaeb-1d76-4c20-9dca-d1a3e2405b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105482750>]}
[0m17:43:03.855693 [info ] [Thread-1 (]: 4 of 8 OK created sql table model analytics.humidity_vs_temp ................... [[32mSUCCESS 1[0m in 1.29s]
[0m17:43:03.856556 [debug] [Thread-1 (]: Finished running node model.weather_dbt.humidity_vs_temp
[0m17:43:03.857149 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m17:43:03.857893 [info ] [Thread-1 (]: 5 of 8 START sql view model analytics.openweather_join ......................... [RUN]
[0m17:43:03.858568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.humidity_vs_temp, now model.weather_dbt.openweather_join)
[0m17:43:03.858983 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m17:43:03.863086 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m17:43:03.864033 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m17:43:03.885548 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m17:43:03.886756 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m17:43:03.887040 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    c."Latitude" AS CITY_LATITUDE,
    c."Longitude" AS CITY_LONGITUDE,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m17:43:03.887282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:04.589876 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.702 seconds
[0m17:43:04.595509 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m17:43:04.795454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22d6eaeb-1d76-4c20-9dca-d1a3e2405b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a9240>]}
[0m17:43:04.796466 [info ] [Thread-1 (]: 5 of 8 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.94s]
[0m17:43:04.797303 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m17:43:04.797870 [debug] [Thread-1 (]: Began running node model.weather_dbt.temp_trends_by_city
[0m17:43:04.798617 [info ] [Thread-1 (]: 6 of 8 START sql table model analytics.temp_trends_by_city ..................... [RUN]
[0m17:43:04.799271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.temp_trends_by_city)
[0m17:43:04.799689 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.temp_trends_by_city
[0m17:43:04.803623 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.temp_trends_by_city"
[0m17:43:04.804960 [debug] [Thread-1 (]: Began executing node model.weather_dbt.temp_trends_by_city
[0m17:43:04.807531 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.temp_trends_by_city"
[0m17:43:04.808969 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.temp_trends_by_city"
[0m17:43:04.809494 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.temp_trends_by_city"} */
create or replace transient table openweather.analytics.temp_trends_by_city
         as
        (WITH TempTrends AS (
    SELECT 
        "Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY
        );
[0m17:43:04.809862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:06.212311 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.402 seconds
[0m17:43:06.216593 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: Close
[0m17:43:06.359045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22d6eaeb-1d76-4c20-9dca-d1a3e2405b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10170f590>]}
[0m17:43:06.360246 [info ] [Thread-1 (]: 6 of 8 OK created sql table model analytics.temp_trends_by_city ................ [[32mSUCCESS 1[0m in 1.56s]
[0m17:43:06.361126 [debug] [Thread-1 (]: Finished running node model.weather_dbt.temp_trends_by_city
[0m17:43:06.361684 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_cond_distribution
[0m17:43:06.362334 [info ] [Thread-1 (]: 7 of 8 START sql table model analytics.weather_cond_distribution ............... [RUN]
[0m17:43:06.362935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.temp_trends_by_city, now model.weather_dbt.weather_cond_distribution)
[0m17:43:06.363357 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_cond_distribution
[0m17:43:06.367157 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_cond_distribution"
[0m17:43:06.368380 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_cond_distribution
[0m17:43:06.370982 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_cond_distribution"
[0m17:43:06.372481 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_cond_distribution"
[0m17:43:06.373027 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_cond_distribution"} */
create or replace transient table openweather.analytics.weather_cond_distribution
         as
        (WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, 3
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC
        );
[0m17:43:06.373392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:07.337664 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.963 seconds
[0m17:43:07.343456 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: Close
[0m17:43:07.474224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22d6eaeb-1d76-4c20-9dca-d1a3e2405b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10170fef0>]}
[0m17:43:07.475345 [info ] [Thread-1 (]: 7 of 8 OK created sql table model analytics.weather_cond_distribution .......... [[32mSUCCESS 1[0m in 1.11s]
[0m17:43:07.476182 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_cond_distribution
[0m17:43:07.476766 [debug] [Thread-1 (]: Began running node model.weather_dbt.wind_speed_analysis
[0m17:43:07.477515 [info ] [Thread-1 (]: 8 of 8 START sql table model analytics.wind_speed_analysis ..................... [RUN]
[0m17:43:07.478232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.weather_cond_distribution, now model.weather_dbt.wind_speed_analysis)
[0m17:43:07.478752 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.wind_speed_analysis
[0m17:43:07.482891 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.wind_speed_analysis"
[0m17:43:07.484043 [debug] [Thread-1 (]: Began executing node model.weather_dbt.wind_speed_analysis
[0m17:43:07.486520 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.wind_speed_analysis"
[0m17:43:07.488036 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.wind_speed_analysis"
[0m17:43:07.488653 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.wind_speed_analysis"} */
create or replace transient table openweather.analytics.wind_speed_analysis
         as
        (WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(WIND_SPEED) AS AVG_WIND_SPEED
FROM WindSpeedData
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY;
[0m17:43:07.489292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:07.949619 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b507-0004-3864-0002-5943000475fa
[0m17:43:07.950356 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 28 at position 7 unexpected ';'.
[0m17:43:07.950960 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: Close
[0m17:43:08.088290 [debug] [Thread-1 (]: Database Error in model wind_speed_analysis (models/output/wind_speed_analysis.sql)
  001003 (42000): SQL compilation error:
  syntax error line 28 at position 7 unexpected ';'.
  compiled code at target/run/weather_dbt/models/output/wind_speed_analysis.sql
[0m17:43:08.089238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22d6eaeb-1d76-4c20-9dca-d1a3e2405b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064be090>]}
[0m17:43:08.090106 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model analytics.wind_speed_analysis ............ [[31mERROR[0m in 0.61s]
[0m17:43:08.090742 [debug] [Thread-1 (]: Finished running node model.weather_dbt.wind_speed_analysis
[0m17:43:08.092905 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:08.093207 [debug] [MainThread]: Connection 'model.weather_dbt.wind_speed_analysis' was properly closed.
[0m17:43:08.093586 [info ] [MainThread]: 
[0m17:43:08.093890 [info ] [MainThread]: Finished running 7 table models, 1 view model in 0 hours 0 minutes and 12.06 seconds (12.06s).
[0m17:43:08.095331 [debug] [MainThread]: Command end result
[0m17:43:08.123562 [info ] [MainThread]: 
[0m17:43:08.123886 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:43:08.124068 [info ] [MainThread]: 
[0m17:43:08.124286 [error] [MainThread]:   Database Error in model wind_speed_analysis (models/output/wind_speed_analysis.sql)
  001003 (42000): SQL compilation error:
  syntax error line 28 at position 7 unexpected ';'.
  compiled code at target/run/weather_dbt/models/output/wind_speed_analysis.sql
[0m17:43:08.124459 [info ] [MainThread]: 
[0m17:43:08.124642 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m17:43:08.126067 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.55412, "process_in_blocks": "0", "process_kernel_time": 0.246382, "process_mem_max_rss": "142016512", "process_out_blocks": "0", "process_user_time": 1.884579}
[0m17:43:08.126446 [debug] [MainThread]: Command `dbt run` failed at 17:43:08.126387 after 12.55 seconds
[0m17:43:08.126682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050b4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102aa5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106757bf0>]}
[0m17:43:08.126892 [debug] [MainThread]: Flushing usage events
[0m17:43:55.111257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c17b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c17d90>]}


============================== 17:43:55.113582 | 0d8f3ab6-c835-4f07-84e8-73f4ac9b5894 ==============================
[0m17:43:55.113582 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:43:55.113906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:43:55.278834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d8f3ab6-c835-4f07-84e8-73f4ac9b5894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11130ab10>]}
[0m17:43:55.301294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d8f3ab6-c835-4f07-84e8-73f4ac9b5894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11130c050>]}
[0m17:43:55.301722 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:43:55.356871 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:43:55.429579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:43:55.430008 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/wind_speed_analysis.sql
[0m17:43:55.526973 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:43:55.527297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0d8f3ab6-c835-4f07-84e8-73f4ac9b5894', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117b9850>]}
[0m17:43:55.647770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d8f3ab6-c835-4f07-84e8-73f4ac9b5894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111797f20>]}
[0m17:43:55.707600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d8f3ab6-c835-4f07-84e8-73f4ac9b5894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113b1b70>]}
[0m17:43:55.707860 [info ] [MainThread]: Found 8 models, 7 snapshots, 27 data tests, 2 sources, 459 macros
[0m17:43:55.708028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d8f3ab6-c835-4f07-84e8-73f4ac9b5894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111918ef0>]}
[0m17:43:55.709220 [info ] [MainThread]: 
[0m17:43:55.709492 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:43:55.711595 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m17:43:55.718178 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m17:43:55.718403 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m17:43:55.718545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:56.389804 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.671 seconds
[0m17:43:56.393968 [debug] [ThreadPool]: On list_openweather: Close
[0m17:43:56.547452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m17:43:56.558467 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m17:43:56.558938 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m17:43:56.559235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:57.060780 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.501 seconds
[0m17:43:57.064758 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m17:43:57.191030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m17:43:57.195521 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m17:43:57.195892 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m17:43:57.196196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:57.738679 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.542 seconds
[0m17:43:57.743110 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m17:43:57.879619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d8f3ab6-c835-4f07-84e8-73f4ac9b5894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bfd190>]}
[0m17:43:57.880469 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m17:43:57.880933 [info ] [MainThread]: 
[0m17:43:57.884267 [debug] [Thread-1 (]: Began running node model.weather_dbt.cloud_coverage_over_time
[0m17:43:57.884955 [info ] [Thread-1 (]: 1 of 8 START sql table model analytics.cloud_coverage_over_time ................ [RUN]
[0m17:43:57.885469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now model.weather_dbt.cloud_coverage_over_time)
[0m17:43:57.885864 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.cloud_coverage_over_time
[0m17:43:57.895819 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.cloud_coverage_over_time"
[0m17:43:57.896898 [debug] [Thread-1 (]: Began executing node model.weather_dbt.cloud_coverage_over_time
[0m17:43:57.920341 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.cloud_coverage_over_time"
[0m17:43:57.921443 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.cloud_coverage_over_time"
[0m17:43:57.921697 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.cloud_coverage_over_time"} */
create or replace transient table openweather.analytics.cloud_coverage_over_time
         as
        (WITH CloudCoverage AS (
    SELECT 
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY
        );
[0m17:43:57.921914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:59.153587 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.231 seconds
[0m17:43:59.179953 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: Close
[0m17:43:59.307021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d8f3ab6-c835-4f07-84e8-73f4ac9b5894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be9f40>]}
[0m17:43:59.308109 [info ] [Thread-1 (]: 1 of 8 OK created sql table model analytics.cloud_coverage_over_time ........... [[32mSUCCESS 1[0m in 1.42s]
[0m17:43:59.309008 [debug] [Thread-1 (]: Finished running node model.weather_dbt.cloud_coverage_over_time
[0m17:43:59.309574 [debug] [Thread-1 (]: Began running node model.weather_dbt.correlation
[0m17:43:59.310239 [info ] [Thread-1 (]: 2 of 8 START sql table model analytics.correlation ............................. [RUN]
[0m17:43:59.310830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.cloud_coverage_over_time, now model.weather_dbt.correlation)
[0m17:43:59.311263 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.correlation
[0m17:43:59.315055 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.correlation"
[0m17:43:59.316360 [debug] [Thread-1 (]: Began executing node model.weather_dbt.correlation
[0m17:43:59.319634 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.correlation"
[0m17:43:59.321333 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.correlation"
[0m17:43:59.321940 [debug] [Thread-1 (]: On model.weather_dbt.correlation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.correlation"} */
create or replace transient table openweather.analytics.correlation
         as
        (WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData
        );
[0m17:43:59.322348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:00.276443 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.953 seconds
[0m17:44:00.280078 [debug] [Thread-1 (]: On model.weather_dbt.correlation: Close
[0m17:44:00.395009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d8f3ab6-c835-4f07-84e8-73f4ac9b5894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105779770>]}
[0m17:44:00.396363 [info ] [Thread-1 (]: 2 of 8 OK created sql table model analytics.correlation ........................ [[32mSUCCESS 1[0m in 1.08s]
[0m17:44:00.397081 [debug] [Thread-1 (]: Finished running node model.weather_dbt.correlation
[0m17:44:00.397574 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m17:44:00.398186 [info ] [Thread-1 (]: 3 of 8 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m17:44:00.398730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.correlation, now model.weather_dbt.extreme_weather_events)
[0m17:44:00.399142 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m17:44:00.402955 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m17:44:00.404134 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m17:44:00.406665 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m17:44:00.408449 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m17:44:00.408798 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT *
FROM Extreme_Weather_Events
ORDER BY DATE_TIME, CITY_NAME
        );
[0m17:44:00.409218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:01.542644 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.133 seconds
[0m17:44:01.545772 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m17:44:01.675673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d8f3ab6-c835-4f07-84e8-73f4ac9b5894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111630b50>]}
[0m17:44:01.676136 [info ] [Thread-1 (]: 3 of 8 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.28s]
[0m17:44:01.679412 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m17:44:01.679744 [debug] [Thread-1 (]: Began running node model.weather_dbt.humidity_vs_temp
[0m17:44:01.680105 [info ] [Thread-1 (]: 4 of 8 START sql table model analytics.humidity_vs_temp ........................ [RUN]
[0m17:44:01.680441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.humidity_vs_temp)
[0m17:44:01.680696 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.humidity_vs_temp
[0m17:44:01.682302 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.humidity_vs_temp"
[0m17:44:01.682794 [debug] [Thread-1 (]: Began executing node model.weather_dbt.humidity_vs_temp
[0m17:44:01.684054 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.humidity_vs_temp"
[0m17:44:01.686022 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.humidity_vs_temp"
[0m17:44:01.686589 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.humidity_vs_temp"} */
create or replace transient table openweather.analytics.humidity_vs_temp
         as
        (WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME,
        w.DATE_TIME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT *
FROM HumidityTemp
        );
[0m17:44:01.686777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:02.940342 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.253 seconds
[0m17:44:02.944829 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: Close
[0m17:44:03.060786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d8f3ab6-c835-4f07-84e8-73f4ac9b5894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052fc8a0>]}
[0m17:44:03.061848 [info ] [Thread-1 (]: 4 of 8 OK created sql table model analytics.humidity_vs_temp ................... [[32mSUCCESS 1[0m in 1.38s]
[0m17:44:03.062661 [debug] [Thread-1 (]: Finished running node model.weather_dbt.humidity_vs_temp
[0m17:44:03.063147 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m17:44:03.063755 [info ] [Thread-1 (]: 5 of 8 START sql view model analytics.openweather_join ......................... [RUN]
[0m17:44:03.064344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.humidity_vs_temp, now model.weather_dbt.openweather_join)
[0m17:44:03.064776 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m17:44:03.068852 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m17:44:03.070163 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m17:44:03.090440 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m17:44:03.091706 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m17:44:03.091987 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    c."Latitude" AS CITY_LATITUDE,
    c."Longitude" AS CITY_LONGITUDE,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m17:44:03.092238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:03.772301 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m17:44:03.776922 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m17:44:03.922854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d8f3ab6-c835-4f07-84e8-73f4ac9b5894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ae7110>]}
[0m17:44:03.924083 [info ] [Thread-1 (]: 5 of 8 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.86s]
[0m17:44:03.924943 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m17:44:03.925548 [debug] [Thread-1 (]: Began running node model.weather_dbt.temp_trends_by_city
[0m17:44:03.926278 [info ] [Thread-1 (]: 6 of 8 START sql table model analytics.temp_trends_by_city ..................... [RUN]
[0m17:44:03.926984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.temp_trends_by_city)
[0m17:44:03.927488 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.temp_trends_by_city
[0m17:44:03.931469 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.temp_trends_by_city"
[0m17:44:03.932532 [debug] [Thread-1 (]: Began executing node model.weather_dbt.temp_trends_by_city
[0m17:44:03.935016 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.temp_trends_by_city"
[0m17:44:03.936336 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.temp_trends_by_city"
[0m17:44:03.937278 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.temp_trends_by_city"} */
create or replace transient table openweather.analytics.temp_trends_by_city
         as
        (WITH TempTrends AS (
    SELECT 
        "Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY
        );
[0m17:44:03.937783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:05.087305 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.149 seconds
[0m17:44:05.089168 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: Close
[0m17:44:05.225338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d8f3ab6-c835-4f07-84e8-73f4ac9b5894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037fb590>]}
[0m17:44:05.226403 [info ] [Thread-1 (]: 6 of 8 OK created sql table model analytics.temp_trends_by_city ................ [[32mSUCCESS 1[0m in 1.30s]
[0m17:44:05.227096 [debug] [Thread-1 (]: Finished running node model.weather_dbt.temp_trends_by_city
[0m17:44:05.227580 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_cond_distribution
[0m17:44:05.228178 [info ] [Thread-1 (]: 7 of 8 START sql table model analytics.weather_cond_distribution ............... [RUN]
[0m17:44:05.228749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.temp_trends_by_city, now model.weather_dbt.weather_cond_distribution)
[0m17:44:05.229190 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_cond_distribution
[0m17:44:05.232988 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_cond_distribution"
[0m17:44:05.234064 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_cond_distribution
[0m17:44:05.236696 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_cond_distribution"
[0m17:44:05.238085 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_cond_distribution"
[0m17:44:05.238455 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_cond_distribution"} */
create or replace transient table openweather.analytics.weather_cond_distribution
         as
        (WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, 3
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC
        );
[0m17:44:05.238755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:06.324279 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.085 seconds
[0m17:44:06.328414 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: Close
[0m17:44:06.444425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d8f3ab6-c835-4f07-84e8-73f4ac9b5894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037fbdd0>]}
[0m17:44:06.445543 [info ] [Thread-1 (]: 7 of 8 OK created sql table model analytics.weather_cond_distribution .......... [[32mSUCCESS 1[0m in 1.22s]
[0m17:44:06.446391 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_cond_distribution
[0m17:44:06.446987 [debug] [Thread-1 (]: Began running node model.weather_dbt.wind_speed_analysis
[0m17:44:06.447736 [info ] [Thread-1 (]: 8 of 8 START sql table model analytics.wind_speed_analysis ..................... [RUN]
[0m17:44:06.448448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.weather_cond_distribution, now model.weather_dbt.wind_speed_analysis)
[0m17:44:06.448966 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.wind_speed_analysis
[0m17:44:06.453017 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.wind_speed_analysis"
[0m17:44:06.454167 [debug] [Thread-1 (]: Began executing node model.weather_dbt.wind_speed_analysis
[0m17:44:06.456733 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.wind_speed_analysis"
[0m17:44:06.458129 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.wind_speed_analysis"
[0m17:44:06.458975 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.wind_speed_analysis"} */
create or replace transient table openweather.analytics.wind_speed_analysis
         as
        (WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(WIND_SPEED) AS AVG_WIND_SPEED
FROM WindSpeedData
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY
        );
[0m17:44:06.459465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:07.751867 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.292 seconds
[0m17:44:07.754674 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: Close
[0m17:44:07.889235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d8f3ab6-c835-4f07-84e8-73f4ac9b5894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10404c710>]}
[0m17:44:07.890336 [info ] [Thread-1 (]: 8 of 8 OK created sql table model analytics.wind_speed_analysis ................ [[32mSUCCESS 1[0m in 1.44s]
[0m17:44:07.891139 [debug] [Thread-1 (]: Finished running node model.weather_dbt.wind_speed_analysis
[0m17:44:07.892727 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:07.893136 [debug] [MainThread]: Connection 'model.weather_dbt.wind_speed_analysis' was properly closed.
[0m17:44:07.893575 [info ] [MainThread]: 
[0m17:44:07.893931 [info ] [MainThread]: Finished running 7 table models, 1 view model in 0 hours 0 minutes and 12.18 seconds (12.18s).
[0m17:44:07.895608 [debug] [MainThread]: Command end result
[0m17:44:07.925755 [info ] [MainThread]: 
[0m17:44:07.926112 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:44:07.926320 [info ] [MainThread]: 
[0m17:44:07.926524 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m17:44:07.927894 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.850002, "process_in_blocks": "0", "process_kernel_time": 0.24208, "process_mem_max_rss": "142376960", "process_out_blocks": "0", "process_user_time": 1.986985}
[0m17:44:07.928379 [debug] [MainThread]: Command `dbt run` succeeded at 17:44:07.928313 after 12.85 seconds
[0m17:44:07.928614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cddc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b4ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b4b9b0>]}
[0m17:44:07.928836 [debug] [MainThread]: Flushing usage events
[0m17:54:34.221530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120edbb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120edbd90>]}


============================== 17:54:34.224746 | 8113f104-bf90-4ca7-9a91-9d9ae1c35cc8 ==============================
[0m17:54:34.224746 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:54:34.225085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:54:34.458170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8113f104-bf90-4ca7-9a91-9d9ae1c35cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c06b10>]}
[0m17:54:34.480639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8113f104-bf90-4ca7-9a91-9d9ae1c35cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c0c050>]}
[0m17:54:34.481228 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:54:34.539238 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:54:34.626616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:54:34.627044 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/output/humidity_vs_temp.sql
[0m17:54:34.723854 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:54:34.724196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8113f104-bf90-4ca7-9a91-9d9ae1c35cc8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f6d850>]}
[0m17:54:34.846982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8113f104-bf90-4ca7-9a91-9d9ae1c35cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b43e30>]}
[0m17:54:34.912036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8113f104-bf90-4ca7-9a91-9d9ae1c35cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c1bcb0>]}
[0m17:54:34.912306 [info ] [MainThread]: Found 8 models, 7 snapshots, 27 data tests, 2 sources, 459 macros
[0m17:54:34.912471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8113f104-bf90-4ca7-9a91-9d9ae1c35cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122222a90>]}
[0m17:54:34.913646 [info ] [MainThread]: 
[0m17:54:34.913923 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:54:34.916024 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m17:54:34.922650 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m17:54:34.922879 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m17:54:34.923017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:35.530601 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.607 seconds
[0m17:54:35.534128 [debug] [ThreadPool]: On list_openweather: Close
[0m17:54:35.660752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m17:54:35.671102 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m17:54:35.671461 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m17:54:35.671722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:36.146921 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.475 seconds
[0m17:54:36.150827 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m17:54:36.266459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m17:54:36.270989 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m17:54:36.271401 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m17:54:36.271709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:36.766242 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.494 seconds
[0m17:54:36.770143 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m17:54:36.909946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8113f104-bf90-4ca7-9a91-9d9ae1c35cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224f9190>]}
[0m17:54:36.910801 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m17:54:36.911250 [info ] [MainThread]: 
[0m17:54:36.915845 [debug] [Thread-1 (]: Began running node model.weather_dbt.cloud_coverage_over_time
[0m17:54:36.916461 [info ] [Thread-1 (]: 1 of 8 START sql table model analytics.cloud_coverage_over_time ................ [RUN]
[0m17:54:36.917157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now model.weather_dbt.cloud_coverage_over_time)
[0m17:54:36.917777 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.cloud_coverage_over_time
[0m17:54:36.926972 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.cloud_coverage_over_time"
[0m17:54:36.928537 [debug] [Thread-1 (]: Began executing node model.weather_dbt.cloud_coverage_over_time
[0m17:54:36.950422 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.cloud_coverage_over_time"
[0m17:54:36.951778 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.cloud_coverage_over_time"
[0m17:54:36.952133 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.cloud_coverage_over_time"} */
create or replace transient table openweather.analytics.cloud_coverage_over_time
         as
        (WITH CloudCoverage AS (
    SELECT 
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY
        );
[0m17:54:36.952372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:38.343681 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.391 seconds
[0m17:54:38.368752 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: Close
[0m17:54:38.484162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8113f104-bf90-4ca7-9a91-9d9ae1c35cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120eadf40>]}
[0m17:54:38.484886 [info ] [Thread-1 (]: 1 of 8 OK created sql table model analytics.cloud_coverage_over_time ........... [[32mSUCCESS 1[0m in 1.57s]
[0m17:54:38.485346 [debug] [Thread-1 (]: Finished running node model.weather_dbt.cloud_coverage_over_time
[0m17:54:38.485662 [debug] [Thread-1 (]: Began running node model.weather_dbt.correlation
[0m17:54:38.485962 [info ] [Thread-1 (]: 2 of 8 START sql table model analytics.correlation ............................. [RUN]
[0m17:54:38.486433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.cloud_coverage_over_time, now model.weather_dbt.correlation)
[0m17:54:38.486808 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.correlation
[0m17:54:38.488861 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.correlation"
[0m17:54:38.489746 [debug] [Thread-1 (]: Began executing node model.weather_dbt.correlation
[0m17:54:38.491936 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.correlation"
[0m17:54:38.493131 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.correlation"
[0m17:54:38.493503 [debug] [Thread-1 (]: On model.weather_dbt.correlation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.correlation"} */
create or replace transient table openweather.analytics.correlation
         as
        (WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData
        );
[0m17:54:38.493745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:39.572301 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.078 seconds
[0m17:54:39.576038 [debug] [Thread-1 (]: On model.weather_dbt.correlation: Close
[0m17:54:39.702455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8113f104-bf90-4ca7-9a91-9d9ae1c35cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122fd76b0>]}
[0m17:54:39.703235 [info ] [Thread-1 (]: 2 of 8 OK created sql table model analytics.correlation ........................ [[32mSUCCESS 1[0m in 1.22s]
[0m17:54:39.703753 [debug] [Thread-1 (]: Finished running node model.weather_dbt.correlation
[0m17:54:39.704096 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m17:54:39.704397 [info ] [Thread-1 (]: 3 of 8 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m17:54:39.704790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.correlation, now model.weather_dbt.extreme_weather_events)
[0m17:54:39.705043 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m17:54:39.707142 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m17:54:39.708473 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m17:54:39.710065 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m17:54:39.711142 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m17:54:39.711411 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT *
FROM Extreme_Weather_Events
ORDER BY DATE_TIME, CITY_NAME
        );
[0m17:54:39.711642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:40.803145 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.091 seconds
[0m17:54:40.807463 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m17:54:40.931000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8113f104-bf90-4ca7-9a91-9d9ae1c35cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e5f450>]}
[0m17:54:40.932133 [info ] [Thread-1 (]: 3 of 8 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.23s]
[0m17:54:40.933175 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m17:54:40.933814 [debug] [Thread-1 (]: Began running node model.weather_dbt.humidity_vs_temp
[0m17:54:40.934493 [info ] [Thread-1 (]: 4 of 8 START sql table model analytics.humidity_vs_temp ........................ [RUN]
[0m17:54:40.935061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.humidity_vs_temp)
[0m17:54:40.935454 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.humidity_vs_temp
[0m17:54:40.939485 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.humidity_vs_temp"
[0m17:54:40.940738 [debug] [Thread-1 (]: Began executing node model.weather_dbt.humidity_vs_temp
[0m17:54:40.943256 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.humidity_vs_temp"
[0m17:54:40.944802 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.humidity_vs_temp"
[0m17:54:40.945369 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.humidity_vs_temp"} */
create or replace transient table openweather.analytics.humidity_vs_temp
         as
        (WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(TEMP_FAHRENHEIT) AS AVG_TEMP_FAHRENHEIT,
    AVG(HUMIDITY) AS AVG_HUMIDITY
FROM HumidityTemp
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY
        );
[0m17:54:40.945961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:42.134351 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.188 seconds
[0m17:54:42.139719 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: Close
[0m17:54:42.267837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8113f104-bf90-4ca7-9a91-9d9ae1c35cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058fc8a0>]}
[0m17:54:42.268925 [info ] [Thread-1 (]: 4 of 8 OK created sql table model analytics.humidity_vs_temp ................... [[32mSUCCESS 1[0m in 1.33s]
[0m17:54:42.269787 [debug] [Thread-1 (]: Finished running node model.weather_dbt.humidity_vs_temp
[0m17:54:42.270379 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m17:54:42.271104 [info ] [Thread-1 (]: 5 of 8 START sql view model analytics.openweather_join ......................... [RUN]
[0m17:54:42.271824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.humidity_vs_temp, now model.weather_dbt.openweather_join)
[0m17:54:42.272336 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m17:54:42.276404 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m17:54:42.277635 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m17:54:42.299023 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m17:54:42.300304 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m17:54:42.300587 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    c."Latitude" AS CITY_LATITUDE,
    c."Longitude" AS CITY_LONGITUDE,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m17:54:42.300835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:43.013674 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.712 seconds
[0m17:54:43.018265 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m17:54:43.137236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8113f104-bf90-4ca7-9a91-9d9ae1c35cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1230d74d0>]}
[0m17:54:43.138796 [info ] [Thread-1 (]: 5 of 8 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.87s]
[0m17:54:43.139439 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m17:54:43.139792 [debug] [Thread-1 (]: Began running node model.weather_dbt.temp_trends_by_city
[0m17:54:43.140261 [info ] [Thread-1 (]: 6 of 8 START sql table model analytics.temp_trends_by_city ..................... [RUN]
[0m17:54:43.140729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.temp_trends_by_city)
[0m17:54:43.141040 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.temp_trends_by_city
[0m17:54:43.143990 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.temp_trends_by_city"
[0m17:54:43.146160 [debug] [Thread-1 (]: Began executing node model.weather_dbt.temp_trends_by_city
[0m17:54:43.148132 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.temp_trends_by_city"
[0m17:54:43.149134 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.temp_trends_by_city"
[0m17:54:43.149394 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.temp_trends_by_city"} */
create or replace transient table openweather.analytics.temp_trends_by_city
         as
        (WITH TempTrends AS (
    SELECT 
        "Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY
        );
[0m17:54:43.149642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:44.283651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.134 seconds
[0m17:54:44.287452 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: Close
[0m17:54:44.428159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8113f104-bf90-4ca7-9a91-9d9ae1c35cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035435f0>]}
[0m17:54:44.429479 [info ] [Thread-1 (]: 6 of 8 OK created sql table model analytics.temp_trends_by_city ................ [[32mSUCCESS 1[0m in 1.29s]
[0m17:54:44.430327 [debug] [Thread-1 (]: Finished running node model.weather_dbt.temp_trends_by_city
[0m17:54:44.430919 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_cond_distribution
[0m17:54:44.431565 [info ] [Thread-1 (]: 7 of 8 START sql table model analytics.weather_cond_distribution ............... [RUN]
[0m17:54:44.432161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.temp_trends_by_city, now model.weather_dbt.weather_cond_distribution)
[0m17:54:44.432582 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_cond_distribution
[0m17:54:44.436602 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_cond_distribution"
[0m17:54:44.437527 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_cond_distribution
[0m17:54:44.439861 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_cond_distribution"
[0m17:54:44.441021 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_cond_distribution"
[0m17:54:44.441509 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_cond_distribution"} */
create or replace transient table openweather.analytics.weather_cond_distribution
         as
        (WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, 3
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC
        );
[0m17:54:44.442018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:45.505299 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.063 seconds
[0m17:54:45.510381 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: Close
[0m17:54:45.634925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8113f104-bf90-4ca7-9a91-9d9ae1c35cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103543ef0>]}
[0m17:54:45.636419 [info ] [Thread-1 (]: 7 of 8 OK created sql table model analytics.weather_cond_distribution .......... [[32mSUCCESS 1[0m in 1.20s]
[0m17:54:45.637351 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_cond_distribution
[0m17:54:45.637977 [debug] [Thread-1 (]: Began running node model.weather_dbt.wind_speed_analysis
[0m17:54:45.638743 [info ] [Thread-1 (]: 8 of 8 START sql table model analytics.wind_speed_analysis ..................... [RUN]
[0m17:54:45.639409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.weather_cond_distribution, now model.weather_dbt.wind_speed_analysis)
[0m17:54:45.639948 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.wind_speed_analysis
[0m17:54:45.644083 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.wind_speed_analysis"
[0m17:54:45.645495 [debug] [Thread-1 (]: Began executing node model.weather_dbt.wind_speed_analysis
[0m17:54:45.648320 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.wind_speed_analysis"
[0m17:54:45.650043 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.wind_speed_analysis"
[0m17:54:45.650718 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.wind_speed_analysis"} */
create or replace transient table openweather.analytics.wind_speed_analysis
         as
        (WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(WIND_SPEED) AS AVG_WIND_SPEED
FROM WindSpeedData
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY
        );
[0m17:54:45.651177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:46.770502 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.119 seconds
[0m17:54:46.774981 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: Close
[0m17:54:46.908417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8113f104-bf90-4ca7-9a91-9d9ae1c35cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039bc770>]}
[0m17:54:46.909625 [info ] [Thread-1 (]: 8 of 8 OK created sql table model analytics.wind_speed_analysis ................ [[32mSUCCESS 1[0m in 1.27s]
[0m17:54:46.910473 [debug] [Thread-1 (]: Finished running node model.weather_dbt.wind_speed_analysis
[0m17:54:46.912299 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:46.912649 [debug] [MainThread]: Connection 'model.weather_dbt.wind_speed_analysis' was properly closed.
[0m17:54:46.913059 [info ] [MainThread]: 
[0m17:54:46.913400 [info ] [MainThread]: Finished running 7 table models, 1 view model in 0 hours 0 minutes and 12.00 seconds (12.00s).
[0m17:54:46.915029 [debug] [MainThread]: Command end result
[0m17:54:46.946083 [info ] [MainThread]: 
[0m17:54:46.946449 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:54:46.946663 [info ] [MainThread]: 
[0m17:54:46.946888 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m17:54:46.948320 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.765502, "process_in_blocks": "0", "process_kernel_time": 0.293498, "process_mem_max_rss": "143409152", "process_out_blocks": "0", "process_user_time": 1.953114}
[0m17:54:46.948677 [debug] [MainThread]: Command `dbt run` succeeded at 17:54:46.948613 after 12.77 seconds
[0m17:54:46.948920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a766f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1233478f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123347fb0>]}
[0m17:54:46.949151 [debug] [MainThread]: Flushing usage events
[0m18:02:36.468111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e74d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108777b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108777d90>]}


============================== 18:02:36.471385 | c56e2306-42a0-4095-86b6-a1ca009e88d5 ==============================
[0m18:02:36.471385 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:02:36.471729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:02:36.527347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c56e2306-42a0-4095-86b6-a1ca009e88d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e3360>]}
[0m18:02:36.539781 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.11055125, "process_in_blocks": "0", "process_kernel_time": 0.137513, "process_mem_max_rss": "98091008", "process_out_blocks": "0", "process_user_time": 0.645065}
[0m18:02:36.540220 [debug] [MainThread]: Command `dbt clean` succeeded at 18:02:36.540096 after 0.11 seconds
[0m18:02:36.540464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a2580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a2690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10850a950>]}
[0m18:02:36.540647 [debug] [MainThread]: Flushing usage events
[0m18:02:59.359174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107330d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c5bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c5bd90>]}


============================== 18:02:59.362246 | dc26295f-3bcc-46f1-b9f3-ff87b5990e50 ==============================
[0m18:02:59.362246 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:02:59.362592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:02:59.611971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc26295f-3bcc-46f1-b9f3-ff87b5990e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a2b10>]}
[0m18:02:59.634646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc26295f-3bcc-46f1-b9f3-ff87b5990e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a8050>]}
[0m18:02:59.636154 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:02:59.698106 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:02:59.698648 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:02:59.698840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dc26295f-3bcc-46f1-b9f3-ff87b5990e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10972ca50>]}
[0m18:03:00.287542 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:03:00.287847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dc26295f-3bcc-46f1-b9f3-ff87b5990e50', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109acb5c0>]}
[0m18:03:00.434594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc26295f-3bcc-46f1-b9f3-ff87b5990e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f90d70>]}
[0m18:03:00.503313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc26295f-3bcc-46f1-b9f3-ff87b5990e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fc6c30>]}
[0m18:03:00.503585 [info ] [MainThread]: Found 8 models, 7 snapshots, 27 data tests, 2 sources, 459 macros
[0m18:03:00.503757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc26295f-3bcc-46f1-b9f3-ff87b5990e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a00e5d0>]}
[0m18:03:00.504949 [info ] [MainThread]: 
[0m18:03:00.505226 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:03:00.507362 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m18:03:00.514013 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m18:03:00.514227 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m18:03:00.514363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:01.146517 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.632 seconds
[0m18:03:01.148537 [debug] [ThreadPool]: On list_openweather: Close
[0m18:03:01.275958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m18:03:01.284607 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m18:03:01.284945 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m18:03:01.285194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:01.825065 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.540 seconds
[0m18:03:01.828433 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m18:03:01.972937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m18:03:01.977336 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m18:03:01.977817 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m18:03:01.978127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:02.460830 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8b51b-0004-386c-0002-594300043c3a
[0m18:03:02.461411 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:03:02.461798 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:03:02.462031 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:03:02.462328 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m18:03:02.593269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc26295f-3bcc-46f1-b9f3-ff87b5990e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2e2830>]}
[0m18:03:02.594168 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m18:03:02.594580 [info ] [MainThread]: 
[0m18:03:02.598115 [debug] [Thread-1 (]: Began running node model.weather_dbt.cloud_coverage_over_time
[0m18:03:02.598796 [info ] [Thread-1 (]: 1 of 8 START sql table model analytics.cloud_coverage_over_time ................ [RUN]
[0m18:03:02.599296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now model.weather_dbt.cloud_coverage_over_time)
[0m18:03:02.599676 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.cloud_coverage_over_time
[0m18:03:02.608887 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.cloud_coverage_over_time"
[0m18:03:02.610732 [debug] [Thread-1 (]: Began executing node model.weather_dbt.cloud_coverage_over_time
[0m18:03:02.634636 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.cloud_coverage_over_time"
[0m18:03:02.635987 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.cloud_coverage_over_time"
[0m18:03:02.636244 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.cloud_coverage_over_time"} */
create or replace transient table openweather.analytics.cloud_coverage_over_time
         as
        (WITH CloudCoverage AS (
    SELECT 
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY
        );
[0m18:03:02.636472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:03.736768 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.100 seconds
[0m18:03:03.761449 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: Close
[0m18:03:03.966906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc26295f-3bcc-46f1-b9f3-ff87b5990e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10821fa70>]}
[0m18:03:03.967861 [info ] [Thread-1 (]: 1 of 8 OK created sql table model analytics.cloud_coverage_over_time ........... [[32mSUCCESS 1[0m in 1.37s]
[0m18:03:03.968564 [debug] [Thread-1 (]: Finished running node model.weather_dbt.cloud_coverage_over_time
[0m18:03:03.969020 [debug] [Thread-1 (]: Began running node model.weather_dbt.correlation
[0m18:03:03.969591 [info ] [Thread-1 (]: 2 of 8 START sql table model analytics.correlation ............................. [RUN]
[0m18:03:03.970073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.cloud_coverage_over_time, now model.weather_dbt.correlation)
[0m18:03:03.970428 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.correlation
[0m18:03:03.973478 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.correlation"
[0m18:03:03.974816 [debug] [Thread-1 (]: Began executing node model.weather_dbt.correlation
[0m18:03:03.982601 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.correlation"
[0m18:03:03.983997 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.correlation"
[0m18:03:03.984331 [debug] [Thread-1 (]: On model.weather_dbt.correlation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.correlation"} */
create or replace transient table openweather.analytics.correlation
         as
        (WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData
        );
[0m18:03:03.984619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:05.337502 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.352 seconds
[0m18:03:05.343842 [debug] [Thread-1 (]: On model.weather_dbt.correlation: Close
[0m18:03:05.470931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc26295f-3bcc-46f1-b9f3-ff87b5990e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d1bd0>]}
[0m18:03:05.472039 [info ] [Thread-1 (]: 2 of 8 OK created sql table model analytics.correlation ........................ [[32mSUCCESS 1[0m in 1.50s]
[0m18:03:05.472896 [debug] [Thread-1 (]: Finished running node model.weather_dbt.correlation
[0m18:03:05.473497 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m18:03:05.474302 [info ] [Thread-1 (]: 3 of 8 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m18:03:05.475006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.correlation, now model.weather_dbt.extreme_weather_events)
[0m18:03:05.475532 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m18:03:05.479618 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m18:03:05.480997 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m18:03:05.484737 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m18:03:05.486463 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m18:03:05.486878 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT *
FROM Extreme_Weather_Events
ORDER BY DATE_TIME, CITY_NAME
        );
[0m18:03:05.487250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:06.670762 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.183 seconds
[0m18:03:06.674501 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m18:03:06.824426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc26295f-3bcc-46f1-b9f3-ff87b5990e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072948a0>]}
[0m18:03:06.825723 [info ] [Thread-1 (]: 3 of 8 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.35s]
[0m18:03:06.827420 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m18:03:06.828705 [debug] [Thread-1 (]: Began running node model.weather_dbt.humidity_vs_temp
[0m18:03:06.829539 [info ] [Thread-1 (]: 4 of 8 START sql table model analytics.humidity_vs_temp ........................ [RUN]
[0m18:03:06.831613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.humidity_vs_temp)
[0m18:03:06.833388 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.humidity_vs_temp
[0m18:03:06.840587 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.humidity_vs_temp"
[0m18:03:06.843073 [debug] [Thread-1 (]: Began executing node model.weather_dbt.humidity_vs_temp
[0m18:03:06.846651 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.humidity_vs_temp"
[0m18:03:06.848632 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.humidity_vs_temp"
[0m18:03:06.849978 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.humidity_vs_temp"} */
create or replace transient table openweather.analytics.humidity_vs_temp
         as
        (WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(TEMP_FAHRENHEIT) AS AVG_TEMP_FAHRENHEIT,
    AVG(HUMIDITY) AS AVG_HUMIDITY
FROM HumidityTemp
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY
        );
[0m18:03:06.850305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:08.101237 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.250 seconds
[0m18:03:08.106248 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: Close
[0m18:03:08.226877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc26295f-3bcc-46f1-b9f3-ff87b5990e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c42270>]}
[0m18:03:08.227999 [info ] [Thread-1 (]: 4 of 8 OK created sql table model analytics.humidity_vs_temp ................... [[32mSUCCESS 1[0m in 1.40s]
[0m18:03:08.228838 [debug] [Thread-1 (]: Finished running node model.weather_dbt.humidity_vs_temp
[0m18:03:08.229398 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m18:03:08.230030 [info ] [Thread-1 (]: 5 of 8 START sql view model analytics.openweather_join ......................... [RUN]
[0m18:03:08.230630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.humidity_vs_temp, now model.weather_dbt.openweather_join)
[0m18:03:08.231068 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m18:03:08.235052 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m18:03:08.236422 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m18:03:08.256856 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m18:03:08.258049 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m18:03:08.258332 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    c."Latitude" AS CITY_LATITUDE,
    c."Longitude" AS CITY_LONGITUDE,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m18:03:08.258574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:09.023238 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.764 seconds
[0m18:03:09.026940 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m18:03:09.142043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc26295f-3bcc-46f1-b9f3-ff87b5990e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106336c90>]}
[0m18:03:09.143367 [info ] [Thread-1 (]: 5 of 8 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 0.91s]
[0m18:03:09.144216 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m18:03:09.144800 [debug] [Thread-1 (]: Began running node model.weather_dbt.temp_trends_by_city
[0m18:03:09.145560 [info ] [Thread-1 (]: 6 of 8 START sql table model analytics.temp_trends_by_city ..................... [RUN]
[0m18:03:09.146284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.temp_trends_by_city)
[0m18:03:09.146727 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.temp_trends_by_city
[0m18:03:09.150829 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.temp_trends_by_city"
[0m18:03:09.152147 [debug] [Thread-1 (]: Began executing node model.weather_dbt.temp_trends_by_city
[0m18:03:09.154600 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.temp_trends_by_city"
[0m18:03:09.156070 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.temp_trends_by_city"
[0m18:03:09.156464 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.temp_trends_by_city"} */
create or replace transient table openweather.analytics.temp_trends_by_city
         as
        (WITH TempTrends AS (
    SELECT 
        "Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY
        );
[0m18:03:09.156803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:10.345095 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.188 seconds
[0m18:03:10.349076 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: Close
[0m18:03:10.492480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc26295f-3bcc-46f1-b9f3-ff87b5990e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063375f0>]}
[0m18:03:10.493697 [info ] [Thread-1 (]: 6 of 8 OK created sql table model analytics.temp_trends_by_city ................ [[32mSUCCESS 1[0m in 1.35s]
[0m18:03:10.494540 [debug] [Thread-1 (]: Finished running node model.weather_dbt.temp_trends_by_city
[0m18:03:10.495123 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_cond_distribution
[0m18:03:10.495862 [info ] [Thread-1 (]: 7 of 8 START sql table model analytics.weather_cond_distribution ............... [RUN]
[0m18:03:10.496534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.temp_trends_by_city, now model.weather_dbt.weather_cond_distribution)
[0m18:03:10.496964 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_cond_distribution
[0m18:03:10.501044 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_cond_distribution"
[0m18:03:10.502411 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_cond_distribution
[0m18:03:10.504880 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_cond_distribution"
[0m18:03:10.506377 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_cond_distribution"
[0m18:03:10.507056 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_cond_distribution"} */
create or replace transient table openweather.analytics.weather_cond_distribution
         as
        (WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, 3
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC
        );
[0m18:03:10.507453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:11.584842 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.077 seconds
[0m18:03:11.590084 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: Close
[0m18:03:11.713775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc26295f-3bcc-46f1-b9f3-ff87b5990e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106337e90>]}
[0m18:03:11.714905 [info ] [Thread-1 (]: 7 of 8 OK created sql table model analytics.weather_cond_distribution .......... [[32mSUCCESS 1[0m in 1.22s]
[0m18:03:11.715613 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_cond_distribution
[0m18:03:11.716097 [debug] [Thread-1 (]: Began running node model.weather_dbt.wind_speed_analysis
[0m18:03:11.716720 [info ] [Thread-1 (]: 8 of 8 START sql table model analytics.wind_speed_analysis ..................... [RUN]
[0m18:03:11.717310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.weather_cond_distribution, now model.weather_dbt.wind_speed_analysis)
[0m18:03:11.717739 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.wind_speed_analysis
[0m18:03:11.721665 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.wind_speed_analysis"
[0m18:03:11.723837 [debug] [Thread-1 (]: Began executing node model.weather_dbt.wind_speed_analysis
[0m18:03:11.726634 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.wind_speed_analysis"
[0m18:03:11.728135 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.wind_speed_analysis"
[0m18:03:11.728989 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.wind_speed_analysis"} */
create or replace transient table openweather.analytics.wind_speed_analysis
         as
        (WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(WIND_SPEED) AS AVG_WIND_SPEED
FROM WindSpeedData
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY
        );
[0m18:03:11.729608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:12.866775 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.137 seconds
[0m18:03:12.872109 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: Close
[0m18:03:12.995966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc26295f-3bcc-46f1-b9f3-ff87b5990e50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b07d0>]}
[0m18:03:12.997197 [info ] [Thread-1 (]: 8 of 8 OK created sql table model analytics.wind_speed_analysis ................ [[32mSUCCESS 1[0m in 1.28s]
[0m18:03:12.998274 [debug] [Thread-1 (]: Finished running node model.weather_dbt.wind_speed_analysis
[0m18:03:13.000366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:13.000777 [debug] [MainThread]: Connection 'model.weather_dbt.wind_speed_analysis' was properly closed.
[0m18:03:13.001218 [info ] [MainThread]: 
[0m18:03:13.001581 [info ] [MainThread]: Finished running 7 table models, 1 view model in 0 hours 0 minutes and 12.50 seconds (12.50s).
[0m18:03:13.003247 [debug] [MainThread]: Command end result
[0m18:03:13.033314 [info ] [MainThread]: 
[0m18:03:13.033738 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:03:13.034170 [info ] [MainThread]: 
[0m18:03:13.034436 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m18:03:13.036461 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.714704, "process_in_blocks": "0", "process_kernel_time": 0.297712, "process_mem_max_rss": "149929984", "process_out_blocks": "0", "process_user_time": 2.408352}
[0m18:03:13.036859 [debug] [MainThread]: Command `dbt run` succeeded at 18:03:13.036795 after 13.72 seconds
[0m18:03:13.037091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ea7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f343b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f340c50>]}
[0m18:03:13.037316 [debug] [MainThread]: Flushing usage events
[0m18:03:18.384991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f64d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10488fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10488fd90>]}


============================== 18:03:18.387711 | abb1a975-a5d7-4063-ba3a-c5a797721d55 ==============================
[0m18:03:18.387711 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:03:18.388023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:03:18.594509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abb1a975-a5d7-4063-ba3a-c5a797721d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054dab10>]}
[0m18:03:18.617139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abb1a975-a5d7-4063-ba3a-c5a797721d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054dc050>]}
[0m18:03:18.617774 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:03:18.677494 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:03:18.761114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:03:18.761358 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:03:18.788121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abb1a975-a5d7-4063-ba3a-c5a797721d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105361450>]}
[0m18:03:18.860787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abb1a975-a5d7-4063-ba3a-c5a797721d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10597f7a0>]}
[0m18:03:18.861069 [info ] [MainThread]: Found 8 models, 7 snapshots, 27 data tests, 2 sources, 459 macros
[0m18:03:18.861237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abb1a975-a5d7-4063-ba3a-c5a797721d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10596b690>]}
[0m18:03:18.862694 [info ] [MainThread]: 
[0m18:03:18.863000 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:03:18.865349 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_snapshot'
[0m18:03:18.875390 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m18:03:18.875698 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m18:03:18.875924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:19.435019 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8b51b-0004-386c-0002-594300043c3e
[0m18:03:19.435644 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:03:19.436066 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:03:19.436300 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:03:19.436632 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m18:03:19.564860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m18:03:19.566278 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m18:03:19.566642 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m18:03:19.566927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:20.080511 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.513 seconds
[0m18:03:20.084160 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m18:03:20.206165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abb1a975-a5d7-4063-ba3a-c5a797721d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac6820>]}
[0m18:03:20.207187 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m18:03:20.207660 [info ] [MainThread]: 
[0m18:03:20.212306 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m18:03:20.212799 [info ] [Thread-1 (]: 1 of 27 START test not_null_cloud_coverage_over_time_avg_cloud_coverage ........ [RUN]
[0m18:03:20.213297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86)
[0m18:03:20.213997 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m18:03:20.230761 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m18:03:20.231850 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m18:03:20.247264 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m18:03:20.248072 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m18:03:20.248317 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_cloud_coverage
from openweather.analytics.cloud_coverage_over_time
where avg_cloud_coverage is null



      
    ) dbt_internal_test
[0m18:03:20.248531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:20.804174 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.555 seconds
[0m18:03:20.815429 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86: Close
[0m18:03:20.963108 [info ] [Thread-1 (]: 1 of 27 PASS not_null_cloud_coverage_over_time_avg_cloud_coverage .............. [[32mPASS[0m in 0.75s]
[0m18:03:20.964671 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m18:03:20.965369 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m18:03:20.966112 [info ] [Thread-1 (]: 2 of 27 START test not_null_cloud_coverage_over_time_city_name ................. [RUN]
[0m18:03:20.966825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86, now test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f)
[0m18:03:20.967260 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m18:03:20.972675 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m18:03:20.973738 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m18:03:20.976110 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m18:03:20.977932 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m18:03:20.978309 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.cloud_coverage_over_time
where city_name is null



      
    ) dbt_internal_test
[0m18:03:20.978607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:21.599049 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m18:03:21.602849 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f: Close
[0m18:03:21.728515 [info ] [Thread-1 (]: 2 of 27 PASS not_null_cloud_coverage_over_time_city_name ....................... [[32mPASS[0m in 0.76s]
[0m18:03:21.729212 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m18:03:21.729640 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m18:03:21.730088 [info ] [Thread-1 (]: 3 of 27 START test not_null_cloud_coverage_over_time_day ....................... [RUN]
[0m18:03:21.730535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f, now test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9)
[0m18:03:21.730827 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m18:03:21.734641 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m18:03:21.735626 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m18:03:21.737940 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m18:03:21.738975 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m18:03:21.739251 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from openweather.analytics.cloud_coverage_over_time
where day is null



      
    ) dbt_internal_test
[0m18:03:21.739491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:22.246052 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.506 seconds
[0m18:03:22.247519 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9: Close
[0m18:03:22.357432 [info ] [Thread-1 (]: 3 of 27 PASS not_null_cloud_coverage_over_time_day ............................. [[32mPASS[0m in 0.63s]
[0m18:03:22.358400 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m18:03:22.359005 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m18:03:22.359554 [info ] [Thread-1 (]: 4 of 27 START test not_null_correlation_avg_humidity ........................... [RUN]
[0m18:03:22.360146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9, now test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d)
[0m18:03:22.360581 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m18:03:22.366179 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m18:03:22.367425 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m18:03:22.369913 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m18:03:22.371081 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m18:03:22.371473 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_humidity
from openweather.analytics.correlation
where avg_humidity is null



      
    ) dbt_internal_test
[0m18:03:22.371805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:22.838259 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.466 seconds
[0m18:03:22.840789 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d: Close
[0m18:03:22.957012 [info ] [Thread-1 (]: 4 of 27 PASS not_null_correlation_avg_humidity ................................. [[32mPASS[0m in 0.60s]
[0m18:03:22.957629 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m18:03:22.957916 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m18:03:22.958280 [info ] [Thread-1 (]: 5 of 27 START test not_null_correlation_avg_pressure ........................... [RUN]
[0m18:03:22.958744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d, now test.weather_dbt.not_null_correlation_avg_pressure.46419021da)
[0m18:03:22.959038 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m18:03:22.965249 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m18:03:22.965950 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m18:03:22.967602 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m18:03:22.968376 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m18:03:22.968620 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_pressure.46419021da: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_pressure
from openweather.analytics.correlation
where avg_pressure is null



      
    ) dbt_internal_test
[0m18:03:22.968832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:23.480508 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.511 seconds
[0m18:03:23.484725 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_pressure.46419021da: Close
[0m18:03:23.683111 [info ] [Thread-1 (]: 5 of 27 PASS not_null_correlation_avg_pressure ................................. [[32mPASS[0m in 0.72s]
[0m18:03:23.684503 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m18:03:23.685048 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m18:03:23.685565 [info ] [Thread-1 (]: 6 of 27 START test not_null_correlation_avg_temp ............................... [RUN]
[0m18:03:23.686174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_pressure.46419021da, now test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61)
[0m18:03:23.686589 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m18:03:23.692324 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m18:03:23.693662 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m18:03:23.696113 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m18:03:23.697462 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m18:03:23.697936 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp
from openweather.analytics.correlation
where avg_temp is null



      
    ) dbt_internal_test
[0m18:03:23.698262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:24.372514 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.674 seconds
[0m18:03:24.377317 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61: Close
[0m18:03:24.518360 [info ] [Thread-1 (]: 6 of 27 PASS not_null_correlation_avg_temp ..................................... [[32mPASS[0m in 0.83s]
[0m18:03:24.519513 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m18:03:24.520081 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m18:03:24.520583 [info ] [Thread-1 (]: 7 of 27 START test not_null_correlation_avg_wind_speed ......................... [RUN]
[0m18:03:24.521164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61, now test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9)
[0m18:03:24.521582 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m18:03:24.527060 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m18:03:24.528254 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m18:03:24.530577 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m18:03:24.532125 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m18:03:24.532704 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_wind_speed
from openweather.analytics.correlation
where avg_wind_speed is null



      
    ) dbt_internal_test
[0m18:03:24.533066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:25.053370 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.520 seconds
[0m18:03:25.057921 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9: Close
[0m18:03:25.263107 [info ] [Thread-1 (]: 7 of 27 PASS not_null_correlation_avg_wind_speed ............................... [[32mPASS[0m in 0.74s]
[0m18:03:25.263781 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m18:03:25.264172 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m18:03:25.264563 [info ] [Thread-1 (]: 8 of 27 START test not_null_correlation_city_name .............................. [RUN]
[0m18:03:25.264978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9, now test.weather_dbt.not_null_correlation_city_name.d4bb85e888)
[0m18:03:25.265291 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m18:03:25.269437 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m18:03:25.270587 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m18:03:25.302554 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m18:03:25.303278 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m18:03:25.303462 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_city_name.d4bb85e888: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.correlation
where city_name is null



      
    ) dbt_internal_test
[0m18:03:25.303622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:25.923809 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.619 seconds
[0m18:03:25.928468 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_city_name.d4bb85e888: Close
[0m18:03:26.068650 [info ] [Thread-1 (]: 8 of 27 PASS not_null_correlation_city_name .................................... [[32mPASS[0m in 0.80s]
[0m18:03:26.069799 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m18:03:26.070423 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m18:03:26.071072 [info ] [Thread-1 (]: 9 of 27 START test not_null_extreme_weather_events_city_id ..................... [RUN]
[0m18:03:26.071776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_city_name.d4bb85e888, now test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4)
[0m18:03:26.072205 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m18:03:26.077539 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m18:03:26.078646 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m18:03:26.080751 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m18:03:26.082033 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m18:03:26.082444 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_id
from openweather.analytics.extreme_weather_events
where city_id is null



      
    ) dbt_internal_test
[0m18:03:26.082785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:26.778603 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.695 seconds
[0m18:03:26.782630 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4: Close
[0m18:03:26.968684 [info ] [Thread-1 (]: 9 of 27 PASS not_null_extreme_weather_events_city_id ........................... [[32mPASS[0m in 0.90s]
[0m18:03:26.969708 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m18:03:26.970218 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m18:03:26.970752 [info ] [Thread-1 (]: 10 of 27 START test not_null_extreme_weather_events_city_name .................. [RUN]
[0m18:03:26.971358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4, now test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589)
[0m18:03:26.971793 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m18:03:26.976990 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m18:03:26.978225 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m18:03:26.980405 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m18:03:26.982022 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m18:03:26.982588 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.extreme_weather_events
where city_name is null



      
    ) dbt_internal_test
[0m18:03:26.982918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:27.489530 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.506 seconds
[0m18:03:27.493912 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589: Close
[0m18:03:27.655209 [info ] [Thread-1 (]: 10 of 27 PASS not_null_extreme_weather_events_city_name ........................ [[32mPASS[0m in 0.68s]
[0m18:03:27.655803 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m18:03:27.656154 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m18:03:27.656499 [info ] [Thread-1 (]: 11 of 27 START test not_null_extreme_weather_events_date_time .................. [RUN]
[0m18:03:27.656864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589, now test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853)
[0m18:03:27.657138 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m18:03:27.660790 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m18:03:27.661793 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m18:03:27.663660 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m18:03:27.664740 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m18:03:27.665012 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_time
from openweather.analytics.extreme_weather_events
where date_time is null



      
    ) dbt_internal_test
[0m18:03:27.665249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:28.243986 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.578 seconds
[0m18:03:28.248923 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853: Close
[0m18:03:28.542436 [info ] [Thread-1 (]: 11 of 27 PASS not_null_extreme_weather_events_date_time ........................ [[32mPASS[0m in 0.88s]
[0m18:03:28.543991 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m18:03:28.544554 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m18:03:28.545107 [info ] [Thread-1 (]: 12 of 27 START test not_null_extreme_weather_events_temp_fahrenheit ............ [RUN]
[0m18:03:28.545750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853, now test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d)
[0m18:03:28.546177 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m18:03:28.551895 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m18:03:28.553173 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m18:03:28.555540 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m18:03:28.556508 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m18:03:28.556836 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_fahrenheit
from openweather.analytics.extreme_weather_events
where temp_fahrenheit is null



      
    ) dbt_internal_test
[0m18:03:28.557155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:29.063240 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.505 seconds
[0m18:03:29.067755 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d: Close
[0m18:03:29.187380 [info ] [Thread-1 (]: 12 of 27 PASS not_null_extreme_weather_events_temp_fahrenheit .................. [[32mPASS[0m in 0.64s]
[0m18:03:29.188520 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m18:03:29.189164 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m18:03:29.189819 [info ] [Thread-1 (]: 13 of 27 START test not_null_extreme_weather_events_weather_alert .............. [RUN]
[0m18:03:29.190546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d, now test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb)
[0m18:03:29.191074 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m18:03:29.196787 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m18:03:29.197894 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m18:03:29.200283 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m18:03:29.201888 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m18:03:29.202546 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_alert
from openweather.analytics.extreme_weather_events
where weather_alert is null



      
    ) dbt_internal_test
[0m18:03:29.203028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:29.793097 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.590 seconds
[0m18:03:29.798175 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb: Close
[0m18:03:30.008438 [info ] [Thread-1 (]: 13 of 27 PASS not_null_extreme_weather_events_weather_alert .................... [[32mPASS[0m in 0.82s]
[0m18:03:30.009344 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m18:03:30.009796 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m18:03:30.010266 [info ] [Thread-1 (]: 14 of 27 START test not_null_extreme_weather_events_wind_speed ................. [RUN]
[0m18:03:30.010823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb, now test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4)
[0m18:03:30.011208 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m18:03:30.015477 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m18:03:30.016639 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m18:03:30.018865 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m18:03:30.019908 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m18:03:30.020435 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select wind_speed
from openweather.analytics.extreme_weather_events
where wind_speed is null



      
    ) dbt_internal_test
[0m18:03:30.021086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:30.701726 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m18:03:30.705929 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4: Close
[0m18:03:30.840568 [info ] [Thread-1 (]: 14 of 27 PASS not_null_extreme_weather_events_wind_speed ....................... [[32mPASS[0m in 0.83s]
[0m18:03:30.841865 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m18:03:30.842421 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m18:03:30.842965 [info ] [Thread-1 (]: 15 of 27 START test not_null_humidity_vs_temp_city_name ........................ [RUN]
[0m18:03:30.843574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4, now test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042)
[0m18:03:30.843992 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m18:03:30.849117 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m18:03:30.850346 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m18:03:30.852296 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m18:03:30.853417 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m18:03:30.853875 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.humidity_vs_temp
where city_name is null



      
    ) dbt_internal_test
[0m18:03:30.854159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:31.438279 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.584 seconds
[0m18:03:31.442554 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042: Close
[0m18:03:31.583143 [info ] [Thread-1 (]: 15 of 27 PASS not_null_humidity_vs_temp_city_name .............................. [[32mPASS[0m in 0.74s]
[0m18:03:31.584044 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m18:03:31.584617 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m18:03:31.585094 [info ] [Thread-1 (]: 16 of 27 START test not_null_humidity_vs_temp_humidity ......................... [RUN]
[0m18:03:31.585919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042, now test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573)
[0m18:03:31.586617 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m18:03:31.591972 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m18:03:31.593331 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m18:03:31.595599 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m18:03:31.597079 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"
[0m18:03:31.597499 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select humidity
from openweather.analytics.humidity_vs_temp
where humidity is null



      
    ) dbt_internal_test
[0m18:03:31.597835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:32.017013 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b51b-0004-386c-0002-594300043c4e
[0m18:03:32.017458 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'HUMIDITY'
[0m18:03:32.017765 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573: Close
[0m18:03:32.128944 [debug] [Thread-1 (]: Database Error in test not_null_humidity_vs_temp_humidity (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'HUMIDITY'
  compiled code at target/run/weather_dbt/models/schema.yml/not_null_humidity_vs_temp_humidity.sql
[0m18:03:32.129326 [error] [Thread-1 (]: 16 of 27 ERROR not_null_humidity_vs_temp_humidity .............................. [[31mERROR[0m in 0.54s]
[0m18:03:32.129638 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573
[0m18:03:32.129844 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m18:03:32.130499 [info ] [Thread-1 (]: 17 of 27 START test not_null_humidity_vs_temp_temp_fahrenheit .................. [RUN]
[0m18:03:32.130882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_humidity.5c6b19a573, now test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5)
[0m18:03:32.131102 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m18:03:32.133324 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m18:03:32.133780 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m18:03:32.134819 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m18:03:32.135453 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"
[0m18:03:32.135680 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_fahrenheit
from openweather.analytics.humidity_vs_temp
where temp_fahrenheit is null



      
    ) dbt_internal_test
[0m18:03:32.135855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:32.692785 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b51b-0004-3867-0002-594300045c9a
[0m18:03:32.693651 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'TEMP_FAHRENHEIT'
[0m18:03:32.694593 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5: Close
[0m18:03:32.819031 [debug] [Thread-1 (]: Database Error in test not_null_humidity_vs_temp_temp_fahrenheit (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'TEMP_FAHRENHEIT'
  compiled code at target/run/weather_dbt/models/schema.yml/not_null_humidity_vs_temp_temp_fahrenheit.sql
[0m18:03:32.819742 [error] [Thread-1 (]: 17 of 27 ERROR not_null_humidity_vs_temp_temp_fahrenheit ....................... [[31mERROR[0m in 0.69s]
[0m18:03:32.820368 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5
[0m18:03:32.820779 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m18:03:32.821263 [info ] [Thread-1 (]: 18 of 27 START test not_null_temp_trends_by_city_avg_temp_fahrenheit ........... [RUN]
[0m18:03:32.821764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_temp_fahrenheit.082fb3a1a5, now test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae)
[0m18:03:32.822128 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m18:03:32.827065 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m18:03:32.828183 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m18:03:32.830163 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m18:03:32.831066 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m18:03:32.831689 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp_fahrenheit
from openweather.analytics.temp_trends_by_city
where avg_temp_fahrenheit is null



      
    ) dbt_internal_test
[0m18:03:32.832225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:33.322876 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.490 seconds
[0m18:03:33.325939 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae: Close
[0m18:03:33.473511 [info ] [Thread-1 (]: 18 of 27 PASS not_null_temp_trends_by_city_avg_temp_fahrenheit ................. [[32mPASS[0m in 0.65s]
[0m18:03:33.474373 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m18:03:33.474811 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m18:03:33.475256 [info ] [Thread-1 (]: 19 of 27 START test not_null_temp_trends_by_city_city_name ..................... [RUN]
[0m18:03:33.475812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae, now test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b)
[0m18:03:33.476325 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m18:03:33.482254 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m18:03:33.483598 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m18:03:33.486016 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m18:03:33.487520 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m18:03:33.487939 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.temp_trends_by_city
where city_name is null



      
    ) dbt_internal_test
[0m18:03:33.488282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:34.253102 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.764 seconds
[0m18:03:34.257152 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b: Close
[0m18:03:34.409234 [info ] [Thread-1 (]: 19 of 27 PASS not_null_temp_trends_by_city_city_name ........................... [[32mPASS[0m in 0.93s]
[0m18:03:34.410358 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m18:03:34.410964 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m18:03:34.411665 [info ] [Thread-1 (]: 20 of 27 START test not_null_temp_trends_by_city_day ........................... [RUN]
[0m18:03:34.412462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b, now test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019)
[0m18:03:34.412911 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m18:03:34.418557 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m18:03:34.419661 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m18:03:34.422072 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m18:03:34.423559 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m18:03:34.424326 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from openweather.analytics.temp_trends_by_city
where day is null



      
    ) dbt_internal_test
[0m18:03:34.424798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:35.036610 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m18:03:35.038463 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019: Close
[0m18:03:35.158007 [info ] [Thread-1 (]: 20 of 27 PASS not_null_temp_trends_by_city_day ................................. [[32mPASS[0m in 0.75s]
[0m18:03:35.158634 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m18:03:35.158899 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m18:03:35.159097 [info ] [Thread-1 (]: 21 of 27 START test not_null_weather_cond_distribution_city_name ............... [RUN]
[0m18:03:35.159382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019, now test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec)
[0m18:03:35.159573 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m18:03:35.162135 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m18:03:35.162668 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m18:03:35.163730 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m18:03:35.164238 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m18:03:35.164428 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.weather_cond_distribution
where city_name is null



      
    ) dbt_internal_test
[0m18:03:35.164590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:35.628041 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.463 seconds
[0m18:03:35.629947 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec: Close
[0m18:03:35.744200 [info ] [Thread-1 (]: 21 of 27 PASS not_null_weather_cond_distribution_city_name ..................... [[32mPASS[0m in 0.58s]
[0m18:03:35.744943 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m18:03:35.745255 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m18:03:35.745514 [info ] [Thread-1 (]: 22 of 27 START test not_null_weather_cond_distribution_count ................... [RUN]
[0m18:03:35.745776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec, now test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4)
[0m18:03:35.745976 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m18:03:35.748443 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m18:03:35.748932 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m18:03:35.749929 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m18:03:35.750423 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m18:03:35.750591 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select count
from openweather.analytics.weather_cond_distribution
where count is null



      
    ) dbt_internal_test
[0m18:03:35.750757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:36.276685 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.525 seconds
[0m18:03:36.281044 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4: Close
[0m18:03:36.519151 [info ] [Thread-1 (]: 22 of 27 PASS not_null_weather_cond_distribution_count ......................... [[32mPASS[0m in 0.77s]
[0m18:03:36.520022 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m18:03:36.520418 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m18:03:36.520732 [info ] [Thread-1 (]: 23 of 27 START test not_null_weather_cond_distribution_weather_main ............ [RUN]
[0m18:03:36.521091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4, now test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6)
[0m18:03:36.521485 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m18:03:36.525849 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m18:03:36.527239 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m18:03:36.529950 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m18:03:36.531049 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m18:03:36.531529 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_main
from openweather.analytics.weather_cond_distribution
where weather_main is null



      
    ) dbt_internal_test
[0m18:03:36.532008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:37.033579 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.501 seconds
[0m18:03:37.035984 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6: Close
[0m18:03:37.143903 [info ] [Thread-1 (]: 23 of 27 PASS not_null_weather_cond_distribution_weather_main .................. [[32mPASS[0m in 0.62s]
[0m18:03:37.144362 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m18:03:37.144599 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m18:03:37.144853 [info ] [Thread-1 (]: 24 of 27 START test not_null_wind_speed_analysis_city_name ..................... [RUN]
[0m18:03:37.145133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6, now test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9)
[0m18:03:37.145341 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m18:03:37.147614 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m18:03:37.148129 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m18:03:37.149244 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m18:03:37.149776 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m18:03:37.149975 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.wind_speed_analysis
where city_name is null



      
    ) dbt_internal_test
[0m18:03:37.150160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:37.659049 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.508 seconds
[0m18:03:37.661763 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9: Close
[0m18:03:37.791012 [info ] [Thread-1 (]: 24 of 27 PASS not_null_wind_speed_analysis_city_name ........................... [[32mPASS[0m in 0.65s]
[0m18:03:37.792028 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m18:03:37.792474 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m18:03:37.792826 [info ] [Thread-1 (]: 25 of 27 START test not_null_wind_speed_analysis_wind_speed .................... [RUN]
[0m18:03:37.793258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9, now test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2)
[0m18:03:37.793607 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m18:03:37.798439 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m18:03:37.799414 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m18:03:37.801375 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m18:03:37.802403 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"
[0m18:03:37.802768 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select wind_speed
from openweather.analytics.wind_speed_analysis
where wind_speed is null



      
    ) dbt_internal_test
[0m18:03:37.803102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:38.377353 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b51b-0004-3865-0002-59430003fd16
[0m18:03:38.378488 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'WIND_SPEED'
[0m18:03:38.379102 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2: Close
[0m18:03:38.507037 [debug] [Thread-1 (]: Database Error in test not_null_wind_speed_analysis_wind_speed (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'WIND_SPEED'
  compiled code at target/run/weather_dbt/models/schema.yml/not_null_wind_speed_analysis_wind_speed.sql
[0m18:03:38.507568 [error] [Thread-1 (]: 25 of 27 ERROR not_null_wind_speed_analysis_wind_speed ......................... [[31mERROR[0m in 0.71s]
[0m18:03:38.507960 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2
[0m18:03:38.508232 [debug] [Thread-1 (]: Began running node test.weather_dbt.valid_temp
[0m18:03:38.508538 [info ] [Thread-1 (]: 26 of 27 START test valid_temp ................................................. [RUN]
[0m18:03:38.508819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_wind_speed_analysis_wind_speed.7f65722ff2, now test.weather_dbt.valid_temp)
[0m18:03:38.509026 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.valid_temp
[0m18:03:38.511154 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.valid_temp"
[0m18:03:38.511859 [debug] [Thread-1 (]: Began executing node test.weather_dbt.valid_temp
[0m18:03:38.513196 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.valid_temp"
[0m18:03:38.514345 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.valid_temp"
[0m18:03:38.514705 [debug] [Thread-1 (]: On test.weather_dbt.valid_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.valid_temp"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- checking valid temperature values for extreme_weather_events.sql
SELECT
    CITY_ID,
    DATE_TIME,
    TEMP_FAHRENHEIT
FROM openweather.analytics.extreme_weather_events
WHERE TEMP_FAHRENHEIT IS NULL
   OR TEMP_FAHRENHEIT < -100 OR TEMP_FAHRENHEIT > 150
      
    ) dbt_internal_test
[0m18:03:38.514994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:39.026418 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.511 seconds
[0m18:03:39.031729 [debug] [Thread-1 (]: On test.weather_dbt.valid_temp: Close
[0m18:03:39.210785 [info ] [Thread-1 (]: 26 of 27 PASS valid_temp ....................................................... [[32mPASS[0m in 0.70s]
[0m18:03:39.211662 [debug] [Thread-1 (]: Finished running node test.weather_dbt.valid_temp
[0m18:03:39.212123 [debug] [Thread-1 (]: Began running node test.weather_dbt.weather_alert_consistency
[0m18:03:39.212508 [info ] [Thread-1 (]: 27 of 27 START test weather_alert_consistency .................................. [RUN]
[0m18:03:39.213049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.valid_temp, now test.weather_dbt.weather_alert_consistency)
[0m18:03:39.213536 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.weather_alert_consistency
[0m18:03:39.216349 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.weather_alert_consistency"
[0m18:03:39.217510 [debug] [Thread-1 (]: Began executing node test.weather_dbt.weather_alert_consistency
[0m18:03:39.220034 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.weather_alert_consistency"
[0m18:03:39.221271 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.weather_alert_consistency"
[0m18:03:39.221609 [debug] [Thread-1 (]: On test.weather_dbt.weather_alert_consistency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.weather_alert_consistency"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- This test checks for consistency in the weather alerts generated in the extreme_weather_events table.
SELECT
    CITY_ID,
    DATE_TIME,
    WEATHER_ALERT,
    TEMP_FAHRENHEIT,
    WIND_SPEED
FROM openweather.analytics.extreme_weather_events
WHERE 
    (WEATHER_ALERT = 'Extreme Heat' AND TEMP_FAHRENHEIT <= 100)
    OR (WEATHER_ALERT = 'Extreme Cold' AND TEMP_FAHRENHEIT >= 32)
    OR (WEATHER_ALERT = 'High Winds' AND WIND_SPEED <= 20)
      
    ) dbt_internal_test
[0m18:03:39.221907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:39.734453 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.512 seconds
[0m18:03:39.739499 [debug] [Thread-1 (]: On test.weather_dbt.weather_alert_consistency: Close
[0m18:03:39.850191 [info ] [Thread-1 (]: 27 of 27 PASS weather_alert_consistency ........................................ [[32mPASS[0m in 0.64s]
[0m18:03:39.851303 [debug] [Thread-1 (]: Finished running node test.weather_dbt.weather_alert_consistency
[0m18:03:39.853338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:39.853756 [debug] [MainThread]: Connection 'test.weather_dbt.weather_alert_consistency' was properly closed.
[0m18:03:39.854232 [info ] [MainThread]: 
[0m18:03:39.854670 [info ] [MainThread]: Finished running 27 data tests in 0 hours 0 minutes and 20.99 seconds (20.99s).
[0m18:03:39.859172 [debug] [MainThread]: Command end result
[0m18:03:39.892800 [info ] [MainThread]: 
[0m18:03:39.893142 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m18:03:39.893337 [info ] [MainThread]: 
[0m18:03:39.893716 [error] [MainThread]:   Database Error in test not_null_humidity_vs_temp_humidity (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'HUMIDITY'
  compiled code at target/run/weather_dbt/models/schema.yml/not_null_humidity_vs_temp_humidity.sql
[0m18:03:39.893902 [info ] [MainThread]: 
[0m18:03:39.894114 [error] [MainThread]:   Database Error in test not_null_humidity_vs_temp_temp_fahrenheit (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'TEMP_FAHRENHEIT'
  compiled code at target/run/weather_dbt/models/schema.yml/not_null_humidity_vs_temp_temp_fahrenheit.sql
[0m18:03:39.894274 [info ] [MainThread]: 
[0m18:03:39.894470 [error] [MainThread]:   Database Error in test not_null_wind_speed_analysis_wind_speed (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'WIND_SPEED'
  compiled code at target/run/weather_dbt/models/schema.yml/not_null_wind_speed_analysis_wind_speed.sql
[0m18:03:39.894651 [info ] [MainThread]: 
[0m18:03:39.894848 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=3 SKIP=0 TOTAL=27
[0m18:03:39.896425 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 21.54633, "process_in_blocks": "0", "process_kernel_time": 0.424057, "process_mem_max_rss": "141705216", "process_out_blocks": "0", "process_user_time": 3.053012}
[0m18:03:39.896892 [debug] [MainThread]: Command `dbt test` failed at 18:03:39.896822 after 21.55 seconds
[0m18:03:39.897195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104649910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da7750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da6af0>]}
[0m18:03:39.897400 [debug] [MainThread]: Flushing usage events
[0m18:04:04.814850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c13b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c13d90>]}


============================== 18:04:04.817951 | 4d7b104c-5b0f-4cad-8a48-784a038388f4 ==============================
[0m18:04:04.817951 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:04:04.818318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m18:04:05.043722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d7b104c-5b0f-4cad-8a48-784a038388f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11340ab10>]}
[0m18:04:05.068243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d7b104c-5b0f-4cad-8a48-784a038388f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11340c050>]}
[0m18:04:05.068995 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:04:05.130313 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:04:05.218910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:04:05.219152 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:04:05.245903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d7b104c-5b0f-4cad-8a48-784a038388f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11316d450>]}
[0m18:04:05.311828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d7b104c-5b0f-4cad-8a48-784a038388f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113141400>]}
[0m18:04:05.312126 [info ] [MainThread]: Found 8 models, 7 snapshots, 27 data tests, 2 sources, 459 macros
[0m18:04:05.312298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d7b104c-5b0f-4cad-8a48-784a038388f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142467b0>]}
[0m18:04:05.313548 [info ] [MainThread]: 
[0m18:04:05.313852 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:04:05.316013 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m18:04:05.323444 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m18:04:05.323678 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m18:04:05.323823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:05.941457 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.617 seconds
[0m18:04:05.945461 [debug] [ThreadPool]: On list_openweather: Close
[0m18:04:06.093728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now create_openweather_snapshot)
[0m18:04:06.095006 [debug] [ThreadPool]: Creating schema "database: "openweather"
schema: "snapshot"
"
[0m18:04:06.101467 [debug] [ThreadPool]: Using snowflake connection "create_openweather_snapshot"
[0m18:04:06.101882 [debug] [ThreadPool]: On create_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "create_openweather_snapshot"} */
create schema if not exists openweather.snapshot
[0m18:04:06.102240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:06.584133 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.481 seconds
[0m18:04:06.587038 [debug] [ThreadPool]: On create_openweather_snapshot: Close
[0m18:04:06.735703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_openweather_snapshot, now list_openweather_analytics)
[0m18:04:06.745965 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m18:04:06.746361 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m18:04:06.746648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:07.228184 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.481 seconds
[0m18:04:07.232764 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m18:04:07.349171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m18:04:07.353772 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m18:04:07.354172 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m18:04:07.354488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:07.783672 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.429 seconds
[0m18:04:07.785800 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m18:04:07.924550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d7b104c-5b0f-4cad-8a48-784a038388f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114231a50>]}
[0m18:04:07.925715 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m18:04:07.930591 [info ] [MainThread]: 
[0m18:04:07.934717 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_cloud_coverage
[0m18:04:07.935656 [info ] [Thread-1 (]: 1 of 7 START snapshot snapshot.snapshot_cloud_coverage ......................... [RUN]
[0m18:04:07.936401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now snapshot.weather_dbt.snapshot_cloud_coverage)
[0m18:04:07.936837 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_cloud_coverage
[0m18:04:07.948190 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_cloud_coverage
[0m18:04:07.997073 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:04:07.997430 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id,
        DAY as dbt_updated_at,
        DAY as dbt_valid_from,
        
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
from (
        



WITH CloudCoverage AS (
    SELECT 
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m18:04:07.997640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:08.497669 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.499 seconds
[0m18:04:08.507039 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:04:08.507646 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:04:08.601249 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.093 seconds
[0m18:04:08.603325 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:04:08.606441 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:04:08.607082 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
create or replace transient table openweather.snapshot.snapshot_cloud_coverage
         as
        (
    

    select *,
        md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id,
        DAY as dbt_updated_at,
        DAY as dbt_valid_from,
        
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
from (
        



WITH CloudCoverage AS (
    SELECT 
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY

    ) sbq



        );
[0m18:04:09.443027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.835 seconds
[0m18:04:09.470425 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: Close
[0m18:04:09.601110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d7b104c-5b0f-4cad-8a48-784a038388f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11453e150>]}
[0m18:04:09.601685 [info ] [Thread-1 (]: 1 of 7 OK snapshotted snapshot.snapshot_cloud_coverage ......................... [[32mSUCCESS 1[0m in 1.66s]
[0m18:04:09.602020 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_cloud_coverage
[0m18:04:09.602269 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_correlation_data
[0m18:04:09.602574 [info ] [Thread-1 (]: 2 of 7 START snapshot snapshot.snapshot_correlation_data ....................... [RUN]
[0m18:04:09.602868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_cloud_coverage, now snapshot.weather_dbt.snapshot_correlation_data)
[0m18:04:09.603064 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_correlation_data
[0m18:04:09.604903 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_correlation_data
[0m18:04:09.618189 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:04:09.618531 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m18:04:09.618763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:10.139923 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.520 seconds
[0m18:04:10.142218 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:04:10.142772 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:04:10.257531 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.114 seconds
[0m18:04:10.259729 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:04:10.263277 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:04:10.263850 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
create or replace transient table openweather.snapshot.snapshot_correlation_data
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData

    ) sbq



        );
[0m18:04:11.078915 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.814 seconds
[0m18:04:11.084904 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: Close
[0m18:04:11.216159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d7b104c-5b0f-4cad-8a48-784a038388f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145f7c20>]}
[0m18:04:11.217562 [info ] [Thread-1 (]: 2 of 7 OK snapshotted snapshot.snapshot_correlation_data ....................... [[32mSUCCESS 1[0m in 1.61s]
[0m18:04:11.218437 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_correlation_data
[0m18:04:11.219028 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m18:04:11.219763 [info ] [Thread-1 (]: 3 of 7 START snapshot snapshot.snapshot_extreme_weather_events ................. [RUN]
[0m18:04:11.220358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_correlation_data, now snapshot.weather_dbt.snapshot_extreme_weather_events)
[0m18:04:11.220797 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m18:04:11.226460 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m18:04:11.231360 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:04:11.232305 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m18:04:11.232868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:11.678822 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.446 seconds
[0m18:04:11.681664 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:04:11.682242 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:04:11.759080 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.076 seconds
[0m18:04:11.759914 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:04:11.761854 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:04:11.762188 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
create or replace transient table openweather.snapshot.snapshot_extreme_weather_events
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id,
        DATE_TIME as dbt_updated_at,
        DATE_TIME as dbt_valid_from,
        
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
from (
        



WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME

    ) sbq



        );
[0m18:04:12.509851 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.747 seconds
[0m18:04:12.511767 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: Close
[0m18:04:12.643717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d7b104c-5b0f-4cad-8a48-784a038388f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c83a70>]}
[0m18:04:12.644753 [info ] [Thread-1 (]: 3 of 7 OK snapshotted snapshot.snapshot_extreme_weather_events ................. [[32mSUCCESS 1[0m in 1.42s]
[0m18:04:12.645381 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m18:04:12.645807 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_humidity_temperature
[0m18:04:12.646349 [info ] [Thread-1 (]: 4 of 7 START snapshot snapshot.snapshot_humidity_temperature ................... [RUN]
[0m18:04:12.646876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_extreme_weather_events, now snapshot.weather_dbt.snapshot_humidity_temperature)
[0m18:04:12.647246 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_humidity_temperature
[0m18:04:12.651284 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_humidity_temperature
[0m18:04:12.656043 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:04:12.656464 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(['DAY'] as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id,
        DAY as dbt_updated_at,
        DAY as dbt_valid_from,
        
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
from (
        



WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(TEMP_FAHRENHEIT) AS AVG_TEMP_FAHRENHEIT,
    AVG(HUMIDITY) AS AVG_HUMIDITY
FROM HumidityTemp
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m18:04:12.656828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:13.078721 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.421 seconds
[0m18:04:13.082203 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:04:13.082916 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:04:13.185339 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.101 seconds
[0m18:04:13.186930 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:04:13.189533 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:04:13.190039 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
create or replace transient table openweather.snapshot.snapshot_humidity_temperature
         as
        (
    

    select *,
        md5(coalesce(cast(['DAY'] as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id,
        DAY as dbt_updated_at,
        DAY as dbt_valid_from,
        
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
from (
        



WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(TEMP_FAHRENHEIT) AS AVG_TEMP_FAHRENHEIT,
    AVG(HUMIDITY) AS AVG_HUMIDITY
FROM HumidityTemp
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY

    ) sbq



        );
[0m18:04:14.356144 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.165 seconds
[0m18:04:14.361845 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: Close
[0m18:04:14.508966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d7b104c-5b0f-4cad-8a48-784a038388f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140149d0>]}
[0m18:04:14.510085 [info ] [Thread-1 (]: 4 of 7 OK snapshotted snapshot.snapshot_humidity_temperature ................... [[32mSUCCESS 1[0m in 1.86s]
[0m18:04:14.510843 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_humidity_temperature
[0m18:04:14.511361 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_temp_trends
[0m18:04:14.511982 [info ] [Thread-1 (]: 5 of 7 START snapshot snapshot.snapshot_temp_trends ............................ [RUN]
[0m18:04:14.512584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_humidity_temperature, now snapshot.weather_dbt.snapshot_temp_trends)
[0m18:04:14.513015 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_temp_trends
[0m18:04:14.517034 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_temp_trends
[0m18:04:14.522197 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:04:14.522770 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id,
        DAY as dbt_updated_at,
        DAY as dbt_valid_from,
        
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
from (
        



WITH TempTrends AS (
    SELECT 
        "Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m18:04:14.523120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:14.988043 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.464 seconds
[0m18:04:14.990979 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:04:14.991511 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:04:15.086950 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.095 seconds
[0m18:04:15.088504 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:04:15.091425 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:04:15.092041 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
create or replace transient table openweather.snapshot.snapshot_temp_trends
         as
        (
    

    select *,
        md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id,
        DAY as dbt_updated_at,
        DAY as dbt_valid_from,
        
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
from (
        



WITH TempTrends AS (
    SELECT 
        "Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY

    ) sbq



        );
[0m18:04:15.995896 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.903 seconds
[0m18:04:16.001941 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: Close
[0m18:04:16.134973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d7b104c-5b0f-4cad-8a48-784a038388f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b4c8a0>]}
[0m18:04:16.136320 [info ] [Thread-1 (]: 5 of 7 OK snapshotted snapshot.snapshot_temp_trends ............................ [[32mSUCCESS 1[0m in 1.62s]
[0m18:04:16.137056 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_temp_trends
[0m18:04:16.137567 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_weather_distribution
[0m18:04:16.138195 [info ] [Thread-1 (]: 6 of 7 START snapshot snapshot.snapshot_weather_distribution ................... [RUN]
[0m18:04:16.138790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_temp_trends, now snapshot.weather_dbt.snapshot_weather_distribution)
[0m18:04:16.139232 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_weather_distribution
[0m18:04:16.143682 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_weather_distribution
[0m18:04:16.154554 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:04:16.154990 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, 3
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m18:04:16.155311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:16.640903 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.485 seconds
[0m18:04:16.643936 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:04:16.644729 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:04:16.722270 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.077 seconds
[0m18:04:16.723857 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:04:16.727030 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:04:16.727688 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
create or replace transient table openweather.snapshot.snapshot_weather_distribution
         as
        (
    

    select *,
        md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        



WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, 3
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC

    ) sbq



        );
[0m18:04:17.531321 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.803 seconds
[0m18:04:17.532962 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: Close
[0m18:04:17.643148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d7b104c-5b0f-4cad-8a48-784a038388f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114573c50>]}
[0m18:04:17.644412 [info ] [Thread-1 (]: 6 of 7 OK snapshotted snapshot.snapshot_weather_distribution ................... [[32mSUCCESS 1[0m in 1.50s]
[0m18:04:17.645196 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_weather_distribution
[0m18:04:17.645673 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_wind_speed
[0m18:04:17.646273 [info ] [Thread-1 (]: 7 of 7 START snapshot snapshot.snapshot_wind_speed ............................. [RUN]
[0m18:04:17.646867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_weather_distribution, now snapshot.weather_dbt.snapshot_wind_speed)
[0m18:04:17.647293 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_wind_speed
[0m18:04:17.651611 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_wind_speed
[0m18:04:17.656743 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:04:17.657687 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(['DAY'] as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id,
        DAY as dbt_updated_at,
        DAY as dbt_valid_from,
        
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
from (
        



WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(WIND_SPEED) AS AVG_WIND_SPEED
FROM WindSpeedData
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m18:04:17.658099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:18.280264 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.622 seconds
[0m18:04:18.282646 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:04:18.283165 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:04:18.407599 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.124 seconds
[0m18:04:18.409253 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:04:18.412118 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:04:18.412745 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
create or replace transient table openweather.snapshot.snapshot_wind_speed
         as
        (
    

    select *,
        md5(coalesce(cast(['DAY'] as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id,
        DAY as dbt_updated_at,
        DAY as dbt_valid_from,
        
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
from (
        



WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(WIND_SPEED) AS AVG_WIND_SPEED
FROM WindSpeedData
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY

    ) sbq



        );
[0m18:04:19.241659 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.828 seconds
[0m18:04:19.246048 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: Close
[0m18:04:19.377133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d7b104c-5b0f-4cad-8a48-784a038388f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145eaf90>]}
[0m18:04:19.378687 [info ] [Thread-1 (]: 7 of 7 OK snapshotted snapshot.snapshot_wind_speed ............................. [[32mSUCCESS 1[0m in 1.73s]
[0m18:04:19.379535 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_wind_speed
[0m18:04:19.381132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:19.381467 [debug] [MainThread]: Connection 'snapshot.weather_dbt.snapshot_wind_speed' was properly closed.
[0m18:04:19.381832 [info ] [MainThread]: 
[0m18:04:19.382171 [info ] [MainThread]: Finished running 7 snapshots in 0 hours 0 minutes and 14.07 seconds (14.07s).
[0m18:04:19.383559 [debug] [MainThread]: Command end result
[0m18:04:19.414324 [info ] [MainThread]: 
[0m18:04:19.414695 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:04:19.414910 [info ] [MainThread]: 
[0m18:04:19.415122 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:04:19.417547 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 14.642687, "process_in_blocks": "0", "process_kernel_time": 0.293993, "process_mem_max_rss": "140083200", "process_out_blocks": "0", "process_user_time": 1.977762}
[0m18:04:19.418000 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:04:19.417936 after 14.64 seconds
[0m18:04:19.418256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110689c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114573770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114573f50>]}
[0m18:04:19.418481 [debug] [MainThread]: Flushing usage events
[0m18:12:14.239494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027b4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105413b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105413d90>]}


============================== 18:12:14.242396 | 5ebb0f92-1e99-47d3-a7c1-4fe42efa0007 ==============================
[0m18:12:14.242396 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:12:14.242711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m18:12:14.295776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ebb0f92-1e99-47d3-a7c1-4fe42efa0007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10367f360>]}
[0m18:12:14.312737 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1084715, "process_in_blocks": "0", "process_kernel_time": 0.120543, "process_mem_max_rss": "97157120", "process_out_blocks": "0", "process_user_time": 0.61365}
[0m18:12:14.313094 [debug] [MainThread]: Command `dbt clean` succeeded at 18:12:14.313036 after 0.11 seconds
[0m18:12:14.313339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10553e580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10553e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052e2950>]}
[0m18:12:14.313553 [debug] [MainThread]: Flushing usage events
[0m18:12:18.305991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a13b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a13d90>]}


============================== 18:12:18.308327 | 90f12fe5-7283-45bc-bd8a-6f3b3c5df808 ==============================
[0m18:12:18.308327 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:12:18.308648 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:12:18.533349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90f12fe5-7283-45bc-bd8a-6f3b3c5df808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130eab10>]}
[0m18:12:18.556234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90f12fe5-7283-45bc-bd8a-6f3b3c5df808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130ec050>]}
[0m18:12:18.556887 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:12:18.615696 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:12:18.616273 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:12:18.616463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '90f12fe5-7283-45bc-bd8a-6f3b3c5df808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f70a50>]}
[0m18:12:19.231708 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:12:19.232025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '90f12fe5-7283-45bc-bd8a-6f3b3c5df808', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11336b7a0>]}
[0m18:12:19.384560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90f12fe5-7283-45bc-bd8a-6f3b3c5df808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143cd1d0>]}
[0m18:12:19.456665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90f12fe5-7283-45bc-bd8a-6f3b3c5df808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11442ac30>]}
[0m18:12:19.456946 [info ] [MainThread]: Found 8 models, 7 snapshots, 29 data tests, 2 sources, 459 macros
[0m18:12:19.457106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90f12fe5-7283-45bc-bd8a-6f3b3c5df808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144ba5d0>]}
[0m18:12:19.458329 [info ] [MainThread]: 
[0m18:12:19.458601 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:12:19.460931 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m18:12:19.468293 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m18:12:19.468546 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m18:12:19.468692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:20.145823 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.677 seconds
[0m18:12:20.148017 [debug] [ThreadPool]: On list_openweather: Close
[0m18:12:20.305373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m18:12:20.316559 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m18:12:20.317156 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m18:12:20.317495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:20.911051 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.593 seconds
[0m18:12:20.913024 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m18:12:21.038309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m18:12:21.040755 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m18:12:21.040989 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m18:12:21.041177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:21.596623 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.555 seconds
[0m18:12:21.598056 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m18:12:21.739032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90f12fe5-7283-45bc-bd8a-6f3b3c5df808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144455a0>]}
[0m18:12:21.739987 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m18:12:21.740359 [info ] [MainThread]: 
[0m18:12:21.743622 [debug] [Thread-1 (]: Began running node model.weather_dbt.cloud_coverage_over_time
[0m18:12:21.744193 [info ] [Thread-1 (]: 1 of 8 START sql table model analytics.cloud_coverage_over_time ................ [RUN]
[0m18:12:21.744608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now model.weather_dbt.cloud_coverage_over_time)
[0m18:12:21.744916 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.cloud_coverage_over_time
[0m18:12:21.751717 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.cloud_coverage_over_time"
[0m18:12:21.753336 [debug] [Thread-1 (]: Began executing node model.weather_dbt.cloud_coverage_over_time
[0m18:12:21.774973 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.cloud_coverage_over_time"
[0m18:12:21.776122 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.cloud_coverage_over_time"
[0m18:12:21.776357 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.cloud_coverage_over_time"} */
create or replace transient table openweather.analytics.cloud_coverage_over_time
         as
        (WITH CloudCoverage AS (
    SELECT 
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY
        );
[0m18:12:21.776559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:23.224007 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.447 seconds
[0m18:12:23.248795 [debug] [Thread-1 (]: On model.weather_dbt.cloud_coverage_over_time: Close
[0m18:12:23.366010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90f12fe5-7283-45bc-bd8a-6f3b3c5df808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dd7a70>]}
[0m18:12:23.367064 [info ] [Thread-1 (]: 1 of 8 OK created sql table model analytics.cloud_coverage_over_time ........... [[32mSUCCESS 1[0m in 1.62s]
[0m18:12:23.368147 [debug] [Thread-1 (]: Finished running node model.weather_dbt.cloud_coverage_over_time
[0m18:12:23.368719 [debug] [Thread-1 (]: Began running node model.weather_dbt.correlation
[0m18:12:23.369120 [info ] [Thread-1 (]: 2 of 8 START sql table model analytics.correlation ............................. [RUN]
[0m18:12:23.369491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.cloud_coverage_over_time, now model.weather_dbt.correlation)
[0m18:12:23.369795 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.correlation
[0m18:12:23.371852 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.correlation"
[0m18:12:23.372442 [debug] [Thread-1 (]: Began executing node model.weather_dbt.correlation
[0m18:12:23.376951 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.correlation"
[0m18:12:23.377903 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.correlation"
[0m18:12:23.378145 [debug] [Thread-1 (]: On model.weather_dbt.correlation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.correlation"} */
create or replace transient table openweather.analytics.correlation
         as
        (WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData
        );
[0m18:12:23.378358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:24.760258 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.381 seconds
[0m18:12:24.764459 [debug] [Thread-1 (]: On model.weather_dbt.correlation: Close
[0m18:12:24.918439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90f12fe5-7283-45bc-bd8a-6f3b3c5df808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144e0050>]}
[0m18:12:24.919711 [info ] [Thread-1 (]: 2 of 8 OK created sql table model analytics.correlation ........................ [[32mSUCCESS 1[0m in 1.55s]
[0m18:12:24.920529 [debug] [Thread-1 (]: Finished running node model.weather_dbt.correlation
[0m18:12:24.920967 [debug] [Thread-1 (]: Began running node model.weather_dbt.extreme_weather_events
[0m18:12:24.921604 [info ] [Thread-1 (]: 3 of 8 START sql table model analytics.extreme_weather_events .................. [RUN]
[0m18:12:24.922213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.correlation, now model.weather_dbt.extreme_weather_events)
[0m18:12:24.922640 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.extreme_weather_events
[0m18:12:24.926823 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.extreme_weather_events"
[0m18:12:24.927956 [debug] [Thread-1 (]: Began executing node model.weather_dbt.extreme_weather_events
[0m18:12:24.931205 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.extreme_weather_events"
[0m18:12:24.932816 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.extreme_weather_events"
[0m18:12:24.933226 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.extreme_weather_events"} */
create or replace transient table openweather.analytics.extreme_weather_events
         as
        (WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT *
FROM Extreme_Weather_Events
ORDER BY DATE_TIME, CITY_NAME
        );
[0m18:12:24.933607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:26.285594 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.351 seconds
[0m18:12:26.289468 [debug] [Thread-1 (]: On model.weather_dbt.extreme_weather_events: Close
[0m18:12:26.473989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90f12fe5-7283-45bc-bd8a-6f3b3c5df808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070fc8a0>]}
[0m18:12:26.475213 [info ] [Thread-1 (]: 3 of 8 OK created sql table model analytics.extreme_weather_events ............. [[32mSUCCESS 1[0m in 1.55s]
[0m18:12:26.476091 [debug] [Thread-1 (]: Finished running node model.weather_dbt.extreme_weather_events
[0m18:12:26.476620 [debug] [Thread-1 (]: Began running node model.weather_dbt.humidity_vs_temp
[0m18:12:26.477231 [info ] [Thread-1 (]: 4 of 8 START sql table model analytics.humidity_vs_temp ........................ [RUN]
[0m18:12:26.477820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.extreme_weather_events, now model.weather_dbt.humidity_vs_temp)
[0m18:12:26.478255 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.humidity_vs_temp
[0m18:12:26.482371 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.humidity_vs_temp"
[0m18:12:26.483794 [debug] [Thread-1 (]: Began executing node model.weather_dbt.humidity_vs_temp
[0m18:12:26.487244 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.humidity_vs_temp"
[0m18:12:26.489018 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.humidity_vs_temp"
[0m18:12:26.489384 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.humidity_vs_temp"} */
create or replace transient table openweather.analytics.humidity_vs_temp
         as
        (WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(TEMP_FAHRENHEIT) AS AVG_TEMP_FAHRENHEIT,
    AVG(HUMIDITY) AS AVG_HUMIDITY
FROM HumidityTemp
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY
        );
[0m18:12:26.489711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:27.723585 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.234 seconds
[0m18:12:27.726454 [debug] [Thread-1 (]: On model.weather_dbt.humidity_vs_temp: Close
[0m18:12:27.853887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90f12fe5-7283-45bc-bd8a-6f3b3c5df808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11485f290>]}
[0m18:12:27.854717 [info ] [Thread-1 (]: 4 of 8 OK created sql table model analytics.humidity_vs_temp ................... [[32mSUCCESS 1[0m in 1.38s]
[0m18:12:27.855262 [debug] [Thread-1 (]: Finished running node model.weather_dbt.humidity_vs_temp
[0m18:12:27.855626 [debug] [Thread-1 (]: Began running node model.weather_dbt.openweather_join
[0m18:12:27.856111 [info ] [Thread-1 (]: 5 of 8 START sql view model analytics.openweather_join ......................... [RUN]
[0m18:12:27.856563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.humidity_vs_temp, now model.weather_dbt.openweather_join)
[0m18:12:27.857072 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.openweather_join
[0m18:12:27.861542 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.openweather_join"
[0m18:12:27.863117 [debug] [Thread-1 (]: Began executing node model.weather_dbt.openweather_join
[0m18:12:27.882408 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.openweather_join"
[0m18:12:27.883687 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.openweather_join"
[0m18:12:27.884002 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.openweather_join"} */
create or replace   view openweather.analytics.openweather_join
  
   as (
    SELECT
    w.CITY_ID,
    c."Name" AS CITY_NAME,
    c."Latitude" AS CITY_LATITUDE,
    c."Longitude" AS CITY_LONGITUDE,
    w.DATE_TIME,
    ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
    ((w.FEELS_LIKE - 273.15) * 9/5 + 32) AS FEELS_LIKE_FAHRENHEIT,
    w.PRESSURE,
    w.HUMIDITY,
    w.WIND_SPEED,
    w.CLOUD_COVERAGE,
    w.WEATHER_MAIN,
    w.WEATHER_DET
FROM
    openweather.raw_data.WEATHER_FACT_TABLE w
JOIN
    openweather.raw_data.CITY_DIMENSION_TABLE c
ON
    w.CITY_ID = c.CITY_ID
  );
[0m18:12:27.884279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:28.753232 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.869 seconds
[0m18:12:28.756657 [debug] [Thread-1 (]: On model.weather_dbt.openweather_join: Close
[0m18:12:28.895436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90f12fe5-7283-45bc-bd8a-6f3b3c5df808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dfac90>]}
[0m18:12:28.896405 [info ] [Thread-1 (]: 5 of 8 OK created sql view model analytics.openweather_join .................... [[32mSUCCESS 1[0m in 1.04s]
[0m18:12:28.896947 [debug] [Thread-1 (]: Finished running node model.weather_dbt.openweather_join
[0m18:12:28.897324 [debug] [Thread-1 (]: Began running node model.weather_dbt.temp_trends_by_city
[0m18:12:28.897874 [info ] [Thread-1 (]: 6 of 8 START sql table model analytics.temp_trends_by_city ..................... [RUN]
[0m18:12:28.898599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.openweather_join, now model.weather_dbt.temp_trends_by_city)
[0m18:12:28.899113 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.temp_trends_by_city
[0m18:12:28.903270 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.temp_trends_by_city"
[0m18:12:28.904594 [debug] [Thread-1 (]: Began executing node model.weather_dbt.temp_trends_by_city
[0m18:12:28.907082 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.temp_trends_by_city"
[0m18:12:28.908807 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.temp_trends_by_city"
[0m18:12:28.909220 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.temp_trends_by_city"} */
create or replace transient table openweather.analytics.temp_trends_by_city
         as
        (WITH TempTrends AS (
    SELECT 
        "Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY
        );
[0m18:12:28.909585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:30.495264 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.585 seconds
[0m18:12:30.500793 [debug] [Thread-1 (]: On model.weather_dbt.temp_trends_by_city: Close
[0m18:12:30.640479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90f12fe5-7283-45bc-bd8a-6f3b3c5df808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dfb590>]}
[0m18:12:30.642061 [info ] [Thread-1 (]: 6 of 8 OK created sql table model analytics.temp_trends_by_city ................ [[32mSUCCESS 1[0m in 1.74s]
[0m18:12:30.642980 [debug] [Thread-1 (]: Finished running node model.weather_dbt.temp_trends_by_city
[0m18:12:30.643605 [debug] [Thread-1 (]: Began running node model.weather_dbt.weather_cond_distribution
[0m18:12:30.644242 [info ] [Thread-1 (]: 7 of 8 START sql table model analytics.weather_cond_distribution ............... [RUN]
[0m18:12:30.644861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.temp_trends_by_city, now model.weather_dbt.weather_cond_distribution)
[0m18:12:30.645292 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.weather_cond_distribution
[0m18:12:30.649390 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.weather_cond_distribution"
[0m18:12:30.650610 [debug] [Thread-1 (]: Began executing node model.weather_dbt.weather_cond_distribution
[0m18:12:30.653123 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.weather_cond_distribution"
[0m18:12:30.654583 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.weather_cond_distribution"
[0m18:12:30.655219 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.weather_cond_distribution"} */
create or replace transient table openweather.analytics.weather_cond_distribution
         as
        (WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, 3
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC
        );
[0m18:12:30.655719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:31.926655 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.270 seconds
[0m18:12:31.930878 [debug] [Thread-1 (]: On model.weather_dbt.weather_cond_distribution: Close
[0m18:12:32.093377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90f12fe5-7283-45bc-bd8a-6f3b3c5df808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dfbe90>]}
[0m18:12:32.094675 [info ] [Thread-1 (]: 7 of 8 OK created sql table model analytics.weather_cond_distribution .......... [[32mSUCCESS 1[0m in 1.45s]
[0m18:12:32.095544 [debug] [Thread-1 (]: Finished running node model.weather_dbt.weather_cond_distribution
[0m18:12:32.096116 [debug] [Thread-1 (]: Began running node model.weather_dbt.wind_speed_analysis
[0m18:12:32.096739 [info ] [Thread-1 (]: 8 of 8 START sql table model analytics.wind_speed_analysis ..................... [RUN]
[0m18:12:32.097347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_dbt.weather_cond_distribution, now model.weather_dbt.wind_speed_analysis)
[0m18:12:32.097773 [debug] [Thread-1 (]: Began compiling node model.weather_dbt.wind_speed_analysis
[0m18:12:32.101932 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_dbt.wind_speed_analysis"
[0m18:12:32.103166 [debug] [Thread-1 (]: Began executing node model.weather_dbt.wind_speed_analysis
[0m18:12:32.105641 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_dbt.wind_speed_analysis"
[0m18:12:32.107109 [debug] [Thread-1 (]: Using snowflake connection "model.weather_dbt.wind_speed_analysis"
[0m18:12:32.107514 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "model.weather_dbt.wind_speed_analysis"} */
create or replace transient table openweather.analytics.wind_speed_analysis
         as
        (WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(WIND_SPEED) AS AVG_WIND_SPEED
FROM WindSpeedData
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY
        );
[0m18:12:32.107873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:33.461531 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.353 seconds
[0m18:12:33.463840 [debug] [Thread-1 (]: On model.weather_dbt.wind_speed_analysis: Close
[0m18:12:33.600855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90f12fe5-7283-45bc-bd8a-6f3b3c5df808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106274710>]}
[0m18:12:33.602001 [info ] [Thread-1 (]: 8 of 8 OK created sql table model analytics.wind_speed_analysis ................ [[32mSUCCESS 1[0m in 1.50s]
[0m18:12:33.602684 [debug] [Thread-1 (]: Finished running node model.weather_dbt.wind_speed_analysis
[0m18:12:33.604227 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:33.604617 [debug] [MainThread]: Connection 'model.weather_dbt.wind_speed_analysis' was properly closed.
[0m18:12:33.605047 [info ] [MainThread]: 
[0m18:12:33.605400 [info ] [MainThread]: Finished running 7 table models, 1 view model in 0 hours 0 minutes and 14.15 seconds (14.15s).
[0m18:12:33.607055 [debug] [MainThread]: Command end result
[0m18:12:33.637913 [info ] [MainThread]: 
[0m18:12:33.638274 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:12:33.638478 [info ] [MainThread]: 
[0m18:12:33.638694 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m18:12:33.640234 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.368218, "process_in_blocks": "0", "process_kernel_time": 0.276371, "process_mem_max_rss": "149274624", "process_out_blocks": "0", "process_user_time": 2.386795}
[0m18:12:33.640643 [debug] [MainThread]: Command `dbt run` succeeded at 18:12:33.640573 after 15.37 seconds
[0m18:12:33.640895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11485d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11046d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149bffb0>]}
[0m18:12:33.641135 [debug] [MainThread]: Flushing usage events
[0m18:12:37.484582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052a8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd3d90>]}


============================== 18:12:37.486909 | 83357d92-946a-489c-aa88-46da6bf32b79 ==============================
[0m18:12:37.486909 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:12:37.487230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m18:12:37.684017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83357d92-946a-489c-aa88-46da6bf32b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10781eb10>]}
[0m18:12:37.706585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83357d92-946a-489c-aa88-46da6bf32b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107820050>]}
[0m18:12:37.707984 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:12:37.765692 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:12:37.851151 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:12:37.851441 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:12:37.880869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83357d92-946a-489c-aa88-46da6bf32b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a5450>]}
[0m18:12:37.956284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83357d92-946a-489c-aa88-46da6bf32b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd77a0>]}
[0m18:12:37.956588 [info ] [MainThread]: Found 8 models, 7 snapshots, 29 data tests, 2 sources, 459 macros
[0m18:12:37.956760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83357d92-946a-489c-aa88-46da6bf32b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ccf850>]}
[0m18:12:37.958276 [info ] [MainThread]: 
[0m18:12:37.958584 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:12:37.960975 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather_analytics'
[0m18:12:37.970805 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m18:12:37.971048 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m18:12:37.971186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:38.650875 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.679 seconds
[0m18:12:38.654592 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m18:12:38.803046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m18:12:38.806117 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m18:12:38.806390 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m18:12:38.806606 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:39.296474 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.489 seconds
[0m18:12:39.299857 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m18:12:39.521306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83357d92-946a-489c-aa88-46da6bf32b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0a9c0>]}
[0m18:12:39.522204 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m18:12:39.522626 [info ] [MainThread]: 
[0m18:12:39.525905 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m18:12:39.526412 [info ] [Thread-1 (]: 1 of 29 START test not_null_cloud_coverage_over_time_avg_cloud_coverage ........ [RUN]
[0m18:12:39.526912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86)
[0m18:12:39.527306 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m18:12:39.545477 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m18:12:39.546947 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m18:12:39.561284 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m18:12:39.562217 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"
[0m18:12:39.562475 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_cloud_coverage
from openweather.analytics.cloud_coverage_over_time
where avg_cloud_coverage is null



      
    ) dbt_internal_test
[0m18:12:39.562696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:40.181178 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.618 seconds
[0m18:12:40.194896 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86: Close
[0m18:12:40.316192 [info ] [Thread-1 (]: 1 of 29 PASS not_null_cloud_coverage_over_time_avg_cloud_coverage .............. [[32mPASS[0m in 0.79s]
[0m18:12:40.317301 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86
[0m18:12:40.317939 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m18:12:40.318656 [info ] [Thread-1 (]: 2 of 29 START test not_null_cloud_coverage_over_time_city_name ................. [RUN]
[0m18:12:40.319404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_avg_cloud_coverage.0e89086b86, now test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f)
[0m18:12:40.319943 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m18:12:40.325670 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m18:12:40.326939 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m18:12:40.329487 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m18:12:40.330720 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"
[0m18:12:40.331133 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.cloud_coverage_over_time
where city_name is null



      
    ) dbt_internal_test
[0m18:12:40.331483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:40.895151 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.563 seconds
[0m18:12:40.899178 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f: Close
[0m18:12:41.022243 [info ] [Thread-1 (]: 2 of 29 PASS not_null_cloud_coverage_over_time_city_name ....................... [[32mPASS[0m in 0.70s]
[0m18:12:41.023464 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f
[0m18:12:41.024089 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m18:12:41.024753 [info ] [Thread-1 (]: 3 of 29 START test not_null_cloud_coverage_over_time_day ....................... [RUN]
[0m18:12:41.025490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_city_name.636f824f7f, now test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9)
[0m18:12:41.025986 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m18:12:41.031646 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m18:12:41.032749 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m18:12:41.035360 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m18:12:41.036901 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"
[0m18:12:41.037400 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from openweather.analytics.cloud_coverage_over_time
where day is null



      
    ) dbt_internal_test
[0m18:12:41.037752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:41.642125 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.604 seconds
[0m18:12:41.646252 [debug] [Thread-1 (]: On test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9: Close
[0m18:12:41.765950 [info ] [Thread-1 (]: 3 of 29 PASS not_null_cloud_coverage_over_time_day ............................. [[32mPASS[0m in 0.74s]
[0m18:12:41.767113 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9
[0m18:12:41.767714 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m18:12:41.768464 [info ] [Thread-1 (]: 4 of 29 START test not_null_correlation_avg_humidity ........................... [RUN]
[0m18:12:41.769317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_cloud_coverage_over_time_day.ea9ddf82f9, now test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d)
[0m18:12:41.769764 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m18:12:41.775289 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m18:12:41.776408 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m18:12:41.778845 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m18:12:41.780135 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"
[0m18:12:41.780504 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_humidity
from openweather.analytics.correlation
where avg_humidity is null



      
    ) dbt_internal_test
[0m18:12:41.780802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:42.381103 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m18:12:42.382788 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d: Close
[0m18:12:42.552896 [info ] [Thread-1 (]: 4 of 29 PASS not_null_correlation_avg_humidity ................................. [[32mPASS[0m in 0.78s]
[0m18:12:42.553642 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d
[0m18:12:42.554045 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m18:12:42.554462 [info ] [Thread-1 (]: 5 of 29 START test not_null_correlation_avg_pressure ........................... [RUN]
[0m18:12:42.554949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_humidity.215c3c5a3d, now test.weather_dbt.not_null_correlation_avg_pressure.46419021da)
[0m18:12:42.555307 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m18:12:42.559185 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m18:12:42.559998 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m18:12:42.562011 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m18:12:42.563169 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"
[0m18:12:42.563481 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_pressure.46419021da: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_pressure.46419021da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_pressure
from openweather.analytics.correlation
where avg_pressure is null



      
    ) dbt_internal_test
[0m18:12:42.563762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:43.113691 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.550 seconds
[0m18:12:43.116815 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_pressure.46419021da: Close
[0m18:12:43.248144 [info ] [Thread-1 (]: 5 of 29 PASS not_null_correlation_avg_pressure ................................. [[32mPASS[0m in 0.69s]
[0m18:12:43.249343 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_pressure.46419021da
[0m18:12:43.250028 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m18:12:43.250639 [info ] [Thread-1 (]: 6 of 29 START test not_null_correlation_avg_temp ............................... [RUN]
[0m18:12:43.251274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_pressure.46419021da, now test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61)
[0m18:12:43.251766 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m18:12:43.257451 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m18:12:43.258701 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m18:12:43.261085 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m18:12:43.262141 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"
[0m18:12:43.262523 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp
from openweather.analytics.correlation
where avg_temp is null



      
    ) dbt_internal_test
[0m18:12:43.262853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:44.289091 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.026 seconds
[0m18:12:44.292907 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61: Close
[0m18:12:44.813972 [info ] [Thread-1 (]: 6 of 29 PASS not_null_correlation_avg_temp ..................................... [[32mPASS[0m in 1.56s]
[0m18:12:44.815034 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61
[0m18:12:44.815631 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m18:12:44.816210 [info ] [Thread-1 (]: 7 of 29 START test not_null_correlation_avg_wind_speed ......................... [RUN]
[0m18:12:44.816794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_temp.c7ca253a61, now test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9)
[0m18:12:44.817222 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m18:12:44.822911 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m18:12:44.824225 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m18:12:44.826521 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m18:12:44.827615 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"
[0m18:12:44.827965 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_wind_speed
from openweather.analytics.correlation
where avg_wind_speed is null



      
    ) dbt_internal_test
[0m18:12:44.828255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:46.387254 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.558 seconds
[0m18:12:46.390998 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9: Close
[0m18:12:46.910914 [info ] [Thread-1 (]: 7 of 29 PASS not_null_correlation_avg_wind_speed ............................... [[32mPASS[0m in 2.09s]
[0m18:12:46.912167 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9
[0m18:12:46.912736 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m18:12:46.913255 [info ] [Thread-1 (]: 8 of 29 START test not_null_correlation_city_name .............................. [RUN]
[0m18:12:46.913856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_avg_wind_speed.fc900916f9, now test.weather_dbt.not_null_correlation_city_name.d4bb85e888)
[0m18:12:46.914297 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m18:12:46.919828 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m18:12:46.921100 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m18:12:46.923479 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m18:12:46.924915 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"
[0m18:12:46.925320 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_city_name.d4bb85e888: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_correlation_city_name.d4bb85e888"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.correlation
where city_name is null



      
    ) dbt_internal_test
[0m18:12:46.925638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:48.482303 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.556 seconds
[0m18:12:48.486919 [debug] [Thread-1 (]: On test.weather_dbt.not_null_correlation_city_name.d4bb85e888: Close
[0m18:12:49.014987 [info ] [Thread-1 (]: 8 of 29 PASS not_null_correlation_city_name .................................... [[32mPASS[0m in 2.10s]
[0m18:12:49.016025 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_correlation_city_name.d4bb85e888
[0m18:12:49.016535 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m18:12:49.017031 [info ] [Thread-1 (]: 9 of 29 START test not_null_extreme_weather_events_city_id ..................... [RUN]
[0m18:12:49.017672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_correlation_city_name.d4bb85e888, now test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4)
[0m18:12:49.018102 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m18:12:49.021445 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m18:12:49.022429 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m18:12:49.024464 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m18:12:49.025374 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"
[0m18:12:49.025735 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_id
from openweather.analytics.extreme_weather_events
where city_id is null



      
    ) dbt_internal_test
[0m18:12:49.026047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:49.887463 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.861 seconds
[0m18:12:49.892221 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4: Close
[0m18:12:50.050778 [info ] [Thread-1 (]: 9 of 29 PASS not_null_extreme_weather_events_city_id ........................... [[32mPASS[0m in 1.03s]
[0m18:12:50.051427 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4
[0m18:12:50.051777 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m18:12:50.052141 [info ] [Thread-1 (]: 10 of 29 START test not_null_extreme_weather_events_city_name .................. [RUN]
[0m18:12:50.052580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_city_id.5d4065e9e4, now test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589)
[0m18:12:50.052912 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m18:12:50.056248 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m18:12:50.057101 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m18:12:50.058771 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m18:12:50.059570 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"
[0m18:12:50.059855 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.extreme_weather_events
where city_name is null



      
    ) dbt_internal_test
[0m18:12:50.060110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:50.668480 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.602 seconds
[0m18:12:50.673054 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589: Close
[0m18:12:50.803181 [info ] [Thread-1 (]: 10 of 29 PASS not_null_extreme_weather_events_city_name ........................ [[32mPASS[0m in 0.75s]
[0m18:12:50.804220 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589
[0m18:12:50.804856 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m18:12:50.805500 [info ] [Thread-1 (]: 11 of 29 START test not_null_extreme_weather_events_date_time .................. [RUN]
[0m18:12:50.806123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_city_name.a4adf00589, now test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853)
[0m18:12:50.806564 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m18:12:50.812369 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m18:12:50.813579 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m18:12:50.816165 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m18:12:50.818017 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"
[0m18:12:50.818457 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_time
from openweather.analytics.extreme_weather_events
where date_time is null



      
    ) dbt_internal_test
[0m18:12:50.818791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:51.511150 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.692 seconds
[0m18:12:51.515430 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853: Close
[0m18:12:51.689832 [info ] [Thread-1 (]: 11 of 29 PASS not_null_extreme_weather_events_date_time ........................ [[32mPASS[0m in 0.88s]
[0m18:12:51.690721 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853
[0m18:12:51.691272 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m18:12:51.691819 [info ] [Thread-1 (]: 12 of 29 START test not_null_extreme_weather_events_temp_fahrenheit ............ [RUN]
[0m18:12:51.692430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_date_time.038097a853, now test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d)
[0m18:12:51.692872 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m18:12:51.698246 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m18:12:51.699384 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m18:12:51.701567 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m18:12:51.703211 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"
[0m18:12:51.703586 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_fahrenheit
from openweather.analytics.extreme_weather_events
where temp_fahrenheit is null



      
    ) dbt_internal_test
[0m18:12:51.703884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:52.180748 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.477 seconds
[0m18:12:52.183549 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d: Close
[0m18:12:52.318916 [info ] [Thread-1 (]: 12 of 29 PASS not_null_extreme_weather_events_temp_fahrenheit .................. [[32mPASS[0m in 0.63s]
[0m18:12:52.319892 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d
[0m18:12:52.320463 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m18:12:52.321077 [info ] [Thread-1 (]: 13 of 29 START test not_null_extreme_weather_events_weather_alert .............. [RUN]
[0m18:12:52.321783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_temp_fahrenheit.ceb6545a8d, now test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb)
[0m18:12:52.322325 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m18:12:52.327410 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m18:12:52.328453 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m18:12:52.331010 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m18:12:52.332439 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"
[0m18:12:52.332877 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_alert
from openweather.analytics.extreme_weather_events
where weather_alert is null



      
    ) dbt_internal_test
[0m18:12:52.333242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:53.007557 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.673 seconds
[0m18:12:53.013179 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb: Close
[0m18:12:53.201632 [info ] [Thread-1 (]: 13 of 29 PASS not_null_extreme_weather_events_weather_alert .................... [[32mPASS[0m in 0.88s]
[0m18:12:53.202609 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb
[0m18:12:53.203050 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m18:12:53.203511 [info ] [Thread-1 (]: 14 of 29 START test not_null_extreme_weather_events_wind_speed ................. [RUN]
[0m18:12:53.204034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_weather_alert.2d17205ddb, now test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4)
[0m18:12:53.204417 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m18:12:53.208609 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m18:12:53.209873 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m18:12:53.212031 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m18:12:53.213265 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"
[0m18:12:53.213581 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select wind_speed
from openweather.analytics.extreme_weather_events
where wind_speed is null



      
    ) dbt_internal_test
[0m18:12:53.213850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:53.766940 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.552 seconds
[0m18:12:53.770808 [debug] [Thread-1 (]: On test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4: Close
[0m18:12:53.947799 [info ] [Thread-1 (]: 14 of 29 PASS not_null_extreme_weather_events_wind_speed ....................... [[32mPASS[0m in 0.74s]
[0m18:12:53.948648 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4
[0m18:12:53.949156 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_avg_humidity.22fff2a115
[0m18:12:53.949678 [info ] [Thread-1 (]: 15 of 29 START test not_null_humidity_vs_temp_avg_humidity ..................... [RUN]
[0m18:12:53.950237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_extreme_weather_events_wind_speed.47ebe49dd4, now test.weather_dbt.not_null_humidity_vs_temp_avg_humidity.22fff2a115)
[0m18:12:53.950664 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_avg_humidity.22fff2a115
[0m18:12:53.955427 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_avg_humidity.22fff2a115"
[0m18:12:53.956837 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_avg_humidity.22fff2a115
[0m18:12:53.959166 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_avg_humidity.22fff2a115"
[0m18:12:53.960645 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_avg_humidity.22fff2a115"
[0m18:12:53.961258 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_avg_humidity.22fff2a115: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_avg_humidity.22fff2a115"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_humidity
from openweather.analytics.humidity_vs_temp
where avg_humidity is null



      
    ) dbt_internal_test
[0m18:12:53.961573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:54.651955 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m18:12:54.657076 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_avg_humidity.22fff2a115: Close
[0m18:12:54.838249 [info ] [Thread-1 (]: 15 of 29 PASS not_null_humidity_vs_temp_avg_humidity ........................... [[32mPASS[0m in 0.89s]
[0m18:12:54.838954 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_avg_humidity.22fff2a115
[0m18:12:54.839390 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_avg_temp_fahrenheit.f6b91d7367
[0m18:12:54.839857 [info ] [Thread-1 (]: 16 of 29 START test not_null_humidity_vs_temp_avg_temp_fahrenheit .............. [RUN]
[0m18:12:54.840382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_avg_humidity.22fff2a115, now test.weather_dbt.not_null_humidity_vs_temp_avg_temp_fahrenheit.f6b91d7367)
[0m18:12:54.840763 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_avg_temp_fahrenheit.f6b91d7367
[0m18:12:54.845021 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_avg_temp_fahrenheit.f6b91d7367"
[0m18:12:54.846346 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_avg_temp_fahrenheit.f6b91d7367
[0m18:12:54.848515 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_avg_temp_fahrenheit.f6b91d7367"
[0m18:12:54.849527 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_avg_temp_fahrenheit.f6b91d7367"
[0m18:12:54.850088 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_avg_temp_fahrenheit.f6b91d7367: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_avg_temp_fahrenheit.f6b91d7367"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp_fahrenheit
from openweather.analytics.humidity_vs_temp
where avg_temp_fahrenheit is null



      
    ) dbt_internal_test
[0m18:12:54.850475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:55.470854 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m18:12:55.474345 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_avg_temp_fahrenheit.f6b91d7367: Close
[0m18:12:55.707788 [info ] [Thread-1 (]: 16 of 29 PASS not_null_humidity_vs_temp_avg_temp_fahrenheit .................... [[32mPASS[0m in 0.87s]
[0m18:12:55.708749 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_avg_temp_fahrenheit.f6b91d7367
[0m18:12:55.709339 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m18:12:55.709956 [info ] [Thread-1 (]: 17 of 29 START test not_null_humidity_vs_temp_city_name ........................ [RUN]
[0m18:12:55.710680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_avg_temp_fahrenheit.f6b91d7367, now test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042)
[0m18:12:55.711206 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m18:12:55.716882 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m18:12:55.717937 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m18:12:55.720019 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m18:12:55.721324 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"
[0m18:12:55.721721 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.humidity_vs_temp
where city_name is null



      
    ) dbt_internal_test
[0m18:12:55.722068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:56.466638 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.744 seconds
[0m18:12:56.470295 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042: Close
[0m18:12:56.682374 [info ] [Thread-1 (]: 17 of 29 PASS not_null_humidity_vs_temp_city_name .............................. [[32mPASS[0m in 0.97s]
[0m18:12:56.683362 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042
[0m18:12:56.683885 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_humidity_vs_temp_day.a0832acbad
[0m18:12:56.684418 [info ] [Thread-1 (]: 18 of 29 START test not_null_humidity_vs_temp_day .............................. [RUN]
[0m18:12:56.685030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_city_name.2c88b30042, now test.weather_dbt.not_null_humidity_vs_temp_day.a0832acbad)
[0m18:12:56.685480 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_humidity_vs_temp_day.a0832acbad
[0m18:12:56.689805 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_humidity_vs_temp_day.a0832acbad"
[0m18:12:56.690981 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_humidity_vs_temp_day.a0832acbad
[0m18:12:56.693032 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_humidity_vs_temp_day.a0832acbad"
[0m18:12:56.693935 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_humidity_vs_temp_day.a0832acbad"
[0m18:12:56.694408 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_day.a0832acbad: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_humidity_vs_temp_day.a0832acbad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from openweather.analytics.humidity_vs_temp
where day is null



      
    ) dbt_internal_test
[0m18:12:56.694872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:57.390479 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.695 seconds
[0m18:12:57.392734 [debug] [Thread-1 (]: On test.weather_dbt.not_null_humidity_vs_temp_day.a0832acbad: Close
[0m18:12:57.528259 [info ] [Thread-1 (]: 18 of 29 PASS not_null_humidity_vs_temp_day .................................... [[32mPASS[0m in 0.84s]
[0m18:12:57.528917 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_humidity_vs_temp_day.a0832acbad
[0m18:12:57.529265 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m18:12:57.529627 [info ] [Thread-1 (]: 19 of 29 START test not_null_temp_trends_by_city_avg_temp_fahrenheit ........... [RUN]
[0m18:12:57.530038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_humidity_vs_temp_day.a0832acbad, now test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae)
[0m18:12:57.530350 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m18:12:57.533550 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m18:12:57.534255 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m18:12:57.536004 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m18:12:57.536983 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"
[0m18:12:57.537280 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_temp_fahrenheit
from openweather.analytics.temp_trends_by_city
where avg_temp_fahrenheit is null



      
    ) dbt_internal_test
[0m18:12:57.537547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:58.249649 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.712 seconds
[0m18:12:58.252285 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae: Close
[0m18:12:58.451364 [info ] [Thread-1 (]: 19 of 29 PASS not_null_temp_trends_by_city_avg_temp_fahrenheit ................. [[32mPASS[0m in 0.92s]
[0m18:12:58.452219 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae
[0m18:12:58.452720 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m18:12:58.453229 [info ] [Thread-1 (]: 20 of 29 START test not_null_temp_trends_by_city_city_name ..................... [RUN]
[0m18:12:58.453807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_avg_temp_fahrenheit.ff5a7bb9ae, now test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b)
[0m18:12:58.454234 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m18:12:58.459908 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m18:12:58.461069 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m18:12:58.463442 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m18:12:58.464608 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"
[0m18:12:58.465002 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.temp_trends_by_city
where city_name is null



      
    ) dbt_internal_test
[0m18:12:58.465328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:58.987971 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.522 seconds
[0m18:12:58.993159 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b: Close
[0m18:12:59.130612 [info ] [Thread-1 (]: 20 of 29 PASS not_null_temp_trends_by_city_city_name ........................... [[32mPASS[0m in 0.68s]
[0m18:12:59.131847 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b
[0m18:12:59.132516 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m18:12:59.133129 [info ] [Thread-1 (]: 21 of 29 START test not_null_temp_trends_by_city_day ........................... [RUN]
[0m18:12:59.133835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_city_name.efce70d94b, now test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019)
[0m18:12:59.134294 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m18:12:59.139493 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m18:12:59.140619 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m18:12:59.142555 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m18:12:59.143964 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"
[0m18:12:59.144459 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from openweather.analytics.temp_trends_by_city
where day is null



      
    ) dbt_internal_test
[0m18:12:59.144928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:59.716063 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.570 seconds
[0m18:12:59.720400 [debug] [Thread-1 (]: On test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019: Close
[0m18:12:59.887097 [info ] [Thread-1 (]: 21 of 29 PASS not_null_temp_trends_by_city_day ................................. [[32mPASS[0m in 0.75s]
[0m18:12:59.888355 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019
[0m18:12:59.888984 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m18:12:59.889636 [info ] [Thread-1 (]: 22 of 29 START test not_null_weather_cond_distribution_city_name ............... [RUN]
[0m18:12:59.890491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_temp_trends_by_city_day.ff17b1b019, now test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec)
[0m18:12:59.891180 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m18:12:59.895787 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m18:12:59.896796 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m18:12:59.898766 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m18:12:59.899820 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"
[0m18:12:59.900266 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.weather_cond_distribution
where city_name is null



      
    ) dbt_internal_test
[0m18:12:59.900676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:00.602181 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.701 seconds
[0m18:13:00.605838 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec: Close
[0m18:13:00.736510 [info ] [Thread-1 (]: 22 of 29 PASS not_null_weather_cond_distribution_city_name ..................... [[32mPASS[0m in 0.85s]
[0m18:13:00.737514 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec
[0m18:13:00.738118 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m18:13:00.738748 [info ] [Thread-1 (]: 23 of 29 START test not_null_weather_cond_distribution_count ................... [RUN]
[0m18:13:00.739469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_city_name.3e2ce12eec, now test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4)
[0m18:13:00.740000 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m18:13:00.745776 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m18:13:00.747082 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m18:13:00.749725 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m18:13:00.750807 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"
[0m18:13:00.751168 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select count
from openweather.analytics.weather_cond_distribution
where count is null



      
    ) dbt_internal_test
[0m18:13:00.751503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:01.396053 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.644 seconds
[0m18:13:01.398528 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4: Close
[0m18:13:01.590741 [info ] [Thread-1 (]: 23 of 29 PASS not_null_weather_cond_distribution_count ......................... [[32mPASS[0m in 0.85s]
[0m18:13:01.591739 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4
[0m18:13:01.592330 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m18:13:01.592958 [info ] [Thread-1 (]: 24 of 29 START test not_null_weather_cond_distribution_weather_main ............ [RUN]
[0m18:13:01.593684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_count.64a78c8ae4, now test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6)
[0m18:13:01.594184 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m18:13:01.599834 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m18:13:01.600977 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m18:13:01.603343 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m18:13:01.604508 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"
[0m18:13:01.604899 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select weather_main
from openweather.analytics.weather_cond_distribution
where weather_main is null



      
    ) dbt_internal_test
[0m18:13:01.605244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:02.211604 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.606 seconds
[0m18:13:02.216657 [debug] [Thread-1 (]: On test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6: Close
[0m18:13:02.330023 [info ] [Thread-1 (]: 24 of 29 PASS not_null_weather_cond_distribution_weather_main .................. [[32mPASS[0m in 0.74s]
[0m18:13:02.330793 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6
[0m18:13:02.331210 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_avg_wind_speed.c35685ef70
[0m18:13:02.331654 [info ] [Thread-1 (]: 25 of 29 START test not_null_wind_speed_analysis_avg_wind_speed ................ [RUN]
[0m18:13:02.332151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_weather_cond_distribution_weather_main.59c94335a6, now test.weather_dbt.not_null_wind_speed_analysis_avg_wind_speed.c35685ef70)
[0m18:13:02.332476 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_avg_wind_speed.c35685ef70
[0m18:13:02.336234 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_avg_wind_speed.c35685ef70"
[0m18:13:02.337228 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_avg_wind_speed.c35685ef70
[0m18:13:02.339454 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_wind_speed_analysis_avg_wind_speed.c35685ef70"
[0m18:13:02.340499 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_wind_speed_analysis_avg_wind_speed.c35685ef70"
[0m18:13:02.340797 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_avg_wind_speed.c35685ef70: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_wind_speed_analysis_avg_wind_speed.c35685ef70"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_wind_speed
from openweather.analytics.wind_speed_analysis
where avg_wind_speed is null



      
    ) dbt_internal_test
[0m18:13:02.341059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:02.985981 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.644 seconds
[0m18:13:02.990561 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_avg_wind_speed.c35685ef70: Close
[0m18:13:03.166664 [info ] [Thread-1 (]: 25 of 29 PASS not_null_wind_speed_analysis_avg_wind_speed ...................... [[32mPASS[0m in 0.83s]
[0m18:13:03.167496 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_avg_wind_speed.c35685ef70
[0m18:13:03.167883 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m18:13:03.168496 [info ] [Thread-1 (]: 26 of 29 START test not_null_wind_speed_analysis_city_name ..................... [RUN]
[0m18:13:03.169144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_wind_speed_analysis_avg_wind_speed.c35685ef70, now test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9)
[0m18:13:03.169485 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m18:13:03.176128 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m18:13:03.177262 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m18:13:03.181015 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m18:13:03.183179 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"
[0m18:13:03.184101 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city_name
from openweather.analytics.wind_speed_analysis
where city_name is null



      
    ) dbt_internal_test
[0m18:13:03.184885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:03.668261 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.483 seconds
[0m18:13:03.671948 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9: Close
[0m18:13:03.855077 [info ] [Thread-1 (]: 26 of 29 PASS not_null_wind_speed_analysis_city_name ........................... [[32mPASS[0m in 0.69s]
[0m18:13:03.856182 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9
[0m18:13:03.856775 [debug] [Thread-1 (]: Began running node test.weather_dbt.not_null_wind_speed_analysis_day.11b3813fea
[0m18:13:03.857396 [info ] [Thread-1 (]: 27 of 29 START test not_null_wind_speed_analysis_day ........................... [RUN]
[0m18:13:03.858123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_wind_speed_analysis_city_name.6c4e7778b9, now test.weather_dbt.not_null_wind_speed_analysis_day.11b3813fea)
[0m18:13:03.858652 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.not_null_wind_speed_analysis_day.11b3813fea
[0m18:13:03.864656 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.not_null_wind_speed_analysis_day.11b3813fea"
[0m18:13:03.866028 [debug] [Thread-1 (]: Began executing node test.weather_dbt.not_null_wind_speed_analysis_day.11b3813fea
[0m18:13:03.868702 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.not_null_wind_speed_analysis_day.11b3813fea"
[0m18:13:03.870188 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.not_null_wind_speed_analysis_day.11b3813fea"
[0m18:13:03.870731 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_day.11b3813fea: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.not_null_wind_speed_analysis_day.11b3813fea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from openweather.analytics.wind_speed_analysis
where day is null



      
    ) dbt_internal_test
[0m18:13:03.871090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:04.540796 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.669 seconds
[0m18:13:04.544927 [debug] [Thread-1 (]: On test.weather_dbt.not_null_wind_speed_analysis_day.11b3813fea: Close
[0m18:13:04.744818 [info ] [Thread-1 (]: 27 of 29 PASS not_null_wind_speed_analysis_day ................................. [[32mPASS[0m in 0.89s]
[0m18:13:04.745997 [debug] [Thread-1 (]: Finished running node test.weather_dbt.not_null_wind_speed_analysis_day.11b3813fea
[0m18:13:04.746629 [debug] [Thread-1 (]: Began running node test.weather_dbt.valid_temp
[0m18:13:04.747253 [info ] [Thread-1 (]: 28 of 29 START test valid_temp ................................................. [RUN]
[0m18:13:04.747947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.not_null_wind_speed_analysis_day.11b3813fea, now test.weather_dbt.valid_temp)
[0m18:13:04.748433 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.valid_temp
[0m18:13:04.752314 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.valid_temp"
[0m18:13:04.753850 [debug] [Thread-1 (]: Began executing node test.weather_dbt.valid_temp
[0m18:13:04.756159 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.valid_temp"
[0m18:13:04.757465 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.valid_temp"
[0m18:13:04.758016 [debug] [Thread-1 (]: On test.weather_dbt.valid_temp: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.valid_temp"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- checking valid temperature values for extreme_weather_events.sql
SELECT
    CITY_ID,
    DATE_TIME,
    TEMP_FAHRENHEIT
FROM openweather.analytics.extreme_weather_events
WHERE TEMP_FAHRENHEIT IS NULL
   OR TEMP_FAHRENHEIT < -100 OR TEMP_FAHRENHEIT > 150
      
    ) dbt_internal_test
[0m18:13:04.758408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:05.312756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.554 seconds
[0m18:13:05.316791 [debug] [Thread-1 (]: On test.weather_dbt.valid_temp: Close
[0m18:13:05.463517 [info ] [Thread-1 (]: 28 of 29 PASS valid_temp ....................................................... [[32mPASS[0m in 0.72s]
[0m18:13:05.464704 [debug] [Thread-1 (]: Finished running node test.weather_dbt.valid_temp
[0m18:13:05.465313 [debug] [Thread-1 (]: Began running node test.weather_dbt.weather_alert_consistency
[0m18:13:05.465901 [info ] [Thread-1 (]: 29 of 29 START test weather_alert_consistency .................................. [RUN]
[0m18:13:05.466513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.weather_dbt.valid_temp, now test.weather_dbt.weather_alert_consistency)
[0m18:13:05.466949 [debug] [Thread-1 (]: Began compiling node test.weather_dbt.weather_alert_consistency
[0m18:13:05.470305 [debug] [Thread-1 (]: Writing injected SQL for node "test.weather_dbt.weather_alert_consistency"
[0m18:13:05.471592 [debug] [Thread-1 (]: Began executing node test.weather_dbt.weather_alert_consistency
[0m18:13:05.473830 [debug] [Thread-1 (]: Writing runtime sql for node "test.weather_dbt.weather_alert_consistency"
[0m18:13:05.475072 [debug] [Thread-1 (]: Using snowflake connection "test.weather_dbt.weather_alert_consistency"
[0m18:13:05.475448 [debug] [Thread-1 (]: On test.weather_dbt.weather_alert_consistency: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "test.weather_dbt.weather_alert_consistency"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- This test checks for consistency in the weather alerts generated in the extreme_weather_events table.
SELECT
    CITY_ID,
    DATE_TIME,
    WEATHER_ALERT,
    TEMP_FAHRENHEIT,
    WIND_SPEED
FROM openweather.analytics.extreme_weather_events
WHERE 
    (WEATHER_ALERT = 'Extreme Heat' AND TEMP_FAHRENHEIT <= 100)
    OR (WEATHER_ALERT = 'Extreme Cold' AND TEMP_FAHRENHEIT >= 32)
    OR (WEATHER_ALERT = 'High Winds' AND WIND_SPEED <= 20)
      
    ) dbt_internal_test
[0m18:13:05.475972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:06.149109 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.673 seconds
[0m18:13:06.153966 [debug] [Thread-1 (]: On test.weather_dbt.weather_alert_consistency: Close
[0m18:13:06.313076 [info ] [Thread-1 (]: 29 of 29 PASS weather_alert_consistency ........................................ [[32mPASS[0m in 0.85s]
[0m18:13:06.313924 [debug] [Thread-1 (]: Finished running node test.weather_dbt.weather_alert_consistency
[0m18:13:06.315706 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:06.316122 [debug] [MainThread]: Connection 'test.weather_dbt.weather_alert_consistency' was properly closed.
[0m18:13:06.316566 [info ] [MainThread]: 
[0m18:13:06.316929 [info ] [MainThread]: Finished running 29 data tests in 0 hours 0 minutes and 28.36 seconds (28.36s).
[0m18:13:06.320578 [debug] [MainThread]: Command end result
[0m18:13:06.356526 [info ] [MainThread]: 
[0m18:13:06.356858 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:13:06.357058 [info ] [MainThread]: 
[0m18:13:06.357258 [info ] [MainThread]: Done. PASS=29 WARN=0 ERROR=0 SKIP=0 TOTAL=29
[0m18:13:06.359138 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 28.907171, "process_in_blocks": "0", "process_kernel_time": 0.422973, "process_mem_max_rss": "141492224", "process_out_blocks": "0", "process_user_time": 3.295707}
[0m18:13:06.359599 [debug] [MainThread]: Command `dbt test` succeeded at 18:13:06.359532 after 28.91 seconds
[0m18:13:06.359850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10698d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080eefc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080efb70>]}
[0m18:13:06.360080 [debug] [MainThread]: Flushing usage events
[0m18:13:36.382490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ecd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f3d90>]}


============================== 18:13:36.385303 | ea3231d8-ed04-40b6-ad81-243a20768dbf ==============================
[0m18:13:36.385303 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:13:36.385686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m18:13:36.614734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea3231d8-ed04-40b6-ad81-243a20768dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e3ab10>]}
[0m18:13:36.639489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea3231d8-ed04-40b6-ad81-243a20768dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d40050>]}
[0m18:13:36.640141 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:13:36.698567 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:13:36.788598 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:13:36.788858 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:13:36.816778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea3231d8-ed04-40b6-ad81-243a20768dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cbd450>]}
[0m18:13:36.882141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea3231d8-ed04-40b6-ad81-243a20768dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c91400>]}
[0m18:13:36.882430 [info ] [MainThread]: Found 8 models, 7 snapshots, 29 data tests, 2 sources, 459 macros
[0m18:13:36.882612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea3231d8-ed04-40b6-ad81-243a20768dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10729a970>]}
[0m18:13:36.883860 [info ] [MainThread]: 
[0m18:13:36.884156 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:13:36.886263 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m18:13:36.893917 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m18:13:36.894151 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m18:13:36.894295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:37.535055 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.640 seconds
[0m18:13:37.539116 [debug] [ThreadPool]: On list_openweather: Close
[0m18:13:37.665620 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m18:13:37.675674 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m18:13:37.676111 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m18:13:37.676435 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:38.183129 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.507 seconds
[0m18:13:38.185938 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m18:13:38.329607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m18:13:38.331920 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m18:13:38.332097 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m18:13:38.332231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:38.786450 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.454 seconds
[0m18:13:38.790199 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m18:13:38.967746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea3231d8-ed04-40b6-ad81-243a20768dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072ad8b0>]}
[0m18:13:38.968873 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m18:13:38.969180 [info ] [MainThread]: 
[0m18:13:38.972588 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_cloud_coverage
[0m18:13:38.973291 [info ] [Thread-1 (]: 1 of 7 START snapshot snapshot.snapshot_cloud_coverage ......................... [RUN]
[0m18:13:38.973808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now snapshot.weather_dbt.snapshot_cloud_coverage)
[0m18:13:38.974479 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_cloud_coverage
[0m18:13:38.983339 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_cloud_coverage
[0m18:13:39.020256 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:13:39.020589 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE"
[0m18:13:39.020794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:39.531822 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.511 seconds
[0m18:13:39.560933 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:13:39.561303 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH CloudCoverage AS (
    SELECT 
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY


    ),

    snapshotted_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
,
            md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            DAY as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DAY))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DAY)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:13:40.535313 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.973 seconds
[0m18:13:40.539558 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:13:40.540130 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE__dbt_tmp"
[0m18:13:40.693050 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.152 seconds
[0m18:13:40.700163 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:13:40.700742 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE"
[0m18:13:40.826267 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.125 seconds
[0m18:13:40.832387 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:13:40.833095 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE__dbt_tmp"
[0m18:13:40.957418 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.123 seconds
[0m18:13:40.964043 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:13:40.964534 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE"
[0m18:13:41.058005 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.093 seconds
[0m18:13:41.063907 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:13:41.064235 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE__dbt_tmp"
[0m18:13:41.173697 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.109 seconds
[0m18:13:41.198331 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:13:41.198857 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
select * from (
        

    with snapshot_query as (

        



WITH CloudCoverage AS (
    SELECT 
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY


    ),

    snapshotted_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
,
            md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            DAY as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DAY))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DAY)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:13:41.418154 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.218 seconds
[0m18:13:41.425468 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:13:41.426010 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:13:41.571568 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.145 seconds
[0m18:13:41.572509 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:13:41.574712 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:13:41.575135 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
BEGIN
[0m18:13:41.752433 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.177 seconds
[0m18:13:41.753291 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:13:41.753845 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
merge into "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_NAME", "DAY", "AVG_CLOUD_COVERAGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_NAME", "DAY", "AVG_CLOUD_COVERAGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:13:42.381185 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.626 seconds
[0m18:13:42.382491 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:13:42.383056 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
COMMIT
[0m18:13:42.785236 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.401 seconds
[0m18:13:42.810156 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: Close
[0m18:13:42.966279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea3231d8-ed04-40b6-ad81-243a20768dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074707d0>]}
[0m18:13:42.967646 [info ] [Thread-1 (]: 1 of 7 OK snapshotted snapshot.snapshot_cloud_coverage ......................... [[32mSUCCESS 0[0m in 3.99s]
[0m18:13:42.968426 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_cloud_coverage
[0m18:13:42.968989 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_correlation_data
[0m18:13:42.969692 [info ] [Thread-1 (]: 2 of 7 START snapshot snapshot.snapshot_correlation_data ....................... [RUN]
[0m18:13:42.970374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_cloud_coverage, now snapshot.weather_dbt.snapshot_correlation_data)
[0m18:13:42.970822 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_correlation_data
[0m18:13:42.975198 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_correlation_data
[0m18:13:42.995276 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:13:42.995646 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
select * from (
        



WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData

    ) as __dbt_sbq
    where false
    limit 0
[0m18:13:42.995924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:43.453774 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.458 seconds
[0m18:13:43.456961 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:13:43.457282 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA"
[0m18:13:43.575741 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.118 seconds
[0m18:13:43.582954 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:13:43.583537 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA"
[0m18:13:43.685146 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.101 seconds
[0m18:13:43.697017 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:13:43.697788 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData


    ),

    snapshotted_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CITY_NAME" != source_data."CITY_NAME"
        or
        (
            ((snapshotted_data."CITY_NAME" is null) and not (source_data."CITY_NAME" is null))
            or
            ((not snapshotted_data."CITY_NAME" is null) and (source_data."CITY_NAME" is null))
        ) or snapshotted_data."AVG_TEMP" != source_data."AVG_TEMP"
        or
        (
            ((snapshotted_data."AVG_TEMP" is null) and not (source_data."AVG_TEMP" is null))
            or
            ((not snapshotted_data."AVG_TEMP" is null) and (source_data."AVG_TEMP" is null))
        ) or snapshotted_data."AVG_HUMIDITY" != source_data."AVG_HUMIDITY"
        or
        (
            ((snapshotted_data."AVG_HUMIDITY" is null) and not (source_data."AVG_HUMIDITY" is null))
            or
            ((not snapshotted_data."AVG_HUMIDITY" is null) and (source_data."AVG_HUMIDITY" is null))
        ) or snapshotted_data."AVG_PRESSURE" != source_data."AVG_PRESSURE"
        or
        (
            ((snapshotted_data."AVG_PRESSURE" is null) and not (source_data."AVG_PRESSURE" is null))
            or
            ((not snapshotted_data."AVG_PRESSURE" is null) and (source_data."AVG_PRESSURE" is null))
        ) or snapshotted_data."AVG_WIND_SPEED" != source_data."AVG_WIND_SPEED"
        or
        (
            ((snapshotted_data."AVG_WIND_SPEED" is null) and not (source_data."AVG_WIND_SPEED" is null))
            or
            ((not snapshotted_data."AVG_WIND_SPEED" is null) and (source_data."AVG_WIND_SPEED" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CITY_NAME" != source_data."CITY_NAME"
        or
        (
            ((snapshotted_data."CITY_NAME" is null) and not (source_data."CITY_NAME" is null))
            or
            ((not snapshotted_data."CITY_NAME" is null) and (source_data."CITY_NAME" is null))
        ) or snapshotted_data."AVG_TEMP" != source_data."AVG_TEMP"
        or
        (
            ((snapshotted_data."AVG_TEMP" is null) and not (source_data."AVG_TEMP" is null))
            or
            ((not snapshotted_data."AVG_TEMP" is null) and (source_data."AVG_TEMP" is null))
        ) or snapshotted_data."AVG_HUMIDITY" != source_data."AVG_HUMIDITY"
        or
        (
            ((snapshotted_data."AVG_HUMIDITY" is null) and not (source_data."AVG_HUMIDITY" is null))
            or
            ((not snapshotted_data."AVG_HUMIDITY" is null) and (source_data."AVG_HUMIDITY" is null))
        ) or snapshotted_data."AVG_PRESSURE" != source_data."AVG_PRESSURE"
        or
        (
            ((snapshotted_data."AVG_PRESSURE" is null) and not (source_data."AVG_PRESSURE" is null))
            or
            ((not snapshotted_data."AVG_PRESSURE" is null) and (source_data."AVG_PRESSURE" is null))
        ) or snapshotted_data."AVG_WIND_SPEED" != source_data."AVG_WIND_SPEED"
        or
        (
            ((snapshotted_data."AVG_WIND_SPEED" is null) and not (source_data."AVG_WIND_SPEED" is null))
            or
            ((not snapshotted_data."AVG_WIND_SPEED" is null) and (source_data."AVG_WIND_SPEED" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:13:44.734000 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.035 seconds
[0m18:13:44.744154 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:13:44.744669 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA__dbt_tmp"
[0m18:13:44.841765 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.096 seconds
[0m18:13:44.846836 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:13:44.847388 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA"
[0m18:13:44.944241 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.097 seconds
[0m18:13:44.946456 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:13:44.946700 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA__dbt_tmp"
[0m18:13:45.116496 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.169 seconds
[0m18:13:45.119538 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:13:45.119876 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA"
[0m18:13:45.282374 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.162 seconds
[0m18:13:45.288173 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:13:45.288710 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA__dbt_tmp"
[0m18:13:45.380061 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.090 seconds
[0m18:13:45.391714 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:13:45.392727 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
select * from (
        

    with snapshot_query as (

        



WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData


    ),

    snapshotted_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CITY_NAME" != source_data."CITY_NAME"
        or
        (
            ((snapshotted_data."CITY_NAME" is null) and not (source_data."CITY_NAME" is null))
            or
            ((not snapshotted_data."CITY_NAME" is null) and (source_data."CITY_NAME" is null))
        ) or snapshotted_data."AVG_TEMP" != source_data."AVG_TEMP"
        or
        (
            ((snapshotted_data."AVG_TEMP" is null) and not (source_data."AVG_TEMP" is null))
            or
            ((not snapshotted_data."AVG_TEMP" is null) and (source_data."AVG_TEMP" is null))
        ) or snapshotted_data."AVG_HUMIDITY" != source_data."AVG_HUMIDITY"
        or
        (
            ((snapshotted_data."AVG_HUMIDITY" is null) and not (source_data."AVG_HUMIDITY" is null))
            or
            ((not snapshotted_data."AVG_HUMIDITY" is null) and (source_data."AVG_HUMIDITY" is null))
        ) or snapshotted_data."AVG_PRESSURE" != source_data."AVG_PRESSURE"
        or
        (
            ((snapshotted_data."AVG_PRESSURE" is null) and not (source_data."AVG_PRESSURE" is null))
            or
            ((not snapshotted_data."AVG_PRESSURE" is null) and (source_data."AVG_PRESSURE" is null))
        ) or snapshotted_data."AVG_WIND_SPEED" != source_data."AVG_WIND_SPEED"
        or
        (
            ((snapshotted_data."AVG_WIND_SPEED" is null) and not (source_data."AVG_WIND_SPEED" is null))
            or
            ((not snapshotted_data."AVG_WIND_SPEED" is null) and (source_data."AVG_WIND_SPEED" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CITY_NAME" != source_data."CITY_NAME"
        or
        (
            ((snapshotted_data."CITY_NAME" is null) and not (source_data."CITY_NAME" is null))
            or
            ((not snapshotted_data."CITY_NAME" is null) and (source_data."CITY_NAME" is null))
        ) or snapshotted_data."AVG_TEMP" != source_data."AVG_TEMP"
        or
        (
            ((snapshotted_data."AVG_TEMP" is null) and not (source_data."AVG_TEMP" is null))
            or
            ((not snapshotted_data."AVG_TEMP" is null) and (source_data."AVG_TEMP" is null))
        ) or snapshotted_data."AVG_HUMIDITY" != source_data."AVG_HUMIDITY"
        or
        (
            ((snapshotted_data."AVG_HUMIDITY" is null) and not (source_data."AVG_HUMIDITY" is null))
            or
            ((not snapshotted_data."AVG_HUMIDITY" is null) and (source_data."AVG_HUMIDITY" is null))
        ) or snapshotted_data."AVG_PRESSURE" != source_data."AVG_PRESSURE"
        or
        (
            ((snapshotted_data."AVG_PRESSURE" is null) and not (source_data."AVG_PRESSURE" is null))
            or
            ((not snapshotted_data."AVG_PRESSURE" is null) and (source_data."AVG_PRESSURE" is null))
        ) or snapshotted_data."AVG_WIND_SPEED" != source_data."AVG_WIND_SPEED"
        or
        (
            ((snapshotted_data."AVG_WIND_SPEED" is null) and not (source_data."AVG_WIND_SPEED" is null))
            or
            ((not snapshotted_data."AVG_WIND_SPEED" is null) and (source_data."AVG_WIND_SPEED" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:13:45.622422 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.228 seconds
[0m18:13:45.625754 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:13:45.626508 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:13:45.741373 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.114 seconds
[0m18:13:45.742829 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:13:45.745306 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:13:45.745894 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
BEGIN
[0m18:13:45.902129 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.156 seconds
[0m18:13:45.902908 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:13:45.903479 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
merge into "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_NAME", "AVG_TEMP", "AVG_HUMIDITY", "AVG_PRESSURE", "AVG_WIND_SPEED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_NAME", "AVG_TEMP", "AVG_HUMIDITY", "AVG_PRESSURE", "AVG_WIND_SPEED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:13:46.475966 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.571 seconds
[0m18:13:46.478007 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:13:46.478821 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
COMMIT
[0m18:13:46.779327 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.299 seconds
[0m18:13:46.783397 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: Close
[0m18:13:46.970130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea3231d8-ed04-40b6-ad81-243a20768dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107614940>]}
[0m18:13:46.971841 [info ] [Thread-1 (]: 2 of 7 OK snapshotted snapshot.snapshot_correlation_data ....................... [[32mSUCCESS 0[0m in 4.00s]
[0m18:13:46.972624 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_correlation_data
[0m18:13:46.973171 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m18:13:46.973855 [info ] [Thread-1 (]: 3 of 7 START snapshot snapshot.snapshot_extreme_weather_events ................. [RUN]
[0m18:13:46.974518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_correlation_data, now snapshot.weather_dbt.snapshot_extreme_weather_events)
[0m18:13:46.974973 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m18:13:46.979499 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m18:13:46.984876 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:13:46.985267 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS"
[0m18:13:46.985578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:47.592538 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.606 seconds
[0m18:13:47.603353 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:13:47.604153 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME


    ),

    snapshotted_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            DATE_TIME as dbt_updated_at,
            DATE_TIME as dbt_valid_from,
            
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            DATE_TIME as dbt_updated_at,
            DATE_TIME as dbt_valid_from,
            DATE_TIME as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DATE_TIME))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DATE_TIME)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:13:49.030922 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.426 seconds
[0m18:13:49.033508 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:13:49.033763 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS__dbt_tmp"
[0m18:13:49.208074 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.174 seconds
[0m18:13:49.214366 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:13:49.215013 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS"
[0m18:13:49.315178 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.099 seconds
[0m18:13:49.320097 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:13:49.320557 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS__dbt_tmp"
[0m18:13:49.465854 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.145 seconds
[0m18:13:49.471621 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:13:49.472104 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS"
[0m18:13:49.584211 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.111 seconds
[0m18:13:49.588725 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:13:49.589005 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS__dbt_tmp"
[0m18:13:49.694999 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.105 seconds
[0m18:13:49.703537 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:13:49.704205 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
select * from (
        

    with snapshot_query as (

        



WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME


    ),

    snapshotted_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            DATE_TIME as dbt_updated_at,
            DATE_TIME as dbt_valid_from,
            
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            DATE_TIME as dbt_updated_at,
            DATE_TIME as dbt_valid_from,
            DATE_TIME as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DATE_TIME))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DATE_TIME)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:13:49.951088 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.246 seconds
[0m18:13:49.952176 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:13:49.952472 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:13:50.053893 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.101 seconds
[0m18:13:50.055128 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:13:50.057616 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:13:50.058282 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
BEGIN
[0m18:13:50.182201 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.123 seconds
[0m18:13:50.183990 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:13:50.184828 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
merge into "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_ID", "CITY_NAME", "DATE_TIME", "TEMP_FAHRENHEIT", "WIND_SPEED", "WEATHER_ALERT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_ID", "CITY_NAME", "DATE_TIME", "TEMP_FAHRENHEIT", "WIND_SPEED", "WEATHER_ALERT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:13:50.989233 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b525-0004-386b-0002-594300046c12
[0m18:13:50.989988 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m18:13:50.990604 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: Close
[0m18:13:51.119492 [debug] [Thread-1 (]: Database Error in snapshot snapshot_extreme_weather_events (snapshots/extreme_weather_events_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/extreme_weather_events_snapshot.sql
[0m18:13:51.120326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea3231d8-ed04-40b6-ad81-243a20768dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b28f0>]}
[0m18:13:51.121296 [error] [Thread-1 (]: 3 of 7 ERROR snapshotting snapshot.snapshot_extreme_weather_events ............. [[31mERROR[0m in 4.15s]
[0m18:13:51.121918 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m18:13:51.122350 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_humidity_temperature
[0m18:13:51.123654 [info ] [Thread-1 (]: 4 of 7 START snapshot snapshot.snapshot_humidity_temperature ................... [RUN]
[0m18:13:51.124162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_extreme_weather_events, now snapshot.weather_dbt.snapshot_humidity_temperature)
[0m18:13:51.124534 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_humidity_temperature
[0m18:13:51.129595 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_humidity_temperature
[0m18:13:51.133389 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:13:51.133942 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE"
[0m18:13:51.134304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:51.659344 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.524 seconds
[0m18:13:51.668658 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:13:51.669274 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(TEMP_FAHRENHEIT) AS AVG_TEMP_FAHRENHEIT,
    AVG(HUMIDITY) AS AVG_HUMIDITY
FROM HumidityTemp
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY


    ),

    snapshotted_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
,
            md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            DAY as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DAY))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DAY)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:13:52.893978 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.224 seconds
[0m18:13:52.897359 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:13:52.897629 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE__dbt_tmp"
[0m18:13:53.013212 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.115 seconds
[0m18:13:53.020464 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:13:53.021453 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE"
[0m18:13:53.136328 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.114 seconds
[0m18:13:53.141632 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:13:53.142081 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE__dbt_tmp"
[0m18:13:53.281173 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.139 seconds
[0m18:13:53.289168 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:13:53.289414 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE"
[0m18:13:53.403630 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.114 seconds
[0m18:13:53.409642 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:13:53.410261 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE__dbt_tmp"
[0m18:13:53.526896 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.116 seconds
[0m18:13:53.535568 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:13:53.536486 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
select * from (
        

    with snapshot_query as (

        



WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(TEMP_FAHRENHEIT) AS AVG_TEMP_FAHRENHEIT,
    AVG(HUMIDITY) AS AVG_HUMIDITY
FROM HumidityTemp
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY


    ),

    snapshotted_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
,
            md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            DAY as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DAY))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DAY)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:13:53.787949 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.250 seconds
[0m18:13:53.789671 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:13:53.789976 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:13:53.898468 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.108 seconds
[0m18:13:53.899919 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:13:53.901482 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:13:53.901784 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
BEGIN
[0m18:13:54.091681 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.189 seconds
[0m18:13:54.092446 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:13:54.092956 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
merge into "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_NAME", "DAY", "AVG_TEMP_FAHRENHEIT", "AVG_HUMIDITY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_NAME", "DAY", "AVG_TEMP_FAHRENHEIT", "AVG_HUMIDITY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:13:54.868951 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.775 seconds
[0m18:13:54.869940 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:13:54.870454 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
COMMIT
[0m18:13:55.384053 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.513 seconds
[0m18:13:55.387904 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: Close
[0m18:13:55.513712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea3231d8-ed04-40b6-ad81-243a20768dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10784c6d0>]}
[0m18:13:55.514948 [info ] [Thread-1 (]: 4 of 7 OK snapshotted snapshot.snapshot_humidity_temperature ................... [[32mSUCCESS 0[0m in 4.39s]
[0m18:13:55.515818 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_humidity_temperature
[0m18:13:55.516363 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_temp_trends
[0m18:13:55.516989 [info ] [Thread-1 (]: 5 of 7 START snapshot snapshot.snapshot_temp_trends ............................ [RUN]
[0m18:13:55.517590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_humidity_temperature, now snapshot.weather_dbt.snapshot_temp_trends)
[0m18:13:55.518036 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_temp_trends
[0m18:13:55.522606 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_temp_trends
[0m18:13:55.527917 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:13:55.528332 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS"
[0m18:13:55.528633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:56.005789 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.477 seconds
[0m18:13:56.016214 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:13:56.017199 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH TempTrends AS (
    SELECT 
        "Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY


    ),

    snapshotted_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
,
            md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            DAY as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DAY))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DAY)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:13:57.123060 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.105 seconds
[0m18:13:57.128353 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:13:57.129010 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS__dbt_tmp"
[0m18:13:57.237218 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.107 seconds
[0m18:13:57.243697 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:13:57.244478 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS"
[0m18:13:57.357074 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.112 seconds
[0m18:13:57.365746 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:13:57.366187 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS__dbt_tmp"
[0m18:13:57.487620 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.118 seconds
[0m18:13:57.493563 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:13:57.494213 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS"
[0m18:13:57.610471 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.115 seconds
[0m18:13:57.616529 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:13:57.617246 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS__dbt_tmp"
[0m18:13:57.789615 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.170 seconds
[0m18:13:57.799338 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:13:57.800189 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
select * from (
        

    with snapshot_query as (

        



WITH TempTrends AS (
    SELECT 
        "Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY


    ),

    snapshotted_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
,
            md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            DAY as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DAY))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DAY)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:13:58.010721 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.209 seconds
[0m18:13:58.013233 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:13:58.013744 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:13:58.153372 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.139 seconds
[0m18:13:58.155179 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:13:58.158162 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:13:58.158827 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
BEGIN
[0m18:13:58.340705 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.181 seconds
[0m18:13:58.342083 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:13:58.343401 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
merge into "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_NAME", "DAY", "AVG_TEMP_FAHRENHEIT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_NAME", "DAY", "AVG_TEMP_FAHRENHEIT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:13:58.966514 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.622 seconds
[0m18:13:58.967966 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:13:58.968531 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
COMMIT
[0m18:13:59.373079 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.404 seconds
[0m18:13:59.376056 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: Close
[0m18:13:59.504608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea3231d8-ed04-40b6-ad81-243a20768dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083894e0>]}
[0m18:13:59.506110 [info ] [Thread-1 (]: 5 of 7 OK snapshotted snapshot.snapshot_temp_trends ............................ [[32mSUCCESS 0[0m in 3.99s]
[0m18:13:59.507003 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_temp_trends
[0m18:13:59.507606 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_weather_distribution
[0m18:13:59.508365 [info ] [Thread-1 (]: 6 of 7 START snapshot snapshot.snapshot_weather_distribution ................... [RUN]
[0m18:13:59.509062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_temp_trends, now snapshot.weather_dbt.snapshot_weather_distribution)
[0m18:13:59.509501 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_weather_distribution
[0m18:13:59.514161 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_weather_distribution
[0m18:13:59.519174 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:13:59.519674 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
select * from (
        



WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, 3
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC

    ) as __dbt_sbq
    where false
    limit 0
[0m18:13:59.520071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:02.346623 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 2.826 seconds
[0m18:14:02.352191 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:14:02.352820 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WEATHER_DISTRIBUTION"
[0m18:14:02.467746 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.114 seconds
[0m18:14:02.472983 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:14:02.473352 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WEATHER_DISTRIBUTION"
[0m18:14:02.560120 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.086 seconds
[0m18:14:02.571129 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:14:02.571978 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WEATHER_DISTRIBUTION__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, 3
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC


    ),

    snapshotted_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WEATHER_DISTRIBUTION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."WEATHER_MAIN" != source_data."WEATHER_MAIN"
        or
        (
            ((snapshotted_data."WEATHER_MAIN" is null) and not (source_data."WEATHER_MAIN" is null))
            or
            ((not snapshotted_data."WEATHER_MAIN" is null) and (source_data."WEATHER_MAIN" is null))
        ) or snapshotted_data."COUNT" != source_data."COUNT"
        or
        (
            ((snapshotted_data."COUNT" is null) and not (source_data."COUNT" is null))
            or
            ((not snapshotted_data."COUNT" is null) and (source_data."COUNT" is null))
        ) or snapshotted_data."CITY_NAME" != source_data."CITY_NAME"
        or
        (
            ((snapshotted_data."CITY_NAME" is null) and not (source_data."CITY_NAME" is null))
            or
            ((not snapshotted_data."CITY_NAME" is null) and (source_data."CITY_NAME" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."WEATHER_MAIN" != source_data."WEATHER_MAIN"
        or
        (
            ((snapshotted_data."WEATHER_MAIN" is null) and not (source_data."WEATHER_MAIN" is null))
            or
            ((not snapshotted_data."WEATHER_MAIN" is null) and (source_data."WEATHER_MAIN" is null))
        ) or snapshotted_data."COUNT" != source_data."COUNT"
        or
        (
            ((snapshotted_data."COUNT" is null) and not (source_data."COUNT" is null))
            or
            ((not snapshotted_data."COUNT" is null) and (source_data."COUNT" is null))
        ) or snapshotted_data."CITY_NAME" != source_data."CITY_NAME"
        or
        (
            ((snapshotted_data."CITY_NAME" is null) and not (source_data."CITY_NAME" is null))
            or
            ((not snapshotted_data."CITY_NAME" is null) and (source_data."CITY_NAME" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:14:03.566014 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.993 seconds
[0m18:14:03.569808 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:14:03.570218 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WEATHER_DISTRIBUTION__dbt_tmp"
[0m18:14:03.671580 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.101 seconds
[0m18:14:03.675295 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:14:03.675652 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WEATHER_DISTRIBUTION"
[0m18:14:03.779585 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.103 seconds
[0m18:14:03.783927 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:14:03.784414 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WEATHER_DISTRIBUTION__dbt_tmp"
[0m18:14:03.864224 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.079 seconds
[0m18:14:03.868714 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:14:03.869207 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WEATHER_DISTRIBUTION"
[0m18:14:03.990455 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.120 seconds
[0m18:14:03.996602 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:14:03.997167 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WEATHER_DISTRIBUTION__dbt_tmp"
[0m18:14:04.102749 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.105 seconds
[0m18:14:04.109609 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:14:04.110647 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
select * from (
        

    with snapshot_query as (

        



WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, 3
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC


    ),

    snapshotted_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WEATHER_DISTRIBUTION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."WEATHER_MAIN" != source_data."WEATHER_MAIN"
        or
        (
            ((snapshotted_data."WEATHER_MAIN" is null) and not (source_data."WEATHER_MAIN" is null))
            or
            ((not snapshotted_data."WEATHER_MAIN" is null) and (source_data."WEATHER_MAIN" is null))
        ) or snapshotted_data."COUNT" != source_data."COUNT"
        or
        (
            ((snapshotted_data."COUNT" is null) and not (source_data."COUNT" is null))
            or
            ((not snapshotted_data."COUNT" is null) and (source_data."COUNT" is null))
        ) or snapshotted_data."CITY_NAME" != source_data."CITY_NAME"
        or
        (
            ((snapshotted_data."CITY_NAME" is null) and not (source_data."CITY_NAME" is null))
            or
            ((not snapshotted_data."CITY_NAME" is null) and (source_data."CITY_NAME" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."WEATHER_MAIN" != source_data."WEATHER_MAIN"
        or
        (
            ((snapshotted_data."WEATHER_MAIN" is null) and not (source_data."WEATHER_MAIN" is null))
            or
            ((not snapshotted_data."WEATHER_MAIN" is null) and (source_data."WEATHER_MAIN" is null))
        ) or snapshotted_data."COUNT" != source_data."COUNT"
        or
        (
            ((snapshotted_data."COUNT" is null) and not (source_data."COUNT" is null))
            or
            ((not snapshotted_data."COUNT" is null) and (source_data."COUNT" is null))
        ) or snapshotted_data."CITY_NAME" != source_data."CITY_NAME"
        or
        (
            ((snapshotted_data."CITY_NAME" is null) and not (source_data."CITY_NAME" is null))
            or
            ((not snapshotted_data."CITY_NAME" is null) and (source_data."CITY_NAME" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:14:04.361370 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.249 seconds
[0m18:14:04.364636 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:14:04.365158 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:14:04.502014 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.136 seconds
[0m18:14:04.503932 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:14:04.507133 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:14:04.507878 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
BEGIN
[0m18:14:04.690693 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.182 seconds
[0m18:14:04.692256 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:14:04.693529 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
merge into "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WEATHER_DISTRIBUTION" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WEATHER_DISTRIBUTION__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("WEATHER_MAIN", "COUNT", "CITY_NAME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("WEATHER_MAIN", "COUNT", "CITY_NAME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:14:05.213366 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b526-0004-3864-0002-59430004770a
[0m18:14:05.214534 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m18:14:05.215345 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: Close
[0m18:14:05.352537 [debug] [Thread-1 (]: Database Error in snapshot snapshot_weather_distribution (snapshots/weather_cond_distributions_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/weather_cond_distributions_snapshot.sql
[0m18:14:05.353380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea3231d8-ed04-40b6-ad81-243a20768dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107514e30>]}
[0m18:14:05.354368 [error] [Thread-1 (]: 6 of 7 ERROR snapshotting snapshot.snapshot_weather_distribution ............... [[31mERROR[0m in 5.84s]
[0m18:14:05.354998 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_weather_distribution
[0m18:14:05.355419 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_wind_speed
[0m18:14:05.356007 [info ] [Thread-1 (]: 7 of 7 START snapshot snapshot.snapshot_wind_speed ............................. [RUN]
[0m18:14:05.356527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_weather_distribution, now snapshot.weather_dbt.snapshot_wind_speed)
[0m18:14:05.356902 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_wind_speed
[0m18:14:05.360962 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_wind_speed
[0m18:14:05.365623 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:14:05.366367 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED"
[0m18:14:05.367050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:05.801261 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.434 seconds
[0m18:14:05.812345 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:14:05.813124 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(WIND_SPEED) AS AVG_WIND_SPEED
FROM WindSpeedData
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY


    ),

    snapshotted_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
,
            md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            DAY as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DAY))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DAY)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:14:07.057211 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.243 seconds
[0m18:14:07.062539 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:14:07.063043 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED__dbt_tmp"
[0m18:14:07.159255 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.095 seconds
[0m18:14:07.165541 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:14:07.166232 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED"
[0m18:14:07.262729 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.096 seconds
[0m18:14:07.268120 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:14:07.268618 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED__dbt_tmp"
[0m18:14:07.408662 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.139 seconds
[0m18:14:07.412779 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:14:07.413242 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED"
[0m18:14:07.500317 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.087 seconds
[0m18:14:07.503802 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:14:07.504105 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED__dbt_tmp"
[0m18:14:07.613073 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.108 seconds
[0m18:14:07.620935 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:14:07.621701 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
select * from (
        

    with snapshot_query as (

        



WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(WIND_SPEED) AS AVG_WIND_SPEED
FROM WindSpeedData
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY


    ),

    snapshotted_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
,
            md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            DAY as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DAY))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DAY)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:14:07.847753 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.225 seconds
[0m18:14:07.851200 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:14:07.851796 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:14:07.930027 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.077 seconds
[0m18:14:07.932023 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:14:07.934717 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:14:07.935190 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
BEGIN
[0m18:14:08.053868 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.118 seconds
[0m18:14:08.054352 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:14:08.054795 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
merge into "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_NAME", "DAY", "AVG_WIND_SPEED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_NAME", "DAY", "AVG_WIND_SPEED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:14:08.591768 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.536 seconds
[0m18:14:08.593398 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:14:08.594290 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
COMMIT
[0m18:14:08.942406 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.347 seconds
[0m18:14:08.947764 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: Close
[0m18:14:09.087940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea3231d8-ed04-40b6-ad81-243a20768dbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107820cb0>]}
[0m18:14:09.089514 [info ] [Thread-1 (]: 7 of 7 OK snapshotted snapshot.snapshot_wind_speed ............................. [[32mSUCCESS 0[0m in 3.73s]
[0m18:14:09.090525 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_wind_speed
[0m18:14:09.092388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:09.092854 [debug] [MainThread]: Connection 'snapshot.weather_dbt.snapshot_wind_speed' was properly closed.
[0m18:14:09.093259 [info ] [MainThread]: 
[0m18:14:09.093646 [info ] [MainThread]: Finished running 7 snapshots in 0 hours 0 minutes and 32.21 seconds (32.21s).
[0m18:14:09.095304 [debug] [MainThread]: Command end result
[0m18:14:09.130061 [info ] [MainThread]: 
[0m18:14:09.130464 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:14:09.130680 [info ] [MainThread]: 
[0m18:14:09.130957 [error] [MainThread]:   Database Error in snapshot snapshot_extreme_weather_events (snapshots/extreme_weather_events_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/extreme_weather_events_snapshot.sql
[0m18:14:09.131157 [info ] [MainThread]: 
[0m18:14:09.131385 [error] [MainThread]:   Database Error in snapshot snapshot_weather_distribution (snapshots/weather_cond_distributions_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/weather_cond_distributions_snapshot.sql
[0m18:14:09.131566 [info ] [MainThread]: 
[0m18:14:09.131753 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m18:14:09.133255 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 32.78498, "process_in_blocks": "0", "process_kernel_time": 0.343374, "process_mem_max_rss": "140951552", "process_out_blocks": "0", "process_user_time": 2.642732}
[0m18:14:09.133624 [debug] [MainThread]: Command `dbt snapshot` failed at 18:14:09.133562 after 32.79 seconds
[0m18:14:09.133863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105047890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10839b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10839b8f0>]}
[0m18:14:09.134078 [debug] [MainThread]: Flushing usage events
[0m18:26:54.611898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c13b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c13d90>]}


============================== 18:26:54.615117 | 063d3817-0c29-4a83-8421-b304f3cb4be1 ==============================
[0m18:26:54.615117 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:26:54.615466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:26:54.866706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '063d3817-0c29-4a83-8421-b304f3cb4be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c0ab10>]}
[0m18:26:54.890707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '063d3817-0c29-4a83-8421-b304f3cb4be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139f0050>]}
[0m18:26:54.891559 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:26:54.954433 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:26:55.046568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:26:55.047012 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/weather_cond_distributions_snapshot.sql
[0m18:26:55.179039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '063d3817-0c29-4a83-8421-b304f3cb4be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f80850>]}
[0m18:26:55.290180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '063d3817-0c29-4a83-8421-b304f3cb4be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113941400>]}
[0m18:26:55.290495 [info ] [MainThread]: Found 8 models, 7 snapshots, 29 data tests, 2 sources, 459 macros
[0m18:26:55.290745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '063d3817-0c29-4a83-8421-b304f3cb4be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c1c210>]}
[0m18:26:55.292179 [info ] [MainThread]: 
[0m18:26:55.292493 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:26:55.294860 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m18:26:55.301575 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m18:26:55.301750 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m18:26:55.301942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:55.859323 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.557 seconds
[0m18:26:55.865713 [debug] [ThreadPool]: On list_openweather: Close
[0m18:26:55.995230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_snapshot)
[0m18:26:56.005873 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m18:26:56.006254 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m18:26:56.006540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:26:56.416181 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.409 seconds
[0m18:26:56.419772 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m18:26:56.541172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now list_openweather_analytics)
[0m18:26:56.544490 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m18:26:56.544787 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m18:26:56.545036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:26:57.004256 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.459 seconds
[0m18:26:57.009794 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m18:26:57.175238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '063d3817-0c29-4a83-8421-b304f3cb4be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c59b20>]}
[0m18:26:57.176103 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m18:26:57.176450 [info ] [MainThread]: 
[0m18:26:57.180622 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_cloud_coverage
[0m18:26:57.181187 [info ] [Thread-1 (]: 1 of 7 START snapshot snapshot.snapshot_cloud_coverage ......................... [RUN]
[0m18:26:57.181606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_analytics, now snapshot.weather_dbt.snapshot_cloud_coverage)
[0m18:26:57.182298 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_cloud_coverage
[0m18:26:57.193872 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_cloud_coverage
[0m18:26:57.226406 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:26:57.226717 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE"
[0m18:26:57.226896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:57.834498 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.607 seconds
[0m18:26:57.881798 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:26:57.882270 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH CloudCoverage AS (
    SELECT 
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY


    ),

    snapshotted_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
,
            md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            DAY as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DAY))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DAY)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:26:59.072326 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.189 seconds
[0m18:26:59.077716 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:26:59.078370 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE__dbt_tmp"
[0m18:26:59.174944 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.096 seconds
[0m18:26:59.180825 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:26:59.181536 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE"
[0m18:26:59.271579 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.089 seconds
[0m18:26:59.274886 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:26:59.275204 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE__dbt_tmp"
[0m18:26:59.365855 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.090 seconds
[0m18:26:59.370820 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:26:59.371257 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE"
[0m18:26:59.464165 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.092 seconds
[0m18:26:59.473608 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:26:59.474059 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE__dbt_tmp"
[0m18:26:59.556117 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.081 seconds
[0m18:26:59.582727 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:26:59.583300 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
select * from (
        

    with snapshot_query as (

        



WITH CloudCoverage AS (
    SELECT 
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY


    ),

    snapshotted_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
,
            md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            DAY as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DAY))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DAY)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:26:59.753040 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.169 seconds
[0m18:26:59.759760 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:26:59.760294 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:26:59.863263 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.102 seconds
[0m18:26:59.864438 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:26:59.868174 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:26:59.868778 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
BEGIN
[0m18:26:59.997619 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.128 seconds
[0m18:26:59.998933 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:26:59.999476 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
merge into "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_NAME", "DAY", "AVG_CLOUD_COVERAGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_NAME", "DAY", "AVG_CLOUD_COVERAGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:27:00.600548 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.600 seconds
[0m18:27:00.601669 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:27:00.602202 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
COMMIT
[0m18:27:00.829674 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.227 seconds
[0m18:27:00.854773 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: Close
[0m18:27:00.995083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '063d3817-0c29-4a83-8421-b304f3cb4be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114259910>]}
[0m18:27:00.996612 [info ] [Thread-1 (]: 1 of 7 OK snapshotted snapshot.snapshot_cloud_coverage ......................... [[32mSUCCESS 0[0m in 3.81s]
[0m18:27:00.997386 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_cloud_coverage
[0m18:27:00.997923 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_correlation_data
[0m18:27:00.998607 [info ] [Thread-1 (]: 2 of 7 START snapshot snapshot.snapshot_correlation_data ....................... [RUN]
[0m18:27:00.999213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_cloud_coverage, now snapshot.weather_dbt.snapshot_correlation_data)
[0m18:27:00.999661 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_correlation_data
[0m18:27:01.004060 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_correlation_data
[0m18:27:01.024075 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:27:01.024499 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
select * from (
        



WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData

    ) as __dbt_sbq
    where false
    limit 0
[0m18:27:01.024765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:01.506455 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.481 seconds
[0m18:27:01.512029 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:27:01.512787 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA"
[0m18:27:01.648690 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.135 seconds
[0m18:27:01.654754 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:27:01.655213 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA"
[0m18:27:01.798098 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.142 seconds
[0m18:27:01.814064 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:27:01.814956 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData


    ),

    snapshotted_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CITY_NAME" != source_data."CITY_NAME"
        or
        (
            ((snapshotted_data."CITY_NAME" is null) and not (source_data."CITY_NAME" is null))
            or
            ((not snapshotted_data."CITY_NAME" is null) and (source_data."CITY_NAME" is null))
        ) or snapshotted_data."AVG_TEMP" != source_data."AVG_TEMP"
        or
        (
            ((snapshotted_data."AVG_TEMP" is null) and not (source_data."AVG_TEMP" is null))
            or
            ((not snapshotted_data."AVG_TEMP" is null) and (source_data."AVG_TEMP" is null))
        ) or snapshotted_data."AVG_HUMIDITY" != source_data."AVG_HUMIDITY"
        or
        (
            ((snapshotted_data."AVG_HUMIDITY" is null) and not (source_data."AVG_HUMIDITY" is null))
            or
            ((not snapshotted_data."AVG_HUMIDITY" is null) and (source_data."AVG_HUMIDITY" is null))
        ) or snapshotted_data."AVG_PRESSURE" != source_data."AVG_PRESSURE"
        or
        (
            ((snapshotted_data."AVG_PRESSURE" is null) and not (source_data."AVG_PRESSURE" is null))
            or
            ((not snapshotted_data."AVG_PRESSURE" is null) and (source_data."AVG_PRESSURE" is null))
        ) or snapshotted_data."AVG_WIND_SPEED" != source_data."AVG_WIND_SPEED"
        or
        (
            ((snapshotted_data."AVG_WIND_SPEED" is null) and not (source_data."AVG_WIND_SPEED" is null))
            or
            ((not snapshotted_data."AVG_WIND_SPEED" is null) and (source_data."AVG_WIND_SPEED" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CITY_NAME" != source_data."CITY_NAME"
        or
        (
            ((snapshotted_data."CITY_NAME" is null) and not (source_data."CITY_NAME" is null))
            or
            ((not snapshotted_data."CITY_NAME" is null) and (source_data."CITY_NAME" is null))
        ) or snapshotted_data."AVG_TEMP" != source_data."AVG_TEMP"
        or
        (
            ((snapshotted_data."AVG_TEMP" is null) and not (source_data."AVG_TEMP" is null))
            or
            ((not snapshotted_data."AVG_TEMP" is null) and (source_data."AVG_TEMP" is null))
        ) or snapshotted_data."AVG_HUMIDITY" != source_data."AVG_HUMIDITY"
        or
        (
            ((snapshotted_data."AVG_HUMIDITY" is null) and not (source_data."AVG_HUMIDITY" is null))
            or
            ((not snapshotted_data."AVG_HUMIDITY" is null) and (source_data."AVG_HUMIDITY" is null))
        ) or snapshotted_data."AVG_PRESSURE" != source_data."AVG_PRESSURE"
        or
        (
            ((snapshotted_data."AVG_PRESSURE" is null) and not (source_data."AVG_PRESSURE" is null))
            or
            ((not snapshotted_data."AVG_PRESSURE" is null) and (source_data."AVG_PRESSURE" is null))
        ) or snapshotted_data."AVG_WIND_SPEED" != source_data."AVG_WIND_SPEED"
        or
        (
            ((snapshotted_data."AVG_WIND_SPEED" is null) and not (source_data."AVG_WIND_SPEED" is null))
            or
            ((not snapshotted_data."AVG_WIND_SPEED" is null) and (source_data."AVG_WIND_SPEED" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:27:02.639065 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.823 seconds
[0m18:27:02.645522 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:27:02.646078 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA__dbt_tmp"
[0m18:27:02.732165 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.085 seconds
[0m18:27:02.737675 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:27:02.738140 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA"
[0m18:27:02.839881 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.101 seconds
[0m18:27:02.844860 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:27:02.845309 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA__dbt_tmp"
[0m18:27:02.997890 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.152 seconds
[0m18:27:03.003779 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:27:03.004429 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA"
[0m18:27:03.086464 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.080 seconds
[0m18:27:03.092534 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:27:03.093101 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA__dbt_tmp"
[0m18:27:03.204825 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.111 seconds
[0m18:27:03.209676 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:27:03.210150 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
select * from (
        

    with snapshot_query as (

        



WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData


    ),

    snapshotted_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CITY_NAME" != source_data."CITY_NAME"
        or
        (
            ((snapshotted_data."CITY_NAME" is null) and not (source_data."CITY_NAME" is null))
            or
            ((not snapshotted_data."CITY_NAME" is null) and (source_data."CITY_NAME" is null))
        ) or snapshotted_data."AVG_TEMP" != source_data."AVG_TEMP"
        or
        (
            ((snapshotted_data."AVG_TEMP" is null) and not (source_data."AVG_TEMP" is null))
            or
            ((not snapshotted_data."AVG_TEMP" is null) and (source_data."AVG_TEMP" is null))
        ) or snapshotted_data."AVG_HUMIDITY" != source_data."AVG_HUMIDITY"
        or
        (
            ((snapshotted_data."AVG_HUMIDITY" is null) and not (source_data."AVG_HUMIDITY" is null))
            or
            ((not snapshotted_data."AVG_HUMIDITY" is null) and (source_data."AVG_HUMIDITY" is null))
        ) or snapshotted_data."AVG_PRESSURE" != source_data."AVG_PRESSURE"
        or
        (
            ((snapshotted_data."AVG_PRESSURE" is null) and not (source_data."AVG_PRESSURE" is null))
            or
            ((not snapshotted_data."AVG_PRESSURE" is null) and (source_data."AVG_PRESSURE" is null))
        ) or snapshotted_data."AVG_WIND_SPEED" != source_data."AVG_WIND_SPEED"
        or
        (
            ((snapshotted_data."AVG_WIND_SPEED" is null) and not (source_data."AVG_WIND_SPEED" is null))
            or
            ((not snapshotted_data."AVG_WIND_SPEED" is null) and (source_data."AVG_WIND_SPEED" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CITY_NAME" != source_data."CITY_NAME"
        or
        (
            ((snapshotted_data."CITY_NAME" is null) and not (source_data."CITY_NAME" is null))
            or
            ((not snapshotted_data."CITY_NAME" is null) and (source_data."CITY_NAME" is null))
        ) or snapshotted_data."AVG_TEMP" != source_data."AVG_TEMP"
        or
        (
            ((snapshotted_data."AVG_TEMP" is null) and not (source_data."AVG_TEMP" is null))
            or
            ((not snapshotted_data."AVG_TEMP" is null) and (source_data."AVG_TEMP" is null))
        ) or snapshotted_data."AVG_HUMIDITY" != source_data."AVG_HUMIDITY"
        or
        (
            ((snapshotted_data."AVG_HUMIDITY" is null) and not (source_data."AVG_HUMIDITY" is null))
            or
            ((not snapshotted_data."AVG_HUMIDITY" is null) and (source_data."AVG_HUMIDITY" is null))
        ) or snapshotted_data."AVG_PRESSURE" != source_data."AVG_PRESSURE"
        or
        (
            ((snapshotted_data."AVG_PRESSURE" is null) and not (source_data."AVG_PRESSURE" is null))
            or
            ((not snapshotted_data."AVG_PRESSURE" is null) and (source_data."AVG_PRESSURE" is null))
        ) or snapshotted_data."AVG_WIND_SPEED" != source_data."AVG_WIND_SPEED"
        or
        (
            ((snapshotted_data."AVG_WIND_SPEED" is null) and not (source_data."AVG_WIND_SPEED" is null))
            or
            ((not snapshotted_data."AVG_WIND_SPEED" is null) and (source_data."AVG_WIND_SPEED" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:27:03.431482 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.221 seconds
[0m18:27:03.433444 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:27:03.433890 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:27:03.611945 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.177 seconds
[0m18:27:03.613473 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:27:03.616378 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:27:03.617080 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
BEGIN
[0m18:27:03.722737 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m18:27:03.723779 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:27:03.724908 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
merge into "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_NAME", "AVG_TEMP", "AVG_HUMIDITY", "AVG_PRESSURE", "AVG_WIND_SPEED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_NAME", "AVG_TEMP", "AVG_HUMIDITY", "AVG_PRESSURE", "AVG_WIND_SPEED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:27:04.182843 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.457 seconds
[0m18:27:04.184842 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:27:04.185457 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
COMMIT
[0m18:27:04.597399 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.411 seconds
[0m18:27:04.600659 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: Close
[0m18:27:04.715232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '063d3817-0c29-4a83-8421-b304f3cb4be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e51de0>]}
[0m18:27:04.716514 [info ] [Thread-1 (]: 2 of 7 OK snapshotted snapshot.snapshot_correlation_data ....................... [[32mSUCCESS 0[0m in 3.72s]
[0m18:27:04.717427 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_correlation_data
[0m18:27:04.717940 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m18:27:04.718593 [info ] [Thread-1 (]: 3 of 7 START snapshot snapshot.snapshot_extreme_weather_events ................. [RUN]
[0m18:27:04.719180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_correlation_data, now snapshot.weather_dbt.snapshot_extreme_weather_events)
[0m18:27:04.719616 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m18:27:04.724287 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m18:27:04.729662 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:27:04.730143 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS"
[0m18:27:04.730692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:05.183926 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.453 seconds
[0m18:27:05.194868 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:27:05.195568 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME


    ),

    snapshotted_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            DATE_TIME as dbt_updated_at,
            DATE_TIME as dbt_valid_from,
            
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            DATE_TIME as dbt_updated_at,
            DATE_TIME as dbt_valid_from,
            DATE_TIME as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DATE_TIME))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DATE_TIME)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:27:06.435864 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.239 seconds
[0m18:27:06.446559 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:27:06.447108 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS__dbt_tmp"
[0m18:27:06.540304 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.092 seconds
[0m18:27:06.547592 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:27:06.548105 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS"
[0m18:27:06.633185 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.084 seconds
[0m18:27:06.638073 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:27:06.638663 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS__dbt_tmp"
[0m18:27:06.718195 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.079 seconds
[0m18:27:06.724857 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:27:06.725429 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS"
[0m18:27:06.843632 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.117 seconds
[0m18:27:06.850097 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:27:06.850543 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS__dbt_tmp"
[0m18:27:06.947496 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.096 seconds
[0m18:27:06.956292 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:27:06.957053 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
select * from (
        

    with snapshot_query as (

        



WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME


    ),

    snapshotted_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            DATE_TIME as dbt_updated_at,
            DATE_TIME as dbt_valid_from,
            
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            DATE_TIME as dbt_updated_at,
            DATE_TIME as dbt_valid_from,
            DATE_TIME as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DATE_TIME))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DATE_TIME)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:27:07.157834 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.199 seconds
[0m18:27:07.161708 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:27:07.162432 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:27:07.266209 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.103 seconds
[0m18:27:07.267590 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:27:07.270763 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:27:07.271219 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
BEGIN
[0m18:27:07.414875 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.143 seconds
[0m18:27:07.415266 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:27:07.415547 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
merge into "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_ID", "CITY_NAME", "DATE_TIME", "TEMP_FAHRENHEIT", "WIND_SPEED", "WEATHER_ALERT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_ID", "CITY_NAME", "DATE_TIME", "TEMP_FAHRENHEIT", "WIND_SPEED", "WEATHER_ALERT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:27:07.936312 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b533-0004-3867-0002-594300045dae
[0m18:27:07.937080 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m18:27:07.937695 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: Close
[0m18:27:08.057718 [debug] [Thread-1 (]: Database Error in snapshot snapshot_extreme_weather_events (snapshots/extreme_weather_events_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/extreme_weather_events_snapshot.sql
[0m18:27:08.058538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '063d3817-0c29-4a83-8421-b304f3cb4be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f720d0>]}
[0m18:27:08.059491 [error] [Thread-1 (]: 3 of 7 ERROR snapshotting snapshot.snapshot_extreme_weather_events ............. [[31mERROR[0m in 3.34s]
[0m18:27:08.060117 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m18:27:08.060533 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_humidity_temperature
[0m18:27:08.061806 [info ] [Thread-1 (]: 4 of 7 START snapshot snapshot.snapshot_humidity_temperature ................... [RUN]
[0m18:27:08.062314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_extreme_weather_events, now snapshot.weather_dbt.snapshot_humidity_temperature)
[0m18:27:08.062659 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_humidity_temperature
[0m18:27:08.066113 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_humidity_temperature
[0m18:27:08.070760 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:27:08.071087 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE"
[0m18:27:08.071351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:08.495125 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.423 seconds
[0m18:27:08.506446 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:27:08.507261 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(TEMP_FAHRENHEIT) AS AVG_TEMP_FAHRENHEIT,
    AVG(HUMIDITY) AS AVG_HUMIDITY
FROM HumidityTemp
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY


    ),

    snapshotted_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
,
            md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            DAY as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DAY))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DAY)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:27:09.607399 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.099 seconds
[0m18:27:09.611343 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:27:09.611823 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE__dbt_tmp"
[0m18:27:09.713012 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.100 seconds
[0m18:27:09.720893 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:27:09.721294 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE"
[0m18:27:09.814717 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.093 seconds
[0m18:27:09.818396 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:27:09.818847 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE__dbt_tmp"
[0m18:27:09.932295 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.113 seconds
[0m18:27:09.938576 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:27:09.939043 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE"
[0m18:27:10.050465 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.111 seconds
[0m18:27:10.056059 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:27:10.056788 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE__dbt_tmp"
[0m18:27:10.146759 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.089 seconds
[0m18:27:10.153509 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:27:10.154216 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
select * from (
        

    with snapshot_query as (

        



WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(TEMP_FAHRENHEIT) AS AVG_TEMP_FAHRENHEIT,
    AVG(HUMIDITY) AS AVG_HUMIDITY
FROM HumidityTemp
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY


    ),

    snapshotted_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
,
            md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            DAY as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DAY))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DAY)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:27:10.335712 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.180 seconds
[0m18:27:10.339076 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:27:10.339841 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:27:10.430354 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.090 seconds
[0m18:27:10.432312 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:27:10.435380 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:27:10.435864 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
BEGIN
[0m18:27:10.587420 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.151 seconds
[0m18:27:10.588557 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:27:10.589255 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
merge into "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_NAME", "DAY", "AVG_TEMP_FAHRENHEIT", "AVG_HUMIDITY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_NAME", "DAY", "AVG_TEMP_FAHRENHEIT", "AVG_HUMIDITY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:27:11.103691 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.513 seconds
[0m18:27:11.105080 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:27:11.105654 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
COMMIT
[0m18:27:11.464765 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.358 seconds
[0m18:27:11.468773 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: Close
[0m18:27:11.601248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '063d3817-0c29-4a83-8421-b304f3cb4be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110772c50>]}
[0m18:27:11.602703 [info ] [Thread-1 (]: 4 of 7 OK snapshotted snapshot.snapshot_humidity_temperature ................... [[32mSUCCESS 0[0m in 3.54s]
[0m18:27:11.603483 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_humidity_temperature
[0m18:27:11.603971 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_temp_trends
[0m18:27:11.604595 [info ] [Thread-1 (]: 5 of 7 START snapshot snapshot.snapshot_temp_trends ............................ [RUN]
[0m18:27:11.605192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_humidity_temperature, now snapshot.weather_dbt.snapshot_temp_trends)
[0m18:27:11.605630 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_temp_trends
[0m18:27:11.611021 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_temp_trends
[0m18:27:11.615397 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:27:11.615807 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS"
[0m18:27:11.616111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:12.080370 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.463 seconds
[0m18:27:12.092499 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:27:12.093242 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH TempTrends AS (
    SELECT 
        "Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY


    ),

    snapshotted_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
,
            md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            DAY as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DAY))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DAY)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:27:13.193528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.100 seconds
[0m18:27:13.195120 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:27:13.195338 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS__dbt_tmp"
[0m18:27:13.277955 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.082 seconds
[0m18:27:13.280772 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:27:13.281056 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS"
[0m18:27:13.375194 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.094 seconds
[0m18:27:13.378734 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:27:13.379184 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS__dbt_tmp"
[0m18:27:13.510686 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.131 seconds
[0m18:27:13.515228 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:27:13.515687 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS"
[0m18:27:13.644320 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.128 seconds
[0m18:27:13.651675 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:27:13.652284 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS__dbt_tmp"
[0m18:27:13.759649 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.107 seconds
[0m18:27:13.767974 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:27:13.768768 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
select * from (
        

    with snapshot_query as (

        



WITH TempTrends AS (
    SELECT 
        "Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY


    ),

    snapshotted_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
,
            md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            DAY as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DAY))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DAY)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:27:14.055330 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.286 seconds
[0m18:27:14.057424 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:27:14.057962 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:27:14.166406 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.108 seconds
[0m18:27:14.168500 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:27:14.174155 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:27:14.174875 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
BEGIN
[0m18:27:14.301572 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.126 seconds
[0m18:27:14.302511 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:27:14.303054 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
merge into "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_NAME", "DAY", "AVG_TEMP_FAHRENHEIT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_NAME", "DAY", "AVG_TEMP_FAHRENHEIT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:27:14.833595 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.529 seconds
[0m18:27:14.835573 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:27:14.836087 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
COMMIT
[0m18:27:15.137904 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.301 seconds
[0m18:27:15.143957 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: Close
[0m18:27:15.293765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '063d3817-0c29-4a83-8421-b304f3cb4be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ef2dd0>]}
[0m18:27:15.295037 [info ] [Thread-1 (]: 5 of 7 OK snapshotted snapshot.snapshot_temp_trends ............................ [[32mSUCCESS 0[0m in 3.69s]
[0m18:27:15.295874 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_temp_trends
[0m18:27:15.296451 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_weather_distribution
[0m18:27:15.297194 [info ] [Thread-1 (]: 6 of 7 START snapshot snapshot.snapshot_weather_distribution ................... [RUN]
[0m18:27:15.297907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_temp_trends, now snapshot.weather_dbt.snapshot_weather_distribution)
[0m18:27:15.298349 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_weather_distribution
[0m18:27:15.302953 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_weather_distribution
[0m18:27:15.312047 [debug] [Thread-1 (]: Compilation Error in snapshot snapshot_weather_distribution (snapshots/weather_cond_distributions_snapshot.sql)
  The specified strategy macro 'append_only' was not found in package 'None'
  
  > in macro strategy_dispatch (macros/materializations/snapshots/strategies.sql)
  > called by macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by macro materialization_snapshot_snowflake (macros/materializations/snapshot.sql)
  > called by snapshot snapshot_weather_distribution (snapshots/weather_cond_distributions_snapshot.sql)
[0m18:27:15.312643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '063d3817-0c29-4a83-8421-b304f3cb4be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114fd2630>]}
[0m18:27:15.313344 [error] [Thread-1 (]: 6 of 7 ERROR snapshotting snapshot.snapshot_weather_distribution ............... [[31mERROR[0m in 0.01s]
[0m18:27:15.313867 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_weather_distribution
[0m18:27:15.314206 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_wind_speed
[0m18:27:15.314683 [info ] [Thread-1 (]: 7 of 7 START snapshot snapshot.snapshot_wind_speed ............................. [RUN]
[0m18:27:15.315143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_weather_distribution, now snapshot.weather_dbt.snapshot_wind_speed)
[0m18:27:15.315672 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_wind_speed
[0m18:27:15.318511 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_wind_speed
[0m18:27:15.322022 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:27:15.322360 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED"
[0m18:27:15.322629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:15.792207 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.469 seconds
[0m18:27:15.801842 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:27:15.802466 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(WIND_SPEED) AS AVG_WIND_SPEED
FROM WindSpeedData
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY


    ),

    snapshotted_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
,
            md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            DAY as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DAY))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DAY)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:27:16.883793 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.080 seconds
[0m18:27:16.893082 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:27:16.893537 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED__dbt_tmp"
[0m18:27:16.987930 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.094 seconds
[0m18:27:16.992705 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:27:16.993131 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED"
[0m18:27:17.086535 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.093 seconds
[0m18:27:17.092055 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:27:17.092664 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED__dbt_tmp"
[0m18:27:17.192845 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.099 seconds
[0m18:27:17.198042 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:27:17.198542 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED"
[0m18:27:17.302707 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.104 seconds
[0m18:27:17.308351 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:27:17.308942 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED__dbt_tmp"
[0m18:27:17.404971 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.095 seconds
[0m18:27:17.413969 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:27:17.414688 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
select * from (
        

    with snapshot_query as (

        



WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(WIND_SPEED) AS AVG_WIND_SPEED
FROM WindSpeedData
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY


    ),

    snapshotted_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
,
            md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            DAY as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DAY))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DAY)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:27:17.697465 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.282 seconds
[0m18:27:17.699141 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:27:17.699522 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:27:17.773826 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.074 seconds
[0m18:27:17.774896 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:27:17.777193 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:27:17.777701 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
BEGIN
[0m18:27:17.917225 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.139 seconds
[0m18:27:17.918698 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:27:17.919548 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
merge into "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_NAME", "DAY", "AVG_WIND_SPEED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_NAME", "DAY", "AVG_WIND_SPEED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:27:18.445557 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.525 seconds
[0m18:27:18.446926 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:27:18.447382 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
COMMIT
[0m18:27:18.771841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.324 seconds
[0m18:27:18.775534 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: Close
[0m18:27:18.898001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '063d3817-0c29-4a83-8421-b304f3cb4be1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114fd2630>]}
[0m18:27:18.899308 [info ] [Thread-1 (]: 7 of 7 OK snapshotted snapshot.snapshot_wind_speed ............................. [[32mSUCCESS 0[0m in 3.58s]
[0m18:27:18.900152 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_wind_speed
[0m18:27:18.901868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:18.902247 [debug] [MainThread]: Connection 'snapshot.weather_dbt.snapshot_wind_speed' was properly closed.
[0m18:27:18.902587 [info ] [MainThread]: 
[0m18:27:18.902913 [info ] [MainThread]: Finished running 7 snapshots in 0 hours 0 minutes and 23.61 seconds (23.61s).
[0m18:27:18.904426 [debug] [MainThread]: Command end result
[0m18:27:18.935936 [info ] [MainThread]: 
[0m18:27:18.936315 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:27:18.936528 [info ] [MainThread]: 
[0m18:27:18.936796 [error] [MainThread]:   Database Error in snapshot snapshot_extreme_weather_events (snapshots/extreme_weather_events_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/extreme_weather_events_snapshot.sql
[0m18:27:18.936976 [info ] [MainThread]: 
[0m18:27:18.937222 [error] [MainThread]:   Compilation Error in snapshot snapshot_weather_distribution (snapshots/weather_cond_distributions_snapshot.sql)
  The specified strategy macro 'append_only' was not found in package 'None'
  
  > in macro strategy_dispatch (macros/materializations/snapshots/strategies.sql)
  > called by macro materialization_snapshot_default (macros/materializations/snapshots/snapshot.sql)
  > called by macro materialization_snapshot_snowflake (macros/materializations/snapshot.sql)
  > called by snapshot snapshot_weather_distribution (snapshots/weather_cond_distributions_snapshot.sql)
[0m18:27:18.937420 [info ] [MainThread]: 
[0m18:27:18.937609 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m18:27:18.939251 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 24.369324, "process_in_blocks": "0", "process_kernel_time": 0.364999, "process_mem_max_rss": "144277504", "process_out_blocks": "0", "process_user_time": 2.614975}
[0m18:27:18.939672 [debug] [MainThread]: Command `dbt snapshot` failed at 18:27:18.939608 after 24.37 seconds
[0m18:27:18.939913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129c3770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c6fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c6fb30>]}
[0m18:27:18.940129 [debug] [MainThread]: Flushing usage events
[0m18:28:05.666880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103224d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b27b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b27d90>]}


============================== 18:28:05.670157 | ef94637d-4111-47f6-8da8-1a4bfceb668b ==============================
[0m18:28:05.670157 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:28:05.670514 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:28:05.897770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef94637d-4111-47f6-8da8-1a4bfceb668b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105772b10>]}
[0m18:28:05.920548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef94637d-4111-47f6-8da8-1a4bfceb668b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105774050>]}
[0m18:28:05.921956 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:28:05.982817 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:28:06.069291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:28:06.069691 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/weather_cond_distributions_snapshot.sql
[0m18:28:06.142662 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: A snapshot configured with the check strategy must specify a check_cols configuration.
[0m18:28:06.144331 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.5152672, "process_in_blocks": "0", "process_kernel_time": 0.201923, "process_mem_max_rss": "124354560", "process_out_blocks": "0", "process_user_time": 0.909552}
[0m18:28:06.144649 [debug] [MainThread]: Command `dbt snapshot` failed at 18:28:06.144595 after 0.52 seconds
[0m18:28:06.144850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f5450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f4c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b41040>]}
[0m18:28:06.145014 [debug] [MainThread]: Flushing usage events
[0m18:28:23.375968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c17b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c17d90>]}


============================== 18:28:23.379103 | 8f6cc116-9d52-4039-aeb9-b6dde6572af5 ==============================
[0m18:28:23.379103 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:28:23.379421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:28:23.627584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f6cc116-9d52-4039-aeb9-b6dde6572af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11397ab10>]}
[0m18:28:23.652588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f6cc116-9d52-4039-aeb9-b6dde6572af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11397c050>]}
[0m18:28:23.653391 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:28:23.713653 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:28:23.803277 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:28:23.803741 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://snapshots/weather_cond_distributions_snapshot.sql
[0m18:28:23.922630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f6cc116-9d52-4039-aeb9-b6dde6572af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114081950>]}
[0m18:28:24.026957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f6cc116-9d52-4039-aeb9-b6dde6572af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113841400>]}
[0m18:28:24.027284 [info ] [MainThread]: Found 8 models, 7 snapshots, 29 data tests, 2 sources, 459 macros
[0m18:28:24.027578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f6cc116-9d52-4039-aeb9-b6dde6572af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139884b0>]}
[0m18:28:24.028871 [info ] [MainThread]: 
[0m18:28:24.029168 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:28:24.031380 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_openweather'
[0m18:28:24.037963 [debug] [ThreadPool]: Using snowflake connection "list_openweather"
[0m18:28:24.038161 [debug] [ThreadPool]: On list_openweather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather"} */
show terse schemas in database openweather
    limit 10000
[0m18:28:24.038299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:24.679221 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.638 seconds
[0m18:28:24.682624 [debug] [ThreadPool]: On list_openweather: Close
[0m18:28:24.802589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather, now list_openweather_analytics)
[0m18:28:24.812894 [debug] [ThreadPool]: Using snowflake connection "list_openweather_analytics"
[0m18:28:24.813282 [debug] [ThreadPool]: On list_openweather_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_analytics"} */
show objects in openweather.analytics limit 10000
[0m18:28:24.813564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:28:25.277668 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.464 seconds
[0m18:28:25.283757 [debug] [ThreadPool]: On list_openweather_analytics: Close
[0m18:28:25.411841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_openweather_analytics, now list_openweather_snapshot)
[0m18:28:25.416512 [debug] [ThreadPool]: Using snowflake connection "list_openweather_snapshot"
[0m18:28:25.416886 [debug] [ThreadPool]: On list_openweather_snapshot: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "connection_name": "list_openweather_snapshot"} */
show objects in openweather.snapshot limit 10000
[0m18:28:25.417191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:28:25.901085 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.484 seconds
[0m18:28:25.905610 [debug] [ThreadPool]: On list_openweather_snapshot: Close
[0m18:28:26.034114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f6cc116-9d52-4039-aeb9-b6dde6572af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139c9b20>]}
[0m18:28:26.035197 [info ] [MainThread]: Concurrency: 1 threads (target='openweather')
[0m18:28:26.035681 [info ] [MainThread]: 
[0m18:28:26.040474 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_cloud_coverage
[0m18:28:26.041142 [info ] [Thread-1 (]: 1 of 7 START snapshot snapshot.snapshot_cloud_coverage ......................... [RUN]
[0m18:28:26.041642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_openweather_snapshot, now snapshot.weather_dbt.snapshot_cloud_coverage)
[0m18:28:26.042510 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_cloud_coverage
[0m18:28:26.056310 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_cloud_coverage
[0m18:28:26.092822 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:28:26.093147 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE"
[0m18:28:26.093351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:26.495569 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.402 seconds
[0m18:28:26.540191 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:28:26.540616 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH CloudCoverage AS (
    SELECT 
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY


    ),

    snapshotted_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
,
            md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            DAY as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DAY))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DAY)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:28:27.620133 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.078 seconds
[0m18:28:27.625074 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:28:27.625619 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE__dbt_tmp"
[0m18:28:27.730920 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.105 seconds
[0m18:28:27.736414 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:28:27.737099 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE"
[0m18:28:27.845066 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.107 seconds
[0m18:28:27.850685 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:28:27.851475 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE__dbt_tmp"
[0m18:28:27.949754 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.097 seconds
[0m18:28:27.955747 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:28:27.956344 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE"
[0m18:28:28.074259 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.118 seconds
[0m18:28:28.079068 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:28:28.079351 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE__dbt_tmp"
[0m18:28:28.163847 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.084 seconds
[0m18:28:28.183580 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:28:28.184027 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
select * from (
        

    with snapshot_query as (

        



WITH CloudCoverage AS (
    SELECT 
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(w.CLOUD_COVERAGE) AS AVG_CLOUD_COVERAGE
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM CloudCoverage
ORDER BY DAY


    ),

    snapshotted_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
,
            md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            DAY as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DAY))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DAY)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:28:28.392346 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.208 seconds
[0m18:28:28.398122 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:28:28.398681 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:28:28.503189 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.104 seconds
[0m18:28:28.505134 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:28:28.509441 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:28:28.510180 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
BEGIN
[0m18:28:28.664566 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.153 seconds
[0m18:28:28.665637 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:28:28.666143 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
merge into "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CLOUD_COVERAGE__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_NAME", "DAY", "AVG_CLOUD_COVERAGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_NAME", "DAY", "AVG_CLOUD_COVERAGE", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:28:29.166136 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.499 seconds
[0m18:28:29.168221 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_cloud_coverage"
[0m18:28:29.169227 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_cloud_coverage"} */
COMMIT
[0m18:28:29.438687 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.269 seconds
[0m18:28:29.460439 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_cloud_coverage: Close
[0m18:28:29.613262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f6cc116-9d52-4039-aeb9-b6dde6572af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115959910>]}
[0m18:28:29.614352 [info ] [Thread-1 (]: 1 of 7 OK snapshotted snapshot.snapshot_cloud_coverage ......................... [[32mSUCCESS 0[0m in 3.57s]
[0m18:28:29.615082 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_cloud_coverage
[0m18:28:29.615611 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_correlation_data
[0m18:28:29.616127 [info ] [Thread-1 (]: 2 of 7 START snapshot snapshot.snapshot_correlation_data ....................... [RUN]
[0m18:28:29.616749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_cloud_coverage, now snapshot.weather_dbt.snapshot_correlation_data)
[0m18:28:29.617263 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_correlation_data
[0m18:28:29.620846 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_correlation_data
[0m18:28:29.639561 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:28:29.639966 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
select * from (
        



WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData

    ) as __dbt_sbq
    where false
    limit 0
[0m18:28:29.640234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:30.096480 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.456 seconds
[0m18:28:30.101892 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:28:30.102451 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA"
[0m18:28:30.202969 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.100 seconds
[0m18:28:30.208120 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:28:30.208593 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA"
[0m18:28:30.291954 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.083 seconds
[0m18:28:30.299470 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:28:30.300009 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData


    ),

    snapshotted_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CITY_NAME" != source_data."CITY_NAME"
        or
        (
            ((snapshotted_data."CITY_NAME" is null) and not (source_data."CITY_NAME" is null))
            or
            ((not snapshotted_data."CITY_NAME" is null) and (source_data."CITY_NAME" is null))
        ) or snapshotted_data."AVG_TEMP" != source_data."AVG_TEMP"
        or
        (
            ((snapshotted_data."AVG_TEMP" is null) and not (source_data."AVG_TEMP" is null))
            or
            ((not snapshotted_data."AVG_TEMP" is null) and (source_data."AVG_TEMP" is null))
        ) or snapshotted_data."AVG_HUMIDITY" != source_data."AVG_HUMIDITY"
        or
        (
            ((snapshotted_data."AVG_HUMIDITY" is null) and not (source_data."AVG_HUMIDITY" is null))
            or
            ((not snapshotted_data."AVG_HUMIDITY" is null) and (source_data."AVG_HUMIDITY" is null))
        ) or snapshotted_data."AVG_PRESSURE" != source_data."AVG_PRESSURE"
        or
        (
            ((snapshotted_data."AVG_PRESSURE" is null) and not (source_data."AVG_PRESSURE" is null))
            or
            ((not snapshotted_data."AVG_PRESSURE" is null) and (source_data."AVG_PRESSURE" is null))
        ) or snapshotted_data."AVG_WIND_SPEED" != source_data."AVG_WIND_SPEED"
        or
        (
            ((snapshotted_data."AVG_WIND_SPEED" is null) and not (source_data."AVG_WIND_SPEED" is null))
            or
            ((not snapshotted_data."AVG_WIND_SPEED" is null) and (source_data."AVG_WIND_SPEED" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CITY_NAME" != source_data."CITY_NAME"
        or
        (
            ((snapshotted_data."CITY_NAME" is null) and not (source_data."CITY_NAME" is null))
            or
            ((not snapshotted_data."CITY_NAME" is null) and (source_data."CITY_NAME" is null))
        ) or snapshotted_data."AVG_TEMP" != source_data."AVG_TEMP"
        or
        (
            ((snapshotted_data."AVG_TEMP" is null) and not (source_data."AVG_TEMP" is null))
            or
            ((not snapshotted_data."AVG_TEMP" is null) and (source_data."AVG_TEMP" is null))
        ) or snapshotted_data."AVG_HUMIDITY" != source_data."AVG_HUMIDITY"
        or
        (
            ((snapshotted_data."AVG_HUMIDITY" is null) and not (source_data."AVG_HUMIDITY" is null))
            or
            ((not snapshotted_data."AVG_HUMIDITY" is null) and (source_data."AVG_HUMIDITY" is null))
        ) or snapshotted_data."AVG_PRESSURE" != source_data."AVG_PRESSURE"
        or
        (
            ((snapshotted_data."AVG_PRESSURE" is null) and not (source_data."AVG_PRESSURE" is null))
            or
            ((not snapshotted_data."AVG_PRESSURE" is null) and (source_data."AVG_PRESSURE" is null))
        ) or snapshotted_data."AVG_WIND_SPEED" != source_data."AVG_WIND_SPEED"
        or
        (
            ((snapshotted_data."AVG_WIND_SPEED" is null) and not (source_data."AVG_WIND_SPEED" is null))
            or
            ((not snapshotted_data."AVG_WIND_SPEED" is null) and (source_data."AVG_WIND_SPEED" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:28:31.130729 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.829 seconds
[0m18:28:31.138270 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:28:31.138842 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA__dbt_tmp"
[0m18:28:31.223320 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.084 seconds
[0m18:28:31.230006 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:28:31.230575 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA"
[0m18:28:31.312477 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.081 seconds
[0m18:28:31.318572 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:28:31.319123 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA__dbt_tmp"
[0m18:28:31.439757 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.120 seconds
[0m18:28:31.445719 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:28:31.446479 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA"
[0m18:28:31.537193 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.090 seconds
[0m18:28:31.540678 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:28:31.540949 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA__dbt_tmp"
[0m18:28:31.685677 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.144 seconds
[0m18:28:31.696534 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:28:31.697583 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
select * from (
        

    with snapshot_query as (

        



WITH CorrelationData AS (
    SELECT 
        c."Name" AS CITY_NAME,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP,
        AVG(w.HUMIDITY) AS AVG_HUMIDITY,
        AVG(w.PRESSURE) AS AVG_PRESSURE,
        AVG(w.WIND_SPEED) AS AVG_WIND_SPEED
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        1
)
SELECT *
FROM CorrelationData


    ),

    snapshotted_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CITY_NAME" != source_data."CITY_NAME"
        or
        (
            ((snapshotted_data."CITY_NAME" is null) and not (source_data."CITY_NAME" is null))
            or
            ((not snapshotted_data."CITY_NAME" is null) and (source_data."CITY_NAME" is null))
        ) or snapshotted_data."AVG_TEMP" != source_data."AVG_TEMP"
        or
        (
            ((snapshotted_data."AVG_TEMP" is null) and not (source_data."AVG_TEMP" is null))
            or
            ((not snapshotted_data."AVG_TEMP" is null) and (source_data."AVG_TEMP" is null))
        ) or snapshotted_data."AVG_HUMIDITY" != source_data."AVG_HUMIDITY"
        or
        (
            ((snapshotted_data."AVG_HUMIDITY" is null) and not (source_data."AVG_HUMIDITY" is null))
            or
            ((not snapshotted_data."AVG_HUMIDITY" is null) and (source_data."AVG_HUMIDITY" is null))
        ) or snapshotted_data."AVG_PRESSURE" != source_data."AVG_PRESSURE"
        or
        (
            ((snapshotted_data."AVG_PRESSURE" is null) and not (source_data."AVG_PRESSURE" is null))
            or
            ((not snapshotted_data."AVG_PRESSURE" is null) and (source_data."AVG_PRESSURE" is null))
        ) or snapshotted_data."AVG_WIND_SPEED" != source_data."AVG_WIND_SPEED"
        or
        (
            ((snapshotted_data."AVG_WIND_SPEED" is null) and not (source_data."AVG_WIND_SPEED" is null))
            or
            ((not snapshotted_data."AVG_WIND_SPEED" is null) and (source_data."AVG_WIND_SPEED" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CITY_NAME" != source_data."CITY_NAME"
        or
        (
            ((snapshotted_data."CITY_NAME" is null) and not (source_data."CITY_NAME" is null))
            or
            ((not snapshotted_data."CITY_NAME" is null) and (source_data."CITY_NAME" is null))
        ) or snapshotted_data."AVG_TEMP" != source_data."AVG_TEMP"
        or
        (
            ((snapshotted_data."AVG_TEMP" is null) and not (source_data."AVG_TEMP" is null))
            or
            ((not snapshotted_data."AVG_TEMP" is null) and (source_data."AVG_TEMP" is null))
        ) or snapshotted_data."AVG_HUMIDITY" != source_data."AVG_HUMIDITY"
        or
        (
            ((snapshotted_data."AVG_HUMIDITY" is null) and not (source_data."AVG_HUMIDITY" is null))
            or
            ((not snapshotted_data."AVG_HUMIDITY" is null) and (source_data."AVG_HUMIDITY" is null))
        ) or snapshotted_data."AVG_PRESSURE" != source_data."AVG_PRESSURE"
        or
        (
            ((snapshotted_data."AVG_PRESSURE" is null) and not (source_data."AVG_PRESSURE" is null))
            or
            ((not snapshotted_data."AVG_PRESSURE" is null) and (source_data."AVG_PRESSURE" is null))
        ) or snapshotted_data."AVG_WIND_SPEED" != source_data."AVG_WIND_SPEED"
        or
        (
            ((snapshotted_data."AVG_WIND_SPEED" is null) and not (source_data."AVG_WIND_SPEED" is null))
            or
            ((not snapshotted_data."AVG_WIND_SPEED" is null) and (source_data."AVG_WIND_SPEED" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:28:31.989699 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.291 seconds
[0m18:28:31.991667 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:28:31.992221 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:28:32.076427 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.083 seconds
[0m18:28:32.078566 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:28:32.080917 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:28:32.081347 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
BEGIN
[0m18:28:32.261098 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.179 seconds
[0m18:28:32.262510 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:28:32.263223 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
merge into "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_CORRELATION_DATA__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_NAME", "AVG_TEMP", "AVG_HUMIDITY", "AVG_PRESSURE", "AVG_WIND_SPEED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_NAME", "AVG_TEMP", "AVG_HUMIDITY", "AVG_PRESSURE", "AVG_WIND_SPEED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:28:32.813190 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.549 seconds
[0m18:28:32.814001 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_correlation_data"
[0m18:28:32.814371 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_correlation_data"} */
COMMIT
[0m18:28:33.272039 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.457 seconds
[0m18:28:33.277049 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_correlation_data: Close
[0m18:28:33.440949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f6cc116-9d52-4039-aeb9-b6dde6572af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a41de0>]}
[0m18:28:33.442309 [info ] [Thread-1 (]: 2 of 7 OK snapshotted snapshot.snapshot_correlation_data ....................... [[32mSUCCESS 0[0m in 3.82s]
[0m18:28:33.443175 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_correlation_data
[0m18:28:33.443777 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m18:28:33.444503 [info ] [Thread-1 (]: 3 of 7 START snapshot snapshot.snapshot_extreme_weather_events ................. [RUN]
[0m18:28:33.445023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_correlation_data, now snapshot.weather_dbt.snapshot_extreme_weather_events)
[0m18:28:33.445412 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m18:28:33.450089 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m18:28:33.455324 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:28:33.455756 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS"
[0m18:28:33.456138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:33.917016 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.460 seconds
[0m18:28:33.927258 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:28:33.928025 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME


    ),

    snapshotted_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            DATE_TIME as dbt_updated_at,
            DATE_TIME as dbt_valid_from,
            
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            DATE_TIME as dbt_updated_at,
            DATE_TIME as dbt_valid_from,
            DATE_TIME as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DATE_TIME))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DATE_TIME)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:28:35.221597 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.292 seconds
[0m18:28:35.231072 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:28:35.231598 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS__dbt_tmp"
[0m18:28:35.376044 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.144 seconds
[0m18:28:35.382936 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:28:35.383361 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS"
[0m18:28:35.482246 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.098 seconds
[0m18:28:35.486620 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:28:35.487061 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS__dbt_tmp"
[0m18:28:35.607546 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.120 seconds
[0m18:28:35.614351 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:28:35.614870 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS"
[0m18:28:35.698658 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.083 seconds
[0m18:28:35.704459 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:28:35.705011 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS__dbt_tmp"
[0m18:28:35.789814 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.084 seconds
[0m18:28:35.796747 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:28:35.797414 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
select * from (
        

    with snapshot_query as (

        



WITH Extreme_Weather_Events AS (
    SELECT
        w.CITY_ID,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.WIND_SPEED,
        CASE
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) > 100 THEN 'Extreme Heat'
            WHEN ((w.TEMP - 273.15) * 9/5 + 32) < 32 THEN 'Extreme Cold'
            WHEN w.WIND_SPEED > 20 THEN 'High Winds'
            ELSE 'Normal'
        END AS WEATHER_ALERT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        ((w.TEMP - 273.15) * 9/5 + 32) > 100
        OR ((w.TEMP - 273.15) * 9/5 + 32) < 32
        OR w.WIND_SPEED > 20
)
SELECT
    *
FROM
    Extreme_Weather_Events
ORDER BY
    DATE_TIME, CITY_NAME


    ),

    snapshotted_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            DATE_TIME as dbt_updated_at,
            DATE_TIME as dbt_valid_from,
            
  
  coalesce(nullif(DATE_TIME, DATE_TIME), null)
  as dbt_valid_to
,
            md5(coalesce(cast(CITY_NAME as varchar ), '')
         || '|' || coalesce(cast(DATE_TIME as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    
,
            DATE_TIME as dbt_updated_at,
            DATE_TIME as dbt_valid_from,
            DATE_TIME as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        CITY_NAME as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DATE_TIME))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DATE_TIME)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:28:36.025744 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.227 seconds
[0m18:28:36.028647 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:28:36.029306 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:28:36.116437 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.086 seconds
[0m18:28:36.117680 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:28:36.121465 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:28:36.122039 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
BEGIN
[0m18:28:36.284864 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.162 seconds
[0m18:28:36.286406 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_extreme_weather_events"
[0m18:28:36.287358 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_extreme_weather_events"} */
merge into "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_EXTREME_WEATHER_EVENTS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_ID", "CITY_NAME", "DATE_TIME", "TEMP_FAHRENHEIT", "WIND_SPEED", "WEATHER_ALERT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_ID", "CITY_NAME", "DATE_TIME", "TEMP_FAHRENHEIT", "WIND_SPEED", "WEATHER_ALERT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:28:36.970447 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8b534-0004-386c-0002-594300043d7a
[0m18:28:36.971144 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m18:28:36.971673 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_extreme_weather_events: Close
[0m18:28:37.117353 [debug] [Thread-1 (]: Database Error in snapshot snapshot_extreme_weather_events (snapshots/extreme_weather_events_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/extreme_weather_events_snapshot.sql
[0m18:28:37.117798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f6cc116-9d52-4039-aeb9-b6dde6572af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c7a0d0>]}
[0m18:28:37.118375 [error] [Thread-1 (]: 3 of 7 ERROR snapshotting snapshot.snapshot_extreme_weather_events ............. [[31mERROR[0m in 3.67s]
[0m18:28:37.118816 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_extreme_weather_events
[0m18:28:37.119108 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_humidity_temperature
[0m18:28:37.119418 [info ] [Thread-1 (]: 4 of 7 START snapshot snapshot.snapshot_humidity_temperature ................... [RUN]
[0m18:28:37.120255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_extreme_weather_events, now snapshot.weather_dbt.snapshot_humidity_temperature)
[0m18:28:37.120586 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_humidity_temperature
[0m18:28:37.122911 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_humidity_temperature
[0m18:28:37.126195 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:28:37.126520 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE"
[0m18:28:37.126755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:37.619873 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.493 seconds
[0m18:28:37.626131 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:28:37.626634 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(TEMP_FAHRENHEIT) AS AVG_TEMP_FAHRENHEIT,
    AVG(HUMIDITY) AS AVG_HUMIDITY
FROM HumidityTemp
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY


    ),

    snapshotted_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
,
            md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            DAY as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DAY))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DAY)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:28:38.908869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.281 seconds
[0m18:28:38.913621 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:28:38.914135 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE__dbt_tmp"
[0m18:28:39.027308 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.112 seconds
[0m18:28:39.033638 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:28:39.034115 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE"
[0m18:28:39.117404 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.083 seconds
[0m18:28:39.122634 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:28:39.123214 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE__dbt_tmp"
[0m18:28:39.225563 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.102 seconds
[0m18:28:39.230355 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:28:39.230710 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE"
[0m18:28:39.329943 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.099 seconds
[0m18:28:39.335920 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:28:39.336553 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE__dbt_tmp"
[0m18:28:39.441939 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.105 seconds
[0m18:28:39.449371 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:28:39.450081 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
select * from (
        

    with snapshot_query as (

        



WITH HumidityTemp AS (
    SELECT 
        ((w.TEMP - 273.15) * 9/5 + 32) AS TEMP_FAHRENHEIT,
        w.HUMIDITY,
        c."Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.HUMIDITY IS NOT NULL 
        AND w.TEMP IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(TEMP_FAHRENHEIT) AS AVG_TEMP_FAHRENHEIT,
    AVG(HUMIDITY) AS AVG_HUMIDITY
FROM HumidityTemp
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY


    ),

    snapshotted_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
,
            md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            DAY as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DAY))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DAY)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:28:39.745820 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.295 seconds
[0m18:28:39.747981 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:28:39.748541 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:28:39.823267 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.074 seconds
[0m18:28:39.825225 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:28:39.828678 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:28:39.829088 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
BEGIN
[0m18:28:39.935253 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m18:28:39.936695 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:28:39.938023 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
merge into "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_HUMIDITY_TEMPERATURE__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_NAME", "DAY", "AVG_TEMP_FAHRENHEIT", "AVG_HUMIDITY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_NAME", "DAY", "AVG_TEMP_FAHRENHEIT", "AVG_HUMIDITY", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:28:40.487703 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.549 seconds
[0m18:28:40.488694 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_humidity_temperature"
[0m18:28:40.489329 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_humidity_temperature"} */
COMMIT
[0m18:28:40.724046 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.234 seconds
[0m18:28:40.729015 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_humidity_temperature: Close
[0m18:28:40.884762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f6cc116-9d52-4039-aeb9-b6dde6572af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f7f550>]}
[0m18:28:40.886061 [info ] [Thread-1 (]: 4 of 7 OK snapshotted snapshot.snapshot_humidity_temperature ................... [[32mSUCCESS 0[0m in 3.76s]
[0m18:28:40.886949 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_humidity_temperature
[0m18:28:40.887460 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_temp_trends
[0m18:28:40.888101 [info ] [Thread-1 (]: 5 of 7 START snapshot snapshot.snapshot_temp_trends ............................ [RUN]
[0m18:28:40.888721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_humidity_temperature, now snapshot.weather_dbt.snapshot_temp_trends)
[0m18:28:40.889154 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_temp_trends
[0m18:28:40.894908 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_temp_trends
[0m18:28:40.899487 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:28:40.899929 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS"
[0m18:28:40.900272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:41.343154 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.442 seconds
[0m18:28:41.354752 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:28:41.355580 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH TempTrends AS (
    SELECT 
        "Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY


    ),

    snapshotted_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
,
            md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            DAY as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DAY))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DAY)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:28:42.388967 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.032 seconds
[0m18:28:42.394496 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:28:42.395235 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS__dbt_tmp"
[0m18:28:42.473618 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.078 seconds
[0m18:28:42.478365 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:28:42.478884 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS"
[0m18:28:42.556215 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.077 seconds
[0m18:28:42.560170 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:28:42.560602 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS__dbt_tmp"
[0m18:28:42.644174 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.083 seconds
[0m18:28:42.649871 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:28:42.650575 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS"
[0m18:28:42.736068 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.085 seconds
[0m18:28:42.742572 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:28:42.743103 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS__dbt_tmp"
[0m18:28:42.853766 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.110 seconds
[0m18:28:42.861925 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:28:42.862664 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
select * from (
        

    with snapshot_query as (

        



WITH TempTrends AS (
    SELECT 
        "Name" AS CITY_NAME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY,
        AVG(((w.TEMP - 273.15) * 9/5 + 32)) AS AVG_TEMP_FAHRENHEIT
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        CITY_NAME, DATE_TRUNC('DAY', w.DATE_TIME)
)
SELECT *
FROM TempTrends
ORDER BY CITY_NAME, DAY


    ),

    snapshotted_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
,
            md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            DAY as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DAY))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DAY)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:28:43.091587 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.228 seconds
[0m18:28:43.092656 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:28:43.092951 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:28:43.210691 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.117 seconds
[0m18:28:43.212839 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:28:43.216812 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:28:43.217484 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
BEGIN
[0m18:28:43.347967 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.129 seconds
[0m18:28:43.349640 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:28:43.350311 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
merge into "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_TEMP_TRENDS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_NAME", "DAY", "AVG_TEMP_FAHRENHEIT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_NAME", "DAY", "AVG_TEMP_FAHRENHEIT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:28:43.926251 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.575 seconds
[0m18:28:43.928311 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_temp_trends"
[0m18:28:43.929036 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_temp_trends"} */
COMMIT
[0m18:28:44.184926 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.255 seconds
[0m18:28:44.188356 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_temp_trends: Close
[0m18:28:44.308270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f6cc116-9d52-4039-aeb9-b6dde6572af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114132740>]}
[0m18:28:44.309538 [info ] [Thread-1 (]: 5 of 7 OK snapshotted snapshot.snapshot_temp_trends ............................ [[32mSUCCESS 0[0m in 3.42s]
[0m18:28:44.310397 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_temp_trends
[0m18:28:44.310981 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_weather_distribution
[0m18:28:44.311583 [info ] [Thread-1 (]: 6 of 7 START snapshot snapshot.snapshot_weather_distribution ................... [RUN]
[0m18:28:44.312103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_temp_trends, now snapshot.weather_dbt.snapshot_weather_distribution)
[0m18:28:44.312509 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_weather_distribution
[0m18:28:44.317128 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_weather_distribution
[0m18:28:44.321794 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:28:44.322266 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
select * from (
        select COUNT from (
                



WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, 3
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m18:28:44.322634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:44.890428 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.568 seconds
[0m18:28:44.896518 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:28:44.897443 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WEATHER_DISTRIBUTION"
[0m18:28:45.040463 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.142 seconds
[0m18:28:45.046905 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:28:45.047426 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WEATHER_DISTRIBUTION"
[0m18:28:45.152684 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.105 seconds
[0m18:28:45.161075 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:28:45.162056 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WEATHER_DISTRIBUTION__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, 3
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC


    ),

    snapshotted_data as (

        select *, 
    
        ['CITY_NAME', 'WEATHER_MAIN'] as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WEATHER_DISTRIBUTION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        ['CITY_NAME', 'WEATHER_MAIN'] as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(['CITY_NAME', 'WEATHER_MAIN'] as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        ['CITY_NAME', 'WEATHER_MAIN'] as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        ['CITY_NAME', 'WEATHER_MAIN'] as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."COUNT" != source_data."COUNT"
        or
        (
            ((snapshotted_data."COUNT" is null) and not (source_data."COUNT" is null))
            or
            ((not snapshotted_data."COUNT" is null) and (source_data."COUNT" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."COUNT" != source_data."COUNT"
        or
        (
            ((snapshotted_data."COUNT" is null) and not (source_data."COUNT" is null))
            or
            ((not snapshotted_data."COUNT" is null) and (source_data."COUNT" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:28:50.919532 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.760 seconds
[0m18:28:50.926321 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:28:50.926863 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WEATHER_DISTRIBUTION__dbt_tmp"
[0m18:28:51.003752 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.077 seconds
[0m18:28:51.012217 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:28:51.012561 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WEATHER_DISTRIBUTION"
[0m18:28:51.095960 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.083 seconds
[0m18:28:51.100600 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:28:51.101077 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WEATHER_DISTRIBUTION__dbt_tmp"
[0m18:28:51.198829 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.097 seconds
[0m18:28:51.205475 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:28:51.206084 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WEATHER_DISTRIBUTION"
[0m18:28:51.282863 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.076 seconds
[0m18:28:51.292416 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:28:51.292970 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WEATHER_DISTRIBUTION__dbt_tmp"
[0m18:28:51.379345 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.086 seconds
[0m18:28:51.387458 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:28:51.388057 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
select * from (
        

    with snapshot_query as (

        



WITH WeatherDistribution AS (
    SELECT 
        w.WEATHER_MAIN,
        COUNT(*) AS COUNT,
        c."Name" AS CITY_NAME
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    GROUP BY 
        w.WEATHER_MAIN, 3
)
SELECT *
FROM WeatherDistribution
ORDER BY COUNT DESC


    ),

    snapshotted_data as (

        select *, 
    
        ['CITY_NAME', 'WEATHER_MAIN'] as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WEATHER_DISTRIBUTION"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        ['CITY_NAME', 'WEATHER_MAIN'] as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(['CITY_NAME', 'WEATHER_MAIN'] as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        ['CITY_NAME', 'WEATHER_MAIN'] as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        ['CITY_NAME', 'WEATHER_MAIN'] as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."COUNT" != source_data."COUNT"
        or
        (
            ((snapshotted_data."COUNT" is null) and not (source_data."COUNT" is null))
            or
            ((not snapshotted_data."COUNT" is null) and (source_data."COUNT" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."COUNT" != source_data."COUNT"
        or
        (
            ((snapshotted_data."COUNT" is null) and not (source_data."COUNT" is null))
            or
            ((not snapshotted_data."COUNT" is null) and (source_data."COUNT" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:28:51.521927 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.133 seconds
[0m18:28:51.524458 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:28:51.525081 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:28:51.604536 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.079 seconds
[0m18:28:51.606658 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:28:51.610185 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:28:51.610667 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
BEGIN
[0m18:28:51.723076 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m18:28:51.724968 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_weather_distribution"
[0m18:28:51.726026 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_weather_distribution"} */
merge into "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WEATHER_DISTRIBUTION" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WEATHER_DISTRIBUTION__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("WEATHER_MAIN", "COUNT", "CITY_NAME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("WEATHER_MAIN", "COUNT", "CITY_NAME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:29:52.719076 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: None
[0m18:29:52.721520 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m18:29:52.722843 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_weather_distribution: Close
[0m18:29:52.852104 [debug] [Thread-1 (]: Database Error in snapshot snapshot_weather_distribution (snapshots/weather_cond_distributions_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/weather_cond_distributions_snapshot.sql
[0m18:29:52.852521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f6cc116-9d52-4039-aeb9-b6dde6572af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159d7cb0>]}
[0m18:29:52.853053 [error] [Thread-1 (]: 6 of 7 ERROR snapshotting snapshot.snapshot_weather_distribution ............... [[31mERROR[0m in 68.54s]
[0m18:29:52.853467 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_weather_distribution
[0m18:29:52.853772 [debug] [Thread-1 (]: Began running node snapshot.weather_dbt.snapshot_wind_speed
[0m18:29:52.854311 [info ] [Thread-1 (]: 7 of 7 START snapshot snapshot.snapshot_wind_speed ............................. [RUN]
[0m18:29:52.854807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.weather_dbt.snapshot_weather_distribution, now snapshot.weather_dbt.snapshot_wind_speed)
[0m18:29:52.855106 [debug] [Thread-1 (]: Began compiling node snapshot.weather_dbt.snapshot_wind_speed
[0m18:29:52.857691 [debug] [Thread-1 (]: Began executing node snapshot.weather_dbt.snapshot_wind_speed
[0m18:29:52.860877 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:29:52.861164 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED"
[0m18:29:52.861370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:53.415905 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.554 seconds
[0m18:29:53.426231 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:29:53.426919 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
create or replace temporary table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(WIND_SPEED) AS AVG_WIND_SPEED
FROM WindSpeedData
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY


    ),

    snapshotted_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
,
            md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            DAY as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DAY))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DAY)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:29:54.568219 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.140 seconds
[0m18:29:54.573102 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:29:54.573763 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED__dbt_tmp"
[0m18:29:54.685920 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.112 seconds
[0m18:29:54.690512 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:29:54.690893 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED"
[0m18:29:54.770584 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.079 seconds
[0m18:29:54.777175 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:29:54.777689 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED__dbt_tmp"
[0m18:29:54.855281 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.077 seconds
[0m18:29:54.859817 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:29:54.860227 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED"
[0m18:29:54.967706 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.107 seconds
[0m18:29:54.974209 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:29:54.974687 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
describe table "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED__dbt_tmp"
[0m18:29:55.079603 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.104 seconds
[0m18:29:55.088727 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:29:55.089555 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
select * from (
        

    with snapshot_query as (

        



WITH WindSpeedData AS (
    SELECT 
        w.WIND_SPEED,
        c."Name" AS CITY_NAME,
        w.DATE_TIME,
        DATE_TRUNC('DAY', w.DATE_TIME) AS DAY
    FROM
        openweather.raw_data.WEATHER_FACT_TABLE w
    JOIN
        openweather.raw_data.CITY_DIMENSION_TABLE c
    ON
        w.CITY_ID = c.CITY_ID
    WHERE
        w.WIND_SPEED IS NOT NULL
)
SELECT 
    CITY_NAME,
    DAY,
    AVG(WIND_SPEED) AS AVG_WIND_SPEED
FROM WindSpeedData
GROUP BY 
    CITY_NAME,
    DAY
ORDER BY 
    CITY_NAME,
    DAY


    ),

    snapshotted_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            
  
  coalesce(nullif(DAY, DAY), null)
  as dbt_valid_to
,
            md5(coalesce(cast(DAY as varchar ), '')
         || '|' || coalesce(cast(DAY as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    
,
            DAY as dbt_updated_at,
            DAY as dbt_valid_from,
            DAY as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        DAY as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.DAY))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.DAY)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m18:29:55.239821 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.149 seconds
[0m18:29:55.243056 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:29:55.243660 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:29:55.344752 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.100 seconds
[0m18:29:55.346726 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:29:55.349248 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:29:55.349860 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
BEGIN
[0m18:29:55.484610 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.134 seconds
[0m18:29:55.485926 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:29:55.486914 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
merge into "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED" as DBT_INTERNAL_DEST
    using "OPENWEATHER"."SNAPSHOT"."SNAPSHOT_WIND_SPEED__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("CITY_NAME", "DAY", "AVG_WIND_SPEED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("CITY_NAME", "DAY", "AVG_WIND_SPEED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:29:56.102015 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.614 seconds
[0m18:29:56.103046 [debug] [Thread-1 (]: Using snowflake connection "snapshot.weather_dbt.snapshot_wind_speed"
[0m18:29:56.103527 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "weather_dbt", "target_name": "openweather", "node_id": "snapshot.weather_dbt.snapshot_wind_speed"} */
COMMIT
[0m18:29:56.418157 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.314 seconds
[0m18:29:56.423016 [debug] [Thread-1 (]: On snapshot.weather_dbt.snapshot_wind_speed: Close
[0m18:29:56.550198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f6cc116-9d52-4039-aeb9-b6dde6572af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115cd2c90>]}
[0m18:29:56.551548 [info ] [Thread-1 (]: 7 of 7 OK snapshotted snapshot.snapshot_wind_speed ............................. [[32mSUCCESS 0[0m in 3.70s]
[0m18:29:56.552326 [debug] [Thread-1 (]: Finished running node snapshot.weather_dbt.snapshot_wind_speed
[0m18:29:56.553989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:29:56.554345 [debug] [MainThread]: Connection 'snapshot.weather_dbt.snapshot_wind_speed' was properly closed.
[0m18:29:56.554747 [info ] [MainThread]: 
[0m18:29:56.555121 [info ] [MainThread]: Finished running 7 snapshots in 0 hours 1 minutes and 32.53 seconds (92.53s).
[0m18:29:56.556619 [debug] [MainThread]: Command end result
[0m18:29:56.587803 [info ] [MainThread]: 
[0m18:29:56.588183 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:29:56.588387 [info ] [MainThread]: 
[0m18:29:56.588779 [error] [MainThread]:   Database Error in snapshot snapshot_extreme_weather_events (snapshots/extreme_weather_events_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/extreme_weather_events_snapshot.sql
[0m18:29:56.589106 [info ] [MainThread]: 
[0m18:29:56.589371 [error] [MainThread]:   Database Error in snapshot snapshot_weather_distribution (snapshots/weather_cond_distributions_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/weather_dbt/snapshots/weather_cond_distributions_snapshot.sql
[0m18:29:56.589567 [info ] [MainThread]: 
[0m18:29:56.589758 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m18:29:56.591689 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 93.26842, "process_in_blocks": "0", "process_kernel_time": 0.374431, "process_mem_max_rss": "143294464", "process_out_blocks": "0", "process_user_time": 2.800413}
[0m18:29:56.592147 [debug] [MainThread]: Command `dbt snapshot` failed at 18:29:56.592075 after 93.27 seconds
[0m18:29:56.592416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115cd2870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115f5fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115f5fa10>]}
[0m18:29:56.592655 [debug] [MainThread]: Flushing usage events
[0m18:32:35.451652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104714d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10603fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10603fd90>]}


============================== 18:32:35.454455 | dd7e5edd-1364-45e5-b552-3fee241ae15d ==============================
[0m18:32:35.454455 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:32:35.454776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/weather_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:32:35.508205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd7e5edd-1364-45e5-b552-3fee241ae15d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eab360>]}
[0m18:32:35.524062 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.10729775, "process_in_blocks": "0", "process_kernel_time": 0.136025, "process_mem_max_rss": "100319232", "process_out_blocks": "0", "process_user_time": 0.628461}
[0m18:32:35.524385 [debug] [MainThread]: Command `dbt clean` succeeded at 18:32:35.524328 after 0.11 seconds
[0m18:32:35.524735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10616a580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10616a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dd2950>]}
[0m18:32:35.524959 [debug] [MainThread]: Flushing usage events
